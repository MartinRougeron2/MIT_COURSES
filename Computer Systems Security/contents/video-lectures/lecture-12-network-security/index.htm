<!DOCTYPE html><html lang="en">
      
      
        
    
    
    
    

      
      
      <head>
        <meta charset="utf-8">
        <meta name="format-detection" content="telephone=no">  
        
        <title>Lecture 12: Network Security | Lecture Videos | Computer Systems Security | Electrical Engineering and Computer Science | MIT OpenCourseWare</title>
    <!-- Begin Automatic Metadata Insertion -->
    <meta content="6-858-computer-systems-security-fall-2014" name="WT.cg_n">
    <meta content="Lecture 12: Network Security" name="WT.cg_s">
    <meta content="In this lecture, Professor Zeldovich discusses network security, and how TCP/IP has evolved." name="Description">
    <meta content="Zeldovich, Nickolai" name="Author">
    <meta content="6.858,TCP/IP,packet spoofing,denial-of-service attack,sequence number attack,SYN flooding,routing protocol,Computer Design and Engineering,Software Design and Engineering" name="keywords">
    <meta content="6.858 Computer Systems Security | Lecture 12: Network Security" name="Search_Display">
    <meta content="Computer Design and Engineering" itemprop="about">
    <meta content="Software Design and Engineering" itemprop="about">
    <!-- End Automatic Metadata Insertion -->

	<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/grid.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/base.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/menu.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.bubblepopup.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/search.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses_new.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.jscrollpane.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/media_tabs.css">
	<link href="../../../common/xml/ocwcc.rdf" type="application/rdf+xml" rel="metadata">
	<link rel="canonical" href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-12-network-security/">
	<link rel="apple-touch-icon" href="../../../common/images/apple-touch-icon.png">
	
	
      
	
	<script type="text/javascript" src="../../../common/scripts/jquery.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-media-utils-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.bubblepopup.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery-ui.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.jscrollpane.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/expandy.js"></script>
	<script type="text/javascript" src="../../../common/scripts/bubble-popup-offline.js"></script>
	
	
	
    <script type="text/javascript">
      $(document).ready(function() {
        $("#tabs").tabs();
        IpadScroller();
      });
    </script>
    
    
    
    
    
    
      
       
		 

        
        
        

        
        
        
        
        
        
        
        
        
      </head>
    <body itemscope itemtype="http://schema.org/WebPage">
        
	

        <header id="top">
			<div id="grid">
				
				
					
<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572">
<div class="portletStaticText portlet-static-site-header">
<!--googleoff: index-->
<div class="grid_6 alpha" id="banner"><a href="https://ocw.mit.edu/"><img src="../../../common/images/ocw_mast.png" class="logo" alt="MIT OpenCourseWare, Massachusetts Institute of Technology"></a></div>
<div class="grid_6 omega" id="subscribe">
<aside class="module" aria-label="Connect with OCW">
<table class="social">
    <tbody>
        <tr>
            <td class="socialbutton"><a aria-label="Subscribe to the OCW Newsletter" href="https://ocw.mit.edu/subscribe/index.htm?utm_source=header"><img src="../../../common/images/trans.gif" alt="An icon depicting an envelope.">Subscribe to the OCW Newsletter</a></td>
            <td>
<a aria-label="Facebook" href="https://facebook.com/mitocw"><img src="../../../common/images/icon_fb.png" alt="Click to visit our Facebook page."></a>  <a aria-label="Instagram" href="https://www.instagram.com/mitocw/"><img src="https://ocw.mit.edu/images/icon_ig.png" alt="Click to visit our Instagram page."></a> <a aria-label="Twitter" href="https://twitter.com/mitocw"><img src="https://ocw.mit.edu/images/icon_twitter.png" alt="Click to visit our Twitter feed."></a><a aria-label="YouTube" href="https://www.youtube.com/mitocw" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_yt.png" alt="Click to visit our YouTube page."></a><span style="font-size: 12.208px;">   </span><a aria-label="Open Matters blog on WordPress" href="https://www.ocw-openmatters.org/" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_wp.png" alt="Click to visit our blog on WordPress."></a>
</td>
        </tr>
    </tbody>
</table>
</aside><nav aria-label="Help Links" class="helplinks">     <a aria-label="OCW Site Help" href="https://ocw.mit.edu/help">Help</a><span aria-hidden="true">|</span>     <a href="../../../common/about/contactus.htm">Contact Us</a>   </nav>
</div>
<div class="clear"> </div>
<!--googleon: index-->
</div>

</div>

<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75">
<div class="portletStaticText portlet-static-mega-menu"><div><nav id="mega" class="grid_8 alpha" aria-label="Site">
<ul id="menu" role="presentation">
    <li id="menu_home">
<a href="https://ocw.mit.edu/" aria-label="Homepage"><img src="../../../common/images/top-nav_home.png" class="home_icon" alt="Click for site home page."></a><!-- Begin Home Item -->
</li>
    <!-- End Home Item -->
    <li id="drop_1" aria-label="Find Courses">
<a href="#" aria-hidden="true">FIND COURSES</a><!-- Begin 5 columns Item -->
    <div class="dropdown_5columns-a mega-courses">
    <div class="col_1a">
    <div class="row_1a">
<nav aria-labelledby="mm-find-courses-by">     <span id="mm-find-courses-by" class="nav" aria-hidden="true">Find courses by:</span>
    <ul class="find_by" role="presentation">
        <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Topic</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-number/">MIT Course Number</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-department/">Department</a></li>
    </ul>
    </nav>     <nav aria-labelledby="mm-collections">     <span id="mm-collections" class="nav" aria-hidden="true">Collections</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Lectures</a></li>
        <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
        <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
        <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    </ul>
    </nav>     <nav class="col_1b" aria-labelledby="mm-translated-courses">     <span id="mm-translated-courses" class="nav" aria-hidden="true" style="line-height: 1.3;">Cross-Disciplinary Topic Lists</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/energy-courses">Energy</a></li>
        <li><a href="https://ocw.mit.edu/courses/entrepreneurship">Entrepreneurship</a></li>
        <li><a href="https://ocw.mit.edu/courses/environment-courses">Environment</a></li>
        <li><a href="https://ocw.mit.edu/courses/intro-programming">Introductory Programming</a></li>
        <li><a href="https://ocw.mit.edu/courses/life-sciences">Life Sciences</a></li>
        <li><a href="https://ocw.mit.edu/courses/transportation-courses">Transportation</a></li>
    </ul>
    </nav>
</div>
    <div class="row_1b"><nav aria-labelledby="mm-cross-disciplinary-topic-lists">     <span id="mm-cross-disciplinary-topic-lists" class="nav" aria-hidden="true">Translated Courses</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/translated-courses/traditional-chinese" aria-label="Traditional Chinese">繁體字 / Traditional Chinese</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/turkish" aria-label="Turkish">Türkçe / Turkish</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/korean" aria-label="Korean">(비디오)한국 / Korean</a></li>
    </ul>
    </nav></div>
    </div>
    </div>
    </li>
    <li id="drop_2">
<a href="#" aria-label="For Educators">For Educators</a>
    <div class="dropdown_1column-a" style="width: 270px;"><nav aria-labelledby="mm-find-courses-by">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/chalk-radio-podcast">Chalk Radio Podcast</a></li>
        <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
        <li><a href="https://openlearning.mit.edu/campus/digital-innovations/">Residential Digital Innovations </a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_3">
<a href="#" aria-hidden="true">Give Now</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="Donate">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
        <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
        <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
        <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
        <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_4">
<a href="#" aria-hidden="true">About</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="About">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/about/">About MIT OpenCourseWare</a></li>
        <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
        <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
        <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
        <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
        <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
    </ul>
    </nav></div>
    </li>
</ul>
</nav></div></div>

</div>





<!--googleoff: index-->
<script>
  (function() {
	var cx = '012626166551961672889:owjdpuboktq';
	var gcse = document.createElement('script');
	gcse.type = 'text/javascript';
	gcse.async = true;
	gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(gcse, s);
  })();
  window.onload = function(){
	document.getElementById('gsc-i-id1').placeholder = 'Search';	
  };

$(document).ready(function(){

$('.advanceSearch a').keydown(function(event){showSearchTips($(this),event);})
$('#searchTipsModal').keydown(function(event){showSearchTips($(this),event);})

function showSearchTips(obj,evt) {
// if pressed enter key
	if ( evt.which == 13 || evt.which == 32) {
		showModal();
		ga('send', 'pageview', "AdvanceSearch");
		$(".advanceSearch a").attr('aria-expanded', 'true');
		$('.searchTipsModal').focus();
		evt.preventDefault();
		}
	if ( evt.which == 27 ) {
		hideModal();
		$(".advanceSearch a").attr('aria-expanded', 'false');
		var modal = document.getElementById('searchTipsModal');
		modal.style.display = "none";
		$(".advanceSearch a").focus();
		evt.preventDefault();
		}
}

});
function showModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "block";
	ga('send', 'pageview', "AdvanceSearch");
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", true);
	window.setTimeout(function () {
    document.getElementById('searchTipsModal').focus(); }, 0);
}

function hideModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "none";
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", false);
}
</script>
<div id="search" role="search" class="grid_4 omega">
    	<table class="search">
				<tbody>
					<tr>
						<td><div class="searchboxheader"><searchbox-only resultsurl="/search/ocwsearch.htm"></searchbox-only></div></td>
						<td>
							<div class="advanceSearch">
								<a id="searchTipsBtn" onclick="showModal();" href="#" role="button" aria-label="search tips" aria-expanded="false" aria-describedby="searchtips">Search Tips</a>

								<!-- The Modal -->
								<div id="searchTipsModal" class="modal" tabindex="-1">
								  <!-- Modal content -->
									<div class="modal-content">
										<div class="modal-body">
											<button class="close" onclick="hideModal();" aria-label="close">X</button>
											<span>
												<b>Exclude words from your search</b>
												<br>Put - in front of a word you want to leave out. For example, jaguar speed -car
												<br><br>
												<b>Search for an exact match</b>
												<br>Put a word or phrase inside quotes. For example, "tallest building".
												<br><br>
												<b>Search for wildcards or unknown words</b>
												<br>Put a * in your word or phrase where you want to leave a placeholder. For example, "largest * in the world".
												<br><br>
												<b>Search within a range of numbers</b>
												<br>Put .. between two numbers. For example, camera $50..$100.
												<br><br>
												<b>Combine searches</b>
												<br>Put "OR" between each search query. For example,  marathon OR race.
												<br><br>
											</span>
										</div>
								  </div>
								</div>
							</div>
						</td>
					</tr>
				</tbody>
		</table>
</div>
<div class="clear"></div>
<!--googleon: index-->
<!-- *end header* -->

				
				
			</div>
<!-- top grid end -->
		</header><!-- top end -->
			
		<div id="center_media">
      	<div id="grid">
      		<div id="left">
        		<nav id="breadcrumb_media" aria-label="Breadcrumb">
                	<p>

    <a href="https://ocw.mit.edu/">Home</a>
    
        »
        
    
    
        
            <a href="https://ocw.mit.edu/courses">Courses</a>
            
                »
                
            
            
         
    
    
        
            <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science">Electrical Engineering and Computer Science</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/index.htm">Computer Systems Security</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/video-lectures/index.htm">Lecture Videos</a>
            
                »
                
            
            
         
    
    
        
            
            
            Lecture 12: Network Security
         
    
</p>

            	</nav>
            	<div class="clear"></div>
        		<div id="media_title">
        		<h1 class="title" itemprop="name" property="dct:title">
        <span class="" id="parent-fieldname-title">
            Lecture 12: Network Security
        </span>
    </h1>
        		</div>
           		<div class="clear"></div>
           		<div id="course_wrapper_media">
           			<nav id="course_nav" aria-label="Course">
           				<script language="javascript" type="text/javascript">
function toggleMenu(objID) {
  if (!document.getElementById) return;
  var ob = document.getElementById(objID);
  ob.className = (ob.className == 'selected')?'': 'selected';
}
function toggleClass(id)
{
  var divtoggleClass= document.getElementById(id);
  divtoggleClass.className = (divtoggleClass.className == 'mO')?'mC': 'mO';
  return false;
}
function changeAlt(id)
{
  id.alt = (id.alt == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
  id.title = (id.title == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
}
</script>
<!--Left Nav Starts -->


	<ul>			  
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/index.htm">
		                  Course Home  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/syllabus/index.htm">
		                  Syllabus  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/calendar/index.htm">
		                  Calendar  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/readings/index.htm">
		                  Readings  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/lecture-notes/index.htm">
		                  Lecture Notes  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="selected">
			   			<a href="../../../contents/video-lectures/index.htm">
		                  Lecture Videos  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/labs/index.htm">
		                  Labs  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/exams/index.htm">
		                  Exams  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/final-project/index.htm">
		                  Final Project  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/related-resources/index.htm">
		                  Related Resources  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    
		    
         	
	<!--second tal block close-->  
	
</ul>


<!--Left Nav Ends -->





           			</nav>
           			<main id="course_inner_media" aria-labelledby="media_title">
      					 
        <div class="" id="parent-fieldname-text">
            
            
        </div>
    
      					     
    
    



<script type="text/javascript">var caption_embed_1 ={'English - US': '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-12-network-security/BZTWXl9QNK8.srt'}</script>     
     <div id="media-embed">
         <div class="attention_message" id="embed_1">
<p>Flash and JavaScript are required for this feature.</p>
<p>Download the video from <a href="https://itunes.apple.com/us/itunes-u/id1017908130">iTunes U</a> or the <a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec12_300k.mp4">Internet Archive</a>.</p>
</div>
     </div>
    
     <script type="text/javascript">ocw_embed_chapter_media('embed_1', 'https://www.youtube.com/v/BZTWXl9QNK8', 'youtube', '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-12-network-security', 'https://img.youtube.com/vi/BZTWXl9QNK8/0.jpg',0,0, 'https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-12-network-security/BZTWXl9QNK8.srt')</script>
	 
	 
	 		
	 		<div id="transcript1"></div>
				 <script type="text/javascript">createThreePlayParams(2, 662955, "embed_1", 0, 0)</script>
			 
	

     <div id="media_resource_next_prev_nav" style="margin-top: 1em;">
        <p>
        
            <a href="../../../contents/video-lectures/lecture-11-ur-web/index.htm">
                <img src="../../../common/images/btn_previous_resource.png" style="margin: 0 30px 0 50px;" alt="Previous track" title="Previous track"></a>
     	
     	
        
            <a href="../../../contents/video-lectures/lecture-13-network-protocols/index.htm"> 
                <img src="../../../common/images/btn_next_resource.png" alt="Next track" title="Next track"></a>
       
       </p>
     </div>
 


<script type="text/javascript">
		window.onload=function(){
		init();
		
		}
		var tabLinks = new Array();
		var contentDivs = new Array();
		function init() {
		  // Grab the tab links and content divs from the page
		  var tabListItems = document.getElementById('tabs').childNodes;
		  for ( var i = 0; i < tabListItems.length; i++ ) {
			if ( tabListItems[i].nodeName == "LI" ) {
			  var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
			  var id = getHash( tabLink.getAttribute('href') );
			  tabLinks[id] = tabLink;
			  contentDivs[id] = document.getElementById( id );
			}
		  }
		  // Assign onclick events to the tab links, and
		  // highlight the first tab
		  var i = 0;
		  for ( var id in tabLinks ) {
			tabLinks[id].onclick = showTab;
			tabLinks[id].onfocus = function() { this.blur() };
			if ( i == 0 ) tabLinks[id].className = 'selected';
			i++;
		  }
		  // Hide all content divs except the first
		  var i = 0;
		  for ( var id in contentDivs ) {
			if ( i != 0 ) contentDivs[id].className = 'tabContent hide';
			i++;
		  }
		}
		function showTab() {
		  var selectedId = getHash( this.getAttribute('href') );
		  // Highlight the selected tab, and dim all others.
		  // Also show the selected content div, and hide all others.
		  for ( var id in contentDivs ) {
			if ( id == selectedId ) {
			  tabLinks[id].className = 'selected';
			  contentDivs[id].className = 'tabContent';
			} else {
			  tabLinks[id].className = '';
			  contentDivs[id].className = 'tabContent hide';
			}
		  }
		  // Stop the browser following the link
		  return false;
		}
		function getFirstChildWithTagName( element, tagName ) {
		  for ( var i = 0; i < element.childNodes.length; i++ ) {
			if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
		  }
		}
		function getHash( url ) {
		  var hashPos = url.lastIndexOf ( '#' );
		  return url.substring( hashPos + 1 );
		}
 </script>	
 

  <div id="media_tabs">
     
        <ul id="tabs">
            <li class="first">
                <a href="#vid_about" class="selected">About this Video</a>
            </li>
            <li class="">
                <a href="#vid_index" class="">Playlist</a>
            </li>
            <li class="">
                <a href="#vid_playlist" class="">Transcript</a>
            </li>
            <li class="">
                <a href="#vid_related" class="">Download this Video</a>
            </li>
        </ul>
   
        <div id="vid_about" itemprop="description" class="tabContent">
<p><strong>Description:</strong> In this lecture, Professor Zeldovich discusses network security, and how TCP/IP has evolved.</p>  <p><strong>Instructor:</strong> Nickolai Zeldovich</p>
</div>
        <div id="vid_index" itemprop="description" class="tabContent hide">
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-1-introduction-threat-models/index.htm">
<img src="https://img.youtube.com/vi/GqmQg-cszw4/default.jpg" title="Lecture 1: Introduction, Threat Models" alt="Lecture 1: Introduction, Threat Models">
<p>Lecture 1: Introduction, Th...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-2-control-hijacking-attacks/index.htm">
<img src="https://img.youtube.com/vi/r4KjHEgg9Wg/default.jpg" title="Lecture 2: Control Hijacking Attacks" alt="Lecture 2: Control Hijacking Attacks">
<p>Lecture 2: Control Hijackin...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-3-buffer-overflow-exploits-and-defenses/index.htm">
<img src="https://img.youtube.com/vi/xSQxaie_h1o/default.jpg" title="Lecture 3: Buffer Overflow Exploits and Defenses" alt="Lecture 3: Buffer Overflow Exploits and Defenses">
<p>Lecture 3: Buffer Overflow ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-4-privilege-separation/index.htm">
<img src="https://img.youtube.com/vi/dNl22h1kW1k/default.jpg" title="Lecture 4: Privilege Separation" alt="Lecture 4: Privilege Separation">
<p>Lecture 4: Privilege Separa...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-6-capabilities/index.htm">
<img src="https://img.youtube.com/vi/TQhmua7Z2cY/default.jpg" title="Lecture 6: Capabilities" alt="Lecture 6: Capabilities">
<p>Lecture 6: Capabilities</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-7-sandboxing-native-code/index.htm">
<img src="https://img.youtube.com/vi/I0Psvvky-44/default.jpg" title="Lecture 7: Sandboxing Native Code	" alt="Lecture 7: Sandboxing Native Code	">
<p>Lecture 7: Sandboxing Nativ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-8-web-security-model/index.htm">
<img src="https://img.youtube.com/vi/eRJ_r8WF1Y0/default.jpg" title="Lecture 8: Web Security Model" alt="Lecture 8: Web Security Model">
<p>Lecture 8: Web Security Model</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-9-securing-web-applications/index.htm">
<img src="https://img.youtube.com/vi/WlmKwIe9z1Q/default.jpg" title="Lecture 9: Securing Web Applications" alt="Lecture 9: Securing Web Applications">
<p>Lecture 9: Securing Web App...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-10-symbolic-execution/index.htm">
<img src="https://img.youtube.com/vi/yRVZPvHYHzw/default.jpg" title="Lecture 10: Symbolic Execution" alt="Lecture 10: Symbolic Execution">
<p>Lecture 10: Symbolic Execution</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-11-ur-web/index.htm">
<img src="https://img.youtube.com/vi/XMEFdofERLI/default.jpg" title="Lecture 11: Ur/Web" alt="Lecture 11: Ur/Web">
<p>Lecture 11: Ur/Web</p></a>
</div>
<div class="related-media-thumbnail-nolink">
<div class="now-playing-resource">Now Playing</div>
<img src="https://img.youtube.com/vi/BZTWXl9QNK8/default.jpg" title="Lecture 12: Network Security" alt="Lecture 12: Network Security">
<p>Lecture 12: Network Security</p>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-13-network-protocols/index.htm">
<img src="https://img.youtube.com/vi/QOtA76ga_fY/default.jpg" title="Lecture 13: Network Protocols" alt="Lecture 13: Network Protocols">
<p>Lecture 13: Network Protocols</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-14-ssl-and-https/index.htm">
<img src="https://img.youtube.com/vi/q1OF_0ICt9A/default.jpg" title="Lecture 14: SSL and HTTPS" alt="Lecture 14: SSL and HTTPS">
<p>Lecture 14: SSL and HTTPS</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-15-medical-software/index.htm">
<img src="https://img.youtube.com/vi/bA3xCpYLA34/default.jpg" title="Lecture 15: Medical Software" alt="Lecture 15: Medical Software">
<p>Lecture 15: Medical Software</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-16-side-channel-attacks/index.htm">
<img src="https://img.youtube.com/vi/3v5Von-oNUg/default.jpg" title="Lecture 16: Side-Channel Attacks" alt="Lecture 16: Side-Channel Attacks">
<p>Lecture 16: Side-Channel At...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-17-user-authentication/index.htm">
<img src="https://img.youtube.com/vi/MT7X17ZRo1U/default.jpg" title="Lecture 17: User Authentication" alt="Lecture 17: User Authentication">
<p>Lecture 17: User Authentica...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-18-private-browsing/index.htm">
<img src="https://img.youtube.com/vi/YTWXAFJf8bw/default.jpg" title="Lecture 18: Private Browsing" alt="Lecture 18: Private Browsing">
<p>Lecture 18: Private Browsing</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-19-anonymous-communication/index.htm">
<img src="https://img.youtube.com/vi/OgGTJIgNewE/default.jpg" title="Lecture 19: Anonymous Communication" alt="Lecture 19: Anonymous Communication">
<p>Lecture 19: Anonymous Commu...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-20-mobile-phone-security/index.htm">
<img src="https://img.youtube.com/vi/uT7BXusDgDM/default.jpg" title="Lecture 20: Mobile Phone Security" alt="Lecture 20: Mobile Phone Security">
<p>Lecture 20: Mobile Phone Se...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-21-data-tracking/index.htm">
<img src="https://img.youtube.com/vi/WG5UbMrUiLU/default.jpg" title="Lecture 21: Data Tracking" alt="Lecture 21: Data Tracking">
<p>Lecture 21: Data Tracking</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-22-guest-lecture-by-mit-is-t/index.htm">
<img src="https://img.youtube.com/vi/2PO8h1pVW50/default.jpg" title="Lecture 22: Guest Lecture by MIT IS&amp;T" alt="Lecture 22: Guest Lecture by MIT IS&amp;T">
<p>Lecture 22: Guest Lecture b...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-23-security-economics/index.htm">
<img src="https://img.youtube.com/vi/8PdnOZI7H5E/default.jpg" title="Lecture 23: Security Economics" alt="Lecture 23: Security Economics">
<p>Lecture 23: Security Economics</p></a>
</div>
</div>
        <div id="vid_playlist" itemprop="description" class="tabContent hide">
<ul><li><a class="transcript-link" title="Open in a new window." alt="Open in a new window." style="text-decoration: none; font-size: 1.0em;" target="_blank" text-decoration: none font-size: href="../../../contents/video-lectures/lecture-12-network-security/BZTWXl9QNK8.pdf"> Download English-US transcript (PDF)</a></li></ul>
<p><span m="80">The</span> <span m="170">following</span> <span m="610">content</span> <span m="1120">is</span> <span m="1230">provided</span> <span m="1670">under</span> <span m="1940">a</span> <span m="1980">Creative</span> <span m="2430">Commons</span> <span m="2830">license.</span> <span m="3810">Your</span> <span m="3910">support</span> <span m="4420">will</span> <span m="4560">help</span> <span m="4820">MIT</span> <span m="5310">OpenCourseWare</span> <span m="6060">continue</span> <span m="6540">to</span> <span m="6680">offer</span> <span m="7000">high</span> <span m="7210">quality</span> <span m="7720">educational</span> <span m="8360">resources</span> <span m="8940">for</span> <span m="9090">free.</span> <span m="10150">To</span> <span m="10250">make</span> <span m="10350">a</span> <span m="10400">donation</span> <span m="11090">or</span> <span m="11340">to</span> <span m="11450">view</span> <span m="11660">additional</span> <span m="12070">materials</span> <span m="12690">from</span> <span m="12860">hundreds</span> <span m="13190">of</span> <span m="13300">MIT</span> <span m="13680">courses,</span> <span m="15000">visit</span> <span m="15160">MIT</span> <span m="15690">OpenCourseWare</span> <span m="16600">at</span> <span m="16830">ocw.mit.edu.</span> </p>
<p><span m="26640">PROFESSOR: All</span> <span m="27200">right,</span> <span m="27360">guys,</span> <span m="27860">let's</span> <span m="28560">get</span> <span m="28750">started.</span> <span m="29680">So</span> <span m="29840">today,</span> <span m="30040">we're</span> <span m="30120">going</span> <span m="30220">to</span> <span m="30350">talk</span> <span m="30550">about</span> <span m="30790">network</span> <span m="31070">security.</span> <span m="31350">And</span> <span m="31630">in particular,</span> <span m="32290">we're</span> <span m="32330">going</span> <span m="32430">to</span> <span m="32750">talk</span> <span m="32910">about</span> <span m="33080">this</span> <span m="33290">paper</span> <span m="33640">on</span> <span m="33880">TCP/IP</span> <span m="34450">security</span> <span m="34910">by</span> <span m="35100">this guy</span> <span m="35550">Steve</span> <span m="36040">Bellovin,</span> <span m="36530">who</span> <span m="36660">used</span> <span m="36800">to be at</span> <span m="36950">AT&amp;T</span> <span m="37340">and</span> <span m="37710">now is</span> <span m="37980">at</span> <span m="38110">Columbia.</span> <span m="40100">One</span> <span m="40260">interesting</span> <span m="40620">thing</span> <span m="41080">about</span> <span m="41230">this</span> <span m="41350">paper</span> <span m="41610">is it's</span> <span m="41780">actually</span> <span m="42070">a</span> <span m="42220">relatively</span> <span m="42640">old</span> <span m="42900">paper.</span> <span m="43250">It's</span> <span m="43600">more than</span> <span m="43820">10</span> <span m="44170">years</span> <span m="44515">old.</span> <span m="44584">And</span> <span m="44653">in</span> <span m="44722">fact,</span> <span m="44791">it's</span> <span m="44860">commentary</span> <span m="45190">on a</span> <span m="45520">paper</span> <span m="45770">that was</span> <span m="45960">10 years</span> <span m="46420">before</span> <span m="46750">that.</span> <span m="48520">And</span> <span m="48835">many</span> <span m="49150">of you</span> <span m="49560">guys</span> <span m="49750">actually</span> <span m="49930">ask,</span> <span m="50380">why</span> <span m="50680">are we</span> <span m="51160">reading</span> <span m="51540">this</span> <span m="51840">if</span> <span m="52020">many of</span> <span m="52330">these</span> <span m="52500">problems</span> <span m="52750">have</span> <span m="52860">been</span> <span m="53000">solved</span> <span m="53420">in</span> <span m="53550">today's</span> <span m="53970">TCP</span> <span m="54500">protocol</span> <span m="54880">stacks?</span> </p>
<p><span m="55980">So</span> <span m="56180">one</span> <span m="56360">interesting</span> <span m="56860">point--</span> <span m="57450">so</span> <span m="57700">it's</span> <span m="57870">true</span> <span m="57990">that</span> <span m="58170">some of these</span> <span m="58500">problems</span> <span m="58770">that</span> <span m="59060">Steve</span> <span m="59220">describes</span> <span m="59650">in this</span> <span m="59810">paper</span> <span m="60040">have</span> <span m="60240">been</span> <span m="60380">solved</span> <span m="60720">since</span> <span m="60940">then.</span> <span m="62150">Some</span> <span m="62380">of</span> <span m="62420">them</span> <span m="62720">are</span> <span m="62890">still</span> <span m="63100">actually</span> <span m="63410">problems</span> <span m="63730">today.</span> <span m="64019">We'll</span> <span m="64110">sort of</span> <span m="64300">look</span> <span m="64640">at</span> <span m="64720">that</span> <span m="64920">and</span> <span m="65050">see</span> <span m="65400">what's</span> <span m="66310">going</span> <span m="66500">on.</span> <span m="67145">But</span> <span m="67440">you</span> <span m="67640">might</span> <span m="67820">actually</span> <span m="68010">wonder,</span> <span m="68580">why</span> <span m="69300">didn't</span> <span m="69610">people</span> <span m="69925">solve</span> <span m="70240">all</span> <span m="70560">these</span> <span m="70880">problems</span> <span m="71140">in the</span> <span m="71260">first</span> <span m="71540">place</span> <span m="71970">when</span> <span m="72110">they were</span> <span m="72610">designing</span> <span m="73350">TCP?</span> <span m="73730">What</span> <span m="74060">were they</span> <span m="74190">thinking?</span> </p>
<p><span m="75480">And</span> <span m="77370">it's</span> <span m="77570">actually</span> <span m="77770">not clear.</span> <span m="78160">So</span> <span m="78196">what</span> <span m="78232">do</span> <span m="78268">you</span> <span m="78304">guys</span> <span m="78340">think?</span> <span m="78590">Why</span> <span m="79000">wasn't</span> <span m="79370">TCP</span> <span m="79710">designed</span> <span m="80400">to</span> <span m="80480">be</span> <span m="80600">secure</span> <span m="81110">with</span> <span m="81270">all</span> <span m="81440">these</span> <span m="81650">considerations</span> <span m="82590">up</span> <span m="82980">front?</span> <span m="83916">Yeah,</span> <span m="84852">any</span> <span m="85320">guesses?</span> <span m="86596">All</span> <span m="87040">right,</span> <span m="87370">anyone</span> <span m="87660">else?</span> <span m="87960">Yeah.</span> </p>
<p><span m="88260">AUDIENCE: The</span> <span m="88708">internet</span> <span m="89156">was a much more trusting</span> <span m="89604">place</span> <span m="90052">back then.</span> </p>
<p><span m="90500">PROFESSOR: Yeah,</span> <span m="90690">this</span> <span m="91090">was</span> <span m="91300">almost</span> <span m="91610">literally a</span> <span m="91730">quote</span> <span m="91910">from</span> <span m="92250">this</span> <span m="92510">guy's</span> <span m="92690">paper.</span> <span m="93515">Yeah,</span> <span m="93880">at</span> <span m="94220">the</span> <span m="94310">time--</span> <span m="94690">the</span> <span m="95150">whole</span> <span m="95430">internet</span> <span m="95800">set of</span> <span m="96230">protocols</span> <span m="96445">was</span> <span m="96660">designed</span> <span m="97460">I</span> <span m="97520">guess</span> <span m="98130">about</span> <span m="98450">40</span> <span m="98590">years</span> <span m="98820">ago</span> <span m="99020">now.</span> <span m="99914">The</span> <span m="100398">requirements were</span> <span m="100882">totally different.</span> <span m="101366">It</span> <span m="101850">was to</span> <span m="101990">connect</span> <span m="102390">a</span> <span m="102750">bunch</span> <span m="102950">of</span> <span m="103070">relatively</span> <span m="103640">trusting</span> <span m="104080">sites</span> <span m="104450">that</span> <span m="104635">all</span> <span m="104820">knew</span> <span m="105010">each</span> <span m="105160">other</span> <span m="105580">by</span> <span m="105740">name.</span> </p>
<p><span m="107070">And</span> <span m="108050">I think</span> <span m="108150">this</span> <span m="108240">is</span> <span m="108450">often</span> <span m="108770">the</span> <span m="108880">case</span> <span m="109220">in</span> <span m="109510">any</span> <span m="110020">system</span> <span m="110400">that</span> <span m="110510">becomes</span> <span m="110770">successful.</span> <span m="111420">The</span> <span m="111530">requirements</span> <span m="112000">change.</span> <span m="112600">So</span> <span m="112730">it used</span> <span m="112990">to</span> <span m="113070">be</span> <span m="113240">that</span> <span m="113420">this</span> <span m="113580">was</span> <span m="113760">a</span> <span m="114410">protocol</span> <span m="114870">for</span> <span m="115200">a</span> <span m="115340">small number</span> <span m="115480">of</span> <span m="115640">sites.</span> <span m="116030">Now</span> <span m="116360">it's</span> <span m="116540">the</span> <span m="116620">entire</span> <span m="116880">world.</span> <span m="117530">And</span> <span m="117870">you</span> <span m="117940">don't</span> <span m="118120">know</span> <span m="118420">all</span> <span m="118620">the</span> <span m="118700">people</span> <span m="118990">connected</span> <span m="119088">to</span> <span m="119187">the</span> <span m="119286">internet</span> <span m="119385">by name</span> <span m="119780">anymore.</span> <span m="120175">You can't</span> <span m="120570">call them</span> <span m="120690">up on the</span> <span m="120780">phone</span> <span m="121120">if</span> <span m="121390">they</span> <span m="121510">do</span> <span m="121640">something</span> <span m="121880">bad,</span> <span m="122250">et</span> <span m="122580">cetera.</span> </p>
<p><span m="123470">So</span> <span m="123590">I</span> <span m="123680">think</span> <span m="123870">this</span> <span m="124000">is</span> <span m="124190">a</span> <span m="124310">story</span> <span m="124690">for</span> <span m="124870">many</span> <span m="125150">of</span> <span m="125220">the</span> <span m="125300">protocols</span> <span m="125650">we look at.</span> <span m="126170">And</span> <span m="126500">many of</span> <span m="126790">you</span> <span m="127090">guys</span> <span m="127310">have</span> <span m="127380">questions,</span> <span m="127750">like,</span> <span m="128030">what</span> <span m="128370">the hell</span> <span m="128520">were</span> <span m="128740">these</span> <span m="129080">guys</span> <span m="129100">thinking?</span> <span m="129490">This</span> <span m="129600">is</span> <span m="129720">so</span> <span m="129979">broken.</span> <span m="130610">But</span> <span m="130720">in</span> <span m="130800">fact,</span> <span m="131100">they</span> <span m="131170">were</span> <span m="131260">designing</span> <span m="131740">a totally</span> <span m="131910">different</span> <span m="132210">system.</span> <span m="132340">It</span> <span m="132500">got</span> <span m="132820">adopted.</span> </p>
<p><span m="133660">Same</span> <span m="133820">for the</span> <span m="134280">web, like we were</span> <span m="134680">looking</span> <span m="134950">at</span> <span m="135380">in</span> <span m="135520">the</span> <span m="135640">last</span> <span m="136330">couple</span> <span m="136560">of</span> <span m="136630">weeks.</span> <span m="137060">It</span> <span m="137270">was</span> <span m="137490">designed</span> <span m="137920">for</span> <span m="138020">a</span> <span m="138120">very</span> <span m="138310">different</span> <span m="138620">goal.</span> <span m="138950">And it</span> <span m="139130">expanded.</span> <span m="139980">And you</span> <span m="140350">sort of</span> <span m="140550">have these</span> <span m="140870">growing</span> <span m="141220">pains</span> <span m="141610">you</span> <span m="141740">have</span> <span m="141990">to</span> <span m="142400">figure</span> <span m="142640">out</span> <span m="142780">how to make</span> <span m="143160">the</span> <span m="143250">protocol</span> <span m="144250">adapt</span> <span m="144760">to</span> <span m="145160">new</span> <span m="145320">requirements.</span> </p>
<p><span m="146750">And</span> <span m="147090">another</span> <span m="147360">thing</span> <span m="147530">that</span> <span m="147780">somewhat</span> <span m="148260">suddenly</span> <span m="148950">happened</span> <span m="149370">is</span> <span m="149470">I</span> <span m="149540">think</span> <span m="149780">people</span> <span m="150200">also</span> <span m="150800">in</span> <span m="150890">the</span> <span m="150980">process</span> <span m="151370">gained</span> <span m="151720">a</span> <span m="151770">much</span> <span m="152030">greater</span> <span m="152310">appreciation</span> <span m="153010">for</span> <span m="153170">the</span> <span m="153330">kinds</span> <span m="153650">of</span> <span m="153750">problems</span> <span m="154070">you</span> <span m="154120">have</span> <span m="154230">to</span> <span m="154310">worry</span> <span m="154560">about</span> <span m="154770">in</span> <span m="154870">security.</span> <span m="155970">And</span> <span m="156365">it used</span> <span m="156760">to be</span> <span m="157150">the</span> <span m="157240">case</span> <span m="157500">that</span> <span m="157730">you</span> <span m="157910">didn't</span> <span m="158170">really</span> <span m="158520">understand</span> <span m="159100">all</span> <span m="159370">the</span> <span m="159460">things</span> <span m="159750">that</span> <span m="159870">you</span> <span m="159960">should</span> <span m="160150">worry</span> <span m="160490">about</span> <span m="160900">an</span> <span m="161020">attacker</span> <span m="161140">doing</span> <span m="161310">to</span> <span m="161480">your</span> <span m="161710">system.</span> </p>
<p><span m="162870">And</span> <span m="163145">I think</span> <span m="163420">it's</span> <span m="163610">partly</span> <span m="163980">for</span> <span m="164070">this</span> <span m="164270">reason</span> <span m="164520">that it's</span> <span m="164850">sort</span> <span m="165200">of</span> <span m="165640">interesting</span> <span m="166050">to</span> <span m="166130">look</span> <span m="166400">at</span> <span m="166820">what</span> <span m="166980">happened</span> <span m="167300">to</span> <span m="167390">TCP</span> <span m="167750">security,</span> <span m="168180">what</span> <span m="168380">went</span> <span m="168610">wrong,</span> <span m="168960">how</span> <span m="169190">could</span> <span m="169290">we</span> <span m="169460">fix it,</span> <span m="169740">et</span> <span m="169920">cetera,</span> <span m="170720">to</span> <span m="171260">both</span> <span m="171780">figure</span> <span m="172050">out</span> <span m="172230">what</span> <span m="172420">kinds</span> <span m="172610">of</span> <span m="172670">problems</span> <span m="172930">you</span> <span m="173000">might</span> <span m="173240">want</span> <span m="173380">to</span> <span m="173420">avoid</span> <span m="173740">when</span> <span m="173870">designing</span> <span m="174180">your own</span> <span m="174410">protocols,</span> <span m="175360">and</span> <span m="175530">also</span> <span m="176490">what's</span> <span m="176980">the</span> <span m="177300">right</span> <span m="177670">mindset</span> <span m="178160">for</span> <span m="178280">thinking</span> <span m="178620">about</span> <span m="178890">these</span> <span m="179180">kinds</span> <span m="179370">of</span> <span m="179440">attacks.</span> <span m="179765">How do</span> <span m="180090">you</span> <span m="181000">figure</span> <span m="181270">out</span> <span m="181500">what</span> <span m="181640">an</span> <span m="181790">attacker</span> <span m="182090">might</span> <span m="182410">be</span> <span m="182570">able</span> <span m="182740">to</span> <span m="182830">do</span> <span m="182960">in</span> <span m="183120">your</span> <span m="183340">own protocol</span> <span m="183840">when</span> <span m="183990">you're</span> <span m="184100">designing</span> <span m="184540">it so you can</span> <span m="184930">avoid</span> <span m="185920">similar</span> <span m="186300">pitfalls?</span> </p>
<p><span m="188290">All right, so</span> <span m="188480">with</span> <span m="188720">that</span> <span m="188960">preamble</span> <span m="189580">aside,</span> <span m="190250">let's</span> <span m="190420">actually</span> <span m="190710">start</span> <span m="191000">talking</span> <span m="191220">about</span> <span m="191420">what</span> <span m="191590">the</span> <span m="191690">paper</span> <span m="192120">is</span> <span m="192240">about.</span> <span m="192610">So</span> <span m="193450">how</span> <span m="193600">should</span> <span m="193770">we</span> <span m="193950">think</span> <span m="194140">about</span> <span m="194410">security</span> <span m="194800">in</span> <span m="195190">a</span> <span m="195420">network?</span> <span m="195770">So</span> <span m="196075">I guess</span> <span m="196380">we could</span> <span m="196850">try</span> <span m="197180">to</span> <span m="197320">start</span> <span m="197640">from</span> <span m="197920">first</span> <span m="198140">principles</span> <span m="198620">and</span> <span m="198710">try</span> <span m="198910">to</span> <span m="198970">figure</span> <span m="199180">out,</span> <span m="199340">what</span> <span m="199560">is our</span> <span m="199770">threat</span> <span m="200123">model?</span> <span m="202350">So</span> <span m="202510">what do</span> <span m="202690">we</span> <span m="202810">think</span> <span m="203010">the</span> <span m="203210">attacker</span> <span m="203810">is</span> <span m="204220">going</span> <span m="204330">to</span> <span m="204370">be</span> <span m="204460">able</span> <span m="204640">to</span> <span m="204740">do</span> <span m="205500">in</span> <span m="205885">our</span> <span m="206270">network?</span> </p>
<p><span m="208210">Well,</span> <span m="208490">relatively</span> <span m="209080">straightforwardly,</span> <span m="209980">there's</span> <span m="210600">presumably</span> <span m="210910">being</span> <span m="211140">able</span> <span m="211370">to</span> <span m="211880">intercept</span> <span m="212420">packets,</span> <span m="216340">and</span> <span m="216630">probably</span> <span m="216930">being</span> <span m="217140">able</span> <span m="217310">to</span> <span m="217370">modify</span> <span m="217640">them.</span> <span m="221000">So</span> <span m="221180">if</span> <span m="221340">you</span> <span m="221520">send</span> <span m="221720">a packet over the</span> <span m="222080">network,</span> <span m="222960">it</span> <span m="223130">might</span> <span m="223420">be</span> <span m="223570">prudent</span> <span m="223865">to</span> <span m="224160">assume</span> <span m="224470">that</span> <span m="224730">some</span> <span m="224960">bad</span> <span m="225260">guy out</span> <span m="225520">there</span> <span m="225730">is</span> <span m="225800">going</span> <span m="225900">to</span> <span m="225980">see</span> <span m="226190">your</span> <span m="226320">packet</span> <span m="226530">and</span> <span m="227020">might</span> <span m="227240">be</span> <span m="227310">able</span> <span m="227490">to</span> <span m="227580">change</span> <span m="227940">it</span> <span m="228540">before</span> <span m="228700">it</span> <span m="228960">reaches</span> <span m="229450">the destination,</span> <span m="229980">might</span> <span m="230140">be</span> <span m="230230">able to</span> <span m="230400">drop</span> <span m="230695">it,</span> <span m="231270">and</span> <span m="231550">in</span> <span m="231815">fact</span> <span m="232080">might</span> <span m="232440">be</span> <span m="232510">able</span> <span m="232700">to</span> <span m="232930">inject</span> <span m="233260">packets</span> <span m="233450">of</span> <span m="233880">their</span> <span m="234310">own</span> <span m="234740">that</span> <span m="234890">you</span> <span m="235030">never</span> <span m="235310">sent</span> <span m="236450">with</span> <span m="236880">arbitrary</span> <span m="237450">contents.</span> </p>
<p><span m="239170">And</span> <span m="240350">probably--</span> <span m="241260">so</span> <span m="241520">this</span> <span m="242260">you</span> <span m="242390">can</span> <span m="242705">sort of</span> <span m="243020">come up</span> <span m="243260">with fairly</span> <span m="243670">straightforwardly</span> <span m="243960">by</span> <span m="244250">just</span> <span m="244480">thinking,</span> <span m="244800">well,</span> <span m="245030">if you</span> <span m="245380">don't</span> <span m="245530">trust</span> <span m="245700">the network,</span> <span m="247010">some</span> <span m="247320">bad guy is</span> <span m="247630">going</span> <span m="247760">to</span> <span m="248490">send</span> <span m="248700">arbitrary</span> <span m="249080">packets,</span> <span m="249490">see yours,</span> <span m="249970">modify</span> <span m="250140">them,</span> <span m="250570">et</span> <span m="250920">cetera.</span> <span m="251470">Somewhat</span> <span m="251680">more</span> <span m="251990">worryingly,</span> <span m="253700">as this</span> <span m="254360">paper</span> <span m="254570">talks</span> <span m="254760">about,</span> <span m="255240">the</span> <span m="255620">bad</span> <span m="255675">guy</span> <span m="255730">can</span> <span m="255785">also</span> <span m="255840">participate</span> <span m="256690">in</span> <span m="256860">your</span> <span m="257120">protocols.</span> <span m="257720">They</span> <span m="257760">have</span> <span m="258019">their own</span> <span m="258110">machine,</span> <span m="258459">right?</span> </p>
<p><span m="258649">So</span> <span m="258769">the</span> <span m="258950">attacker</span> <span m="259130">has their</span> <span m="259610">own</span> <span m="260090">computer</span> <span m="262490">that</span> <span m="262680">they</span> <span m="262790">have</span> <span m="263000">full</span> <span m="263160">control</span> <span m="263520">over.</span> <span m="263990">So</span> <span m="264080">even</span> <span m="264320">if</span> <span m="264780">all</span> <span m="264990">the</span> <span m="265080">computers</span> <span m="266070">that</span> <span m="268420">you</span> <span m="268620">trust</span> <span m="269450">are</span> <span m="269860">reasonably</span> <span m="270520">maintained,</span> <span m="271230">they</span> <span m="271440">all</span> <span m="271650">behave</span> <span m="271920">correctly,</span> <span m="272700">the</span> <span m="273110">bad guy</span> <span m="273230">has his own</span> <span m="273610">computer</span> <span m="273660">that</span> <span m="273750">he</span> <span m="273840">can</span> <span m="274020">make</span> <span m="274180">it</span> <span m="274290">do</span> <span m="274460">whatever</span> <span m="274730">he</span> <span m="274810">wants.</span> <span m="275700">And</span> <span m="275710">in</span> <span m="275800">fact,</span> <span m="276020">he</span> <span m="276070">can</span> <span m="276400">participate</span> <span m="277120">in</span> <span m="277220">a</span> <span m="277530">protocol</span> <span m="277840">or</span> <span m="278270">distribute</span> <span m="278761">a</span> <span m="279252">system.</span> </p>
<p><span m="285150">So</span> <span m="285490">if</span> <span m="285620">you</span> <span m="285690">have</span> <span m="285890">a</span> <span m="286040">routing</span> <span m="286370">protocol,</span> <span m="286940">which</span> <span m="287000">involves</span> <span m="287510">many</span> <span m="287600">people</span> <span m="287820">talking</span> <span m="288130">to</span> <span m="288250">each other,</span> <span m="289110">at</span> <span m="289500">some</span> <span m="289670">scale, it's</span> <span m="290060">probably</span> <span m="290380">going</span> <span m="290510">to</span> <span m="290560">be</span> <span m="290780">impractical</span> <span m="291470">to</span> <span m="291560">keep</span> <span m="291710">the</span> <span m="291800">bad</span> <span m="292010">guys</span> <span m="292260">out.</span> <span m="293230">If</span> <span m="293320">you're</span> <span m="293470">running</span> <span m="293680">a routing</span> <span m="293910">protocol</span> <span m="294190">with</span> <span m="294470">10</span> <span m="294830">participants,</span> <span m="294900">then</span> <span m="295240">maybe you</span> <span m="295580">can just</span> <span m="295865">call</span> <span m="296007">all</span> <span m="296150">them</span> <span m="296280">up</span> <span m="296470">and say, well,</span> <span m="296820">yeah,</span> <span m="297170">yeah,</span> <span m="297480">I know all you</span> <span m="297790">guys.</span> </p>
<p><span m="298380">But</span> <span m="298740">at the</span> <span m="298810">scale</span> <span m="299140">of the internet</span> <span m="299630">today,</span> <span m="300250">it's</span> <span m="300720">unfeasible</span> <span m="301380">to</span> <span m="301910">have</span> <span m="302480">sort</span> <span m="302580">of</span> <span m="302670">direct</span> <span m="303190">knowledge</span> <span m="303590">of</span> <span m="304060">what</span> <span m="304300">everyone</span> <span m="304650">else</span> <span m="305010">or</span> <span m="305290">who</span> <span m="305430">everyone</span> <span m="305710">else in</span> <span m="306100">this</span> <span m="306410">protocol</span> <span m="306910">is.</span> <span m="307250">So</span> <span m="307400">probably</span> <span m="307740">some bad</span> <span m="307960">guy</span> <span m="308350">is</span> <span m="308490">going</span> <span m="308610">to</span> <span m="308670">be</span> <span m="309190">participating</span> <span m="309750">in your</span> <span m="309840">protocols</span> <span m="310570">or</span> <span m="310730">distributed</span> <span m="311160">systems.</span> <span m="311660">And</span> <span m="311940">it's</span> <span m="312130">important</span> <span m="312335">to</span> <span m="312540">design</span> <span m="312930">distributed</span> <span m="313300">systems</span> <span m="313575">that</span> <span m="313850">can</span> <span m="314560">nonetheless</span> <span m="315040">do</span> <span m="315160">something</span> <span m="315460">reasonable</span> <span m="316900">with</span> <span m="317090">that.</span> </p>
<p><span m="318560">All right,</span> <span m="318690">so what</span> <span m="318880">are</span> <span m="318940">the</span> <span m="319040">implications</span> <span m="319580">of</span> <span m="319680">all</span> <span m="319790">these</span> <span m="319990">things?</span> <span m="320280">I</span> <span m="320340">guess</span> <span m="320500">we'll</span> <span m="320960">go</span> <span m="321090">down</span> <span m="321290">the</span> <span m="321350">list.</span> <span m="321680">So</span> <span m="321770">intercepting</span> <span m="322720">is--</span> <span m="323050">it's on</span> <span m="323415">the</span> <span m="323780">whole</span> <span m="324820">easy</span> <span m="325090">to</span> <span m="325930">understand.</span> <span m="326570">Well,</span> <span m="327160">you</span> <span m="327410">shouldn't</span> <span m="327910">send</span> <span m="328015">any</span> <span m="328120">important</span> <span m="328470">data</span> <span m="329170">over</span> <span m="329420">the</span> <span m="329660">network</span> <span m="329970">if</span> <span m="330130">you</span> <span m="330280">expect</span> <span m="330540">a</span> <span m="330800">bad</span> <span m="330850">guy</span> <span m="331570">to</span> <span m="331630">intercept</span> <span m="332050">them,</span> <span m="332380">or at least</span> <span m="332710">not</span> <span m="332910">in</span> <span m="333170">clear</span> <span m="333400">text.</span> <span m="333680">Maybe</span> <span m="333960">you should</span> <span m="334220">encrypt</span> <span m="334520">your</span> <span m="334600">data.</span> </p>
<p><span m="335480">So</span> <span m="335745">that</span> <span m="336010">seems</span> <span m="336460">relatively</span> <span m="336840">straightforward</span> <span m="337380">to</span> <span m="337650">sort</span> <span m="337785">of</span> <span m="337920">figure</span> <span m="338180">out.</span> <span m="338770">Although</span> <span m="338860">still</span> <span m="339050">you</span> <span m="339320">should</span> <span m="339810">sort</span> <span m="340020">of</span> <span m="340370">keep</span> <span m="340445">it</span> <span m="340520">in</span> <span m="340600">mind,</span> <span m="340940">of</span> <span m="341023">course,</span> <span m="341106">when</span> <span m="341190">designing</span> <span m="341580">protocols.</span> <span m="343070">Now,</span> <span m="343300">injecting</span> <span m="343410">packets</span> <span m="344010">turns</span> <span m="345510">out</span> <span m="345800">to</span> <span m="346400">lead</span> <span m="346770">to a</span> <span m="346910">much</span> <span m="347710">wider</span> <span m="348690">range</span> <span m="349090">of</span> <span m="349590">interesting</span> <span m="350010">problems</span> <span m="350380">that</span> <span m="350490">this</span> <span m="350590">paper</span> <span m="350870">talks</span> <span m="351110">about.</span> <span m="351970">And</span> <span m="352310">in</span> <span m="352670">particular,</span> <span m="353650">attackers</span> <span m="354360">can</span> <span m="354710">inject</span> <span m="355160">packets</span> <span m="355930">that</span> <span m="356310">can</span> <span m="357200">pretend</span> <span m="357590">to</span> <span m="357660">be</span> <span m="357780">from</span> <span m="357960">any</span> <span m="358130">other</span> <span m="358370">sender.</span> <span m="358860">Because</span> <span m="359140">the</span> <span m="359230">way</span> <span m="360040">this</span> <span m="360450">works in</span> <span m="360860">IP</span> <span m="361270">is</span> <span m="361680">that</span> <span m="361800">the IP</span> <span m="362160">packet</span> <span m="362340">itself</span> <span m="362640">has</span> <span m="362940">a</span> <span m="363040">header that</span> <span m="363150">contains</span> <span m="363630">the</span> <span m="363730">source of</span> <span m="363890">the</span> <span m="364310">packet and</span> <span m="364530">the</span> <span m="364640">destination.</span> </p>
<p><span m="366080">And</span> <span m="366250">it's</span> <span m="366390">up</span> <span m="366550">to</span> <span m="367580">whoever</span> <span m="367930">creates</span> <span m="368350">the</span> <span m="368420">packet</span> <span m="368830">to</span> <span m="369000">fill</span> <span m="369330">in</span> <span m="369420">the</span> <span m="369530">right</span> <span m="369750">values</span> <span m="370090">for the</span> <span m="370290">source</span> <span m="370540">and</span> <span m="370640">destination.</span> <span m="371750">And</span> <span m="371870">no</span> <span m="372210">one</span> <span m="372550">checks</span> <span m="372835">that</span> <span m="373120">the</span> <span m="373230">source</span> <span m="373660">is</span> <span m="373780">necessarily</span> <span m="374100">the correct.</span> <span m="376100">There's</span> <span m="376210">some</span> <span m="376600">filtering</span> <span m="377050">going</span> <span m="377300">on</span> <span m="377440">these</span> <span m="377610">days.</span> <span m="378050">But</span> <span m="378250">it's</span> <span m="378590">sort</span> <span m="379060">of</span> <span m="379150">fairly</span> <span m="379405">spotty,</span> <span m="379660">and</span> <span m="380000">it's</span> <span m="380220">hard to</span> <span m="380560">rely</span> <span m="380995">on.</span> <span m="381430">So</span> <span m="381760">to</span> <span m="381790">a first</span> <span m="381820">approximation,</span> <span m="382156">an</span> <span m="382492">attacker</span> <span m="383115">could</span> <span m="383400">fill</span> <span m="383650">in</span> <span m="383890">any</span> <span m="384170">IP</span> <span m="384520">address</span> <span m="384870">as the source,</span> <span m="385340">and</span> <span m="385570">it</span> <span m="385680">will</span> <span m="386130">get</span> <span m="386400">to the</span> <span m="386470">destination</span> <span m="387040">correctly.</span> <span m="389180">And</span> <span m="390990">it's</span> <span m="391130">interesting</span> <span m="391450">to try to</span> <span m="391710">figure out</span> <span m="392070">what</span> <span m="392320">could an</span> <span m="392580">attacker</span> <span m="392850">do</span> <span m="393410">with</span> <span m="393760">such</span> <span m="393980">a</span> <span m="394030">capability</span> <span m="394430">of</span> <span m="395080">sending</span> <span m="395540">arbitrary</span> <span m="396050">packets.</span> </p>
<p><span m="397670">Now,</span> <span m="398320">in</span> <span m="398570">the</span> <span m="400670">several</span> <span m="401170">weeks</span> <span m="401380">up</span> <span m="401630">to this,</span> <span m="402000">like</span> <span m="402250">in</span> <span m="402310">buffer overflows</span> <span m="402625">and</span> <span m="402940">web</span> <span m="403160">security,</span> <span m="403520">we</span> <span m="403780">looked at,</span> <span m="404325">to a</span> <span m="404610">large</span> <span m="404880">extent,</span> <span m="405220">implementation</span> <span m="405850">bugs, like,</span> <span m="406110">how could</span> <span m="406230">you</span> <span m="406670">exploit</span> <span m="406880">a buffer</span> <span m="406990">overflow?</span> <span m="408440">And</span> <span m="409070">interestingly,</span> <span m="409830">the</span> <span m="409930">author</span> <span m="409973">of</span> <span m="410016">this</span> <span m="410060">paper</span> <span m="410420">is</span> <span m="410760">actually</span> <span m="411060">not</span> <span m="411360">at</span> <span m="411630">all</span> <span m="411890">interested</span> <span m="412290">in</span> <span m="412580">implementation</span> <span m="413220">bugs.</span> <span m="413510">He's</span> <span m="413740">really</span> <span m="414030">interested</span> <span m="414335">in</span> <span m="414640">protocol</span> <span m="415790">errors</span> <span m="416180">or</span> <span m="416360">protocol</span> <span m="416770">mistakes.</span> </p>
<p><span m="417870">So what's</span> <span m="418000">the</span> <span m="418090">big deal?</span> <span m="418520">Why is</span> <span m="418890">he</span> <span m="419310">down</span> <span m="419560">on</span> <span m="419990">implementation</span> <span m="420420">bugs, even</span> <span m="420740">though we spent</span> <span m="420920">several</span> <span m="421190">weeks looking at them?</span> <span m="422084">Why</span> <span m="422531">does</span> <span m="422980">it</span> <span m="423250">matter?</span> <span m="423510">Yeah.</span> </p>
<p><span m="423825">AUDIENCE: Because</span> <span m="424140">we have to</span> <span m="424588">keep</span> <span m="425036">those bugs</span> <span m="425484">[INAUDIBLE].</span> </p>
<p><span m="426828">PROFESSOR: Yeah,</span> <span m="427280">so this is</span> <span m="427580">the</span> <span m="427630">really</span> <span m="427980">big</span> <span m="428340">bummer</span> <span m="428530">about</span> <span m="428960">a</span> <span m="429420">bug</span> <span m="429800">in your</span> <span m="430710">protocol</span> <span m="431030">design.</span> <span m="431550">Because</span> <span m="432710">it's</span> <span m="432880">hard</span> <span m="433070">to</span> <span m="433130">change.</span> <span m="433830">So if you</span> <span m="433970">have</span> <span m="434110">an</span> <span m="434250">implementation</span> <span m="434540">bug,</span> <span m="435130">well,</span> <span m="435430">you</span> <span m="435930">had a</span> <span m="436200">memcpy</span> <span m="436810">or a</span> <span m="437040">print-out</span> <span m="437350">out</span> <span m="437700">of some</span> <span m="437870">sort</span> <span m="438140">that</span> <span m="438250">didn't</span> <span m="438460">check</span> <span m="438720">the</span> <span m="438830">range.</span> <span m="439350">OK,</span> <span m="439720">well,</span> <span m="440090">you had a</span> <span m="440150">range</span> <span m="440430">check,</span> <span m="440710">and</span> <span m="440795">it</span> <span m="440880">still</span> <span m="441090">works,</span> <span m="441420">and</span> <span m="441660">now it's</span> <span m="441760">also</span> <span m="442060">secure.</span> <span m="442380">So that's</span> <span m="442750">great.</span> </p>
<p><span m="443510">But</span> <span m="443600">if</span> <span m="443870">you have some</span> <span m="444145">bug</span> <span m="444420">in</span> <span m="444600">the</span> <span m="445040">protocol</span> <span m="445610">specification,</span> <span m="445995">in</span> <span m="446380">how</span> <span m="446600">the</span> <span m="446690">protocol</span> <span m="447010">has</span> <span m="447410">to</span> <span m="447510">work,</span> <span m="448450">then</span> <span m="448715">fixing</span> <span m="448980">a bug</span> <span m="449140">is going</span> <span m="449630">to</span> <span m="449700">require</span> <span m="450100">fixing a</span> <span m="450595">protocol,</span> <span m="451090">which</span> <span m="451190">means</span> <span m="451800">potentially</span> <span m="452170">affecting</span> <span m="452920">all</span> <span m="453180">the</span> <span m="453280">systems</span> <span m="453710">that</span> <span m="453820">are</span> <span m="453990">out</span> <span m="454190">there</span> <span m="454410">speaking</span> <span m="454790">this</span> <span m="454940">protocol.</span> <span m="455460">So</span> <span m="455600">if we</span> <span m="455740">find</span> <span m="456060">some</span> <span m="456260">problem in</span> <span m="456590">TCP,</span> <span m="457340">it's</span> <span m="457790">potentially</span> <span m="458160">quite</span> <span m="458380">devastating.</span> <span m="458910">Because</span> <span m="459600">every</span> <span m="459870">machine</span> <span m="460240">that</span> <span m="460550">uses</span> <span m="460700">TCP</span> <span m="460800">is going</span> <span m="461160">to</span> <span m="461240">have</span> <span m="461430">to</span> <span m="461530">change.</span> <span m="462590">Because</span> <span m="462810">it's</span> <span m="462950">going</span> <span m="463060">to</span> <span m="463110">be</span> <span m="463180">hard</span> <span m="463490">to</span> <span m="463570">make</span> <span m="463770">it</span> <span m="463960">potentially</span> <span m="464440">backwards</span> <span m="464920">compatible.</span> </p>
<p><span m="465790">We'll</span> <span m="465920">see</span> <span m="466260">exactly</span> <span m="466610">what</span> <span m="466760">these</span> <span m="466920">bugs</span> <span m="467180">are.</span> <span m="468530">But</span> <span m="468780">this</span> <span m="468900">is</span> <span m="469060">the</span> <span m="469520">real</span> <span m="469730">reason</span> <span m="470000">he's</span> <span m="470460">so</span> <span m="470750">excited</span> <span m="471190">about</span> <span m="471460">looking</span> <span m="471640">at</span> <span m="471830">protocol</span> <span m="472170">bugs.</span> <span m="472460">Because</span> <span m="473140">they're</span> <span m="473380">fairly</span> <span m="473590">fundamental</span> <span m="474340">to</span> <span m="475130">the</span> <span m="475975">TCP</span> <span m="476320">protocol</span> <span m="476555">that</span> <span m="476790">everyone</span> <span m="477110">agrees</span> <span m="477430">to speak.</span> </p>
<p><span m="479360">So</span> <span m="479750">let's look at</span> <span m="479950">one of</span> <span m="480010">these</span> <span m="480200">guys.</span> <span m="480440">So</span> <span m="481810">the</span> <span m="482050">first</span> <span m="482240">example</span> <span m="482690">he</span> <span m="483160">points</span> <span m="483610">out</span> <span m="483950">has</span> <span m="484340">to do</span> <span m="484580">with</span> <span m="485000">how</span> <span m="485360">TCP</span> <span m="486080">sequence</span> <span m="486480">numbers</span> <span m="486800">work.</span> <span m="489720">So</span> <span m="490670">just</span> <span m="490870">to</span> <span m="492030">re-explain--</span> <span m="492580">yeah,</span> <span m="492830">question.</span> </p>
<p><span m="493318">AUDIENCE: I'm</span> <span m="493806">just curious.</span> <span m="494294">This is</span> <span m="494782">a tiny bit off topic.</span> <span m="495270">But let's</span> <span m="495710">say you do</span> <span m="496184">find a</span> <span m="496658">bug in</span> <span m="497132">TCP.</span> <span m="497606">How do</span> <span m="498080">you make the</span> <span m="498554">change</span> <span m="499028">to</span> <span m="499502">it?</span> <span m="499976">How do you</span> <span m="500450">tell all the</span> <span m="500924">computers</span> <span m="501398">in the</span> <span m="501872">world</span> <span m="502346">to change</span> <span m="502820">that?</span> </p>
<p><span m="503780">PROFESSOR: Yeah,</span> <span m="504125">I think it's a</span> <span m="504470">huge</span> <span m="504810">problem.</span> <span m="505610">What</span> <span m="505970">if</span> <span m="506190">you find a</span> <span m="506280">bug</span> <span m="506660">in</span> <span m="506750">TCP?</span> <span m="506900">Well,</span> <span m="508580">it's unclear</span> <span m="508680">what to</span> <span m="508980">do.</span> <span m="509280">And</span> <span m="509625">I</span> <span m="509970">think</span> <span m="510390">the</span> <span m="510710">authors</span> <span m="511070">here</span> <span m="511280">struggle</span> <span m="511530">a</span> <span m="511600">lot</span> <span m="511900">with</span> <span m="512220">that.</span> <span m="512530">And</span> <span m="512840">in</span> <span m="513020">many</span> <span m="513240">ways,</span> <span m="513704">if</span> <span m="514169">you</span> <span m="514440">could</span> <span m="514620">redesign</span> <span m="515240">TCP,</span> <span m="516169">many</span> <span m="516390">of</span> <span m="516470">these</span> <span m="516630">bugs</span> <span m="516980">are</span> <span m="517120">relatively</span> <span m="517539">easy</span> <span m="517830">to</span> <span m="517900">fix</span> <span m="519280">if</span> <span m="519490">you</span> <span m="519880">knew</span> <span m="520150">what to</span> <span m="520230">look</span> <span m="520440">for</span> <span m="520630">ahead of time.</span> </p>
<p><span m="521620">But</span> <span m="522320">because</span> <span m="522830">TCP</span> <span m="523230">is</span> <span m="523570">sort</span> <span m="523690">of</span> <span m="525100">relatively</span> <span m="526040">hard</span> <span m="526410">to</span> <span m="526500">fix</span> <span m="527950">or</span> <span m="528110">change,</span> <span m="530530">what</span> <span m="530690">ends</span> <span m="530820">up</span> <span m="530970">happening</span> <span m="531350">is</span> <span m="531490">that</span> <span m="532370">people</span> <span m="532760">or</span> <span m="532880">designers</span> <span m="533330">try</span> <span m="533813">to</span> <span m="534296">look for backwards</span> <span m="534780">compatible</span> <span m="535580">tweaks</span> <span m="536400">that</span> <span m="537080">either</span> <span m="537770">allow</span> <span m="538135">old</span> <span m="538500">implementations</span> <span m="539480">to</span> <span m="539600">coexist</span> <span m="540150">with</span> <span m="540220">the new</span> <span m="540270">implementation</span> <span m="541170">or</span> <span m="541620">to add</span> <span m="542088">some</span> <span m="542556">optional</span> <span m="543024">field that if</span> <span m="543492">it's</span> <span m="543960">there,</span> <span m="544700">then</span> <span m="544970">the</span> <span m="545190">communication</span> <span m="545830">is</span> <span m="545950">more</span> <span m="546170">secure</span> <span m="546620">in</span> <span m="546710">some</span> <span m="546950">way.</span> </p>
<p><span m="548590">But</span> <span m="549000">it</span> <span m="549290">is</span> <span m="549490">a big</span> <span m="549910">problem.</span> <span m="550370">If</span> <span m="550550">it's</span> <span m="550930">some</span> <span m="551090">security</span> <span m="551820">issue</span> <span m="552140">that's</span> <span m="552490">deeply</span> <span m="552860">ingrained</span> <span m="553400">in</span> <span m="553520">TCP,</span> <span m="554030">then</span> <span m="554880">it's</span> <span m="555250">going</span> <span m="555640">to</span> <span m="555910">be</span> <span m="556180">a</span> <span m="556485">pretty</span> <span m="556790">humongous</span> <span m="557045">issue</span> <span m="557300">for</span> <span m="557490">everyone</span> <span m="557750">to</span> <span m="558010">just</span> <span m="558340">pack</span> <span m="558560">up</span> <span m="558800">and</span> <span m="559180">move</span> <span m="559290">onto</span> <span m="559560">a</span> <span m="559865">TCP</span> <span m="560170">version</span> <span m="561090">whatever,</span> <span m="561490">n</span> <span m="561590">plus</span> <span m="561820">1.</span> <span m="563930">And</span> <span m="564200">you can look at</span> <span m="564480">IPv6</span> <span m="565110">as</span> <span m="565200">one</span> <span m="565350">example</span> <span m="565725">of</span> <span m="566100">this</span> <span m="566330">not</span> <span m="566590">happening.</span> <span m="567320">We've</span> <span m="567620">known</span> <span m="567950">this</span> <span m="568690">problem</span> <span m="568970">was going to come up for like</span> <span m="569250">15</span> <span m="569515">years</span> <span m="569780">or</span> <span m="569940">20</span> <span m="570240">years.</span> </p>
<p><span m="571025">IPv6</span> <span m="571620">has</span> <span m="571940">been</span> <span m="572040">around</span> <span m="572630">for</span> <span m="573230">well</span> <span m="573410">over</span> <span m="573590">10</span> <span m="573780">years</span> <span m="574090">now.</span> <span m="574780">And it's</span> <span m="575070">just</span> <span m="575280">hard to</span> <span m="575520">convince</span> <span m="575650">people to</span> <span m="575820">move</span> <span m="575880">away</span> <span m="576080">from</span> <span m="576560">IPv4.</span> <span m="577300">It's</span> <span m="577750">good enough.</span> <span m="578060">It</span> <span m="578370">sort</span> <span m="578540">of</span> <span m="578650">works.</span> <span m="579040">It's</span> <span m="579330">a</span> <span m="579620">lot</span> <span m="579965">of</span> <span m="580310">overhead</span> <span m="580770">to move</span> <span m="581020">over.</span> <span m="581465">And</span> <span m="581910">no one</span> <span m="582220">else</span> <span m="582370">is</span> <span m="582810">speaking IPv6,</span> <span m="583070">so</span> <span m="583370">why</span> <span m="583460">should</span> <span m="583630">I</span> <span m="583700">start</span> <span m="583990">speaking</span> <span m="584200">this</span> <span m="584640">bizarre</span> <span m="584790">protocol</span> <span m="585060">that no one else</span> <span m="585170">is going to</span> <span m="585520">speak to</span> <span m="585955">me in?</span> </p>
<p><span m="587220">So</span> <span m="587540">it's</span> <span m="587870">sort</span> <span m="587952">of</span> <span m="588035">moving</span> <span m="588117">along.</span> <span m="588520">But</span> <span m="588740">I think it</span> <span m="588900">takes</span> <span m="589090">a</span> <span m="589150">long</span> <span m="589420">time.</span> <span m="589760">And</span> <span m="589880">there's</span> <span m="590010">going</span> <span m="590170">to</span> <span m="590210">be</span> <span m="590420">really</span> <span m="590640">some</span> <span m="590760">motivation</span> <span m="591520">to</span> <span m="592040">migrate.</span> <span m="593290">And</span> <span m="594750">backwards</span> <span m="595110">compatibility</span> <span m="595160">helps</span> <span m="595465">a</span> <span m="595770">lot.</span> <span m="596940">Not</span> <span m="597320">good</span> <span m="597600">enough for, I guess,</span> <span m="597960">IPv6--</span> <span m="598450">IPv6</span> <span m="598700">has</span> <span m="599100">lots of</span> <span m="599450">backwards</span> <span m="599750">compatibility</span> <span m="600270">plans</span> <span m="600610">in</span> <span m="600900">it.</span> <span m="601205">You</span> <span m="601510">can</span> <span m="601580">talk to an</span> <span m="601960">IPv4</span> <span m="602180">host</span> <span m="603020">from</span> <span m="603240">IPv6.</span> <span m="604720">So</span> <span m="605576">they</span> <span m="606510">try</span> <span m="606840">to</span> <span m="606970">engineer</span> <span m="607320">all this</span> <span m="607490">support.</span> <span m="607770">But</span> <span m="608050">still,</span> <span m="608550">it's hard to</span> <span m="608650">convince people</span> <span m="608980">to</span> <span m="609410">upgrade.</span> </p>
<p><span m="611840">All</span> <span m="611900">right,</span> <span m="613570">but</span> <span m="613690">yeah,</span> <span m="613920">looking</span> <span m="614270">back</span> <span m="614530">at</span> <span m="614790">the TCP</span> <span m="615080">sequence</span> <span m="615370">numbers,</span> <span m="615560">we're going to look at</span> <span m="616030">actually</span> <span m="616380">two</span> <span m="616970">problems</span> <span m="617480">that</span> <span m="617610">have</span> <span m="617830">to</span> <span m="617970">do</span> <span m="618180">with</span> <span m="618460">how</span> <span m="618980">the</span> <span m="619260">TCP</span> <span m="619750">handshake</span> <span m="620340">works.</span> <span m="620990">So</span> <span m="621285">let's</span> <span m="621580">just</span> <span m="621840">spend a</span> <span m="621880">little</span> <span m="622180">bit</span> <span m="622280">of</span> <span m="622400">time</span> <span m="623460">working</span> <span m="623930">out</span> <span m="624260">what</span> <span m="624303">are</span> <span m="624346">the</span> <span m="624390">details</span> <span m="624780">of</span> <span m="624900">how a</span> <span m="625215">TCP</span> <span m="625530">connection</span> <span m="626020">gets</span> <span m="626350">initially</span> <span m="627060">established.</span> </p>
<p><span m="628510">So</span> <span m="628800">there's</span> <span m="629090">actually</span> <span m="629510">three</span> <span m="629875">packets</span> <span m="630650">that</span> <span m="631060">have</span> <span m="631210">to</span> <span m="631320">get</span> <span m="631570">sent</span> <span m="632260">in</span> <span m="632430">order for</span> <span m="632530">a</span> <span m="633000">new</span> <span m="633210">TCP</span> <span m="633550">connection</span> <span m="633900">to be</span> <span m="634070">established.</span> <span m="634690">So</span> <span m="635000">our</span> <span m="635150">client</span> <span m="636270">generates</span> <span m="636690">a packet</span> <span m="637160">to</span> <span m="637260">connect</span> <span m="637520">to</span> <span m="637580">a</span> <span m="637640">server.</span> <span m="637960">And</span> <span m="638280">it</span> <span m="638410">says,</span> <span m="638550">well,</span> <span m="638910">here's</span> <span m="639000">my</span> <span m="639390">IP</span> <span m="639865">address, C,</span> <span m="640340">client.</span> <span m="641140">I'm</span> <span m="641330">sending</span> <span m="641590">this</span> <span m="641850">to</span> <span m="641930">the</span> <span m="642050">server.</span> </p>
<p><span m="642940">And</span> <span m="644040">there's</span> <span m="644430">various</span> <span m="644820">fields.</span> <span m="645200">But</span> <span m="645240">the</span> <span m="645330">ones</span> <span m="645580">that</span> <span m="645710">are</span> <span m="645920">interesting</span> <span m="646270">for the purpose</span> <span m="646575">of this</span> <span m="646880">discussion</span> <span m="647610">is</span> <span m="647720">going</span> <span m="647830">to</span> <span m="647930">be a</span> <span m="648290">sequence</span> <span m="648750">number.</span> <span m="649590">So</span> <span m="649900">there's</span> <span m="650130">going</span> <span m="650230">to</span> <span m="650280">be</span> <span m="650490">a</span> <span m="650710">syn</span> <span m="650970">flag</span> <span m="651230">saying,</span> <span m="651610">I</span> <span m="651650">want</span> <span m="651890">to</span> <span m="651960">synchronize</span> <span m="652300">state</span> <span m="652740">and establish</span> <span m="653142">a new</span> <span m="653544">connection.</span> <span m="654350">And</span> <span m="654670">you</span> <span m="654970">include</span> <span m="655200">a client</span> <span m="656680">sequence</span> <span m="657010">number</span> <span m="657480">in</span> <span m="657890">the</span> <span m="658800">initial</span> <span m="659060">syn</span> <span m="659320">packet.</span> </p>
<p><span m="660680">Then when</span> <span m="661160">the</span> <span m="661500">server</span> <span m="661710">receives</span> <span m="662130">this,</span> <span m="662370">the</span> <span m="662460">server</span> <span m="663230">is</span> <span m="663500">going</span> <span m="663770">to look</span> <span m="664020">and</span> <span m="664240">say,</span> <span m="664750">well, a client</span> <span m="665170">wants</span> <span m="665500">to connect</span> <span m="665600">to me,</span> <span m="665750">so I'll send</span> <span m="666020">a</span> <span m="666160">packet</span> <span m="666470">back</span> <span m="666790">to</span> <span m="667290">whatever</span> <span m="667550">this</span> <span m="667720">address</span> <span m="667910">is,</span> <span m="668250">whoever</span> <span m="668730">said they're</span> <span m="669000">trying to</span> <span m="669300">connect to</span> <span m="669680">me.</span> <span m="670060">So</span> <span m="670440">it'll</span> <span m="670620">send</span> <span m="670780">a</span> <span m="670830">packet</span> <span m="671060">from</span> <span m="671330">the</span> <span m="671430">server</span> <span m="672140">to</span> <span m="672250">the</span> <span m="672400">client</span> <span m="673740">and</span> <span m="674300">include</span> <span m="674585">its</span> <span m="674870">own</span> <span m="675080">synchronization</span> <span m="675740">number,</span> <span m="676600">SN</span> <span m="677170">server.</span> <span m="678080">And</span> <span m="678350">it'll</span> <span m="678550">acknowledge</span> <span m="679150">the</span> <span m="679270">client's</span> <span m="679700">number.</span> </p>
<p><span m="683750">And</span> <span m="684710">finally,</span> <span m="685130">the</span> <span m="685640">client</span> <span m="686860">replies</span> <span m="687610">back,</span> <span m="688040">acknowledging</span> <span m="688670">the</span> <span m="688770">server</span> <span m="689140">synchronization</span> <span m="690260">number--</span> <span m="693860">acknowledge</span> <span m="695970">SNS.</span> <span m="697070">And</span> <span m="697430">now the</span> <span m="697780">client</span> <span m="697965">can</span> <span m="698150">actually</span> <span m="698460">start</span> <span m="698860">sending</span> <span m="699300">data.</span> <span m="700110">So in</span> <span m="700380">order to</span> <span m="700580">send</span> <span m="700960">data,</span> <span m="701860">the</span> <span m="701990">client</span> <span m="702290">has</span> <span m="702700">to</span> <span m="704250">include</span> <span m="704610">some</span> <span m="704740">data</span> <span m="705400">in</span> <span m="705856">the</span> <span m="706312">packet,</span> <span m="706770">and</span> <span m="707180">also</span> <span m="707730">put</span> <span m="708240">in</span> <span m="708410">the</span> <span m="709100">sequence</span> <span m="709580">number</span> <span m="710140">of</span> <span m="710240">the</span> <span m="710370">client</span> <span m="711780">to</span> <span m="712060">indicate</span> <span m="712640">that</span> <span m="712830">this</span> <span m="712960">is</span> <span m="713020">actually</span> <span m="713275">sort</span> <span m="713402">of</span> <span m="713530">legitimate</span> <span m="714010">client</span> <span m="714350">data</span> <span m="714850">at</span> <span m="714960">the</span> <span m="715050">start</span> <span m="715260">of</span> <span m="715320">the</span> <span m="715420">connection.</span> <span m="715710">It's</span> <span m="716000">not</span> <span m="716230">some</span> <span m="716400">data</span> <span m="716760">from</span> <span m="717120">later</span> <span m="717470">on,</span> <span m="717650">for</span> <span m="717770">example,</span> <span m="719060">that</span> <span m="719250">just</span> <span m="719490">happens</span> <span m="719770">to arrive</span> <span m="720232">now</span> <span m="720694">because</span> <span m="721156">the server missed some</span> <span m="721618">initial parts of the</span> <span m="722080">data.</span> </p>
<p><span m="722542">So</span> <span m="723010">generally,</span> <span m="723740">all these</span> <span m="724015">sequence</span> <span m="724290">numbers</span> <span m="724735">were</span> <span m="725180">meant</span> <span m="725480">for</span> <span m="726130">ensuring</span> <span m="726610">in</span> <span m="726825">order</span> <span m="727040">delivery</span> <span m="727530">of</span> <span m="727690">packets.</span> <span m="728240">So</span> <span m="728500">if</span> <span m="728830">the</span> <span m="728980">client</span> <span m="729280">sends</span> <span m="729580">two</span> <span m="729840">packets,</span> <span m="730110">the</span> <span m="730600">one</span> <span m="731080">that has</span> <span m="731370">the</span> <span m="732350">initial</span> <span m="732680">sequence</span> <span m="733000">number,</span> <span m="733240">that's</span> <span m="733390">the</span> <span m="733480">first</span> <span m="733750">chunk</span> <span m="733920">of</span> <span m="734020">data.</span> <span m="734370">And</span> <span m="734740">the</span> <span m="734810">one with the next</span> <span m="735300">sequence number is the next</span> <span m="735600">chunk of</span> <span m="736100">data.</span> </p>
<p><span m="737410">But</span> <span m="737570">it</span> <span m="737650">turns out</span> <span m="737730">to</span> <span m="737980">also</span> <span m="738260">be</span> <span m="739070">useful</span> <span m="739640">for</span> <span m="740320">providing</span> <span m="740790">some</span> <span m="740970">security</span> <span m="741360">properties.</span> <span m="742820">Here's</span> <span m="743050">an</span> <span m="743090">example</span> <span m="743570">of</span> <span m="743630">these</span> <span m="743790">requirements</span> <span m="744280">changing.</span> <span m="744465">So</span> <span m="744650">initially,</span> <span m="745050">no one</span> <span m="745400">was</span> <span m="745530">thinking</span> <span m="745810">TCP</span> <span m="746140">provides</span> <span m="746470">any</span> <span m="746680">security</span> <span m="747090">properties.</span> <span m="747465">But</span> <span m="747840">then applications</span> <span m="748287">started</span> <span m="748734">using</span> <span m="749181">TCP</span> <span m="749630">and sort</span> <span m="749940">of</span> <span m="750300">relying</span> <span m="750850">on</span> <span m="750970">these TCP</span> <span m="751090">connections</span> <span m="752470">not</span> <span m="752710">being</span> <span m="752970">able</span> <span m="753360">to</span> <span m="753870">be</span> <span m="754090">broken</span> <span m="754590">by</span> <span m="754740">some</span> <span m="754930">arbitrary</span> <span m="755430">attacker,</span> <span m="755800">or</span> <span m="756350">an</span> <span m="756830">attacker</span> <span m="757210">not</span> <span m="757350">being</span> <span m="757500">able</span> <span m="757650">to inject</span> <span m="758140">data</span> <span m="758410">into your</span> <span m="758880">existing</span> <span m="759150">TCP</span> <span m="759430">connection.</span> <span m="760360">And</span> <span m="760690">all of</span> <span m="761060">a sudden,</span> <span m="761350">this</span> <span m="761460">mechanism</span> <span m="762380">that</span> <span m="762570">was</span> <span m="762700">initially</span> <span m="763060">meant</span> <span m="763400">for</span> <span m="763720">just</span> <span m="764430">packet</span> <span m="764710">ordering</span> <span m="766140">now</span> <span m="766240">gets</span> <span m="766460">used</span> <span m="766800">to</span> <span m="767240">guarantee</span> <span m="767750">some</span> <span m="768120">semblance</span> <span m="768660">of</span> <span m="768820">security</span> <span m="769160">for</span> <span m="769500">these</span> <span m="769935">connections.</span> </p>
<p><span m="772110">So</span> <span m="774180">in</span> <span m="774300">this</span> <span m="774460">case,</span> <span m="777000">I</span> <span m="777080">guess</span> <span m="777735">the</span> <span m="779070">problem</span> <span m="779810">stems</span> <span m="780170">from</span> <span m="780540">what</span> <span m="780930">could</span> <span m="781000">a</span> <span m="781340">server</span> <span m="781890">assume</span> <span m="782315">about</span> <span m="782740">this</span> <span m="783370">TCP</span> <span m="783710">connection.</span> <span m="784520">So</span> <span m="784680">typically,</span> <span m="785050">the</span> <span m="785160">server</span> <span m="785930">assumes--</span> <span m="788080">implicitly,</span> <span m="788180">you</span> <span m="788390">might</span> <span m="788710">imagine--</span> <span m="790170">that this</span> <span m="790350">connection</span> <span m="791230">is</span> <span m="791800">established</span> <span m="792480">with</span> <span m="792660">the right</span> <span m="792880">client</span> <span m="793220">at</span> <span m="793560">this</span> <span m="793730">IP</span> <span m="794210">address</span> <span m="794310">C.</span> <span m="797060">It</span> <span m="797150">seems like</span> <span m="797240">a</span> <span m="797330">natural</span> <span m="797790">thing to</span> <span m="798220">assume.</span> </p>
<p><span m="798650">Is</span> <span m="798955">there any</span> <span m="799260">basis for</span> <span m="799410">making</span> <span m="799670">this</span> <span m="799740">assumption?</span> <span m="800990">If</span> <span m="801060">a</span> <span m="801210">server</span> <span m="801916">gets</span> <span m="802270">this</span> <span m="803060">message</span> <span m="803560">saying,</span> <span m="804485">here's</span> <span m="804780">some</span> <span m="804970">data</span> <span m="805030">on</span> <span m="805240">this</span> <span m="805530">connection</span> <span m="806000">from</span> <span m="806170">a</span> <span m="806240">client</span> <span m="806406">to</span> <span m="806573">a</span> <span m="806740">server,</span> <span m="807500">and</span> <span m="807770">it</span> <span m="807870">has</span> <span m="808190">sequence</span> <span m="808430">number</span> <span m="808700">C,</span> <span m="810200">why</span> <span m="810760">might</span> <span m="810970">the</span> <span m="811410">server</span> <span m="812950">conclude</span> <span m="813245">that</span> <span m="813540">this</span> <span m="813700">was</span> <span m="813800">actually</span> <span m="814230">the</span> <span m="814850">real</span> <span m="815070">client</span> <span m="815520">sending this?</span> </p>
<p><span m="815970">AUDIENCE: Because</span> <span m="816386">the</span> <span m="816802">sequence number is hard to</span> <span m="817218">guess.</span> </p>
<p><span m="818050">PROFESSOR: Right,</span> <span m="818380">so</span> <span m="818820">that's</span> <span m="819060">sort of the</span> <span m="819180">implicit thing</span> <span m="819450">going</span> <span m="819700">on,</span> <span m="819940">that</span> <span m="820270">it</span> <span m="820358">has</span> <span m="820446">to</span> <span m="820534">have</span> <span m="820622">the</span> <span m="820710">right</span> <span m="821160">sequence</span> <span m="821480">number</span> <span m="821980">C here.</span> <span m="822640">And</span> <span m="823910">in</span> <span m="824040">order</span> <span m="824370">for</span> <span m="824560">this</span> <span m="824730">connection</span> <span m="825140">to</span> <span m="825510">get</span> <span m="825570">established,</span> <span m="826430">the</span> <span m="826610">client</span> <span m="827030">must</span> <span m="827450">have</span> <span m="827750">acknowledged</span> <span m="828730">the</span> <span m="829005">server</span> <span m="829870">sequence</span> <span m="830230">number</span> <span m="830530">S</span> <span m="830760">here.</span> <span m="831570">And</span> <span m="831910">the</span> <span m="832140">server sequence</span> <span m="832270">number</span> <span m="833010">S</span> <span m="833800">was only</span> <span m="834200">sent</span> <span m="834520">by</span> <span m="834620">the</span> <span m="834840">server</span> <span m="835520">to</span> <span m="835920">the</span> <span m="836670">intended</span> <span m="837030">client</span> <span m="837330">IP</span> <span m="837850">address.</span> <span m="839394">Yeah.</span> </p>
<p><span m="839886">AUDIENCE: How</span> <span m="840378">many bits are available</span> <span m="840870">for the sequence</span> <span m="841362">number?</span> </p>
<p><span m="841860">PROFESSOR: So</span> <span m="841970">sequence</span> <span m="842050">numbers</span> <span m="842270">in</span> <span m="842370">TCP</span> <span m="842780">are</span> <span m="843260">32</span> <span m="843600">bits</span> <span m="844100">long.</span> <span m="845831">That's</span> <span m="846730">not</span> <span m="848130">entirely</span> <span m="848920">easy</span> <span m="849170">to</span> <span m="849550">guess.</span> <span m="850396">If</span> <span m="850752">it</span> <span m="851110">was</span> <span m="851200">really a random</span> <span m="851450">32</span> <span m="851570">bit</span> <span m="851690">number,</span> <span m="852025">it</span> <span m="852360">would</span> <span m="852430">be</span> <span m="852520">hard</span> <span m="852970">to</span> <span m="853120">just</span> <span m="853440">guess.</span> <span m="854040">And</span> <span m="854460">you'd</span> <span m="855370">probably</span> <span m="855640">waste a lot</span> <span m="855910">of</span> <span m="856230">bandwidth</span> <span m="856699">trying to guess</span> <span m="857168">this.</span> <span m="857637">Yeah,</span> <span m="858106">question.</span> </p>
<p><span m="859044">AUDIENCE: The</span> <span m="859513">data</span> <span m="859982">frequency</span> <span m="860451">number</span> <span m="860607">is</span> <span m="860763">higher</span> <span m="860920">than</span> <span m="861154">the initial</span> <span m="861389">sequence</span> <span m="861858">number?</span> </p>
<p><span m="863740">PROFESSOR: Yeah,</span> <span m="863980">so</span> <span m="864275">basically,</span> <span m="864570">these things</span> <span m="864840">get</span> <span m="865060">incremented.</span> <span m="865650">So</span> <span m="865820">every</span> <span m="866130">time</span> <span m="866390">you</span> <span m="866480">send</span> <span m="866720">a</span> <span m="867030">syn, that</span> <span m="867500">counts</span> <span m="867820">as one</span> <span m="868140">byte</span> <span m="868620">against</span> <span m="868920">your</span> <span m="869080">sequence</span> <span m="869490">number.</span> <span m="869660">So</span> <span m="870000">this</span> <span m="870330">is</span> <span m="870490">SNC.</span> <span m="871010">I think</span> <span m="871460">actually</span> <span m="871880">what</span> <span m="872030">happens</span> <span m="872360">is this</span> <span m="872690">is</span> <span m="872790">SNC</span> <span m="873550">plus</span> <span m="873870">1.</span> <span m="874670">And</span> <span m="874900">then</span> <span m="875320">it</span> <span m="875470">goes</span> <span m="875680">on</span> <span m="875800">from</span> <span m="875950">there.</span> </p>
<p><span m="876140">So if</span> <span m="876270">you</span> <span m="876390">send</span> <span m="876750">5</span> <span m="876970">bytes,</span> <span m="877420">then</span> <span m="877700">the</span> <span m="877910">next one</span> <span m="878040">is</span> <span m="878225">SNC</span> <span m="878520">initial</span> <span m="878860">plus</span> <span m="879130">6.</span> <span m="880530">So</span> <span m="880690">this</span> <span m="880900">just counts</span> <span m="881200">the</span> <span m="881700">bytes</span> <span m="881825">that</span> <span m="881950">you're</span> <span m="882075">sending.</span> <span m="882200">SYNs</span> <span m="882700">count</span> <span m="882950">as</span> <span m="883200">1</span> <span m="883415">byte</span> <span m="883630">each.</span> <span m="884920">Make</span> <span m="885350">sense?</span> <span m="885720">Other</span> <span m="886125">questions</span> <span m="886530">about</span> <span m="886950">this?</span> </p>
<p><span m="888050">All right,</span> <span m="889310">so</span> <span m="891510">typically,</span> <span m="893205">or</span> <span m="893600">at least</span> <span m="894035">the</span> <span m="894470">way</span> <span m="894650">the TCP</span> <span m="894960">specification</span> <span m="895830">recommended</span> <span m="896370">that</span> <span m="896520">people</span> <span m="896900">choose</span> <span m="897150">these</span> <span m="897300">sequence</span> <span m="897770">numbers,</span> <span m="898550">was</span> <span m="899690">to</span> <span m="899880">increment</span> <span m="900346">them</span> <span m="900812">at</span> <span m="901280">some</span> <span m="901390">roughly</span> <span m="901500">fixed</span> <span m="901940">rate.</span> <span m="902750">So</span> <span m="903080">the</span> <span m="903220">initial</span> <span m="903540">RFCs</span> <span m="903970">suggested</span> <span m="904120">that</span> <span m="904270">you</span> <span m="904560">increment</span> <span m="904940">these</span> <span m="905540">things</span> <span m="906300">at</span> <span m="906650">something like</span> <span m="906950">250,000</span> <span m="908520">units,</span> <span m="909400">plus</span> <span m="910110">250,000,</span> <span m="910505">per</span> <span m="910900">second.</span> </p>
<p><span m="912350">And</span> <span m="912450">the</span> <span m="912550">reason</span> <span m="912690">that it</span> <span m="913210">wasn't</span> <span m="913710">entirely</span> <span m="914140">random</span> <span m="914920">is</span> <span m="915200">that</span> <span m="915870">these</span> <span m="916220">sequence</span> <span m="916520">numbers</span> <span m="916790">are</span> <span m="916820">actually</span> <span m="917060">used</span> <span m="917480">to</span> <span m="917960">prevent</span> <span m="919520">out of</span> <span m="919740">order</span> <span m="920130">packets,</span> <span m="920410">or packets</span> <span m="920690">from</span> <span m="921151">previous</span> <span m="921612">connections,</span> <span m="922073">from interfering</span> <span m="922534">with</span> <span m="922995">new</span> <span m="923456">connections.</span> <span m="923917">So</span> <span m="924378">if</span> <span m="924840">every</span> <span m="925090">time</span> <span m="925330">you</span> <span m="925715">established a</span> <span m="926100">new connection</span> <span m="926870">you</span> <span m="926990">chose</span> <span m="927260">a</span> <span m="927550">completely</span> <span m="928170">random</span> <span m="928500">sequence</span> <span m="928940">number,</span> <span m="929740">then</span> <span m="930480">there's</span> <span m="930670">some</span> <span m="930880">chance</span> <span m="931220">if</span> <span m="931310">you</span> <span m="931410">establish</span> <span m="931840">lots</span> <span m="932040">of</span> <span m="932150">connections</span> <span m="932590">over</span> <span m="932770">and</span> <span m="932850">over</span> <span m="933140">that</span> <span m="933430">some</span> <span m="933620">packet</span> <span m="933830">from</span> <span m="934120">a</span> <span m="934360">previous</span> <span m="934730">connection</span> <span m="935510">is</span> <span m="935610">going</span> <span m="935730">to</span> <span m="935770">have</span> <span m="936030">a</span> <span m="936180">similar</span> <span m="936510">enough</span> <span m="936840">sequence</span> <span m="937300">number</span> <span m="937590">to your</span> <span m="937920">new</span> <span m="938020">connection</span> <span m="938365">and</span> <span m="938710">is</span> <span m="938790">going</span> <span m="938910">to</span> <span m="938970">be</span> <span m="939090">accepted</span> <span m="939670">as</span> <span m="939880">a</span> <span m="939960">valid</span> <span m="940315">piece</span> <span m="940670">of</span> <span m="940780">data</span> <span m="941490">on</span> <span m="941690">that</span> <span m="941870">new</span> <span m="942236">connection.</span> </p>
<p><span m="942602">So</span> <span m="942970">this is</span> <span m="943150">something</span> <span m="943530">that</span> <span m="943710">the TCP</span> <span m="943970">designers</span> <span m="944390">worried</span> <span m="944620">a</span> <span m="944690">lot</span> <span m="945000">about--</span> <span m="945580">these</span> <span m="945770">out of</span> <span m="946010">order</span> <span m="946350">packets</span> <span m="946800">or</span> <span m="947270">delayed</span> <span m="947640">packets.</span> <span m="949020">So</span> <span m="949350">as</span> <span m="949460">a</span> <span m="949510">result,</span> <span m="949880">they</span> <span m="950130">really</span> <span m="950320">wanted</span> <span m="950400">these</span> <span m="950570">sequence</span> <span m="950950">numbers</span> <span m="951290">to</span> <span m="951610">progress</span> <span m="952220">in</span> <span m="952300">a</span> <span m="952430">roughly</span> <span m="953160">monotonic</span> <span m="953940">matter</span> <span m="954540">over</span> <span m="954800">time,</span> <span m="955210">even</span> <span m="955550">across</span> <span m="955890">connections.</span> <span m="956900">If</span> <span m="957060">I</span> <span m="957160">opened</span> <span m="957370">one</span> <span m="957580">connection,</span> <span m="958390">it</span> <span m="958410">might</span> <span m="958580">have</span> <span m="958730">the</span> <span m="958790">same</span> <span m="959130">source</span> <span m="959510">and</span> <span m="959600">destination,</span> <span m="960440">port</span> <span m="960760">numbers,</span> <span m="961060">IP</span> <span m="961410">addresses,</span> <span m="961760">et cetera.</span> <span m="962610">But</span> <span m="963160">because</span> <span m="963390">I</span> <span m="963460">established this</span> <span m="963950">connection</span> <span m="964360">now</span> <span m="964740">instead of</span> <span m="965100">earlier,</span> <span m="965990">packets</span> <span m="966350">from</span> <span m="966430">earlier</span> <span m="967270">hopefully</span> <span m="967640">aren't</span> <span m="967960">going</span> <span m="968110">to</span> <span m="968260">match</span> <span m="968590">up</span> <span m="969120">with</span> <span m="969280">the</span> <span m="969360">sequence</span> <span m="969650">numbers</span> <span m="970030">I have</span> <span m="970190">for my</span> <span m="970570">new</span> <span m="971005">connection.</span> <span m="972310">So</span> <span m="972440">this was a</span> <span m="972540">mechanism</span> <span m="972950">to</span> <span m="973130">prevent</span> <span m="973750">confusion</span> <span m="974280">across</span> <span m="976550">repeated</span> <span m="977430">connection</span> <span m="978270">establishments.</span> <span m="978650">Yeah.</span> </p>
<p><span m="978930">AUDIENCE: So</span> <span m="979404">if you</span> <span m="979878">don't</span> <span m="980352">know</span> <span m="980826">exactly</span> <span m="981300">how</span> <span m="981774">much</span> <span m="982248">your</span> <span m="982722">other</span> <span m="983196">grid that</span> <span m="983670">you're</span> <span m="983788">talking</span> <span m="983907">to</span> <span m="984025">is</span> <span m="984144">going to</span> <span m="984618">improve</span> <span m="984855">the</span> <span m="985092">sequencing</span> <span m="985566">pack,</span> <span m="986040">how do you know</span> <span m="986514">that</span> <span m="986632">the</span> <span m="986751">packet</span> <span m="986774">you're</span> <span m="986798">getting</span> <span m="986821">is</span> <span m="986845">the</span> <span m="986869">next packet</span> <span m="986988">if there</span> <span m="987462">wasn't</span> <span m="987950">[INAUDIBLE]</span> <span m="988300">immediate</span> <span m="988710">packet</span> <span m="989120">that you--</span> </p>
<p><span m="989530">PROFESSOR: So</span> <span m="989740">typically</span> <span m="990230">you'll</span> <span m="990430">remember</span> <span m="990940">the</span> <span m="991080">last</span> <span m="991480">packet</span> <span m="991870">that you</span> <span m="992000">received.</span> <span m="993260">And</span> <span m="993585">if</span> <span m="993910">the</span> <span m="994010">next</span> <span m="994260">sequence</span> <span m="994620">number is</span> <span m="994920">exactly</span> <span m="995410">that,</span> <span m="995680">then</span> <span m="995950">this is</span> <span m="996210">the</span> <span m="996310">next</span> <span m="996580">packet</span> <span m="996790">in</span> <span m="997030">sequence.</span> <span m="998300">So</span> <span m="998340">for</span> <span m="998450">example,</span> <span m="998710">here,</span> <span m="998950">the</span> <span m="999070">server</span> <span m="999430">knows</span> <span m="999850">that</span> <span m="1000125">I've</span> <span m="1000400">seen</span> <span m="1001110">exactly</span> <span m="1001650">SNC</span> <span m="1002100">plus</span> <span m="1002480">1</span> <span m="1002710">worth</span> <span m="1002920">of</span> <span m="1003030">data.</span> <span m="1004020">If</span> <span m="1004140">the</span> <span m="1004220">next</span> <span m="1004440">packet has</span> <span m="1004830">sequence</span> <span m="1005150">number</span> <span m="1005420">SNC</span> <span m="1005690">plus</span> <span m="1005800">1,</span> <span m="1006020">that's</span> <span m="1006640">the</span> <span m="1006710">next</span> <span m="1006930">one.</span> </p>
<p><span m="1007902">AUDIENCE: So</span> <span m="1008388">you're</span> <span m="1008550">saying</span> <span m="1008712">that</span> <span m="1008874">when you</span> <span m="1009360">establish</span> <span m="1009846">a sequence number,</span> <span m="1010332">then even</span> <span m="1010818">after</span> <span m="1011061">that</span> <span m="1011304">you're</span> <span m="1011790">committing</span> <span m="1012276">it--</span> </p>
<p><span m="1012762">PROFESSOR: Well,</span> <span m="1013260">absolutely,</span> <span m="1013660">yeah,</span> <span m="1013793">yeah.</span> <span m="1013926">So these</span> <span m="1014060">sequence</span> <span m="1014470">numbers,</span> <span m="1015670">initially</span> <span m="1016330">when</span> <span m="1016780">you establish</span> <span m="1017230">it,</span> <span m="1017510">they get picked</span> <span m="1017790">according</span> <span m="1018210">to</span> <span m="1018400">some</span> <span m="1018830">plan. We'll talk</span> <span m="1019300">about that</span> <span m="1019690">plan.</span> <span m="1020135">You</span> <span m="1020390">can</span> <span m="1020560">sort</span> <span m="1020780">of</span> <span m="1020870">think</span> <span m="1021060">they</span> <span m="1021170">might</span> <span m="1021430">be</span> <span m="1021530">random.</span> <span m="1021940">But</span> <span m="1022310">over</span> <span m="1022570">time,</span> <span m="1022900">they</span> <span m="1023000">have</span> <span m="1023200">to</span> <span m="1023310">have</span> <span m="1023500">some</span> <span m="1023710">flow</span> <span m="1024390">for</span> <span m="1024560">initial</span> <span m="1024970">sequence</span> <span m="1025310">numbers</span> <span m="1025619">for</span> <span m="1025780">connection.</span> </p>
<p><span m="1027036">But</span> <span m="1027400">within</span> <span m="1027660">a connection,</span> <span m="1027770">once</span> <span m="1027869">they're</span> <span m="1028260">established,</span> <span m="1029319">that's</span> <span m="1029520">it.</span> <span m="1029575">They're</span> <span m="1029680">fixed.</span> <span m="1030280">And</span> <span m="1030380">they</span> <span m="1030470">just</span> <span m="1030700">tick</span> <span m="1030859">along</span> <span m="1031290">as</span> <span m="1031430">the</span> <span m="1031500">data</span> <span m="1031890">gets sent</span> <span m="1032170">on</span> <span m="1032260">the</span> <span m="1032339">connection,</span> <span m="1033139">exactly.</span> <span m="1035630">Make</span> <span m="1036119">sense?</span> <span m="1037270">All</span> <span m="1037535">right,</span> <span m="1038579">so</span> <span m="1038859">there</span> <span m="1039050">were</span> <span m="1039250">some</span> <span m="1039434">plans</span> <span m="1039619">suggested</span> <span m="1039819">for</span> <span m="1040305">how</span> <span m="1040660">to</span> <span m="1041025">manage</span> <span m="1041207">these</span> <span m="1041390">sequence</span> <span m="1041740">numbers.</span> <span m="1042020">And</span> <span m="1042140">it</span> <span m="1042260">was</span> <span m="1042380">actually</span> <span m="1042535">a</span> <span m="1042690">reasonable</span> <span m="1043109">plan</span> <span m="1043650">for</span> <span m="1044069">avoiding</span> <span m="1044640">duplicate</span> <span m="1045250">packets</span> <span m="1045810">in the</span> <span m="1046079">network</span> <span m="1046550">causing</span> <span m="1046900">trouble.</span> </p>
<p><span m="1047970">But</span> <span m="1048790">the</span> <span m="1049340">problem,</span> <span m="1050490">of course,</span> <span m="1050990">showed</span> <span m="1051490">up</span> <span m="1051730">that</span> <span m="1055290">attackers</span> <span m="1055560">were</span> <span m="1055830">able</span> <span m="1056100">to</span> <span m="1056500">sort</span> <span m="1056950">of</span> <span m="1057150">guess these</span> <span m="1057330">sequence</span> <span m="1057620">numbers.</span> <span m="1058010">Because</span> <span m="1059340">there</span> <span m="1059850">wasn't</span> <span m="1060290">a lot</span> <span m="1060640">of</span> <span m="1061100">randomness</span> <span m="1061330">being</span> <span m="1061690">chosen.</span> <span m="1062090">So the</span> <span m="1062240">way</span> <span m="1062440">that</span> <span m="1062745">the</span> <span m="1063050">host</span> <span m="1063430">machine</span> <span m="1063820">would</span> <span m="1064100">choose</span> <span m="1064250">these</span> <span m="1064360">sequence</span> <span m="1064750">numbers</span> <span m="1065020">is they</span> <span m="1065420">have just a</span> <span m="1065820">running</span> <span m="1066220">counter in</span> <span m="1066620">memory.</span> <span m="1067290">Every</span> <span m="1067530">second</span> <span m="1067860">they</span> <span m="1068190">bump</span> <span m="1068410">it by</span> <span m="1068550">250,000.</span> <span m="1070080">And</span> <span m="1070510">every</span> <span m="1070710">time</span> <span m="1070880">a new</span> <span m="1071070">connection</span> <span m="1071520">comes</span> <span m="1071790">in, they</span> <span m="1072160">also</span> <span m="1072440">bump</span> <span m="1072780">it</span> <span m="1073010">by</span> <span m="1073550">some</span> <span m="1073800">constant</span> <span m="1074225">like</span> <span m="1074650">64k</span> <span m="1074950">or</span> <span m="1075240">128k.</span> <span m="1075530">I</span> <span m="1076026">forget the</span> <span m="1076522">exact</span> <span m="1077018">number.</span> <span m="1078010">So</span> <span m="1078400">this was</span> <span m="1078670">relatively</span> <span m="1079025">easy</span> <span m="1079380">to guess,</span> <span m="1079820">as you</span> <span m="1080010">can</span> <span m="1080030">tell.</span> <span m="1080180">You send</span> <span m="1080320">them</span> <span m="1081060">their</span> <span m="1081260">connection</span> <span m="1081590">request,</span> <span m="1082030">and you</span> <span m="1082220">see</span> <span m="1082370">what</span> <span m="1083180">sequence</span> <span m="1083540">number</span> <span m="1083790">comes</span> <span m="1084235">back.</span> <span m="1084680">And</span> <span m="1084820">then</span> <span m="1084960">you know</span> <span m="1085170">the</span> <span m="1085260">next</span> <span m="1085480">one is going to</span> <span m="1085830">be</span> <span m="1086180">64k</span> <span m="1086530">higher</span> <span m="1086820">than</span> <span m="1087180">that.</span> <span m="1087950">So</span> <span m="1088150">there</span> <span m="1088280">wasn't</span> <span m="1088560">a</span> <span m="1088730">huge</span> <span m="1089010">amount</span> <span m="1089210">of</span> <span m="1089320">randomness</span> <span m="1090220">in</span> <span m="1090920">this</span> <span m="1091120">protocol.</span> </p>
<p><span m="1092680">So we</span> <span m="1092970">can just sketch out</span> <span m="1093390">what this</span> <span m="1093810">looks</span> <span m="1094020">like.</span> <span m="1094310">So if I'm</span> <span m="1094940">an</span> <span m="1095020">attacker</span> <span m="1095590">that</span> <span m="1095933">wants</span> <span m="1096276">to</span> <span m="1096620">connect to a</span> <span m="1096820">server</span> <span m="1097190">but</span> <span m="1097310">pretend</span> <span m="1098030">to</span> <span m="1098110">be</span> <span m="1098290">from</span> <span m="1098470">a</span> <span m="1098580">particular</span> <span m="1099410">IP</span> <span m="1099770">address,</span> <span m="1100690">then</span> <span m="1101040">what</span> <span m="1101390">I</span> <span m="1101690">might</span> <span m="1102080">do is send</span> <span m="1102420">a</span> <span m="1103050">request</span> <span m="1103520">to</span> <span m="1103645">the</span> <span m="1103770">server,</span> <span m="1103920">very</span> <span m="1104110">much</span> <span m="1104300">like</span> <span m="1104390">the</span> <span m="1104520">first</span> <span m="1104790">step</span> <span m="1105010">there,</span> <span m="1106490">include</span> <span m="1107960">some</span> <span m="1108170">initial</span> <span m="1108730">sequence</span> <span m="1109160">number</span> <span m="1109490">that</span> <span m="1109700">I</span> <span m="1109820">choose.</span> <span m="1110470">At</span> <span m="1110950">this</span> <span m="1111120">point,</span> <span m="1111320">any</span> <span m="1111520">sequence</span> <span m="1111780">number is</span> <span m="1112210">just</span> <span m="1112400">as good,</span> <span m="1112700">because</span> <span m="1113070">the</span> <span m="1113160">server</span> <span m="1113430">shouldn't</span> <span m="1113660">have</span> <span m="1113810">any</span> <span m="1113980">assumptions</span> <span m="1114400">about</span> <span m="1114630">what</span> <span m="1115160">the</span> <span m="1115260">client's</span> <span m="1115600">sequence</span> <span m="1115970">number is.</span> </p>
<p><span m="1117140">Now,</span> <span m="1117395">what does</span> <span m="1117650">the</span> <span m="1117780">server</span> <span m="1118210">do?</span> <span m="1118250">The</span> <span m="1118350">server</span> <span m="1119430">gets</span> <span m="1119640">the</span> <span m="1119710">same</span> <span m="1120000">packet as</span> <span m="1120320">before.</span> <span m="1120760">So it</span> <span m="1120940">performs</span> <span m="1121440">the</span> <span m="1121530">same</span> <span m="1121760">way</span> <span m="1122200">as before.</span> <span m="1122550">It</span> <span m="1122850">sends</span> <span m="1123370">a</span> <span m="1123500">packet</span> <span m="1123820">back</span> <span m="1124050">to</span> <span m="1124130">the</span> <span m="1124230">client</span> <span m="1125100">with</span> <span m="1126070">some</span> <span m="1126960">server</span> <span m="1127500">sequence</span> <span m="1127870">number</span> <span m="1129520">and</span> <span m="1130450">acknowledges</span> <span m="1131920">SNC.</span> <span m="1133000">And</span> <span m="1133220">now</span> <span m="1133970">the</span> <span m="1134130">attacker,</span> <span m="1135170">if</span> <span m="1135600">the attacker</span> <span m="1135800">wants</span> <span m="1135990">to</span> <span m="1136100">establish</span> <span m="1136510">a</span> <span m="1136580">connection,</span> <span m="1137735">needs</span> <span m="1137800">to</span> <span m="1138240">somehow</span> <span m="1138400">synthesize</span> <span m="1138620">a packet that</span> <span m="1139060">looks</span> <span m="1139240">exactly</span> <span m="1139700">like</span> <span m="1139890">the third</span> <span m="1139980">packet</span> <span m="1140470">over</span> <span m="1140680">there.</span> <span m="1141540">So</span> <span m="1141640">it</span> <span m="1141650">needs</span> <span m="1141870">to</span> <span m="1142000">send</span> <span m="1142610">a</span> <span m="1142700">packet</span> <span m="1143260">from</span> <span m="1143460">the client</span> <span m="1143920">to</span> <span m="1144000">the</span> <span m="1144150">server.</span> </p>
<p><span m="1144860">That's</span> <span m="1145070">easy</span> <span m="1145490">enough.</span> <span m="1145570">You just</span> <span m="1145875">fill in these</span> <span m="1146180">values in the</span> <span m="1146450">header.</span> <span m="1146705">But you</span> <span m="1146960">have</span> <span m="1147285">to</span> <span m="1147610">acknowledge</span> <span m="1148990">this</span> <span m="1149990">server</span> <span m="1150780">sequence</span> <span m="1151200">number</span> <span m="1151510">SNS.</span> <span m="1152820">And</span> <span m="1153540">this is</span> <span m="1153840">where</span> <span m="1154290">sort of the</span> <span m="1154560">problems</span> <span m="1154810">start.</span> <span m="1155090">If</span> <span m="1155370">the</span> <span m="1155746">SNS</span> <span m="1156500">value</span> <span m="1156940">is</span> <span m="1157590">relatively</span> <span m="1158060">easy</span> <span m="1158300">to</span> <span m="1158390">guess,</span> <span m="1158950">then</span> <span m="1159710">the</span> <span m="1159840">attacker</span> <span m="1160280">is</span> <span m="1160520">good</span> <span m="1160720">to</span> <span m="1160780">go.</span> <span m="1161050">And</span> <span m="1161380">now</span> <span m="1161710">the</span> <span m="1161910">server</span> <span m="1162180">thinks</span> <span m="1162580">they</span> <span m="1162680">have</span> <span m="1162910">an</span> <span m="1163000">established</span> <span m="1163480">connection</span> <span m="1164290">with</span> <span m="1164520">a</span> <span m="1164710">client</span> <span m="1165170">coming</span> <span m="1165480">from</span> <span m="1165760">this</span> <span m="1166080">IP</span> <span m="1166400">address.</span> </p>
<p><span m="1167990">And</span> <span m="1168030">now</span> <span m="1168345">an</span> <span m="1168660">attacker</span> <span m="1169420">could</span> <span m="1170290">inject</span> <span m="1170810">data</span> <span m="1171080">into</span> <span m="1171300">this</span> <span m="1171410">connection</span> <span m="1171920">just</span> <span m="1172290">as</span> <span m="1172540">before.</span> <span m="1173270">They</span> <span m="1173380">just</span> <span m="1173540">synthesize</span> <span m="1173940">a</span> <span m="1174070">packet</span> <span m="1174330">that</span> <span m="1174590">looks</span> <span m="1174820">like</span> <span m="1175000">this,</span> <span m="1175480">has</span> <span m="1175845">the</span> <span m="1176210">data,</span> <span m="1177240">and</span> <span m="1177600">it</span> <span m="1177680">has</span> <span m="1178140">the</span> <span m="1178520">client</span> <span m="1178880">sequence</span> <span m="1179290">number</span> <span m="1179880">that</span> <span m="1180240">in</span> <span m="1180340">fact</span> <span m="1180440">the</span> <span m="1180660">adversary</span> <span m="1181030">chose.</span> <span m="1181540">Maybe</span> <span m="1181820">it's plus</span> <span m="1182230">1</span> <span m="1182640">here.</span> <span m="1183870">But</span> <span m="1184760">it</span> <span m="1184780">all</span> <span m="1185010">hinges</span> <span m="1185190">on</span> <span m="1185480">being</span> <span m="1185680">able</span> <span m="1185900">to</span> <span m="1185960">guess</span> <span m="1186600">this</span> <span m="1186810">particular</span> <span m="1187320">server</span> <span m="1188170">supplied</span> <span m="1188720">sequence</span> <span m="1189080">number.</span> <span m="1191400">All right,</span> <span m="1191880">does this</span> <span m="1192360">make sense?</span> <span m="1192840">Yeah.</span> </p>
<p><span m="1193320">AUDIENCE: What's</span> <span m="1193416">the</span> <span m="1193512">reason</span> <span m="1193608">that</span> <span m="1193704">the</span> <span m="1193800">server sequence</span> <span m="1194280">number isn't</span> <span m="1194760">completely</span> <span m="1195240">random?</span> </p>
<p><span m="1196690">PROFESSOR: So</span> <span m="1196960">there's</span> <span m="1197240">two</span> <span m="1197380">reasons.</span> <span m="1197790">One,</span> <span m="1198000">as</span> <span m="1198210">I</span> <span m="1198270">was</span> <span m="1198860">describing</span> <span m="1199640">earlier,</span> <span m="1200940">the</span> <span m="1201600">server</span> <span m="1203140">wants</span> <span m="1203600">to</span> <span m="1203930">make</span> <span m="1204210">sure</span> <span m="1204640">that</span> <span m="1204760">packets</span> <span m="1205330">from</span> <span m="1205630">different</span> <span m="1206040">connections</span> <span m="1206570">over</span> <span m="1206850">time</span> <span m="1207720">don't</span> <span m="1207980">get</span> <span m="1208200">confused</span> <span m="1208730">for</span> <span m="1208860">one</span> <span m="1209060">another.</span> <span m="1209315">So</span> <span m="1209570">if</span> <span m="1210040">you</span> <span m="1210360">establish</span> <span m="1210790">a</span> <span m="1210870">connection</span> <span m="1211350">from</span> <span m="1211600">one</span> <span m="1211780">source</span> <span m="1212060">port</span> <span m="1212280">to another</span> <span m="1212640">destination</span> <span m="1213150">port,</span> <span m="1214060">and</span> <span m="1214230">then</span> <span m="1214570">you close</span> <span m="1214740">the</span> <span m="1214820">connection</span> <span m="1215200">and establish</span> <span m="1215620">another</span> <span m="1215910">one</span> <span m="1216150">of</span> <span m="1216200">the</span> <span m="1216290">same</span> <span m="1216520">source and</span> <span m="1216760">destination</span> <span m="1217240">port,</span> <span m="1217610">you</span> <span m="1217980">want to</span> <span m="1218120">make</span> <span m="1218350">sure</span> <span m="1218820">the</span> <span m="1218900">packets from</span> <span m="1219170">one connection</span> <span m="1220000">don't</span> <span m="1221030">appear</span> <span m="1221410">to</span> <span m="1221460">be</span> <span m="1221560">valid</span> <span m="1221770">in</span> <span m="1221950">another</span> <span m="1222280">connection.</span> </p>
<p><span m="1224121">AUDIENCE: So</span> <span m="1224618">the server</span> <span m="1225115">sequence</span> <span m="1225612">number</span> <span m="1226109">is</span> <span m="1226606">incremented</span> <span m="1227103">for every one</span> <span m="1227600">of their</span> <span m="1228070">packets?</span> </p>
<p><span m="1228525">PROFESSOR: Well,</span> <span m="1230660">so</span> <span m="1231470">the</span> <span m="1231730">sequence</span> <span m="1232090">numbers</span> <span m="1232760">within</span> <span m="1233220">a</span> <span m="1233340">connection, as I was</span> <span m="1233570">describing,</span> <span m="1233900">get</span> <span m="1234230">bumped</span> <span m="1234330">with</span> <span m="1234790">all</span> <span m="1234980">the</span> <span m="1235070">data</span> <span m="1235550">in</span> <span m="1235900">a connection.</span> <span m="1236380">But</span> <span m="1236850">there's</span> <span m="1236950">also the</span> <span m="1237240">question</span> <span m="1237470">of,</span> <span m="1237550">how do you choose</span> <span m="1237830">the</span> <span m="1238110">initial</span> <span m="1238520">sequence</span> <span m="1238890">number</span> <span m="1239230">here?</span> </p>
<p><span m="1239820">And</span> <span m="1239870">that</span> <span m="1240090">gets</span> <span m="1240520">bumped</span> <span m="1241230">every</span> <span m="1241500">time</span> <span m="1241730">a new</span> <span m="1241990">connection</span> <span m="1242190">is</span> <span m="1242530">established.</span> <span m="1243440">So</span> <span m="1243820">the</span> <span m="1243990">hope</span> <span m="1244300">is</span> <span m="1244645">that</span> <span m="1244990">by</span> <span m="1245160">the</span> <span m="1245290">time</span> <span m="1245580">it</span> <span m="1245720">wraps</span> <span m="1246260">around</span> <span m="1246630">2 to the</span> <span m="1246910">32</span> <span m="1247190">and</span> <span m="1247450">comes</span> <span m="1247710">back,</span> <span m="1249670">there's</span> <span m="1249840">been</span> <span m="1250010">enough</span> <span m="1250220">time</span> <span m="1250600">so</span> <span m="1250880">that</span> <span m="1251020">old</span> <span m="1251160">packets</span> <span m="1251530">in the</span> <span m="1251900">network</span> <span m="1252270">have</span> <span m="1252350">actually</span> <span m="1252940">been</span> <span m="1253210">dropped</span> <span m="1253860">and</span> <span m="1254040">will</span> <span m="1254130">not appear as</span> <span m="1254590">duplicates</span> <span m="1255260">anymore.</span> <span m="1256120">So that's</span> <span m="1256330">the</span> <span m="1256430">reason</span> <span m="1256710">why you</span> <span m="1256900">don't</span> <span m="1257310">just</span> <span m="1257630">choose</span> <span m="1257900">random</span> <span m="1258310">points,</span> <span m="1258950">or</span> <span m="1259160">they didn't</span> <span m="1259260">initially</span> <span m="1259920">choose</span> <span m="1260090">random</span> <span m="1260500">points.</span> <span m="1261387">Yeah.</span> </p>
<p><span m="1261874">AUDIENCE: So</span> <span m="1262361">this is a</span> <span m="1262848">problem between</span> <span m="1263335">connections,</span> <span m="1264309">for</span> <span m="1264796">a</span> <span m="1265290">connection between</span> <span m="1265560">the same</span> <span m="1266010">guide,</span> <span m="1266460">the same client,</span> <span m="1266910">the same</span> <span m="1267360">server,</span> <span m="1267725">the same source</span> <span m="1268090">port, the same destination.</span> <span m="1268577">And</span> <span m="1269064">we're</span> <span m="1269307">worried</span> <span m="1269551">about</span> <span m="1270038">old</span> <span m="1270525">packets--</span> </p>
<p><span m="1271012">PROFESSOR: So</span> <span m="1271500">this is</span> <span m="1271830">what</span> <span m="1271980">the</span> <span m="1272180">original,</span> <span m="1272510">yeah,</span> <span m="1272840">TCP</span> <span m="1273340">designers were</span> <span m="1273790">worried</span> <span m="1274040">about,</span> <span m="1274240">which</span> <span m="1274370">is</span> <span m="1274460">why they</span> <span m="1274810">prescribed</span> <span m="1275340">this</span> <span m="1275550">way</span> <span m="1275760">of picking</span> <span m="1275980">these initial</span> <span m="1276230">sequence numbers.</span> </p>
<p><span m="1276696">AUDIENCE: If you</span> <span m="1277162">have different</span> <span m="1277628">new connections,</span> <span m="1278094">you could</span> <span m="1278560">differentiate.</span> </p>
<p><span m="1279135">PROFESSOR: That's</span> <span m="1279240">right,</span> <span m="1279450">yeah.</span> </p>
<p><span m="1279900">AUDIENCE: So</span> <span m="1280395">then I don't</span> <span m="1280890">see why</span> <span m="1281385">the</span> <span m="1281880">incrementing stuff</span> <span m="1282375">and not just</span> <span m="1282870">take</span> <span m="1283365">randomly.</span> </p>
<p><span m="1284355">PROFESSOR: So</span> <span m="1284850">I</span> <span m="1284930">think</span> <span m="1285140">the</span> <span m="1285260">reason</span> <span m="1285630">they</span> <span m="1285970">don't</span> <span m="1286440">pick</span> <span m="1286560">randomly</span> <span m="1287090">is</span> <span m="1287250">that</span> <span m="1287600">if</span> <span m="1287720">you</span> <span m="1287840">did</span> <span m="1287960">pick</span> <span m="1288160">randomly,</span> <span m="1288480">and you</span> <span m="1288800">established,</span> <span m="1289100">I</span> <span m="1289400">don't know,</span> <span m="1289680">1,000</span> <span m="1290160">connections</span> <span m="1290560">within</span> <span m="1290860">a</span> <span m="1290890">short</span> <span m="1291130">amount</span> <span m="1291320">of</span> <span m="1291410">time</span> <span m="1291910">from</span> <span m="1292030">the</span> <span m="1292110">same</span> <span m="1292350">source to</span> <span m="1292800">the same</span> <span m="1292930">destination,</span> <span m="1294040">then,</span> <span m="1295510">well,</span> <span m="1295760">every</span> <span m="1295960">one</span> <span m="1296160">of</span> <span m="1296230">them</span> <span m="1296460">is</span> <span m="1296540">some</span> <span m="1296730">random</span> <span m="1297070">value</span> <span m="1297325">of module</span> <span m="1297580">2</span> <span m="1297780">to the</span> <span m="1298070">32.</span> <span m="1298990">And</span> <span m="1299255">now</span> <span m="1299520">there's</span> <span m="1299770">a</span> <span m="1299960">nontrivial</span> <span m="1300630">chance</span> <span m="1301010">that</span> <span m="1301180">some</span> <span m="1301360">packet</span> <span m="1301680">from</span> <span m="1301800">one</span> <span m="1301960">connection</span> <span m="1302420">will</span> <span m="1303060">be</span> <span m="1303200">delayed</span> <span m="1303560">in</span> <span m="1303620">the</span> <span m="1303750">network,</span> <span m="1304360">and</span> <span m="1304490">eventually</span> <span m="1304830">show</span> <span m="1305000">up</span> <span m="1305120">again,</span> <span m="1305600">and</span> <span m="1305850">will</span> <span m="1306000">get</span> <span m="1306570">confused</span> <span m="1307010">for</span> <span m="1307190">a packet</span> <span m="1307400">from</span> <span m="1307550">another</span> <span m="1307990">connection.</span> <span m="1308760">This</span> <span m="1309010">is</span> <span m="1309090">just</span> <span m="1309440">sort</span> <span m="1309705">of</span> <span m="1309970">nothing</span> <span m="1310070">to do</span> <span m="1310310">with</span> <span m="1310380">security.</span> <span m="1310840">This is just</span> <span m="1311090">their</span> <span m="1311240">design</span> <span m="1311660">consideration</span> <span m="1311740">initially</span> <span m="1311970">for</span> <span m="1313592">reliable</span> <span m="1313970">delivery.</span> </p>
<p><span m="1315290">AUDIENCE: [INAUDIBLE]</span> <span m="1316600">some</span> <span m="1316770">other</span> <span m="1316980">client</span> <span m="1317370">to the server,</span> <span m="1317820">right?</span> </p>
<p><span m="1318720">PROFESSOR: Sorry?</span> </p>
<p><span m="1319595">AUDIENCE: This</span> <span m="1320020">is</span> <span m="1320436">[INAUDIBLE]</span> <span m="1321268">some</span> <span m="1321684">other client?</span> </p>
<p><span m="1322100">PROFESSOR: That's</span> <span m="1322310">right,</span> <span m="1322520">yeah.</span> <span m="1323080">So</span> <span m="1323330">we</span> <span m="1323690">haven't actually said</span> <span m="1324220">why</span> <span m="1324320">this is</span> <span m="1324580">interesting</span> <span m="1324750">at all for</span> <span m="1324870">the</span> <span m="1325125">attacker</span> <span m="1325380">to do.</span> <span m="1326190">Why</span> <span m="1326400">bother?</span> <span m="1326880">You</span> <span m="1327060">could just</span> <span m="1327510">go</span> <span m="1327710">from his old</span> <span m="1327810">IP</span> <span m="1327880">address,</span> <span m="1328210">right?</span> </p>
<p><span m="1329055">AUDIENCE: So</span> <span m="1329530">what</span> <span m="1330005">happens</span> <span m="1330480">for</span> <span m="1330955">the</span> <span m="1331430">server</span> <span m="1332380">[INAUDIBLE]?</span> </p>
<p><span m="1338150">PROFESSOR: Yes,</span> <span m="1338610">this is actually</span> <span m="1339070">an interesting</span> <span m="1339340">question.</span> <span m="1339720">What</span> <span m="1339860">happens</span> <span m="1340200">here?</span> <span m="1340440">So</span> <span m="1340560">this packet</span> <span m="1340840">doesn't</span> <span m="1341310">just</span> <span m="1341560">get</span> <span m="1341820">dropped.</span> <span m="1342015">It</span> <span m="1342210">actually</span> <span m="1342440">goes</span> <span m="1342830">to</span> <span m="1343100">this</span> <span m="1343350">computer.</span> <span m="1344430">And</span> <span m="1345130">what</span> <span m="1345240">happens?</span> </p>
<p><span m="1346586">AUDIENCE: [INAUDIBLE],</span> <span m="1347054">they just</span> <span m="1347522">mentioned you</span> <span m="1347990">try and</span> <span m="1348458">do it</span> <span m="1348926">like</span> <span m="1349400">they</span> <span m="1349720">would try</span> <span m="1350050">and</span> <span m="1350380">do</span> <span m="1350640">it</span> <span m="1350900">when the</span> <span m="1351332">other</span> <span m="1351764">computer</span> <span m="1352196">was</span> <span m="1352630">updating</span> <span m="1352885">or</span> <span m="1353140">rebooting</span> <span m="1353545">or</span> <span m="1353950">off,</span> <span m="1354255">or something.</span> </p>
<p><span m="1354560">PROFESSOR: Right,</span> <span m="1354968">certainly</span> <span m="1355376">they</span> <span m="1355512">felt,</span> <span m="1355648">oh, that computer is</span> <span m="1355784">offline.</span> <span m="1356192">The</span> <span m="1356600">packet</span> <span m="1357050">will just get</span> <span m="1357200">dropped,</span> <span m="1357670">and</span> <span m="1357870">you</span> <span m="1357940">don't</span> <span m="1358100">have</span> <span m="1358220">to</span> <span m="1358330">worry</span> <span m="1358580">about</span> <span m="1358890">it too</span> <span m="1359000">much.</span> <span m="1359720">If a</span> <span m="1360080">computer</span> <span m="1360470">is</span> <span m="1360730">actually</span> <span m="1361150">listening</span> <span m="1361570">on</span> <span m="1361830">that</span> <span m="1361940">IP</span> <span m="1362375">address,</span> <span m="1363010">then</span> <span m="1363580">in the</span> <span m="1363840">TCP</span> <span m="1364340">protocol,</span> <span m="1364630">you're</span> <span m="1365030">supposed to send a</span> <span m="1365170">reset</span> <span m="1365500">packet</span> <span m="1366910">resetting</span> <span m="1367040">the</span> <span m="1367200">connection.</span> <span m="1367790">Because this is</span> <span m="1368230">not</span> <span m="1368605">a</span> <span m="1368980">connection</span> <span m="1369480">that</span> <span m="1369980">computer</span> <span m="1370410">C</span> <span m="1370760">knows</span> <span m="1370850">about.</span> </p>
<p><span m="1371630">And</span> <span m="1372220">in</span> <span m="1372490">TCP,</span> <span m="1372890">this is</span> <span m="1373120">presumed</span> <span m="1373490">to</span> <span m="1373580">be</span> <span m="1373800">because,</span> <span m="1374460">oh, this</span> <span m="1374730">is some</span> <span m="1374850">old</span> <span m="1375400">packet</span> <span m="1375720">that</span> <span m="1376040">I</span> <span m="1376590">requested</span> <span m="1377110">long</span> <span m="1377360">ago,</span> <span m="1377640">but I've</span> <span m="1377925">since</span> <span m="1378210">forgotten</span> <span m="1378620">about</span> <span m="1378910">it.</span> <span m="1379320">So</span> <span m="1379660">the</span> <span m="1380350">machine</span> <span m="1380780">C</span> <span m="1381220">here</span> <span m="1381660">might</span> <span m="1381970">send</span> <span m="1382280">a</span> <span m="1382590">packet</span> <span m="1383600">to</span> <span m="1384030">the</span> <span m="1384160">server</span> <span m="1384750">saying,</span> <span m="1384850">I</span> <span m="1385120">want a</span> <span m="1385300">reset.</span> <span m="1387710">I</span> <span m="1388070">actually</span> <span m="1388830">forget</span> <span m="1389080">exactly</span> <span m="1389290">which</span> <span m="1389440">sequence</span> <span m="1389590">number</span> <span m="1389890">goes in there.</span> <span m="1390503">But</span> <span m="1390896">the</span> <span m="1391750">client</span> <span m="1392250">C</span> <span m="1392730">here</span> <span m="1392940">knows all the</span> <span m="1393430">sequence</span> <span m="1393630">numbers</span> <span m="1394035">and send</span> <span m="1394440">any</span> <span m="1394835">sequence</span> <span m="1395230">number as necessary</span> <span m="1395290">and</span> <span m="1395580">reset</span> <span m="1396280">this</span> <span m="1396420">connection.</span> </p>
<p><span m="1397580">So</span> <span m="1398220">if</span> <span m="1398430">this</span> <span m="1399020">computer</span> <span m="1399360">C</span> <span m="1399695">is going to</span> <span m="1400030">do this,</span> <span m="1400500">then</span> <span m="1400970">it might</span> <span m="1401440">interfere</span> <span m="1401550">with</span> <span m="1401660">your</span> <span m="1401770">plan to establish a</span> <span m="1401940">connection.</span> <span m="1403570">Because</span> <span m="1403920">when S gets this</span> <span m="1404080">packet, it says,</span> <span m="1404570">oh,</span> <span m="1405060">sure,</span> <span m="1405335">if you don't</span> <span m="1405610">want it,</span> <span m="1405993">I'll</span> <span m="1406376">reset your</span> <span m="1406760">connection.</span> </p>
<p><span m="1407840">There's</span> <span m="1408250">some</span> <span m="1409040">implementation-ish</span> <span m="1410020">bugs</span> <span m="1410610">that</span> <span m="1411130">you</span> <span m="1411220">might</span> <span m="1411580">exploit,</span> <span m="1413230">or</span> <span m="1413290">at</span> <span m="1413430">least</span> <span m="1413750">the author talks about,</span> <span m="1414075">and</span> <span m="1414400">an</span> <span m="1415530">potentially</span> <span m="1415890">exploiting,</span> <span m="1416740">that</span> <span m="1417130">would</span> <span m="1417870">prevent</span> <span m="1418215">client</span> <span m="1418560">C</span> <span m="1419150">from</span> <span m="1419330">responding.</span> <span m="1419990">So</span> <span m="1420386">for</span> <span m="1420782">example,</span> <span m="1421180">if</span> <span m="1421670">you flood</span> <span m="1422130">C</span> <span m="1422280">with</span> <span m="1422680">lots</span> <span m="1422706">of</span> <span m="1422732">packets,</span> <span m="1422758">it's</span> <span m="1422784">an</span> <span m="1422810">easy</span> <span m="1423030">way</span> <span m="1423190">to</span> <span m="1423270">get him</span> <span m="1423660">to drop this</span> <span m="1424040">one.</span> <span m="1424755">It</span> <span m="1425130">turns out</span> <span m="1425310">there</span> <span m="1425500">are</span> <span m="1425690">other</span> <span m="1425985">more</span> <span m="1426280">interesting</span> <span m="1426535">bugs</span> <span m="1426790">that don't</span> <span m="1427030">require</span> <span m="1427470">flooding</span> <span m="1427690">C</span> <span m="1428160">with</span> <span m="1428540">lots of</span> <span m="1428840">packets</span> <span m="1429010">that still</span> <span m="1429310">get</span> <span m="1429520">C to drop this</span> <span m="1429750">packet,</span> <span m="1430502">or at</span> <span m="1430880">least</span> <span m="1431040">it</span> <span m="1431200">used</span> <span m="1431360">to on</span> <span m="1431610">some</span> <span m="1431960">implementations</span> <span m="1432454">on</span> <span m="1432701">TCP</span> <span m="1432948">stacks.</span> <span m="1433442">Yeah.</span> </p>
<p><span m="1433936">AUDIENCE: Presumably,</span> <span m="1434430">most firewalls</span> <span m="1434924">would</span> <span m="1435912">also</span> <span m="1436406">[INAUDIBLE].</span> </p>
<p><span m="1437888">PROFESSOR: This</span> <span m="1438382">one?</span> </p>
<p><span m="1439370">AUDIENCE: No,</span> <span m="1439864">the</span> <span m="1440111">SYN.</span> </p>
<p><span m="1440852">PROFESSOR: This</span> <span m="1441346">one.</span> </p>
<p><span m="1441840">AUDIENCE: That came</span> <span m="1442334">into a client,</span> <span m="1442828">and a client</span> <span m="1443322">didn't</span> <span m="1443571">originally</span> <span m="1443820">send a</span> <span m="1444130">SYN</span> <span m="1444320">to that server.</span> <span m="1444580">And</span> <span m="1445002">the</span> <span m="1445424">firewall</span> <span m="1445846">is</span> <span m="1446270">going</span> <span m="1446740">to drop it.</span> </p>
<p><span m="1447188">PROFESSOR: It</span> <span m="1447636">depends,</span> <span m="1448084">yeah.</span> <span m="1448980">So</span> <span m="1449430">certainly</span> <span m="1449560">if</span> <span m="1450180">you</span> <span m="1450260">have</span> <span m="1450440">a</span> <span m="1450540">very</span> <span m="1450970">sophisticated</span> <span m="1451580">stateful</span> <span m="1452270">firewall</span> <span m="1452590">that</span> <span m="1452720">keeps</span> <span m="1452980">track of</span> <span m="1453090">all</span> <span m="1453460">existing</span> <span m="1453720">connections,</span> <span m="1454260">or</span> <span m="1454570">for</span> <span m="1455050">example</span> <span m="1455150">if</span> <span m="1455560">you</span> <span m="1455790">have</span> <span m="1455955">a</span> <span m="1456120">NAT,</span> <span m="1456285">then</span> <span m="1456780">this</span> <span m="1456940">might happen.</span> <span m="1457110">On</span> <span m="1457460">the other</span> <span m="1457810">hand,</span> <span m="1458760">a</span> <span m="1458900">NAT</span> <span m="1459365">might</span> <span m="1459830">actually</span> <span m="1460110">send the</span> <span m="1460430">RST</span> <span m="1460640">on</span> <span m="1460940">behalf of</span> <span m="1461070">the</span> <span m="1461430">client.</span> </p>
<p><span m="1462810">So</span> <span m="1463120">it's</span> <span m="1463240">not</span> <span m="1463410">clear.</span> <span m="1463720">I</span> <span m="1463850">think</span> <span m="1464770">this</span> <span m="1464800">is</span> <span m="1465060">not</span> <span m="1465453">as</span> <span m="1465846">common.</span> <span m="1466450">So</span> <span m="1466780">for example,</span> <span m="1468160">on</span> <span m="1468620">a</span> <span m="1468720">Comcast</span> <span m="1469210">network,</span> <span m="1469730">I</span> <span m="1469850">certainly</span> <span m="1470170">don't</span> <span m="1470370">have</span> <span m="1470500">anyone</span> <span m="1470855">intercepting</span> <span m="1471210">these</span> <span m="1471600">packets</span> <span m="1472640">and</span> <span m="1472740">maintaining</span> <span m="1473070">state for me</span> <span m="1473370">and</span> <span m="1473500">sending</span> <span m="1473630">RSTs</span> <span m="1473970">on</span> <span m="1474250">my</span> <span m="1474750">behalf or anything</span> <span m="1475250">like that.</span> <span m="1475750">Yeah.</span> </p>
<p><span m="1476250">AUDIENCE: So</span> <span m="1476750">why can't</span> <span m="1477250">the</span> <span m="1477750">server</span> <span m="1478250">have</span> <span m="1478750">independent</span> <span m="1479250">sequence</span> <span m="1479728">numbers</span> <span m="1480206">for</span> <span m="1480684">each</span> <span m="1481162">possible</span> <span m="1481640">source?</span> </p>
<p><span m="1482380">PROFESSOR: Right,</span> <span m="1482695">so</span> <span m="1483010">this</span> <span m="1483432">is</span> <span m="1483854">in</span> <span m="1484276">fact</span> <span m="1484700">what</span> <span m="1485150">TCP</span> <span m="1485475">stacks do</span> <span m="1485800">today.</span> <span m="1486260">This is</span> <span m="1486630">one</span> <span m="1486910">example</span> <span m="1487100">of</span> <span m="1487650">how</span> <span m="1487790">you</span> <span m="1487990">fix</span> <span m="1488290">this</span> <span m="1488500">problem</span> <span m="1488800">in</span> <span m="1489265">a</span> <span m="1489730">backwards compatible</span> <span m="1490195">manner.</span> <span m="1490660">So</span> <span m="1490900">we'll</span> <span m="1491090">get</span> <span m="1491210">to</span> <span m="1491330">exactly</span> <span m="1491555">the</span> <span m="1491780">formulation</span> <span m="1492100">of how</span> <span m="1492260">you</span> <span m="1492420">arrange this.</span> <span m="1493330">But</span> <span m="1493430">yeah,</span> <span m="1493890">it</span> <span m="1494030">turns</span> <span m="1494260">out</span> <span m="1494600">that</span> <span m="1494655">if</span> <span m="1494710">you</span> <span m="1494800">look at this</span> <span m="1495190">carefully,</span> <span m="1495910">as</span> <span m="1496050">you're</span> <span m="1496250">doing,</span> <span m="1496770">you</span> <span m="1497420">don't</span> <span m="1497690">need</span> <span m="1497910">to</span> <span m="1498070">have</span> <span m="1498570">this</span> <span m="1498940">initial</span> <span m="1499310">sequence</span> <span m="1499630">number</span> <span m="1500090">be global.</span> <span m="1500950">You</span> <span m="1501090">just</span> <span m="1501410">scope</span> <span m="1501700">it</span> <span m="1502080">to</span> <span m="1502200">every</span> <span m="1502460">source/destination</span> <span m="1503800">pair.</span> <span m="1504650">And</span> <span m="1504780">then</span> <span m="1505100">you have</span> <span m="1505375">all</span> <span m="1505650">the</span> <span m="1506010">duplicate</span> <span m="1506370">avoidance</span> <span m="1506500">properties</span> <span m="1506775">we had</span> <span m="1507050">before,</span> <span m="1509110">and</span> <span m="1509490">you have some</span> <span m="1509800">security</span> <span m="1510660">as</span> <span m="1510910">well.</span> </p>
<p><span m="1511560">So</span> <span m="1513460">just</span> <span m="1513640">to sort</span> <span m="1514040">of</span> <span m="1515240">write</span> <span m="1515500">this out</span> <span m="1515590">on the</span> <span m="1515980">board of</span> <span m="1516890">how</span> <span m="1517210">the</span> <span m="1517400">attacker</span> <span m="1517770">is</span> <span m="1518220">getting</span> <span m="1518550">this</span> <span m="1519060">initial</span> <span m="1519330">sequence</span> <span m="1519660">number,</span> <span m="1520160">the</span> <span m="1520380">attacker</span> <span m="1520900">would</span> <span m="1521090">probably</span> <span m="1521425">just</span> <span m="1521760">send a</span> <span m="1522025">connection</span> <span m="1522290">from its</span> <span m="1522780">own</span> <span m="1523140">IP address</span> <span m="1523770">to</span> <span m="1524060">the</span> <span m="1524220">server</span> <span m="1524860">saying,</span> <span m="1525440">I</span> <span m="1525550">want</span> <span m="1525870">to</span> <span m="1526380">establish</span> <span m="1526840">a new</span> <span m="1526960">connection,</span> <span m="1527400">and</span> <span m="1527895">the</span> <span m="1528390">server</span> <span m="1528885">would</span> <span m="1529380">send</span> <span m="1529875">a</span> <span m="1530370">response</span> <span m="1530506">back</span> <span m="1530643">to the attacker</span> <span m="1530780">containing</span> <span m="1531190">its</span> <span m="1531610">own</span> <span m="1532140">sequence</span> <span m="1532510">number</span> <span m="1532780">S.</span> <span m="1533920">And</span> <span m="1534840">if</span> <span m="1535120">the</span> <span m="1535820">SNS</span> <span m="1536160">for this connection</span> <span m="1536590">and</span> <span m="1536805">the</span> <span m="1537020">SNS</span> <span m="1537450">for</span> <span m="1537880">this</span> <span m="1538020">connection</span> <span m="1538390">are</span> <span m="1538880">related,</span> <span m="1539540">then</span> <span m="1539610">this</span> <span m="1539750">is</span> <span m="1539880">a</span> <span m="1539950">problem.</span> </p>
<p><span m="1540450">But</span> <span m="1540610">you're</span> <span m="1540770">saying,</span> <span m="1541220">let's make</span> <span m="1541390">them</span> <span m="1541590">not</span> <span m="1541640">related.</span> <span m="1542540">Because</span> <span m="1542760">this</span> <span m="1542880">is</span> <span m="1543040">from</span> <span m="1543180">a</span> <span m="1543240">different</span> <span m="1543530">address.</span> <span m="1544310">Then</span> <span m="1544560">this is</span> <span m="1545010">not</span> <span m="1545111">a</span> <span m="1545213">problem</span> <span m="1545315">anymore.</span> <span m="1545960">You can't</span> <span m="1546377">guess what</span> <span m="1546794">this</span> <span m="1547211">SNS is going</span> <span m="1547630">to</span> <span m="1547772">be</span> <span m="1548490">based</span> <span m="1548820">on</span> <span m="1549010">this</span> <span m="1549410">SNS</span> <span m="1549810">for</span> <span m="1550308">a</span> <span m="1550806">different</span> <span m="1551802">connection.</span> <span m="1552300">Yeah.</span> </p>
<p><span m="1552798">AUDIENCE: So you still</span> <span m="1553296">have a</span> <span m="1553794">collision</span> <span m="1553918">problem,</span> <span m="1554043">because</span> <span m="1554167">you</span> <span m="1554292">could</span> <span m="1554790">engage</span> <span m="1555288">the</span> <span m="1555786">32</span> <span m="1556284">bits by</span> <span m="1556782">the</span> <span m="1557280">addresses of</span> <span m="1557778">your</span> <span m="1558276">peers.</span> <span m="1558774">So</span> <span m="1559272">you</span> <span m="1559770">have</span> <span m="1560268">a lot of</span> <span m="1560766">ports for each one of these.</span> <span m="1561264">So you</span> <span m="1561762">still</span> <span m="1562260">have</span> <span m="1562758">conflicting</span> <span m="1563256">sequence</span> <span m="1563754">numbers</span> <span m="1564252">for</span> <span m="1564750">all of</span> <span m="1565248">these</span> <span m="1565746">connections that you're</span> <span m="1566244">getting, right?</span> </p>
<p><span m="1566770">PROFESSOR: So</span> <span m="1566940">these</span> <span m="1567590">sequence</span> <span m="1567900">numbers</span> <span m="1568160">are</span> <span m="1568560">specific,</span> <span m="1569312">as</span> <span m="1569690">it</span> <span m="1569960">turns</span> <span m="1570200">out,</span> <span m="1570670">to</span> <span m="1570760">an IP</span> <span m="1571156">address</span> <span m="1571552">and a</span> <span m="1571950">port</span> <span m="1572100">number</span> <span m="1572840">source/destination</span> <span m="1573700">duple.</span> <span m="1574530">So</span> <span m="1574810">if it's</span> <span m="1575300">different</span> <span m="1575630">ports,</span> <span m="1576020">then</span> <span m="1576220">they</span> <span m="1576360">don't</span> <span m="1576700">interfere with each</span> <span m="1576990">other at all.</span> </p>
<p><span m="1577372">AUDIENCE: Oh,</span> <span m="1577754">because</span> <span m="1578136">you're</span> <span m="1578520">using</span> <span m="1578825">the port--</span> </p>
<p><span m="1579130">PROFESSOR: That's</span> <span m="1579360">right,</span> <span m="1579575">yeah,</span> <span m="1579790">you also</span> <span m="1579930">use</span> <span m="1580205">the</span> <span m="1580480">port in</span> <span m="1580790">this as well.</span> </p>
<p><span m="1581504">AUDIENCE: Because I</span> <span m="1581918">thought those</span> <span m="1582332">ports--</span> </p>
<p><span m="1582746">PROFESSOR: Yeah,</span> <span m="1583160">so</span> <span m="1583350">the</span> <span m="1583560">ports</span> <span m="1583885">are sort</span> <span m="1584210">of</span> <span m="1584345">below</span> <span m="1584480">the</span> <span m="1584750">sequence</span> <span m="1585010">numbers</span> <span m="1585240">in</span> <span m="1585610">some way of</span> <span m="1586020">thinking about</span> <span m="1586430">it.</span> <span m="1588150">Question?</span> </p>
<p><span m="1588486">AUDIENCE: If</span> <span m="1588822">the</span> <span m="1589160">sequence</span> <span m="1590110">numbers are</span> <span m="1590585">global,</span> <span m="1591060">then doesn't</span> <span m="1592485">the</span> <span m="1592960">attacker</span> <span m="1593435">[INAUDIBLE]?</span> </p>
<p><span m="1597235">PROFESSOR: Yeah,</span> <span m="1597720">good point.</span> <span m="1597940">So in</span> <span m="1598400">fact,</span> <span m="1598900">if</span> <span m="1599130">the</span> <span m="1599200">server</span> <span m="1599455">increments</span> <span m="1599710">the</span> <span m="1599950">sequence</span> <span m="1600410">number</span> <span m="1600780">by,</span> <span m="1601170">I don't know,</span> <span m="1601620">64k</span> <span m="1602160">I</span> <span m="1602270">think it</span> <span m="1602710">is,</span> <span m="1603180">or</span> <span m="1603640">it</span> <span m="1603790">was,</span> <span m="1604080">for</span> <span m="1604370">every</span> <span m="1604890">connection,</span> <span m="1605340">then,</span> <span m="1605615">well,</span> <span m="1605890">you</span> <span m="1606200">connect.</span> <span m="1606885">And</span> <span m="1607260">then</span> <span m="1607410">maybe five other</span> <span m="1608040">people</span> <span m="1608300">connect.</span> <span m="1609090">And</span> <span m="1609250">then</span> <span m="1609450">you have to do</span> <span m="1609580">this</span> <span m="1609940">attack.</span> </p>
<p><span m="1611120">So</span> <span m="1611840">to</span> <span m="1611970">some</span> <span m="1612150">extent,</span> <span m="1613030">you're</span> <span m="1613460">right,</span> <span m="1613610">this is a</span> <span m="1614040">little troublesome.</span> <span m="1614790">On</span> <span m="1615040">the other hand,</span> <span m="1615680">you</span> <span m="1615790">could</span> <span m="1615990">probably</span> <span m="1616420">arrange</span> <span m="1616845">it</span> <span m="1617270">for</span> <span m="1618510">your</span> <span m="1618950">packet</span> <span m="1619790">here</span> <span m="1620590">to</span> <span m="1620920">be</span> <span m="1621060">delivered</span> <span m="1621460">just</span> <span m="1621860">before</span> <span m="1622320">this packet.</span> <span m="1622740">So if you</span> <span m="1623000">send</span> <span m="1623230">these</span> <span m="1623500">guys</span> <span m="1623860">back</span> <span m="1624130">to back,</span> <span m="1625870">then</span> <span m="1626580">there's</span> <span m="1626790">a good</span> <span m="1626890">chance</span> <span m="1627255">they'll</span> <span m="1627290">arrive</span> <span m="1627570">at</span> <span m="1627850">the</span> <span m="1627930">server</span> <span m="1628200">back</span> <span m="1628430">to</span> <span m="1628500">back.</span> </p>
<p><span m="1628920">The</span> <span m="1629130">server</span> <span m="1629280">will</span> <span m="1629620">get</span> <span m="1629860">this</span> <span m="1630000">one,</span> <span m="1630330">respond</span> <span m="1630710">with</span> <span m="1630930">this</span> <span m="1630990">sequence</span> <span m="1631410">number.</span> <span m="1632180">It'll</span> <span m="1632370">get</span> <span m="1632530">the</span> <span m="1632610">next</span> <span m="1632900">one,</span> <span m="1633230">this</span> <span m="1633390">one,</span> <span m="1633580">respond</span> <span m="1634020">with</span> <span m="1634930">the</span> <span m="1635360">sequence</span> <span m="1635690">number right</span> <span m="1635890">afterwards.</span> <span m="1636930">And</span> <span m="1637040">then you</span> <span m="1637200">know</span> <span m="1637340">exactly</span> <span m="1637800">what to</span> <span m="1638080">put</span> <span m="1638220">in</span> <span m="1638360">this</span> <span m="1638480">third</span> <span m="1638970">packet</span> <span m="1639170">in</span> <span m="1639310">your</span> <span m="1639670">sequence.</span> </p>
<p><span m="1641450">So</span> <span m="1641560">I</span> <span m="1641620">think</span> <span m="1642520">this is</span> <span m="1642830">not</span> <span m="1643225">a</span> <span m="1643620">foolproof</span> <span m="1644240">method</span> <span m="1644620">of connecting</span> <span m="1644990">to a</span> <span m="1645360">server.</span> <span m="1645790">There's</span> <span m="1645940">some</span> <span m="1646100">guessing</span> <span m="1646505">involved.</span> <span m="1647260">But</span> <span m="1647610">if</span> <span m="1648030">you</span> <span m="1648450">carefully</span> <span m="1648635">arrange</span> <span m="1648820">your</span> <span m="1649000">packets</span> <span m="1649360">right,</span> <span m="1649720">then</span> <span m="1650470">it's</span> <span m="1650710">quite</span> <span m="1651010">easy</span> <span m="1651290">to</span> <span m="1651370">make</span> <span m="1651560">the right</span> <span m="1651780">guess.</span> <span m="1652230">Or</span> <span m="1652340">maybe</span> <span m="1652550">you try several</span> <span m="1652690">times,</span> <span m="1653170">and</span> <span m="1653530">you'll</span> <span m="1653670">get</span> <span m="1654005">lucky.</span> <span m="1654720">Yeah.</span> </p>
<p><span m="1655480">AUDIENCE: So</span> <span m="1655860">even</span> <span m="1656270">if</span> <span m="1657142">it's</span> <span m="1657624">totally</span> <span m="1658106">random,</span> <span m="1658347">and</span> <span m="1658588">you have</span> <span m="1659070">to guess it,</span> <span m="1659552">there are only like</span> <span m="1660034">4 billion</span> <span m="1660516">possibilities.</span> <span m="1660998">It's</span> <span m="1661239">not</span> <span m="1661480">a huge number, right?</span> <span m="1661962">I</span> <span m="1662444">feel</span> <span m="1662926">like</span> <span m="1663408">in the course of a</span> <span m="1663890">year,</span> <span m="1664372">you should be able to</span> <span m="1664854">probably</span> <span m="1665336">get</span> <span m="1665818">through.</span> </p>
<p><span m="1666300">PROFESSOR: Right,</span> <span m="1666590">yeah,</span> <span m="1666880">so</span> <span m="1667970">you're absolutely</span> <span m="1668315">right.</span> <span m="1668660">You</span> <span m="1668920">shouldn't</span> <span m="1669240">really</span> <span m="1669480">be</span> <span m="1669670">relying</span> <span m="1670250">on</span> <span m="1670430">TCP</span> <span m="1671300">to</span> <span m="1671940">provide</span> <span m="1672620">security</span> <span m="1673500">very</span> <span m="1674600">strongly.</span> <span m="1675210">Because</span> <span m="1675510">you're</span> <span m="1675795">right,</span> <span m="1676080">it's only</span> <span m="1676280">4</span> <span m="1676540">billion guesses.</span> <span m="1676900">And you can</span> <span m="1677260">probably</span> <span m="1677550">send that</span> <span m="1677915">many packets</span> <span m="1679370">certainly</span> <span m="1679720">within</span> <span m="1680090">a</span> <span m="1680170">day</span> <span m="1681230">if</span> <span m="1681640">you have a</span> <span m="1682020">fast enough</span> <span m="1682400">connection.</span> </p>
<p><span m="1685510">So</span> <span m="1687160">it's sort of an</span> <span m="1687560">interesting</span> <span m="1688060">argument</span> <span m="1688425">we're</span> <span m="1688790">having here in the sense that at</span> <span m="1689050">some</span> <span m="1689310">level,</span> <span m="1689645">TCP</span> <span m="1689980">is hopefully</span> <span m="1690160">insecure.</span> <span m="1691120">Because</span> <span m="1691470">it's</span> <span m="1691570">only 32</span> <span m="1691920">bits.</span> <span m="1692270">There's</span> <span m="1692445">no</span> <span m="1692620">way</span> <span m="1692750">we</span> <span m="1693070">could</span> <span m="1693240">make</span> <span m="1693470">it secure.</span> <span m="1694090">But</span> <span m="1694200">I think</span> <span m="1694440">many</span> <span m="1694610">applications</span> <span m="1694890">rely</span> <span m="1695170">on it</span> <span m="1695475">enough that</span> <span m="1695780">not</span> <span m="1696230">providing</span> <span m="1696610">any</span> <span m="1696830">security</span> <span m="1697340">at</span> <span m="1697550">all</span> <span m="1698740">is</span> <span m="1699110">so</span> <span m="1699180">much</span> <span m="1699400">of</span> <span m="1699550">a</span> <span m="1699760">nuisance</span> <span m="1699970">that</span> <span m="1700230">it</span> <span m="1700410">really</span> <span m="1700790">becomes</span> <span m="1701000">a</span> <span m="1701456">problem.</span> </p>
<p><span m="1702368">But</span> <span m="1702824">you're</span> <span m="1703280">absolutely</span> <span m="1703740">right.</span> <span m="1704060">In</span> <span m="1704380">practice,</span> <span m="1705060">you do</span> <span m="1705450">want</span> <span m="1705710">to</span> <span m="1705790">do</span> <span m="1705940">some</span> <span m="1706110">sort</span> <span m="1706240">of</span> <span m="1706310">encryption</span> <span m="1706790">on top of</span> <span m="1707160">this</span> <span m="1707530">that</span> <span m="1708260">will</span> <span m="1708520">provide</span> <span m="1708890">stronger</span> <span m="1709350">guarantees</span> <span m="1709920">that</span> <span m="1710090">no</span> <span m="1710200">one</span> <span m="1710560">tampered with</span> <span m="1710810">your</span> <span m="1710960">data,</span> <span m="1711610">but</span> <span m="1711910">where</span> <span m="1712050">the</span> <span m="1712190">keys</span> <span m="1712520">are</span> <span m="1712620">more than</span> <span m="1712970">32</span> <span m="1713230">bits</span> <span m="1713380">long.</span> <span m="1719120">It</span> <span m="1719430">still turns</span> <span m="1719550">out to be</span> <span m="1720040">useful</span> <span m="1720521">to</span> <span m="1721002">prevent people from tampering</span> <span m="1721483">with</span> <span m="1721964">TCP connections</span> <span m="1722445">in most</span> <span m="1722926">cases.</span> </p>
<p><span m="1725812">All right,</span> <span m="1726300">other</span> <span m="1726620">questions?</span> <span m="1728140">All right,</span> <span m="1728470">so</span> <span m="1728800">let's</span> <span m="1729130">see what</span> <span m="1729595">actually</span> <span m="1730060">goes wrong.</span> <span m="1730435">Why</span> <span m="1730810">is it</span> <span m="1731130">a</span> <span m="1731760">bad</span> <span m="1732070">thing</span> <span m="1732450">if</span> <span m="1733000">people</span> <span m="1733250">are</span> <span m="1733360">able</span> <span m="1733530">to</span> <span m="1733580">spoof</span> <span m="1734040">TCP</span> <span m="1734410">connections</span> <span m="1734920">from</span> <span m="1735260">arbitrary</span> <span m="1735540">addresses?</span> <span m="1736990">So</span> <span m="1737540">one</span> <span m="1737800">reason</span> <span m="1738060">why this</span> <span m="1738310">is bad</span> <span m="1738870">is</span> <span m="1739790">if</span> <span m="1740150">there is</span> <span m="1740520">any</span> <span m="1740770">kind of</span> <span m="1740980">IP-based</span> <span m="1743090">authorization.</span> <span m="1748240">So</span> <span m="1748340">if</span> <span m="1748510">some</span> <span m="1748670">server</span> <span m="1749370">decides</span> <span m="1750450">whether</span> <span m="1750705">an</span> <span m="1750960">operation is</span> <span m="1751230">going</span> <span m="1751600">to</span> <span m="1751650">be</span> <span m="1751770">allowed</span> <span m="1751840">or</span> <span m="1752120">not</span> <span m="1752470">based</span> <span m="1752770">on the</span> <span m="1753155">IP</span> <span m="1753540">address it comes</span> <span m="1753840">from,</span> <span m="1754170">then</span> <span m="1754570">this</span> <span m="1754810">is</span> <span m="1755180">potentially</span> <span m="1755680">going</span> <span m="1755800">to</span> <span m="1755850">be</span> <span m="1756000">a</span> <span m="1756100">problem</span> <span m="1757490">for</span> <span m="1757870">an attacker</span> <span m="1758215">who</span> <span m="1758387">spoofed</span> <span m="1758560">connections</span> <span m="1758950">from</span> <span m="1759130">an</span> <span m="1759210">arbitrary</span> <span m="1759850">source</span> <span m="1760290">address.</span> </p>
<p><span m="1761440">So</span> <span m="1761880">one</span> <span m="1762100">example</span> <span m="1762360">where</span> <span m="1762620">this</span> <span m="1763030">was</span> <span m="1763200">a</span> <span m="1763310">problem--</span> <span m="1764040">and</span> <span m="1764420">it largely</span> <span m="1764750">isn't</span> <span m="1765080">anymore--</span> <span m="1765930">is</span> <span m="1766350">this</span> <span m="1766810">family</span> <span m="1767290">of</span> <span m="1767605">r</span> <span m="1768620">commands,</span> <span m="1769270">things</span> <span m="1769500">like</span> <span m="1769650">rlogin.</span> <span m="1771050">So it</span> <span m="1771150">used to</span> <span m="1771420">be</span> <span m="1771790">the case</span> <span m="1772110">that</span> <span m="1772430">you</span> <span m="1772540">could</span> <span m="1772670">run</span> <span m="1772900">something</span> <span m="1773160">like</span> <span m="1773370">rlogin</span> <span m="1773560">into</span> <span m="1773845">a</span> <span m="1774130">machine,</span> <span m="1774540">let's</span> <span m="1774720">say</span> <span m="1775540">athena.dialup.mit.edu.</span> <span m="1781360">And</span> <span m="1781850">if</span> <span m="1782110">your</span> <span m="1782460">connection</span> <span m="1782930">was</span> <span m="1783070">coming</span> <span m="1783360">from</span> <span m="1783700">a</span> <span m="1784180">host at</span> <span m="1784560">MIT,</span> <span m="1785600">then this</span> <span m="1786000">rlogin</span> <span m="1786400">command would</span> <span m="1786870">succeed</span> <span m="1787420">if</span> <span m="1788180">you</span> <span m="1788360">say,</span> <span m="1788660">oh yeah,</span> <span m="1789000">I'm</span> <span m="1789340">user</span> <span m="1789610">Alice</span> <span m="1789880">on this</span> <span m="1790040">machine.</span> <span m="1791240">Let me</span> <span m="1791440">log in</span> <span m="1791680">as</span> <span m="1791855">user</span> <span m="1792030">Alice</span> <span m="1792360">onto</span> <span m="1792690">this</span> <span m="1792780">other machine.</span> <span m="1793340">And</span> <span m="1793645">it'll</span> <span m="1793950">just</span> <span m="1794280">trust that all the</span> <span m="1794610">machines</span> <span m="1794930">at</span> <span m="1795110">mit.edu</span> <span m="1795250">are</span> <span m="1795860">trustworthy</span> <span m="1796350">to</span> <span m="1796420">make</span> <span m="1796620">these</span> <span m="1796790">statements.</span> </p>
<p><span m="1798410">I</span> <span m="1798730">should</span> <span m="1799050">say</span> <span m="1799370">I</span> <span m="1799780">think</span> <span m="1800115">dial-up never</span> <span m="1800450">actually</span> <span m="1800700">had this</span> <span m="1800930">problem.</span> <span m="1801500">It</span> <span m="1801820">was</span> <span m="1801930">using</span> <span m="1802265">Cerberus</span> <span m="1802600">from the</span> <span m="1802690">very</span> <span m="1802985">beginning.</span> <span m="1803280">But</span> <span m="1804090">other</span> <span m="1804580">systems</span> <span m="1805420">certainly</span> <span m="1805860">did have such</span> <span m="1806360">problems.</span> <span m="1807360">And</span> <span m="1807860">this is</span> <span m="1808360">an</span> <span m="1808860">example</span> <span m="1809360">of using</span> <span m="1809860">the IP address</span> <span m="1810360">where the</span> <span m="1810860">connection</span> <span m="1811230">is</span> <span m="1811450">coming</span> <span m="1811770">from</span> <span m="1812770">some</span> <span m="1813130">sort</span> <span m="1813320">of</span> <span m="1814560">authentication</span> <span m="1815170">mechanism</span> <span m="1815600">for</span> <span m="1816360">whether</span> <span m="1817220">the</span> <span m="1818020">caller or</span> <span m="1818355">the</span> <span m="1818690">client</span> <span m="1819190">is</span> <span m="1819410">trustworthy</span> <span m="1819540">or not.</span> <span m="1820470">So</span> <span m="1820940">this</span> <span m="1821650">certainly used to</span> <span m="1821990">be</span> <span m="1822050">a</span> <span m="1822180">problem,</span> <span m="1822650">isn't a</span> <span m="1822900">problem</span> <span m="1823240">anymore.</span> <span m="1823730">So relying</span> <span m="1824130">on</span> <span m="1824430">IP</span> <span m="1824620">seems like</span> <span m="1825360">such</span> <span m="1825670">a</span> <span m="1825940">clearly</span> <span m="1826280">bad</span> <span m="1826580">plan.</span> </p>
<p><span m="1827120">Yet,</span> <span m="1827510">this</span> <span m="1827640">actually</span> <span m="1827845">is</span> <span m="1828050">still</span> <span m="1828350">the</span> <span m="1828450">case.</span> <span m="1828980">So</span> <span m="1829350">rlogin is</span> <span m="1829720">gone.</span> <span m="1830160">It</span> <span m="1830560">was recently</span> <span m="1830660">replaced</span> <span m="1830840">by</span> <span m="1830990">SSH</span> <span m="1831430">now,</span> <span m="1832280">which</span> <span m="1832430">is</span> <span m="1832600">good.</span> <span m="1834400">On the other</span> <span m="1834630">hand,</span> <span m="1834680">there</span> <span m="1834730">are</span> <span m="1834780">still</span> <span m="1834990">many</span> <span m="1835330">other</span> <span m="1835550">examples</span> <span m="1836240">of</span> <span m="1837350">protocols</span> <span m="1837725">that</span> <span m="1838100">rely</span> <span m="1838470">on</span> <span m="1838840">IP-based</span> <span m="1839080">authentication.</span> </p>
<p><span m="1840530">One</span> <span m="1840920">of them is</span> <span m="1841170">SMTP.</span> <span m="1841890">So</span> <span m="1842890">when</span> <span m="1843100">you</span> <span m="1843170">send</span> <span m="1843490">email,</span> <span m="1844540">you</span> <span m="1844740">use</span> <span m="1844780">SMTP</span> <span m="1845210">to</span> <span m="1845320">talk to some</span> <span m="1845400">mail server</span> <span m="1845710">to</span> <span m="1846010">send</span> <span m="1846590">a</span> <span m="1846680">message.</span> <span m="1847650">And</span> <span m="1848530">to</span> <span m="1848830">prevent</span> <span m="1849320">spam,</span> <span m="1849890">many</span> <span m="1850330">SMTP</span> <span m="1850760">servers</span> <span m="1851120">will only</span> <span m="1851550">accept</span> <span m="1852270">incoming</span> <span m="1852670">messages</span> <span m="1853470">from</span> <span m="1853880">a</span> <span m="1853940">particular</span> <span m="1854660">source</span> <span m="1855020">IP</span> <span m="1855365">address.</span> <span m="1855710">So</span> <span m="1856005">for</span> <span m="1856300">example,</span> <span m="1856650">Comcast's</span> <span m="1856905">mail</span> <span m="1857160">server</span> <span m="1857460">will</span> <span m="1857690">only accept</span> <span m="1857860">mail</span> <span m="1858110">from</span> <span m="1858260">Comcast</span> <span m="1858600">IP</span> <span m="1858940">addresses.</span> <span m="1860280">Same for</span> <span m="1860650">MIT</span> <span m="1861080">mail</span> <span m="1861250">servers--</span> <span m="1861515">will</span> <span m="1861780">only</span> <span m="1862030">accept</span> <span m="1862320">mail</span> <span m="1862570">from</span> <span m="1862770">MIT</span> <span m="1863090">IP</span> <span m="1863230">addresses.</span> <span m="1863500">Or</span> <span m="1863780">there</span> <span m="1864060">was</span> <span m="1864380">at least</span> <span m="1864550">one</span> <span m="1865310">server</span> <span m="1865585">that</span> <span m="1865860">ISNT</span> <span m="1866260">runs</span> <span m="1866510">that</span> <span m="1866660">has</span> <span m="1867020">this</span> <span m="1867290">property.</span> </p>
<p><span m="1868910">So</span> <span m="1869350">this is</span> <span m="1869600">the case</span> <span m="1869730">where</span> <span m="1869990">it's</span> <span m="1870510">still</span> <span m="1871090">using</span> <span m="1871574">IP-based</span> <span m="1872058">authentication.</span> <span m="1873026">Here</span> <span m="1873510">it's</span> <span m="1873880">not</span> <span m="1874250">so bad.</span> <span m="1874905">Worst</span> <span m="1875180">case,</span> <span m="1875290">you'll</span> <span m="1875615">send</span> <span m="1875940">some</span> <span m="1876260">piece of</span> <span m="1876580">spam</span> <span m="1876900">through</span> <span m="1877060">the</span> <span m="1877280">mail</span> <span m="1877490">server.</span> <span m="1877775">So</span> <span m="1878060">that's</span> <span m="1878220">probably</span> <span m="1878500">why</span> <span m="1878680">they're</span> <span m="1878860">still</span> <span m="1879110">using</span> <span m="1879500">it,</span> <span m="1879890">whereas</span> <span m="1881000">things</span> <span m="1881110">that allow</span> <span m="1881360">you</span> <span m="1881740">to</span> <span m="1881990">log</span> <span m="1882043">into</span> <span m="1882150">an</span> <span m="1882360">arbitrary</span> <span m="1882860">account</span> <span m="1883710">stopped</span> <span m="1884060">using</span> <span m="1884360">IP-based</span> <span m="1884846">authentication.</span> <span m="1887280">So</span> <span m="1887490">does this</span> <span m="1887630">make</span> <span m="1887790">sense,</span> <span m="1888030">why this</span> <span m="1888320">is</span> <span m="1888820">a bad plan?</span> </p>
<p><span m="1889820">And</span> <span m="1890100">just</span> <span m="1890165">to</span> <span m="1890230">double</span> <span m="1890570">check,</span> <span m="1891940">suppose</span> <span m="1892360">that</span> <span m="1892780">some</span> <span m="1893000">server</span> <span m="1893500">was</span> <span m="1893630">using</span> <span m="1893861">rlogin.</span> <span m="1894554">What</span> <span m="1894785">would you do to attack</span> <span m="1895016">it?</span> <span m="1895478">What</span> <span m="1895940">bad</span> <span m="1896402">thing would</span> <span m="1896864">happen?</span> <span m="1899640">Suggestions?</span> <span m="1901720">Yeah.</span> </p>
<p><span m="1902090">AUDIENCE: Just</span> <span m="1902574">getting</span> <span m="1903058">into your</span> <span m="1903542">computer,</span> <span m="1904026">and</span> <span m="1904510">then</span> <span m="1904994">make</span> <span m="1905236">a</span> <span m="1905478">user</span> <span m="1905962">that you</span> <span m="1906446">want to log</span> <span m="1906930">into,</span> <span m="1907414">and then you get into the network.</span> </p>
<p><span m="1907898">PROFESSOR: Yeah,</span> <span m="1908382">so</span> <span m="1908866">basically</span> <span m="1909350">you</span> <span m="1909840">get</span> <span m="1910060">your</span> <span m="1910280">computer.</span> <span m="1910450">You synthesize</span> <span m="1910815">this</span> <span m="1911180">data</span> <span m="1911760">to</span> <span m="1911850">look</span> <span m="1912030">like</span> <span m="1912220">a</span> <span m="1912260">legitimate</span> <span m="1913050">set</span> <span m="1913480">of</span> <span m="1913670">rlogin</span> <span m="1913955">commands</span> <span m="1914950">that</span> <span m="1915140">say,</span> <span m="1915280">log in</span> <span m="1915610">as this</span> <span m="1915970">user</span> <span m="1916170">and</span> <span m="1916560">run</span> <span m="1916950">this</span> <span m="1917245">command</span> <span m="1917540">in my</span> <span m="1917650">Unix</span> <span m="1918040">shell</span> <span m="1918410">there.</span> <span m="1918980">You</span> <span m="1919390">sort</span> <span m="1919690">of</span> <span m="1919850">synthesize</span> <span m="1920020">this data</span> <span m="1920190">and</span> <span m="1920420">you</span> <span m="1920960">mount</span> <span m="1921460">this whole</span> <span m="1921520">attack</span> <span m="1921780">and</span> <span m="1922010">send</span> <span m="1922130">this</span> <span m="1922410">data</span> <span m="1922610">as if</span> <span m="1923030">a</span> <span m="1923450">legitimate user</span> <span m="1923760">was</span> <span m="1924080">interacting with</span> <span m="1924510">an</span> <span m="1924810">rlogin</span> <span m="1925110">client,</span> <span m="1925500">and then</span> <span m="1925760">you're</span> <span m="1926160">good</span> <span m="1926560">to</span> <span m="1926730">go.</span> </p>
<p><span m="1929275">OK,</span> <span m="1929730">so this is</span> <span m="1930040">one</span> <span m="1930260">reason</span> <span m="1930530">why</span> <span m="1930770">you</span> <span m="1930980">probably</span> <span m="1931280">don't</span> <span m="1931520">want</span> <span m="1931870">your</span> <span m="1932900">TCP</span> <span m="1933320">sequence</span> <span m="1933550">numbers to</span> <span m="1933850">be</span> <span m="1934150">so</span> <span m="1934280">guessable.</span> <span m="1935560">Another</span> <span m="1935870">problem is</span> <span m="1936240">these</span> <span m="1936880">reset</span> <span m="1937070">attacks.</span> <span m="1937340">So</span> <span m="1940290">much</span> <span m="1940580">like</span> <span m="1940830">we</span> <span m="1941090">were</span> <span m="1941350">able</span> <span m="1941605">to</span> <span m="1941860">send</span> <span m="1942240">a</span> <span m="1942460">SYN</span> <span m="1942790">packet,</span> <span m="1943120">if you</span> <span m="1943350">know</span> <span m="1943590">someone's</span> <span m="1944650">sequence</span> <span m="1945090">number,</span> <span m="1945340">you could</span> <span m="1945630">also send</span> <span m="1945990">a</span> <span m="1946020">reset</span> <span m="1946360">packet.</span> <span m="1946680">We</span> <span m="1946920">sort of</span> <span m="1947040">briefly</span> <span m="1947370">talked</span> <span m="1947580">about it</span> <span m="1947810">here</span> <span m="1948150">as</span> <span m="1948490">the</span> <span m="1948890">legitimate</span> <span m="1949225">client</span> <span m="1949560">potentially</span> <span m="1949750">sending</span> <span m="1949950">a</span> <span m="1950510">reset</span> <span m="1951550">to</span> <span m="1951850">reset</span> <span m="1952220">the</span> <span m="1952470">fake</span> <span m="1952700">connection</span> <span m="1952975">that</span> <span m="1953430">the</span> <span m="1953770">attacker</span> <span m="1954110">is</span> <span m="1954450">establishing.</span> </p>
<p><span m="1955200">But</span> <span m="1955510">in a</span> <span m="1955690">similar</span> <span m="1956045">vain,</span> <span m="1956665">the</span> <span m="1956930">adversary</span> <span m="1956960">could</span> <span m="1957510">try</span> <span m="1957730">to send</span> <span m="1958120">reset</span> <span m="1958440">packets</span> <span m="1958610">for</span> <span m="1958970">an</span> <span m="1959170">existing</span> <span m="1959300">connection</span> <span m="1960180">if</span> <span m="1960310">there's</span> <span m="1960520">some</span> <span m="1960830">way</span> <span m="1961110">that</span> <span m="1961470">the</span> <span m="1961765">adversary</span> <span m="1962060">knows</span> <span m="1962400">what your</span> <span m="1962610">sequence</span> <span m="1963080">number is</span> <span m="1963576">on that</span> <span m="1964072">connection.</span> <span m="1966060">So</span> <span m="1966100">this</span> <span m="1966170">is</span> <span m="1966240">actually</span> <span m="1967560">not</span> <span m="1967840">clear if this is</span> <span m="1968330">such a</span> <span m="1968590">big problem</span> <span m="1968850">or</span> <span m="1969050">or.</span> </p>
<p><span m="1969750">At</span> <span m="1970100">some level,</span> <span m="1970495">maybe you should</span> <span m="1970890">be</span> <span m="1971240">assuming that</span> <span m="1971590">all your TCP</span> <span m="1971780">connections</span> <span m="1972310">could</span> <span m="1972490">be</span> <span m="1972600">broken</span> <span m="1973090">at any time anyway.</span> <span m="1973450">It's</span> <span m="1973810">not like the</span> <span m="1974230">network</span> <span m="1974660">is</span> <span m="1974935">reliable.</span> <span m="1975210">So maybe you</span> <span m="1975710">should be</span> <span m="1976030">expecting</span> <span m="1976440">your</span> <span m="1976640">connections</span> <span m="1976925">to</span> <span m="1977210">drop.</span> </p>
<p><span m="1977920">But</span> <span m="1978380">one</span> <span m="1978710">place</span> <span m="1979000">where</span> <span m="1979160">this</span> <span m="1979350">turned</span> <span m="1979550">out</span> <span m="1979710">to</span> <span m="1979770">be</span> <span m="1979910">particularly</span> <span m="1981190">not</span> <span m="1981560">a</span> <span m="1981630">good</span> <span m="1981770">assumption</span> <span m="1982180">to</span> <span m="1982270">make</span> <span m="1983000">is</span> <span m="1983340">in</span> <span m="1983460">the</span> <span m="1983570">case</span> <span m="1983860">of</span> <span m="1984170">routers</span> <span m="1984420">talking</span> <span m="1984600">to</span> <span m="1984950">one</span> <span m="1985170">another.</span> <span m="1986060">So</span> <span m="1986170">if</span> <span m="1986260">you</span> <span m="1986330">have</span> <span m="1986550">multiple</span> <span m="1986890">routers</span> <span m="1987560">that</span> <span m="1988340">speak</span> <span m="1988480">some</span> <span m="1988620">routing</span> <span m="1988900">protocol,</span> <span m="1989780">then</span> <span m="1990260">they're connected,</span> <span m="1990750">of</span> <span m="1990890">course,</span> <span m="1991170">by</span> <span m="1991430">some</span> <span m="1992440">physical</span> <span m="1992830">links.</span> <span m="1993590">But</span> <span m="1994060">over</span> <span m="1994480">some</span> <span m="1995010">physical</span> <span m="1995360">links,</span> <span m="1995575">they</span> <span m="1995790">actually</span> <span m="1996480">speak</span> <span m="1996900">some</span> <span m="1997350">network</span> <span m="1997590">protocol.</span> <span m="1998000">And that network</span> <span m="1998380">protocol</span> <span m="1998840">runs</span> <span m="1998900">over</span> <span m="1999375">TCP.</span> <span m="1999850">So</span> <span m="2000030">there's actually</span> <span m="2000340">some</span> <span m="2000440">TCP</span> <span m="2000830">session</span> <span m="2001170">running</span> <span m="2001440">over</span> <span m="2001680">each of</span> <span m="2001900">these</span> <span m="2002130">physical</span> <span m="2002450">links</span> <span m="2002705">that</span> <span m="2002960">the</span> <span m="2003350">routers</span> <span m="2003740">use to</span> <span m="2004190">exchange</span> <span m="2004740">routing</span> <span m="2005060">information.</span> </p>
<p><span m="2006980">So this is</span> <span m="2007150">certainly</span> <span m="2007200">the</span> <span m="2007460">case</span> <span m="2007730">for</span> <span m="2007850">this</span> <span m="2007980">protocol</span> <span m="2008630">called</span> <span m="2008870">BGP we'll</span> <span m="2009270">talk</span> <span m="2009410">about</span> <span m="2009775">a bit</span> <span m="2010140">more</span> <span m="2010400">in a</span> <span m="2010650">second.</span> <span m="2012250">And</span> <span m="2012560">BGP</span> <span m="2013100">uses</span> <span m="2013650">the</span> <span m="2015040">fact</span> <span m="2015350">that</span> <span m="2015530">the TCP</span> <span m="2015850">connection is</span> <span m="2016250">alive</span> <span m="2016520">to</span> <span m="2016790">also</span> <span m="2017120">infer</span> <span m="2017430">that the</span> <span m="2017630">link</span> <span m="2017950">is</span> <span m="2018270">alive.</span> <span m="2019580">So</span> <span m="2019810">if</span> <span m="2020020">the</span> <span m="2020130">TCP</span> <span m="2020490">connection</span> <span m="2020790">breaks,</span> <span m="2021160">then</span> <span m="2021270">the</span> <span m="2021390">routers</span> <span m="2021750">assume</span> <span m="2022110">the link</span> <span m="2022600">broke.</span> <span m="2023090">And</span> <span m="2023410">they</span> <span m="2023620">recompute</span> <span m="2023760">all</span> <span m="2024080">their</span> <span m="2024350">routing</span> <span m="2024680">tables.</span> </p>
<p><span m="2026350">So</span> <span m="2026670">if</span> <span m="2026820">an</span> <span m="2026990">adversary</span> <span m="2027290">wants</span> <span m="2027510">to</span> <span m="2027630">mount some</span> <span m="2028120">sort of a</span> <span m="2028577">denial of</span> <span m="2029034">service</span> <span m="2029491">attack here,</span> <span m="2029948">they could try</span> <span m="2030405">to guess the</span> <span m="2030862">sequence</span> <span m="2031319">numbers of</span> <span m="2031776">these routers</span> <span m="2032233">and</span> <span m="2032690">reset</span> <span m="2032980">these</span> <span m="2033450">sessions.</span> <span m="2034520">So</span> <span m="2034910">if</span> <span m="2035190">the</span> <span m="2035490">TCP</span> <span m="2035830">session between two</span> <span m="2036060">routers</span> <span m="2036395">goes</span> <span m="2036730">down,</span> <span m="2037900">both</span> <span m="2038250">routers</span> <span m="2038440">are</span> <span m="2038935">like,</span> <span m="2039430">oh, this</span> <span m="2039520">link is dead.</span> <span m="2039750">We have to recompute</span> <span m="2040160">all the</span> <span m="2040400">routing</span> <span m="2040820">tables,</span> <span m="2041180">and the</span> <span m="2041330">routes</span> <span m="2041650">change.</span> <span m="2042510">And</span> <span m="2042630">then</span> <span m="2042910">you</span> <span m="2043060">might</span> <span m="2043370">shoot down</span> <span m="2043600">another</span> <span m="2043870">link,</span> <span m="2044290">and</span> <span m="2044460">so</span> <span m="2044830">on.</span> </p>
<p><span m="2045235">So</span> <span m="2045640">this is</span> <span m="2046000">a bit of a</span> <span m="2046260">worrisome</span> <span m="2046520">attack,</span> <span m="2047300">not</span> <span m="2047780">because</span> <span m="2048300">it</span> <span m="2048639">violates</span> <span m="2049199">someone's</span> <span m="2050110">secrecy,</span> <span m="2050850">et</span> <span m="2051120">cetera,</span> <span m="2052489">or</span> <span m="2052639">at</span> <span m="2052840">least not</span> <span m="2053020">directly,</span> <span m="2054239">but</span> <span m="2054639">more</span> <span m="2054679">because</span> <span m="2054909">it</span> <span m="2055139">really</span> <span m="2055510">causes</span> <span m="2055985">a lot</span> <span m="2056460">of</span> <span m="2058365">availability</span> <span m="2058719">problems</span> <span m="2059310">for</span> <span m="2059580">other</span> <span m="2060230">users in the</span> <span m="2060500">system.</span> <span m="2061079">Yeah.</span> </p>
<p><span m="2061734">AUDIENCE: So</span> <span m="2062080">if you're</span> <span m="2062425">an</span> <span m="2062770">attacker,</span> <span m="2063960">and</span> <span m="2064415">you wanted to</span> <span m="2064870">target</span> <span m="2065175">one</span> <span m="2065480">particular</span> <span m="2065870">user,</span> <span m="2066170">could</span> <span m="2066595">you</span> <span m="2067020">just</span> <span m="2067445">keep</span> <span m="2067870">sending</span> <span m="2068706">connection</span> <span m="2069420">requests</span> <span m="2069740">to</span> <span m="2070060">a</span> <span m="2070560">server</span> <span m="2071014">on</span> <span m="2071469">behalf</span> <span m="2071719">of</span> <span m="2072219">his</span> <span m="2072719">IP</span> <span m="2072819">and</span> <span m="2072919">make him</span> <span m="2073019">keep</span> <span m="2073119">dropping</span> <span m="2073219">his</span> <span m="2073719">connections to</span> <span m="2074219">the</span> <span m="2074719">servers</span> <span m="2075219">and so</span> <span m="2075719">you just</span> <span m="2076219">[INAUDIBLE]?</span> </p>
<p><span m="2078679">PROFESSOR: Well,</span> <span m="2079130">so</span> <span m="2080030">it</span> <span m="2080440">requires</span> <span m="2080659">you</span> <span m="2080840">guessing.</span> <span m="2081540">So</span> <span m="2081969">you're</span> <span m="2082270">saying,</span> <span m="2082650">suppose</span> <span m="2082900">I'm</span> <span m="2083020">using Gmail,</span> <span m="2083460">and</span> <span m="2083740">you</span> <span m="2084020">want</span> <span m="2084199">to stop me</span> <span m="2084460">from</span> <span m="2084889">learning something</span> <span m="2085250">in</span> <span m="2085280">Gmail,</span> <span m="2085610">so</span> <span m="2085973">just</span> <span m="2086154">send</span> <span m="2086699">packets</span> <span m="2086929">to</span> <span m="2087380">my</span> <span m="2088260">machine pretending to be</span> <span m="2088389">from</span> <span m="2088570">Gmail.</span> <span m="2089530">Well,</span> <span m="2089699">you</span> <span m="2089760">have</span> <span m="2089920">to</span> <span m="2090040">guess</span> <span m="2090449">the</span> <span m="2090659">right</span> <span m="2091320">source</span> <span m="2091770">and</span> <span m="2091860">destination</span> <span m="2091980">port</span> <span m="2092250">numbers.</span> </p>
<p><span m="2092870">The</span> <span m="2093040">destination</span> <span m="2093070">port number</span> <span m="2093290">is</span> <span m="2093370">probably</span> <span m="2093940">443,</span> <span m="2094620">because</span> <span m="2094840">I'm</span> <span m="2094980">using</span> <span m="2095600">HTTPS.</span> <span m="2096230">But</span> <span m="2096600">the source port</span> <span m="2096980">number</span> <span m="2097240">is going to be</span> <span m="2097500">some random</span> <span m="2097940">16-bit</span> <span m="2098520">thing.</span> <span m="2099390">And</span> <span m="2099680">it's</span> <span m="2099970">also</span> <span m="2100180">going</span> <span m="2100350">to</span> <span m="2100400">be</span> <span m="2100480">the</span> <span m="2100590">case</span> <span m="2100910">that</span> <span m="2101420">probably</span> <span m="2101660">the</span> <span m="2101730">sequence</span> <span m="2102040">numbers</span> <span m="2102340">are going to be</span> <span m="2102550">different.</span> <span m="2103070">So</span> <span m="2103170">unless</span> <span m="2103510">you</span> <span m="2103600">guess</span> <span m="2103840">a</span> <span m="2103900">sequence</span> <span m="2104240">number</span> <span m="2104430">that's</span> <span m="2104670">within</span> <span m="2105720">my</span> <span m="2106430">TCP</span> <span m="2106810">window,</span> <span m="2107240">which</span> <span m="2107440">is</span> <span m="2107980">in</span> <span m="2108280">order</span> <span m="2109095">of</span> <span m="2109460">probably</span> <span m="2109650">tens</span> <span m="2110010">of</span> <span m="2110160">kilobytes,</span> <span m="2110970">you're</span> <span m="2111100">also</span> <span m="2111270">going</span> <span m="2111400">to</span> <span m="2111450">be</span> <span m="2111830">not</span> <span m="2112360">successful</span> <span m="2112760">in</span> <span m="2112810">that</span> <span m="2113000">regard.</span> </p>
<p><span m="2113280">So</span> <span m="2113315">you</span> <span m="2113350">have to</span> <span m="2113620">guess</span> <span m="2113915">a</span> <span m="2114210">fair</span> <span m="2114565">amount of</span> <span m="2114920">stuff.</span> <span m="2117350">There's</span> <span m="2117650">no</span> <span m="2118110">sort of</span> <span m="2118370">oracle</span> <span m="2118630">access.</span> <span m="2119430">You</span> <span m="2119830">can't just</span> <span m="2120195">query</span> <span m="2120560">the server and</span> <span m="2120860">say, well,</span> <span m="2121185">what is that</span> <span m="2121510">guy's</span> <span m="2121770">sequence number?</span> <span m="2123130">So</span> <span m="2123440">that's</span> <span m="2123475">the</span> <span m="2123510">reason</span> <span m="2123760">why</span> <span m="2123970">that</span> <span m="2124270">doesn't</span> <span m="2124550">work</span> <span m="2124770">out</span> <span m="2125270">as well.</span> </p>
<p><span m="2127890">So</span> <span m="2128590">again,</span> <span m="2129180">many of</span> <span m="2129485">these</span> <span m="2129790">issues</span> <span m="2129915">were</span> <span m="2130040">fixed,</span> <span m="2130300">including</span> <span m="2130560">this</span> <span m="2130740">RST-based</span> <span m="2131410">thing,</span> <span m="2131880">especially for</span> <span m="2132180">BGP</span> <span m="2132710">routers.</span> <span m="2135890">There</span> <span m="2136200">was</span> <span m="2136360">actually</span> <span m="2136640">two</span> <span m="2136840">sort of</span> <span m="2137125">amusing</span> <span m="2137410">fixes.</span> <span m="2138460">One</span> <span m="2139260">really</span> <span m="2139890">shows</span> <span m="2140130">you</span> <span m="2140270">how</span> <span m="2140430">you can</span> <span m="2141100">carefully</span> <span m="2141490">exploit</span> <span m="2141970">existing</span> <span m="2142240">things</span> <span m="2142510">or</span> <span m="2142970">take advantage of them</span> <span m="2143430">to</span> <span m="2143890">fix</span> <span m="2144670">particular</span> <span m="2144990">problems.</span> <span m="2145670">Here,</span> <span m="2145960">the</span> <span m="2146390">insight</span> <span m="2146790">is</span> <span m="2146930">that</span> <span m="2147230">these routers</span> <span m="2147575">only want</span> <span m="2147920">to</span> <span m="2148040">talk to</span> <span m="2148330">each</span> <span m="2148490">other,</span> <span m="2148690">not to someone</span> <span m="2149148">else over the</span> <span m="2149606">network.</span> <span m="2150980">And</span> <span m="2151840">as</span> <span m="2151940">a</span> <span m="2151990">result,</span> <span m="2152490">if the</span> <span m="2152690">packet</span> <span m="2152830">is</span> <span m="2152990">coming</span> <span m="2153235">not</span> <span m="2153480">from</span> <span m="2153710">the</span> <span m="2154080">immediate</span> <span m="2154453">router</span> <span m="2154826">next</span> <span m="2155200">across</span> <span m="2155560">the</span> <span m="2155700">link,</span> <span m="2155840">but</span> <span m="2155980">from</span> <span m="2156130">someone</span> <span m="2156420">else,</span> <span m="2156810">I want to drop</span> <span m="2157218">this</span> <span m="2157626">packet all</span> <span m="2158034">together.</span> </p>
<p><span m="2158442">And</span> <span m="2159490">what</span> <span m="2159830">the</span> <span m="2160055">designers of these</span> <span m="2160280">writing</span> <span m="2160730">protocols</span> <span m="2161290">realized</span> <span m="2161730">is that</span> <span m="2162140">there's</span> <span m="2162230">this</span> <span m="2162320">wonderful</span> <span m="2162820">field</span> <span m="2163170">in a</span> <span m="2163445">packet</span> <span m="2163720">called</span> <span m="2164120">time</span> <span m="2164370">to</span> <span m="2164430">live.</span> <span m="2165390">It's an</span> <span m="2165610">8-bit</span> <span m="2165820">field</span> <span m="2166710">that</span> <span m="2167190">gets</span> <span m="2167400">decremented</span> <span m="2167870">by</span> <span m="2168370">every router</span> <span m="2168665">to</span> <span m="2169130">make</span> <span m="2169350">sure</span> <span m="2169520">that</span> <span m="2169640">packets don't go</span> <span m="2169970">into</span> <span m="2170450">an</span> <span m="2170930">infinite</span> <span m="2171180">loop.</span> <span m="2171840">So</span> <span m="2172310">the</span> <span m="2172500">highest</span> <span m="2172880">this</span> <span m="2173280">TTL</span> <span m="2173680">value could ever</span> <span m="2174080">be</span> <span m="2174290">is</span> <span m="2174710">255.</span> <span m="2175180">And then</span> <span m="2175670">it'll</span> <span m="2176160">get decremented</span> <span m="2176650">from</span> <span m="2177140">there.</span> </p>
<p><span m="2177630">So</span> <span m="2178160">what</span> <span m="2178470">these</span> <span m="2178860">writing protocols do--</span> <span m="2179165">it's sort of</span> <span m="2179470">a</span> <span m="2179540">clever</span> <span m="2179990">hack--</span> <span m="2180550">is</span> <span m="2181180">they</span> <span m="2183000">reject</span> <span m="2183343">any</span> <span m="2184030">packet</span> <span m="2184240">with a TTL</span> <span m="2184740">value</span> <span m="2185030">that's</span> <span m="2185160">not</span> <span m="2185850">255.</span> <span m="2187220">Because</span> <span m="2188000">if</span> <span m="2188180">a</span> <span m="2188260">packet</span> <span m="2188645">has</span> <span m="2189030">a value of</span> <span m="2189290">255,</span> <span m="2189660">it</span> <span m="2190040">must</span> <span m="2190500">have come</span> <span m="2190690">from the</span> <span m="2191100">router</span> <span m="2191430">just on</span> <span m="2191610">the</span> <span m="2191820">other</span> <span m="2192180">side</span> <span m="2192350">of</span> <span m="2192440">this</span> <span m="2192640">link.</span> <span m="2193530">And</span> <span m="2193810">if the</span> <span m="2193955">an</span> <span m="2194100">adversary</span> <span m="2194460">tries to inject</span> <span m="2194880">any</span> <span m="2195300">packet</span> <span m="2195630">to</span> <span m="2195750">tamper with</span> <span m="2196220">this</span> <span m="2196450">existing</span> <span m="2196830">BGP</span> <span m="2196980">connection,</span> <span m="2197900">it'll</span> <span m="2198130">have</span> <span m="2198690">a</span> <span m="2198820">TTL</span> <span m="2199040">value less than</span> <span m="2199535">255,</span> <span m="2200310">because it'll be</span> <span m="2200675">decremented</span> <span m="2201040">by</span> <span m="2201410">some</span> <span m="2201725">other routers along</span> <span m="2202040">the</span> <span m="2202240">path,</span> <span m="2202890">including</span> <span m="2203280">this</span> <span m="2203440">one.</span> </p>
<p><span m="2204520">And</span> <span m="2204690">then</span> <span m="2205010">it'll</span> <span m="2205210">just</span> <span m="2205520">get</span> <span m="2205795">rejected</span> <span m="2206070">by</span> <span m="2206480">the</span> <span m="2206955">recipient.</span> <span m="2207766">So</span> <span m="2208102">this is</span> <span m="2208440">one</span> <span m="2208760">example</span> <span m="2209830">of</span> <span m="2209910">a</span> <span m="2210040">clever</span> <span m="2210570">combination</span> <span m="2211060">of</span> <span m="2211130">techniques</span> <span m="2211510">that's</span> <span m="2211640">backwards</span> <span m="2211970">compatible</span> <span m="2212470">and</span> <span m="2213080">solves</span> <span m="2213600">this</span> <span m="2213730">very</span> <span m="2214170">specific problem.</span> <span m="2214664">Yeah.</span> </p>
<p><span m="2215158">AUDIENCE: Doesn't</span> <span m="2215652">the</span> <span m="2216146">bottom right router</span> <span m="2216640">also</span> <span m="2216763">send</span> <span m="2216887">something</span> <span m="2217010">with a</span> <span m="2217134">TTL</span> <span m="2217298">of</span> <span m="2217463">255?</span> </p>
<p><span m="2218616">PROFESSOR: Yeah,</span> <span m="2219110">so</span> <span m="2219490">these routers</span> <span m="2219940">are</span> <span m="2220300">actually--</span> <span m="2220670">this is</span> <span m="2221050">a</span> <span m="2221230">physical</span> <span m="2221530">router.</span> <span m="2221830">And it</span> <span m="2221950">knows these</span> <span m="2222245">are</span> <span m="2222540">separate</span> <span m="2222780">links.</span> <span m="2223780">So</span> <span m="2223920">it</span> <span m="2224230">looks at</span> <span m="2224713">the TTL</span> <span m="2225196">and</span> <span m="2225679">which link</span> <span m="2226162">it came</span> <span m="2226645">on.</span> <span m="2227130">So</span> <span m="2227370">if</span> <span m="2227630">a</span> <span m="2227890">packet came in</span> <span m="2228080">on</span> <span m="2228340">this</span> <span m="2228670">link,</span> <span m="2229150">it</span> <span m="2229220">will</span> <span m="2229290">not accept</span> <span m="2229570">it for</span> <span m="2229850">this</span> <span m="2231556">TCP</span> <span m="2231984">connection.</span> </p>
<p><span m="2232840">But</span> <span m="2232970">you're</span> <span m="2233220">right.</span> <span m="2233896">For</span> <span m="2234232">the</span> <span m="2234570">most</span> <span m="2234706">part,</span> <span m="2234843">these</span> <span m="2234980">routers</span> <span m="2237250">trust</span> <span m="2237630">their</span> <span m="2238130">immediate</span> <span m="2238570">neighbors.</span> <span m="2239550">It need</span> <span m="2239870">not</span> <span m="2240090">necessarily</span> <span m="2240345">be</span> <span m="2240600">the</span> <span m="2240680">case.</span> <span m="2240950">But</span> <span m="2241200">if</span> <span m="2241285">you</span> <span m="2241370">keep seeing</span> <span m="2241580">this</span> <span m="2241670">problem,</span> <span m="2242016">and</span> <span m="2242362">you</span> <span m="2242478">know</span> <span m="2242594">you've</span> <span m="2242710">implemented</span> <span m="2242840">this</span> <span m="2243240">hack,</span> <span m="2243740">then</span> <span m="2244040">it must be one</span> <span m="2244060">of your</span> <span m="2244490">neighbors.</span> <span m="2244720">You're</span> <span m="2244930">going to look.</span> <span m="2245500">TCP</span> <span m="2245970">dumped</span> <span m="2246210">these</span> <span m="2246686">interfaces.</span> <span m="2247162">Why are you</span> <span m="2247638">sending</span> <span m="2248114">me these reset</span> <span m="2248590">packets?</span> </p>
<p><span m="2249210">This</span> <span m="2249380">problem</span> <span m="2250020">is</span> <span m="2250220">not as</span> <span m="2250510">big.</span> <span m="2251120">You</span> <span m="2251440">can</span> <span m="2251910">manage</span> <span m="2252380">it</span> <span m="2252570">by some</span> <span m="2252835">Auto</span> <span m="2253100">Pan mechanism.</span> <span m="2254736">Make</span> <span m="2255159">sense?</span> <span m="2256005">All</span> <span m="2256430">right,</span> <span m="2256770">there are</span> <span m="2257230">other</span> <span m="2257570">fixes for</span> <span m="2257880">BGP</span> <span m="2258450">where</span> <span m="2258840">they</span> <span m="2259130">implemented</span> <span m="2259480">some</span> <span m="2259820">form</span> <span m="2260160">of</span> <span m="2260623">header</span> <span m="2261086">authentication,</span> <span m="2261550">MD5</span> <span m="2261900">header</span> <span m="2262060">authentication</span> <span m="2262680">as</span> <span m="2263070">well.</span> <span m="2263480">But</span> <span m="2263890">they're</span> <span m="2264060">really</span> <span m="2264280">targeting</span> <span m="2264850">this</span> <span m="2265090">particular</span> <span m="2265550">application</span> <span m="2266220">where</span> <span m="2266850">this</span> <span m="2267030">reset</span> <span m="2267285">attack</span> <span m="2267540">is particularly</span> <span m="2267940">bad.</span> </p>
<p><span m="2268340">This</span> <span m="2268550">is</span> <span m="2268930">still</span> <span m="2269190">a</span> <span m="2269250">problem</span> <span m="2269700">today.</span> <span m="2269975">If</span> <span m="2270570">there's</span> <span m="2270900">some</span> <span m="2271210">long-lived</span> <span m="2271680">connection</span> <span m="2271975">out there that</span> <span m="2272270">I</span> <span m="2272430">really</span> <span m="2272550">want</span> <span m="2272640">to shoot</span> <span m="2272760">down,</span> <span m="2273030">I</span> <span m="2273300">just</span> <span m="2274176">have</span> <span m="2274622">to send</span> <span m="2275960">some</span> <span m="2276450">large</span> <span m="2276780">number</span> <span m="2277050">of</span> <span m="2277110">RST</span> <span m="2277550">packets,</span> <span m="2278480">probably</span> <span m="2278580">on the</span> <span m="2278850">order of</span> <span m="2279230">hundreds of</span> <span m="2279730">thousands</span> <span m="2280730">or</span> <span m="2281000">so,</span> <span m="2282100">but</span> <span m="2282390">probably</span> <span m="2282630">not</span> <span m="2283160">exactly</span> <span m="2283560">4</span> <span m="2283950">billion.</span> <span m="2284770">Because</span> <span m="2285790">the</span> <span m="2286400">servers are</span> <span m="2286820">actually</span> <span m="2287390">somewhat</span> <span m="2287930">lax</span> <span m="2288400">in</span> <span m="2288540">terms</span> <span m="2288730">of</span> <span m="2288840">which</span> <span m="2289050">sequence</span> <span m="2289250">number they</span> <span m="2289560">accept</span> <span m="2289960">for</span> <span m="2290150">a reset.</span> </p>
<p><span m="2290520">It can</span> <span m="2291010">be any</span> <span m="2291500">packet within</span> <span m="2291610">a</span> <span m="2292120">certain</span> <span m="2292380">window.</span> <span m="2293360">And</span> <span m="2294520">in that</span> <span m="2294960">case, I</span> <span m="2295400">could probably,</span> <span m="2295830">or</span> <span m="2296050">any</span> <span m="2296250">attacker,</span> <span m="2296730">reset</span> <span m="2297065">an</span> <span m="2297400">existing</span> <span m="2297520">connection</span> <span m="2297930">with</span> <span m="2298505">a</span> <span m="2298830">modest</span> <span m="2299500">but</span> <span m="2299650">not</span> <span m="2299850">a</span> <span m="2299910">huge</span> <span m="2300230">amount</span> <span m="2300450">of</span> <span m="2300530">effort.</span> <span m="2301262">That's still a</span> <span m="2301754">problem.</span> <span m="2302738">And</span> <span m="2303230">people</span> <span m="2303520">haven't</span> <span m="2303730">really</span> <span m="2303980">found any</span> <span m="2304360">great</span> <span m="2304750">solution for</span> <span m="2305000">that.</span> </p>
<p><span m="2308640">All</span> <span m="2308850">right,</span> <span m="2309060">and</span> <span m="2309460">I</span> <span m="2309670">guess</span> <span m="2309812">the</span> <span m="2309955">sort</span> <span m="2310240">of</span> <span m="2310360">last</span> <span m="2311040">bad</span> <span m="2311250">thing</span> <span m="2311610">that</span> <span m="2311870">happens</span> <span m="2312310">because</span> <span m="2312380">these</span> <span m="2312560">sequence</span> <span m="2313050">numbers</span> <span m="2313330">are</span> <span m="2313410">somewhat</span> <span m="2313700">predictable</span> <span m="2314390">is</span> <span m="2314810">just</span> <span m="2315460">data</span> <span m="2315840">injection</span> <span m="2316331">into</span> <span m="2316822">existing</span> <span m="2317313">connections.</span> <span m="2319280">So</span> <span m="2319810">suppose</span> <span m="2320170">there</span> <span m="2320320">is</span> <span m="2320370">some</span> <span m="2320570">protocol</span> <span m="2321160">like</span> <span m="2322160">rlogin,</span> <span m="2323550">but</span> <span m="2324712">maybe</span> <span m="2324936">rlogin</span> <span m="2325160">doesn't--</span> <span m="2326790">suppose</span> <span m="2327060">we</span> <span m="2327170">have</span> <span m="2327330">some</span> <span m="2327650">hypothetical</span> <span m="2327770">protocol</span> <span m="2328330">that's</span> <span m="2328450">kind of like</span> <span m="2328850">rlogin,</span> <span m="2329710">but</span> <span m="2330050">actually</span> <span m="2330390">it</span> <span m="2330530">doesn't do</span> <span m="2330680">IP-based</span> <span m="2331430">authentication.</span> <span m="2331990">You have to type</span> <span m="2332305">in your</span> <span m="2332920">password</span> <span m="2333205">to</span> <span m="2333347">log in,</span> <span m="2334250">all</span> <span m="2334460">this great</span> <span m="2334720">stuff.</span> </p>
<p><span m="2335910">The</span> <span m="2336000">problem</span> <span m="2336200">is</span> <span m="2336290">once</span> <span m="2336490">you've</span> <span m="2336630">typed</span> <span m="2336860">your</span> <span m="2336960">password,</span> <span m="2337350">maybe</span> <span m="2337610">your TCP</span> <span m="2337950">connection</span> <span m="2338280">is just</span> <span m="2338550">established</span> <span m="2338810">and</span> <span m="2339070">can</span> <span m="2339480">accept</span> <span m="2339820">arbitrary</span> <span m="2340210">data.</span> <span m="2341060">So</span> <span m="2341370">wait for</span> <span m="2341530">one of</span> <span m="2341860">you</span> <span m="2341990">guys</span> <span m="2342270">to log</span> <span m="2342650">into a</span> <span m="2342750">machine,</span> <span m="2343340">type</span> <span m="2343530">in</span> <span m="2343630">your</span> <span m="2343770">password.</span> <span m="2344100">I</span> <span m="2344290">don't know what</span> <span m="2344470">that</span> <span m="2344620">password</span> <span m="2344790">is.</span> <span m="2345235">But</span> <span m="2345580">once</span> <span m="2345980">you've</span> <span m="2346080">established</span> <span m="2346340">TCP</span> <span m="2346600">connection,</span> <span m="2346990">I'll</span> <span m="2347420">just</span> <span m="2347600">try</span> <span m="2347840">to</span> <span m="2347960">guess</span> <span m="2348140">your</span> <span m="2348290">sequence</span> <span m="2348670">number</span> <span m="2349120">and</span> <span m="2349250">inject</span> <span m="2349380">some</span> <span m="2349600">data</span> <span m="2350350">into</span> <span m="2350570">your</span> <span m="2350770">existing</span> <span m="2351080">connection.</span> <span m="2351540">So if</span> <span m="2351990">I can</span> <span m="2352260">guess your</span> <span m="2352750">sequence</span> <span m="2352950">numbers</span> <span m="2353090">correctly,</span> <span m="2353415">then</span> <span m="2353740">this</span> <span m="2354120">allows</span> <span m="2354330">me</span> <span m="2354520">to</span> <span m="2355420">make</span> <span m="2355650">it</span> <span m="2355830">pretend</span> <span m="2356040">like</span> <span m="2356140">you've</span> <span m="2356470">typed</span> <span m="2356640">some</span> <span m="2356920">command</span> <span m="2357070">after</span> <span m="2357465">you</span> <span m="2357860">authenticated</span> <span m="2358255">correctly</span> <span m="2358650">with your</span> <span m="2358820">password.</span> </p>
<p><span m="2360150">So</span> <span m="2360540">this all sort</span> <span m="2360930">of</span> <span m="2361195">suggests that</span> <span m="2361460">you really</span> <span m="2361810">don't</span> <span m="2361943">want</span> <span m="2362076">to</span> <span m="2362210">rely</span> <span m="2362590">on</span> <span m="2363640">these</span> <span m="2364890">32-bit</span> <span m="2366935">sequence</span> <span m="2367220">numbers</span> <span m="2368260">for</span> <span m="2368700">providing</span> <span m="2369050">security.</span> <span m="2370430">But</span> <span m="2370695">let's</span> <span m="2371235">actually</span> <span m="2371640">see</span> <span m="2371850">what</span> <span m="2372245">modern</span> <span m="2372640">TCP</span> <span m="2372900">stacks</span> <span m="2373450">actually</span> <span m="2373660">do</span> <span m="2374140">to</span> <span m="2374390">try</span> <span m="2374570">to</span> <span m="2374710">mitigate</span> <span m="2375170">this</span> <span m="2375320">problem.</span> <span m="2375650">So</span> <span m="2375940">as we</span> <span m="2376080">were</span> <span m="2376680">sort of</span> <span m="2376820">discussing,</span> <span m="2377650">I</span> <span m="2378070">guess</span> <span m="2378205">one</span> <span m="2378880">approach</span> <span m="2379285">that</span> <span m="2379850">we'll</span> <span m="2380080">look</span> <span m="2380360">at in</span> <span m="2380640">the</span> <span m="2380850">next two</span> <span m="2381170">lectures</span> <span m="2381930">is</span> <span m="2382380">how</span> <span m="2382670">to</span> <span m="2383450">implement</span> <span m="2384230">some</span> <span m="2384450">security</span> <span m="2384780">at the</span> <span m="2385110">application</span> <span m="2385590">level.</span> <span m="2385910">So</span> <span m="2386050">we'll</span> <span m="2386990">use</span> <span m="2387300">cryptography</span> <span m="2387920">to</span> <span m="2388810">authenticate</span> <span m="2389510">and</span> <span m="2389600">encrypt</span> <span m="2390160">and</span> <span m="2390400">sign</span> <span m="2391010">and</span> <span m="2392250">verify</span> <span m="2392730">messages</span> <span m="2393740">at</span> <span m="2393870">the</span> <span m="2394050">application</span> <span m="2394410">level</span> <span m="2394460">without</span> <span m="2395090">really</span> <span m="2395340">involving</span> <span m="2395820">TCP</span> <span m="2396050">so much.</span> </p>
<p><span m="2397420">But</span> <span m="2397920">there</span> <span m="2398230">are</span> <span m="2398540">some</span> <span m="2398966">existing</span> <span m="2399392">applications that</span> <span m="2399820">would</span> <span m="2399880">benefit</span> <span m="2400360">from</span> <span m="2400710">making</span> <span m="2401020">this</span> <span m="2401810">slightly</span> <span m="2402300">better,</span> <span m="2403950">at least</span> <span m="2404330">not</span> <span m="2404600">make</span> <span m="2404690">it so</span> <span m="2404780">easy</span> <span m="2405010">to</span> <span m="2405100">exploit</span> <span m="2405490">these</span> <span m="2405680">problems.</span> <span m="2407160">And</span> <span m="2408085">the way</span> <span m="2408370">that</span> <span m="2408660">I</span> <span m="2408730">guess</span> <span m="2408980">people</span> <span m="2409270">do this</span> <span m="2409450">in</span> <span m="2410000">practice</span> <span m="2410420">today--</span> <span m="2410785">for</span> <span m="2411150">example Linux</span> <span m="2411420">and</span> <span m="2411740">Windows--</span> <span m="2413200">is</span> <span m="2413570">they</span> <span m="2414080">implement</span> <span m="2414380">the</span> <span m="2414520">suggestion</span> <span m="2414760">that</span> <span m="2414910">John</span> <span m="2415190">gave</span> <span m="2415470">earlier,</span> <span m="2417360">that</span> <span m="2418100">we</span> <span m="2418550">maintain</span> <span m="2419498">different</span> <span m="2419972">initial</span> <span m="2420446">sequence</span> <span m="2420920">numbers</span> <span m="2421078">for</span> <span m="2421236">every</span> <span m="2421394">source</span> <span m="2421631">destination</span> <span m="2421868">pair.</span> </p>
<p><span m="2422820">So</span> <span m="2423140">what</span> <span m="2423543">most</span> <span m="2423946">TCP</span> <span m="2424826">SYN</span> <span m="2426990">implementations</span> <span m="2427710">do</span> <span m="2429110">is</span> <span m="2429580">they</span> <span m="2429850">still</span> <span m="2430120">compute</span> <span m="2430710">this</span> <span m="2431050">initial</span> <span m="2431450">sequence</span> <span m="2431860">number</span> <span m="2433200">as</span> <span m="2433650">we</span> <span m="2433920">were computing</span> <span m="2434140">before.</span> <span m="2434590">So</span> <span m="2435040">this</span> <span m="2435210">is</span> <span m="2435410">the</span> <span m="2435780">old</span> <span m="2436060">style</span> <span m="2438140">ISN,</span> <span m="2438530">let's</span> <span m="2438910">say.</span> <span m="2439600">And</span> <span m="2439905">in</span> <span m="2440210">order</span> <span m="2440400">to</span> <span m="2440470">actually</span> <span m="2440760">generate</span> <span m="2442000">the</span> <span m="2442250">actual</span> <span m="2442650">ISN</span> <span m="2443280">for</span> <span m="2443420">any</span> <span m="2443580">particular</span> <span m="2444030">connection,</span> <span m="2444650">we're</span> <span m="2445075">going to</span> <span m="2445500">add</span> <span m="2445520">a</span> <span m="2445780">random</span> <span m="2446160">32-bit</span> <span m="2447070">offset.</span> <span m="2448130">So</span> <span m="2448500">we're</span> <span m="2448710">going</span> <span m="2449090">to</span> <span m="2449440">include</span> <span m="2450170">some</span> <span m="2450390">sort</span> <span m="2450530">of</span> <span m="2450610">a</span> <span m="2450690">function.</span> <span m="2451005">Think</span> <span m="2451320">of</span> <span m="2451400">it like</span> <span m="2451610">as</span> <span m="2451790">like</span> <span m="2451970">a</span> <span m="2452330">hash</span> <span m="2452650">function</span> <span m="2453040">like</span> <span m="2453250">SHA-1</span> <span m="2454010">or</span> <span m="2454550">something</span> <span m="2454950">maybe</span> <span m="2455200">better.</span> </p>
<p><span m="2456295">And</span> <span m="2456780">this is</span> <span m="2457265">going to be</span> <span m="2457750">a</span> <span m="2458130">function</span> <span m="2458430">of the</span> <span m="2458730">source</span> <span m="2459190">IP,</span> <span m="2459670">the</span> <span m="2460290">source</span> <span m="2460690">port</span> <span m="2460980">number,</span> <span m="2463610">the</span> <span m="2464330">destination</span> <span m="2464735">IP</span> <span m="2465140">address,</span> <span m="2466340">destination</span> <span m="2466800">port,</span> <span m="2468510">and</span> <span m="2469140">some</span> <span m="2469350">sort</span> <span m="2469510">of</span> <span m="2469590">a</span> <span m="2469660">secret</span> <span m="2470130">key</span> <span m="2470820">that</span> <span m="2471200">only</span> <span m="2471630">the</span> <span m="2471950">server</span> <span m="2472730">knows</span> <span m="2473170">in</span> <span m="2473280">this</span> <span m="2473460">case.</span> <span m="2474900">So</span> <span m="2475110">this has</span> <span m="2475360">the</span> <span m="2475400">nice</span> <span m="2475670">property</span> <span m="2476110">that</span> <span m="2477290">within</span> <span m="2477860">any</span> <span m="2478180">particular</span> <span m="2478700">connection,</span> <span m="2479350">as</span> <span m="2479490">identified</span> <span m="2480030">by</span> <span m="2480280">a</span> <span m="2480360">source</span> <span m="2480770">and</span> <span m="2480860">destination</span> <span m="2481400">IP</span> <span m="2481710">port</span> <span m="2482450">pair,</span> <span m="2484250">it</span> <span m="2484470">still</span> <span m="2484610">preserves</span> <span m="2484910">all</span> <span m="2485210">these nice</span> <span m="2485470">properties</span> <span m="2485980">of</span> <span m="2486060">this</span> <span m="2486240">old</span> <span m="2486510">style</span> <span m="2487380">sequence</span> <span m="2487770">number</span> <span m="2488040">algorithm</span> <span m="2488310">had.</span> </p>
<p><span m="2490000">But</span> <span m="2491150">if</span> <span m="2491370">you</span> <span m="2491980">have</span> <span m="2492420">connections</span> <span m="2492930">from</span> <span m="2493120">different</span> <span m="2494350">source/destination</span> <span m="2494780">tuples,</span> <span m="2496230">then</span> <span m="2496450">there's</span> <span m="2496670">nothing</span> <span m="2497100">you can</span> <span m="2497230">learn</span> <span m="2497710">about</span> <span m="2497965">the</span> <span m="2498220">exact</span> <span m="2498430">value</span> <span m="2498640">of</span> <span m="2499060">another</span> <span m="2500320">connection</span> <span m="2500676">tuple's</span> <span m="2501600">sequence</span> <span m="2501940">number.</span> <span m="2502780">And</span> <span m="2502920">in</span> <span m="2503020">fact,</span> <span m="2503400">you'll</span> <span m="2503805">have</span> <span m="2504210">to</span> <span m="2504290">guess</span> <span m="2504630">this</span> <span m="2504830">key</span> <span m="2505140">in</span> <span m="2505220">order</span> <span m="2505450">to</span> <span m="2506365">infer</span> <span m="2506680">that</span> <span m="2507120">value.</span> <span m="2507680">And</span> <span m="2508130">hopefully</span> <span m="2508195">the</span> <span m="2508260">server,</span> <span m="2509030">presumably</span> <span m="2509420">the OS</span> <span m="2509760">kernel,</span> <span m="2510580">stores</span> <span m="2510845">this</span> <span m="2511110">key</span> <span m="2511250">somewhere</span> <span m="2511480">in</span> <span m="2511700">its</span> <span m="2511930">memory</span> <span m="2512290">and</span> <span m="2512520">doesn't give it out</span> <span m="2512610">to</span> <span m="2512920">anyone</span> <span m="2513230">else.</span> </p>
<p><span m="2514750">So</span> <span m="2515080">this is</span> <span m="2515260">how</span> <span m="2515460">pretty</span> <span m="2515820">much most TCP</span> <span m="2516140">stacks</span> <span m="2516420">deal</span> <span m="2516700">with</span> <span m="2517090">this</span> <span m="2517515">particular</span> <span m="2517940">problem</span> <span m="2518365">today</span> <span m="2519055">to</span> <span m="2519320">the</span> <span m="2519500">extent</span> <span m="2520170">allowed</span> <span m="2520680">by</span> <span m="2520840">the</span> <span m="2521645">total</span> <span m="2521970">32-bit</span> <span m="2522370">sequence</span> <span m="2522950">number.</span> <span m="2523395">It's</span> <span m="2523840">not great, but sort of works.</span> <span m="2524050">Yeah.</span> </p>
<p><span m="2524543">AUDIENCE: Could</span> <span m="2525036">you repeat that</span> <span m="2525529">again?</span> <span m="2526022">Is</span> <span m="2526515">the</span> <span m="2527501">key</span> <span m="2527994">unique</span> <span m="2528487">to--</span> </p>
<p><span m="2529480">PROFESSOR: So</span> <span m="2529900">when</span> <span m="2530350">my</span> <span m="2530410">machine</span> <span m="2530900">boots up,</span> <span m="2531380">or</span> <span m="2531530">when</span> <span m="2531940">any</span> <span m="2532240">machine boots up,</span> <span m="2532520">it</span> <span m="2533210">generates</span> <span m="2533276">a</span> <span m="2533343">random</span> <span m="2533410">key.</span> <span m="2533780">Every</span> <span m="2533920">time</span> <span m="2534060">you</span> <span m="2534183">reboot</span> <span m="2534307">it</span> <span m="2534430">it</span> <span m="2534554">generates</span> <span m="2535048">a</span> <span m="2536036">new key.</span> <span m="2536530">And</span> <span m="2537310">this</span> <span m="2537530">means</span> <span m="2537880">that</span> <span m="2539160">every</span> <span m="2539450">time</span> <span m="2540190">that</span> <span m="2540565">for</span> <span m="2540940">a</span> <span m="2541140">particular</span> <span m="2541890">source/destination</span> <span m="2543240">pair,</span> <span m="2544680">the</span> <span m="2544960">sequence</span> <span m="2545040">numbers</span> <span m="2545500">advance</span> <span m="2545805">at the</span> <span m="2546110">same</span> <span m="2546430">rate</span> <span m="2546650">as controlled</span> <span m="2547010">by</span> <span m="2547270">this.</span> </p>
<p><span m="2547820">So</span> <span m="2547930">for</span> <span m="2548041">a</span> <span m="2548152">given</span> <span m="2548263">source/destination</span> <span m="2548706">pair,</span> <span m="2549150">this</span> <span m="2549430">thing</span> <span m="2549710">is</span> <span m="2549890">fixed.</span> <span m="2550850">So</span> <span m="2551430">you</span> <span m="2551590">observe</span> <span m="2552060">your</span> <span m="2552260">sequence</span> <span m="2552740">numbers</span> <span m="2553050">evolving</span> <span m="2553360">according</span> <span m="2553705">to your</span> <span m="2554090">initial</span> <span m="2554390">sequence</span> <span m="2554680">numbers</span> <span m="2554980">for new</span> <span m="2555360">connections</span> <span m="2555700">evolving</span> <span m="2556180">according</span> <span m="2556350">to a</span> <span m="2556630">particular</span> <span m="2556895">algorithm.</span> <span m="2559480">So</span> <span m="2559805">that still</span> <span m="2560130">provides</span> <span m="2560220">all</span> <span m="2560310">these</span> <span m="2560770">defences</span> <span m="2561320">against</span> <span m="2563380">old</span> <span m="2563690">packets from</span> <span m="2564140">previous</span> <span m="2564590">connections</span> <span m="2565210">being</span> <span m="2565670">injected</span> <span m="2565950">into</span> <span m="2566230">new connections,</span> <span m="2567120">just</span> <span m="2567530">like</span> <span m="2567820">packet</span> <span m="2568090">reordering</span> <span m="2568558">problems.</span> </p>
<p><span m="2570430">So</span> <span m="2570460">that</span> <span m="2570690">still</span> <span m="2570870">works.</span> <span m="2571630">And</span> <span m="2571900">that's</span> <span m="2572180">the</span> <span m="2572460">only real</span> <span m="2572720">thing</span> <span m="2573100">for which</span> <span m="2573490">we needed</span> <span m="2574270">this</span> <span m="2574660">sequence</span> <span m="2574880">number</span> <span m="2575070">choosing</span> <span m="2575550">algorithms</span> <span m="2576030">to</span> <span m="2576100">prevent</span> <span m="2576460">these</span> <span m="2576760">duplicate</span> <span m="2577170">packets from causing</span> <span m="2577580">problems.</span> <span m="2578800">However,</span> <span m="2579920">the</span> <span m="2580180">thing</span> <span m="2580440">that</span> <span m="2580850">we were exploiting</span> <span m="2581255">before,</span> <span m="2581660">which</span> <span m="2581720">is</span> <span m="2581850">that</span> <span m="2582215">if</span> <span m="2582580">you</span> <span m="2582930">get</span> <span m="2583380">the</span> <span m="2583830">sequence</span> <span m="2584095">number</span> <span m="2584360">for</span> <span m="2584910">one</span> <span m="2585250">connection</span> <span m="2585570">from A</span> <span m="2585890">to</span> <span m="2586310">S,</span> <span m="2587650">then</span> <span m="2588130">from</span> <span m="2588600">that</span> <span m="2589070">you</span> <span m="2589540">can</span> <span m="2590010">infer the sequence</span> <span m="2590480">number for</span> <span m="2590950">a</span> <span m="2591420">different</span> <span m="2591890">connection.</span> </p>
<p><span m="2592360">That's</span> <span m="2592630">now</span> <span m="2592720">gone.</span> <span m="2593080">Because</span> <span m="2593350">every</span> <span m="2593670">connection has a</span> <span m="2594100">different</span> <span m="2594750">offset</span> <span m="2596030">in this</span> <span m="2596210">32-bit</span> <span m="2596670">space</span> <span m="2597430">as</span> <span m="2597620">implemented</span> <span m="2597770">by its</span> <span m="2598090">F</span> <span m="2598410">function.</span> <span m="2599790">So</span> <span m="2600430">this</span> <span m="2601180">completely</span> <span m="2601600">decouples</span> <span m="2602600">the</span> <span m="2604130">initial</span> <span m="2604465">sequence</span> <span m="2604800">numbers</span> <span m="2605085">seen by</span> <span m="2605370">every</span> <span m="2605710">connection.</span> <span m="2607655">Yeah.</span> </p>
<p><span m="2608110">AUDIENCE: What's</span> <span m="2608565">the point in</span> <span m="2609020">including the</span> <span m="2609475">key?</span> </p>
<p><span m="2611300">PROFESSOR: Well,</span> <span m="2611560">if you</span> <span m="2611710">don't</span> <span m="2612040">include</span> <span m="2612350">the</span> <span m="2612660">key,</span> <span m="2613300">then</span> <span m="2613600">I can</span> <span m="2613870">connect</span> <span m="2614290">to</span> <span m="2614660">you.</span> <span m="2615050">I'll</span> <span m="2615187">compute the same</span> <span m="2615600">function</span> <span m="2615940">F.</span> <span m="2616270">I'll</span> <span m="2616600">subtract</span> <span m="2616980">it</span> <span m="2617250">out.</span> <span m="2617540">I'll get</span> <span m="2617670">this.</span> <span m="2618070">I'll</span> <span m="2618470">compute this</span> <span m="2619030">function</span> <span m="2619350">F</span> <span m="2619452">for</span> <span m="2619555">the</span> <span m="2619657">connection</span> <span m="2619760">I actually</span> <span m="2620170">want to</span> <span m="2620580">fake.</span> <span m="2620910">And I'll</span> <span m="2621110">guess</span> <span m="2621420">what</span> <span m="2621592">the</span> <span m="2621765">initial</span> <span m="2622110">sequence</span> <span m="2622310">number</span> <span m="2622352">for</span> <span m="2622395">that</span> <span m="2622480">one is</span> <span m="2622750">going to</span> <span m="2622930">be.</span> </p>
<p><span m="2623360">AUDIENCE: So</span> <span m="2623838">can</span> <span m="2624316">you--</span> <span m="2624794">because</span> <span m="2625272">machines</span> <span m="2625511">now</span> <span m="2625750">restart</span> <span m="2626230">infrequently,</span> <span m="2626520">can</span> <span m="2626986">you</span> <span m="2627452">still</span> <span m="2628850">[INAUDIBLE]</span> <span m="2629803">by</span> <span m="2630216">reversing--</span> </p>
<p><span m="2630630">PROFESSOR: I</span> <span m="2630880">think</span> <span m="2632020">typically</span> <span m="2632590">this</span> <span m="2632980">function</span> <span m="2633370">F</span> <span m="2633580">is</span> <span m="2633730">something</span> <span m="2634145">like a</span> <span m="2634560">cryptographically</span> <span m="2634820">secure</span> <span m="2635280">hash</span> <span m="2635610">function,</span> <span m="2636290">which</span> <span m="2636700">has</span> <span m="2638361">a</span> <span m="2639090">semi-proved</span> <span m="2639670">property</span> <span m="2639975">that it's</span> <span m="2641690">very</span> <span m="2641860">difficult.</span> <span m="2642150">It's</span> <span m="2642440">cryptographically</span> <span m="2643140">hard</span> <span m="2643570">to</span> <span m="2643690">invert</span> <span m="2644090">it.</span> <span m="2644480">So</span> <span m="2644600">even</span> <span m="2644900">if</span> <span m="2645120">you</span> <span m="2645400">were</span> <span m="2645550">given</span> <span m="2645870">the</span> <span m="2645980">literal</span> <span m="2646480">inputs and</span> <span m="2646910">outputs</span> <span m="2647160">of</span> <span m="2647410">this</span> <span m="2647715">hash</span> <span m="2648020">function</span> <span m="2653120">except</span> <span m="2653220">for this</span> <span m="2653530">key</span> <span m="2653825">part,</span> <span m="2654400">it would</span> <span m="2654580">be</span> <span m="2654720">very</span> <span m="2655010">hard</span> <span m="2655250">for you guess what this</span> <span m="2655698">key</span> <span m="2656146">is</span> <span m="2656594">cryptographically,</span> <span m="2657490">even</span> <span m="2657938">in an</span> <span m="2658386">isolated</span> <span m="2658840">setting.</span> </p>
<p><span m="2659530">So</span> <span m="2660030">hopefully</span> <span m="2660360">this</span> <span m="2660480">will</span> <span m="2660570">be</span> <span m="2660720">at</span> <span m="2660850">least</span> <span m="2661110">as</span> <span m="2661240">hard</span> <span m="2661440">in this setting</span> <span m="2661740">as</span> <span m="2661990">well.</span> <span m="2664380">We'll</span> <span m="2664590">talk</span> <span m="2664770">a</span> <span m="2664820">little</span> <span m="2664940">bit</span> <span m="2665100">more</span> <span m="2665310">about</span> <span m="2665745">what these</span> <span m="2666180">functions</span> <span m="2666615">F</span> <span m="2667050">are a</span> <span m="2667355">bit</span> <span m="2667660">later</span> <span m="2667930">on</span> <span m="2668230">and how</span> <span m="2668676">you to use them</span> <span m="2669122">correctly.</span> <span m="2670460">Make</span> <span m="2670470">sense?</span> <span m="2671650">Other</span> <span m="2672050">questions</span> <span m="2673970">of this</span> <span m="2674410">problem</span> <span m="2674670">and</span> <span m="2674930">solution?</span> </p>
<p><span m="2677140">All right,</span> <span m="2678831">so</span> <span m="2679250">in</span> <span m="2679580">fact,</span> <span m="2680430">this was</span> <span m="2680850">mostly</span> <span m="2681252">sort of an example</span> <span m="2681654">of</span> <span m="2682460">these</span> <span m="2682790">TCP</span> <span m="2683130">sequence</span> <span m="2683450">number</span> <span m="2683690">attacks</span> <span m="2684255">that</span> <span m="2684770">aren't</span> <span m="2685780">as</span> <span m="2686040">relevant</span> <span m="2686420">anymore.</span> <span m="2686790">Because</span> <span m="2687400">every</span> <span m="2687690">operating</span> <span m="2688120">system</span> <span m="2688240">basically</span> <span m="2688700">implements</span> <span m="2688980">this plan</span> <span m="2689440">these</span> <span m="2689600">days.</span> <span m="2690080">So</span> <span m="2690230">it's</span> <span m="2690370">hard</span> <span m="2690710">to</span> <span m="2691010">infer</span> <span m="2691360">what</span> <span m="2691710">someone's</span> <span m="2692040">sequence</span> <span m="2692425">number is going to be.</span> </p>
<p><span m="2693840">On the other</span> <span m="2694095">hand,</span> <span m="2694350">people</span> <span m="2694635">keep</span> <span m="2694920">making</span> <span m="2695210">the</span> <span m="2695310">same</span> <span m="2695490">mistakes.</span> <span m="2695910">So</span> <span m="2696725">even</span> <span m="2697090">after</span> <span m="2697463">this was</span> <span m="2697836">implemented</span> <span m="2698210">for</span> <span m="2698280">TCP,</span> <span m="2699755">there</span> <span m="2700040">was this</span> <span m="2700270">other</span> <span m="2700510">protocol</span> <span m="2701010">called</span> <span m="2701490">DNS</span> <span m="2701980">that is</span> <span m="2702300">hugely</span> <span m="2702650">vulnerable</span> <span m="2703130">to</span> <span m="2703570">similar</span> <span m="2704150">attacks.</span> <span m="2705830">And</span> <span m="2706110">the</span> <span m="2706190">reason</span> <span m="2706460">is</span> <span m="2706610">that</span> <span m="2706780">DNS</span> <span m="2706860">actually</span> <span m="2707340">runs</span> <span m="2707510">over</span> <span m="2707720">UDP.</span> </p>
<p><span m="2710060">So</span> <span m="2710680">UDP</span> <span m="2711050">is</span> <span m="2711430">a</span> <span m="2711930">stateless</span> <span m="2712320">protocol</span> <span m="2712740">where</span> <span m="2712810">you</span> <span m="2712880">actually</span> <span m="2713100">don't</span> <span m="2713650">do</span> <span m="2714830">any</span> <span m="2715000">connection</span> <span m="2715450">establishment</span> <span m="2716190">where</span> <span m="2716340">you</span> <span m="2716670">exchange</span> <span m="2717000">sequence</span> <span m="2717380">numbers.</span> <span m="2718140">In</span> <span m="2718470">UDP,</span> <span m="2718635">you</span> <span m="2718800">simply</span> <span m="2719330">send</span> <span m="2719570">a</span> <span m="2719640">request</span> <span m="2720040">from</span> <span m="2720240">your</span> <span m="2720470">source</span> <span m="2720770">address</span> <span m="2721180">to</span> <span m="2721260">the</span> <span m="2721380">server.</span> <span m="2722140">And</span> <span m="2722290">the</span> <span m="2722370">server</span> <span m="2723440">figures</span> <span m="2723590">out what the</span> <span m="2723970">reply</span> <span m="2724285">should</span> <span m="2724600">be</span> <span m="2724890">and sends it</span> <span m="2725120">back</span> <span m="2725480">to</span> <span m="2725580">whatever</span> <span m="2725890">source</span> <span m="2726180">address</span> <span m="2726520">appeared</span> <span m="2726900">in</span> <span m="2727170">the</span> <span m="2727280">packet.</span> </p>
<p><span m="2728780">So</span> <span m="2731000">it's</span> <span m="2731400">a</span> <span m="2731530">single</span> <span m="2731740">round</span> <span m="2732060">trip,</span> <span m="2732475">so there's</span> <span m="2732890">no time</span> <span m="2733120">to exchange</span> <span m="2733390">sequence</span> <span m="2734060">numbers</span> <span m="2734350">and</span> <span m="2734500">to</span> <span m="2734720">establish</span> <span m="2735060">that,</span> <span m="2735400">oh,</span> <span m="2735580">yeah,</span> <span m="2735910">you're</span> <span m="2736040">actually</span> <span m="2736245">talking</span> <span m="2736313">to</span> <span m="2736381">the</span> <span m="2736450">right</span> <span m="2736760">guy.</span> <span m="2738140">So</span> <span m="2739250">with</span> <span m="2739630">DNS,</span> <span m="2741263">as</span> <span m="2741746">a</span> <span m="2742230">result,</span> <span m="2743345">for</span> <span m="2743680">a</span> <span m="2744005">while,</span> <span m="2744330">it was</span> <span m="2744600">quite</span> <span m="2745000">easy</span> <span m="2745400">to</span> <span m="2745795">fake</span> <span m="2746600">responses</span> <span m="2747240">from</span> <span m="2747400">a</span> <span m="2747470">DNS</span> <span m="2747840">server.</span> </p>
<p><span m="2748840">So</span> <span m="2749290">how would</span> <span m="2749740">a</span> <span m="2750120">query</span> <span m="2750395">look like</span> <span m="2750670">in DNS,</span> <span m="2750925">typically?</span> <span m="2751550">Well,</span> <span m="2751890">you</span> <span m="2752160">send some</span> <span m="2752530">queries--</span> <span m="2752930">so</span> <span m="2753030">suppose</span> <span m="2753130">a</span> <span m="2753330">client</span> <span m="2753740">sends</span> <span m="2754150">a</span> <span m="2754435">packet</span> <span m="2754910">from</span> <span m="2755570">client</span> <span m="2756030">to</span> <span m="2756280">some</span> <span m="2756460">DNS</span> <span m="2756840">server</span> <span m="2757230">that</span> <span m="2757620">knows</span> <span m="2757860">the</span> <span m="2758165">DNS</span> <span m="2758470">server's</span> <span m="2758870">IP</span> <span m="2758960">address</span> <span m="2759220">ahead</span> <span m="2759540">of</span> <span m="2759640">time,</span> <span m="2760210">maybe</span> <span m="2760455">preconfigured</span> <span m="2761080">somewhere,</span> <span m="2761860">say,</span> <span m="2762080">well,</span> <span m="2762490">here's</span> <span m="2762670">my</span> <span m="2762910">query.</span> <span m="2764260">Maybe</span> <span m="2764840">I'm</span> <span m="2765130">looking</span> <span m="2765440">for</span> <span m="2765630">mit.edu.</span> <span m="2767336">And</span> <span m="2768590">that's</span> <span m="2768890">basically</span> <span m="2769155">it.</span> </p>
<p><span m="2769860">And</span> <span m="2770240">the</span> <span m="2770710">server's</span> <span m="2771380">destination</span> <span m="2771960">port</span> <span m="2772160">number</span> <span m="2772420">is</span> <span m="2772490">always</span> <span m="2772860">53</span> <span m="2773210">for</span> <span m="2773520">DNS.</span> <span m="2774600">And</span> <span m="2774870">the</span> <span m="2775325">clients</span> <span m="2775780">used to</span> <span m="2775890">also</span> <span m="2776330">run on</span> <span m="2776590">the</span> <span m="2776670">same</span> <span m="2776840">port</span> <span m="2777100">number</span> <span m="2777380">for</span> <span m="2778020">ease</span> <span m="2778100">of</span> <span m="2778240">use</span> <span m="2778860">or</span> <span m="2778950">something.</span> <span m="2780720">So</span> <span m="2781510">you send this</span> <span m="2781760">packet</span> <span m="2782190">from the</span> <span m="2782560">client on this</span> <span m="2782910">port</span> <span m="2783003">to</span> <span m="2783096">the</span> <span m="2783190">server</span> <span m="2783470">on</span> <span m="2783930">this port.</span> <span m="2784320">Here's the</span> <span m="2784760">query.</span> <span m="2785200">And</span> <span m="2785350">the</span> <span m="2785440">server</span> <span m="2785950">eventually</span> <span m="2786650">sends</span> <span m="2786950">back</span> <span m="2787110">a</span> <span m="2787320">reply</span> <span m="2789750">saying,</span> <span m="2790460">mit.edu</span> <span m="2790730">has</span> <span m="2791990">a</span> <span m="2792080">particular</span> <span m="2792890">IP</span> <span m="2793150">address,</span> <span m="2793745">18.9</span> <span m="2794460">dot</span> <span m="2794880">something.</span> </p>
<p><span m="2798580">The</span> <span m="2798670">problem</span> <span m="2799100">is</span> <span m="2799290">that</span> <span m="2799810">some</span> <span m="2800280">adversary</span> <span m="2800730">could</span> <span m="2801160">easily</span> <span m="2801860">send a</span> <span m="2802130">similar</span> <span m="2802620">response</span> <span m="2803030">packet</span> <span m="2803360">pretending</span> <span m="2803615">to</span> <span m="2803870">be</span> <span m="2803990">from</span> <span m="2804220">the</span> <span m="2804300">server.</span> <span m="2805530">And</span> <span m="2805540">there's</span> <span m="2805720">not a</span> <span m="2805780">whole</span> <span m="2806110">lot</span> <span m="2806260">of</span> <span m="2806310">randomness</span> <span m="2806790">here.</span> <span m="2807366">So if I</span> <span m="2807782">know that</span> <span m="2808200">you're</span> <span m="2808475">trying to</span> <span m="2808750">connect to</span> <span m="2809030">mit.edu,</span> <span m="2810180">I'll</span> <span m="2810390">just</span> <span m="2810820">send a</span> <span m="2811020">lot of</span> <span m="2811460">packets</span> <span m="2811970">like</span> <span m="2812160">this to your</span> <span m="2812650">machine.</span> </p>
<p><span m="2813260">I</span> <span m="2813350">know</span> <span m="2813460">exactly</span> <span m="2813870">what</span> <span m="2813990">DNS</span> <span m="2814438">server</span> <span m="2814550">you're</span> <span m="2814662">going</span> <span m="2814774">to</span> <span m="2814886">query.</span> <span m="2815334">I</span> <span m="2815782">know exactly what your</span> <span m="2816230">IP</span> <span m="2816420">address is.</span> <span m="2817400">I know the</span> <span m="2817720">port</span> <span m="2817970">numbers.</span> <span m="2818830">I know</span> <span m="2818990">what you're</span> <span m="2819330">querying</span> <span m="2819683">for.</span> <span m="2820036">I</span> <span m="2820390">can</span> <span m="2820570">just</span> <span m="2820750">supply my own</span> <span m="2821110">IP</span> <span m="2821510">address</span> <span m="2821850">here.</span> </p>
<p><span m="2822530">And</span> <span m="2822980">if</span> <span m="2823140">my</span> <span m="2823280">packet</span> <span m="2824200">gets</span> <span m="2824460">there</span> <span m="2825010">after</span> <span m="2825360">you</span> <span m="2825530">send</span> <span m="2825710">this</span> <span m="2826310">but</span> <span m="2826530">before</span> <span m="2827190">you</span> <span m="2827250">get</span> <span m="2827420">the real</span> <span m="2827540">response,</span> <span m="2828630">your</span> <span m="2828800">client</span> <span m="2829040">machine</span> <span m="2829100">is</span> <span m="2829160">going to</span> <span m="2829621">use my</span> <span m="2830082">packet.</span> <span m="2831930">So this</span> <span m="2832110">is</span> <span m="2832150">another</span> <span m="2832520">example</span> <span m="2833030">where</span> <span m="2833760">insufficient</span> <span m="2834270">randomness</span> <span m="2834585">in this</span> <span m="2834900">protocol</span> <span m="2835340">makes</span> <span m="2835550">it</span> <span m="2835810">very</span> <span m="2836090">easy</span> <span m="2836280">to</span> <span m="2836500">inject</span> <span m="2836930">responses</span> <span m="2837470">or</span> <span m="2837580">inject</span> <span m="2837930">packets</span> <span m="2838280">in</span> <span m="2838370">general.</span> </p>
<p><span m="2840460">And</span> <span m="2840530">this is</span> <span m="2840760">actually</span> <span m="2840940">in some</span> <span m="2841370">ways</span> <span m="2841533">even</span> <span m="2841696">worse</span> <span m="2841860">than the</span> <span m="2842200">previous</span> <span m="2842550">attack.</span> <span m="2843113">Because</span> <span m="2843840">here you</span> <span m="2844040">could</span> <span m="2844380">convince</span> <span m="2844690">a</span> <span m="2844750">client</span> <span m="2845220">to</span> <span m="2845690">connect to</span> <span m="2846182">another</span> <span m="2846674">IP</span> <span m="2847166">address all together.</span> <span m="2848150">And</span> <span m="2848640">it'll</span> <span m="2848840">probably</span> <span m="2849100">cache</span> <span m="2849510">this result,</span> <span m="2849865">because</span> <span m="2850120">DNS</span> <span m="2850520">involves</span> <span m="2850830">caching.</span> <span m="2851600">Maybe</span> <span m="2851685">you</span> <span m="2851770">can</span> <span m="2851855">supply</span> <span m="2851940">a</span> <span m="2852020">very</span> <span m="2852325">long</span> <span m="2852630">time to</span> <span m="2852945">live</span> <span m="2853260">in</span> <span m="2853540">this</span> <span m="2853820">response</span> <span m="2854600">saying,</span> <span m="2854930">this is</span> <span m="2855370">valid for</span> <span m="2855500">years.</span> <span m="2856550">And</span> <span m="2857000">then</span> <span m="2857130">your</span> <span m="2857270">client, again</span> <span m="2857690">till</span> <span m="2857940">it</span> <span m="2858190">reboots,</span> <span m="2858620">is</span> <span m="2858730">going</span> <span m="2858860">to</span> <span m="2859020">keep using</span> <span m="2859390">this</span> <span m="2860010">IP</span> <span m="2860340">address</span> <span m="2860670">for</span> <span m="2861140">mit.edu.</span> <span m="2861872">Yeah.</span> </p>
<p><span m="2862240">AUDIENCE: Could</span> <span m="2862645">you</span> <span m="2863050">fix this</span> <span m="2863440">by</span> <span m="2863620">having the</span> <span m="2864073">client</span> <span m="2864526">include</span> <span m="2864980">some</span> <span m="2865370">random</span> <span m="2865835">value in the</span> <span m="2866300">query,</span> <span m="2866765">and the</span> <span m="2867230">server</span> <span m="2867695">customer</span> <span m="2868160">exactly?</span> </p>
<p><span m="2868630">PROFESSOR: That's</span> <span m="2869120">right, yeah,</span> <span m="2869320">so</span> <span m="2869460">this is</span> <span m="2870000">typically</span> <span m="2870400">what</span> <span m="2870620">people</span> <span m="2871080">have</span> <span m="2871330">done</span> <span m="2871590">now.</span> <span m="2872050">The</span> <span m="2872516">problem,</span> <span m="2872982">as we</span> <span m="2873448">were</span> <span m="2873914">sort of</span> <span m="2874380">talking about</span> <span m="2874846">earlier,</span> <span m="2875312">is</span> <span m="2875467">backward</span> <span m="2875622">compatibility.</span> <span m="2876250">It's</span> <span m="2876340">very</span> <span m="2876500">hard</span> <span m="2876740">to</span> <span m="2876860">change</span> <span m="2877290">the</span> <span m="2877410">DNS</span> <span m="2877890">server</span> <span m="2878290">software</span> <span m="2878870">that</span> <span m="2879270">everyone runs.</span> </p>
<p><span m="2879760">So you</span> <span m="2880080">basically</span> <span m="2880390">have</span> <span m="2880530">to</span> <span m="2880590">figure</span> <span m="2880800">out,</span> <span m="2880890">where</span> <span m="2881090">can</span> <span m="2881280">you</span> <span m="2881470">inject</span> <span m="2881800">randomness?</span> <span m="2882700">And</span> <span m="2882820">people have</span> <span m="2883140">figured</span> <span m="2883410">out</span> <span m="2883690">two</span> <span m="2883840">places.</span> <span m="2884450">It's</span> <span m="2885270">not</span> <span m="2885590">great.</span> <span m="2885860">But</span> <span m="2885970">basically</span> <span m="2886260">there's</span> <span m="2886550">a</span> <span m="2886850">source</span> <span m="2887320">port</span> <span m="2887590">number,</span> <span m="2888340">which</span> <span m="2888570">is</span> <span m="2888770">16</span> <span m="2889220">bits</span> <span m="2889380">of</span> <span m="2889500">randomness.</span> <span m="2891050">So</span> <span m="2891690">if</span> <span m="2891810">you can</span> <span m="2891980">choose</span> <span m="2892290">the</span> <span m="2892400">source</span> <span m="2892690">port</span> <span m="2892880">number</span> <span m="2893330">randomly,</span> <span m="2893700">then</span> <span m="2893900">you</span> <span m="2894090">get</span> <span m="2894320">16</span> <span m="2894650">bits.</span> <span m="2895140">And</span> <span m="2895440">there's</span> <span m="2895770">also</span> <span m="2896230">a</span> <span m="2896595">query</span> <span m="2896960">ID</span> <span m="2898920">inside</span> <span m="2899470">of</span> <span m="2899590">the</span> <span m="2899710">packet,</span> <span m="2900390">which</span> <span m="2900570">is</span> <span m="2900660">also</span> <span m="2900980">16</span> <span m="2901330">bits.</span> <span m="2902460">And</span> <span m="2902730">the</span> <span m="2902800">server</span> <span m="2903080">does</span> <span m="2903430">echo</span> <span m="2903725">back the</span> <span m="2904020">query</span> <span m="2904250">ID.</span> </p>
<p><span m="2905030">So</span> <span m="2905280">combining</span> <span m="2905780">these</span> <span m="2905980">two</span> <span m="2906110">things</span> <span m="2906330">together,</span> <span m="2907040">most</span> <span m="2907495">resolvers</span> <span m="2908090">these</span> <span m="2908270">days</span> <span m="2908920">get</span> <span m="2909180">32</span> <span m="2909440">bits of</span> <span m="2909900">randomness</span> <span m="2910570">out</span> <span m="2911070">of this</span> <span m="2911180">protocol.</span> <span m="2911940">And</span> <span m="2912170">it,</span> <span m="2912580">again,</span> <span m="2913150">makes</span> <span m="2913525">it</span> <span m="2915031">noticeably</span> <span m="2915450">harder,</span> <span m="2916280">but still</span> <span m="2916620">not</span> <span m="2916960">cryptographically</span> <span m="2917550">perfect,</span> <span m="2918820">to</span> <span m="2919744">fake</span> <span m="2920188">this kind of</span> <span m="2920632">response and</span> <span m="2921076">have</span> <span m="2921298">it</span> <span m="2921520">be</span> <span m="2921950">accepted</span> <span m="2922200">by the</span> <span m="2922390">client.</span> <span m="2924340">But</span> <span m="2925340">these</span> <span m="2925792">problems</span> <span m="2926244">keep coming up,</span> <span m="2927150">unfortunately.</span> <span m="2927450">So</span> <span m="2927730">even</span> <span m="2928010">though it</span> <span m="2928250">was</span> <span m="2928750">well</span> <span m="2929060">understood</span> <span m="2929250">for</span> <span m="2929636">TCP,</span> <span m="2931990">some</span> <span m="2932110">people</span> <span m="2933350">I</span> <span m="2933430">guess</span> <span m="2933660">suggested</span> <span m="2933730">that this</span> <span m="2934075">might</span> <span m="2934420">be</span> <span m="2934610">a</span> <span m="2934770">problem.</span> <span m="2935200">But</span> <span m="2935630">it wasn't</span> <span m="2936060">actually</span> <span m="2936255">fixed</span> <span m="2936450">until</span> <span m="2937516">only</span> <span m="2938230">a</span> <span m="2938310">few</span> <span m="2938450">years</span> <span m="2938890">ago.</span> <span m="2941970">Make</span> <span m="2942000">sense?</span> </p>
<p><span m="2944220">All right,</span> <span m="2944400">so</span> <span m="2944765">I</span> <span m="2945130">guess</span> <span m="2945310">maybe</span> <span m="2945490">as an</span> <span m="2945760">aside,</span> <span m="2946080">there</span> <span m="2946500">are</span> <span m="2946580">solutions</span> <span m="2947230">to</span> <span m="2948010">this</span> <span m="2948270">DNS</span> <span m="2948650">problem</span> <span m="2948910">as</span> <span m="2949380">well</span> <span m="2949915">by</span> <span m="2950190">enforcing</span> <span m="2950880">security</span> <span m="2951340">for</span> <span m="2951615">DNS</span> <span m="2951890">at</span> <span m="2952240">the</span> <span m="2952370">application</span> <span m="2952950">level.</span> <span m="2953270">So instead</span> <span m="2953610">of</span> <span m="2954760">relying</span> <span m="2955290">on</span> <span m="2955430">these</span> <span m="2955630">randomness</span> <span m="2956330">properties</span> <span m="2956750">of</span> <span m="2956860">small</span> <span m="2957770">numbers</span> <span m="2958120">of</span> <span m="2958617">bits in the</span> <span m="2959114">packet,</span> <span m="2959611">you</span> <span m="2960110">could</span> <span m="2960350">try</span> <span m="2960590">to</span> <span m="2961250">use</span> <span m="2961480">encryption</span> <span m="2962160">in</span> <span m="2962440">the</span> <span m="2962720">DNS</span> <span m="2963010">protocols.</span> <span m="2963680">So protocols</span> <span m="2963980">like</span> <span m="2964240">DNS</span> <span m="2964640">SEC</span> <span m="2965070">that</span> <span m="2965210">the</span> <span m="2965290">paper</span> <span m="2965665">briefly</span> <span m="2966040">talks</span> <span m="2966426">about</span> <span m="2967200">try</span> <span m="2967520">to</span> <span m="2967660">do</span> <span m="2967750">this.</span> <span m="2968070">So instead</span> <span m="2968470">of</span> <span m="2968610">relying</span> <span m="2969140">on</span> <span m="2969310">any</span> <span m="2969720">network</span> <span m="2970080">level</span> <span m="2970390">security</span> <span m="2970770">properties,</span> <span m="2971600">they</span> <span m="2972110">require</span> <span m="2972410">that</span> <span m="2972710">all</span> <span m="2973100">DNS</span> <span m="2973510">names</span> <span m="2973900">have</span> <span m="2974160">signatures</span> <span m="2974590">attached</span> <span m="2974845">to them.</span> </p>
<p><span m="2976290">That</span> <span m="2976370">seems</span> <span m="2976550">like</span> <span m="2976660">a</span> <span m="2976740">sensible</span> <span m="2977070">plan.</span> <span m="2977820">But</span> <span m="2978020">it</span> <span m="2978060">turns</span> <span m="2978270">out</span> <span m="2978440">that</span> <span m="2978570">working</span> <span m="2978713">out</span> <span m="2978856">the</span> <span m="2979000">details</span> <span m="2979230">is</span> <span m="2979460">actually</span> <span m="2979810">quite</span> <span m="2980060">difficult.</span> <span m="2980890">So</span> <span m="2981530">one</span> <span m="2981700">example</span> <span m="2982300">of</span> <span m="2983540">a</span> <span m="2983680">problem</span> <span m="2984180">that</span> <span m="2984740">showed</span> <span m="2984990">up</span> <span m="2985580">is</span> <span m="2985915">name</span> <span m="2986250">and</span> <span m="2986720">origin.</span> <span m="2987100">Because</span> <span m="2987390">in</span> <span m="2987770">DNS,</span> <span m="2988290">you</span> <span m="2988430">want</span> <span m="2988750">to</span> <span m="2989940">get</span> <span m="2990270">responses.</span> <span m="2991130">Well,</span> <span m="2991380">this name</span> <span m="2991520">has</span> <span m="2991760">that</span> <span m="2992050">IP</span> <span m="2992140">address.</span> </p>
<p><span m="2992680">Or</span> <span m="2993020">you</span> <span m="2993210">could</span> <span m="2993310">get</span> <span m="2993410">a</span> <span m="2993430">response</span> <span m="2993840">saying,</span> <span m="2994020">no, so</span> <span m="2994310">sorry,</span> <span m="2994520">this name</span> <span m="2994700">doesn't</span> <span m="2995090">exist.</span> <span m="2996310">So</span> <span m="2996400">you</span> <span m="2996780">want</span> <span m="2996900">to</span> <span m="2997190">sign</span> <span m="2997745">the</span> <span m="2997800">it</span> <span m="2998210">doesn't</span> <span m="2998580">exist</span> <span m="2998980">response</span> <span m="2999480">as</span> <span m="2999610">well.</span> <span m="3000260">Because</span> <span m="3000480">otherwise,</span> <span m="3000980">that</span> <span m="3001080">adversary</span> <span m="3001560">could</span> <span m="3001980">send</span> <span m="3002400">back a</span> <span m="3002420">doesn't</span> <span m="3002750">exist</span> <span m="3002930">response</span> <span m="3003970">and</span> <span m="3004360">pretend</span> <span m="3004760">that a</span> <span m="3005030">name doesn't</span> <span m="3005390">exist,</span> <span m="3005680">even though it</span> <span m="3005840">does.</span> <span m="3007420">So how do you</span> <span m="3007850">sign</span> <span m="3008480">responses</span> <span m="3009110">that</span> <span m="3009400">certain</span> <span m="3009710">names don't</span> <span m="3010150">exist</span> <span m="3012270">ahead</span> <span m="3012314">of</span> <span m="3012358">time?</span> <span m="3012402">I</span> <span m="3012446">guess</span> <span m="3012490">one</span> <span m="3012890">possibility</span> <span m="3013170">is you could</span> <span m="3013450">give your</span> <span m="3013900">DNS</span> <span m="3014260">server</span> <span m="3014560">the</span> <span m="3014680">key</span> <span m="3015400">that</span> <span m="3015970">signs</span> <span m="3016480">all</span> <span m="3016670">your</span> <span m="3016780">records.</span> </p>
<p><span m="3017950">That</span> <span m="3018010">seems</span> <span m="3018190">like</span> <span m="3018550">a</span> <span m="3018990">bad plan. Because</span> <span m="3019130">then</span> <span m="3019235">someone</span> <span m="3019340">who</span> <span m="3019630">compromises</span> <span m="3019930">your</span> <span m="3020230">DNS server</span> <span m="3020630">could</span> <span m="3021030">walk away</span> <span m="3021230">with this</span> <span m="3021720">key.</span> <span m="3022680">So instead,</span> <span m="3023420">the</span> <span m="3023660">model</span> <span m="3024210">the</span> <span m="3024390">DNS</span> <span m="3024520">SEC</span> <span m="3024910">operates</span> <span m="3025330">under</span> <span m="3025700">is</span> <span m="3026020">that</span> <span m="3026350">you</span> <span m="3026480">sign</span> <span m="3026745">all your</span> <span m="3027010">names</span> <span m="3027802">in</span> <span m="3028200">your</span> <span m="3028590">domain</span> <span m="3028840">ahead of</span> <span m="3029110">time,</span> <span m="3029440">and you</span> <span m="3029920">give</span> <span m="3030270">the</span> <span m="3030420">signed</span> <span m="3030895">blob</span> <span m="3031370">to</span> <span m="3031650">your DNS</span> <span m="3031910">server.</span> <span m="3032315">And</span> <span m="3032720">the</span> <span m="3032800">DNS</span> <span m="3033010">server</span> <span m="3033355">can then</span> <span m="3033700">respond to</span> <span m="3034180">any</span> <span m="3034520">queries.</span> <span m="3035180">But</span> <span m="3035430">even if it's</span> <span m="3035680">compromised,</span> <span m="3035950">there's</span> <span m="3036220">not much</span> <span m="3036760">else</span> <span m="3036990">that that</span> <span m="3037070">attacker</span> <span m="3037165">can</span> <span m="3037260">do.</span> <span m="3037480">All these</span> <span m="3037560">things</span> <span m="3037610">are</span> <span m="3038130">signed,</span> <span m="3038700">and</span> <span m="3039280">the</span> <span m="3039370">key</span> <span m="3039600">is</span> <span m="3039720">not</span> <span m="3040510">to</span> <span m="3040560">be</span> <span m="3040680">found</span> <span m="3040990">on</span> <span m="3041140">the</span> <span m="3041250">DNS</span> <span m="3041710">server</span> <span m="3041950">itself.</span> </p>
<p><span m="3043340">So</span> <span m="3044090">the</span> <span m="3044290">DNS</span> <span m="3044430">SEC</span> <span m="3044710">protocol</span> <span m="3045140">had this</span> <span m="3045630">clever</span> <span m="3045980">mechanism</span> <span m="3047320">called</span> <span m="3047760">NSEC</span> <span m="3049150">for</span> <span m="3049480">signing</span> <span m="3050360">nonexistent</span> <span m="3051190">records.</span> <span m="3052230">And</span> <span m="3052360">the</span> <span m="3052440">way</span> <span m="3052580">you would</span> <span m="3052800">do</span> <span m="3052950">this</span> <span m="3053540">is</span> <span m="3053990">by</span> <span m="3054290">signing</span> <span m="3055110">gaps</span> <span m="3055390">in</span> <span m="3055670">the</span> <span m="3055780">namespace.</span> <span m="3056650">So</span> <span m="3058510">an</span> <span m="3058700">NSEC</span> <span m="3058880">record</span> <span m="3059010">might</span> <span m="3059420">say,</span> <span m="3059800">well,</span> <span m="3060210">there's</span> <span m="3060490">a</span> <span m="3060640">name called</span> <span m="3061070">foo.mit.edu,</span> <span m="3063190">and</span> <span m="3063580">the</span> <span m="3063970">next</span> <span m="3064460">name</span> <span m="3065230">alphabetically</span> <span m="3066550">is</span> <span m="3067790">maybe</span> <span m="3068660">goo.mit.edu.</span> </p>
<p><span m="3070492">And</span> <span m="3070950">there's nothing</span> <span m="3071408">alphabetical</span> <span m="3072330">in</span> <span m="3072450">between</span> <span m="3072750">these</span> <span m="3072970">two</span> <span m="3073120">names.</span> <span m="3073680">So</span> <span m="3073910">if you</span> <span m="3074260">query</span> <span m="3074700">for a</span> <span m="3075045">name</span> <span m="3075570">between</span> <span m="3076000">these</span> <span m="3076260">two</span> <span m="3076380">names</span> <span m="3076690">alphabetically</span> <span m="3077260">sorted,</span> <span m="3077700">then</span> <span m="3078110">the</span> <span m="3078520">server</span> <span m="3078930">could send back</span> <span m="3079215">this</span> <span m="3079500">signed message</span> <span m="3079920">saying,</span> <span m="3080170">oh,</span> <span m="3080390">there's</span> <span m="3080650">nothing between</span> <span m="3080740">these</span> <span m="3080870">two</span> <span m="3081245">names.</span> <span m="3082050">You</span> <span m="3082370">can</span> <span m="3082630">safely</span> <span m="3082890">return,</span> <span m="3083580">doesn't</span> <span m="3083760">exist.</span> </p>
<p><span m="3084460">But</span> <span m="3084720">then this</span> <span m="3084980">allows</span> <span m="3085360">some</span> <span m="3085740">attacker</span> <span m="3086120">to</span> <span m="3086390">completely</span> <span m="3086475">enumerate</span> <span m="3086560">your</span> <span m="3086950">domain</span> <span m="3087340">name.</span> <span m="3087768">You</span> <span m="3088196">can</span> <span m="3088624">just</span> <span m="3089480">ask</span> <span m="3089740">for some</span> <span m="3089810">domain</span> <span m="3090250">name</span> <span m="3090455">and</span> <span m="3090660">find this</span> <span m="3091140">record</span> <span m="3091410">and</span> <span m="3091545">say,</span> <span m="3091680">oh,</span> <span m="3091930">yeah,</span> <span m="3092185">great.</span> <span m="3092710">So</span> <span m="3093360">these</span> <span m="3093640">two things</span> <span m="3094110">exist.</span> <span m="3094330">Let me</span> <span m="3094480">query</span> <span m="3094880">for</span> <span m="3095250">gooa.mit.edu.</span> <span m="3096520">That'll</span> <span m="3096730">give me</span> <span m="3096870">a</span> <span m="3097080">response</span> <span m="3097260">saying,</span> <span m="3098200">what's</span> <span m="3098400">the</span> <span m="3098520">next</span> <span m="3098840">name in</span> <span m="3099000">your</span> <span m="3099300">domain,</span> <span m="3099390">et</span> <span m="3099650">cetera.</span> </p>
<p><span m="3100820">So</span> <span m="3101090">it's</span> <span m="3101360">actually</span> <span m="3101530">a</span> <span m="3101640">little</span> <span m="3101840">bit</span> <span m="3102090">hard to</span> <span m="3102490">come up with the</span> <span m="3102980">right</span> <span m="3103465">protocol</span> <span m="3103950">that</span> <span m="3104435">both</span> <span m="3104556">preserves</span> <span m="3104677">all</span> <span m="3104798">the</span> <span m="3104920">nice</span> <span m="3105405">properties</span> <span m="3105890">of</span> <span m="3106380">DNS</span> <span m="3106790">and</span> <span m="3108070">prevents</span> <span m="3108430">name</span> <span m="3108790">enumeration</span> <span m="3109130">and</span> <span m="3109470">other</span> <span m="3109880">problems.</span> <span m="3110420">There's</span> <span m="3110800">actually</span> <span m="3111070">a</span> <span m="3111340">nice thing</span> <span m="3111490">now</span> <span m="3112020">called</span> <span m="3112550">NSEC3</span> <span m="3113240">that</span> <span m="3113380">tries to</span> <span m="3113650">solve</span> <span m="3113760">this</span> <span m="3114080">problem</span> <span m="3114390">partially--</span> <span m="3115830">sort of</span> <span m="3116070">works,</span> <span m="3116440">sort</span> <span m="3116590">of not.</span> <span m="3116875">We'll</span> <span m="3117160">see,</span> <span m="3118020">I guess,</span> <span m="3118420">what</span> <span m="3118510">gets</span> <span m="3118600">it</span> <span m="3118860">[INAUDIBLE].</span> <span m="3119110">Yeah.</span> </p>
<p><span m="3119880">AUDIENCE: Is</span> <span m="3120350">there</span> <span m="3120710">any kind of</span> <span m="3121070">signing</span> <span m="3121550">of</span> <span m="3121810">nonexistent</span> <span m="3122610">top</span> <span m="3122930">level</span> <span m="3123303">domains?</span> </p>
<p><span m="3124600">PROFESSOR: Yeah,</span> <span m="3124820">I think actually</span> <span m="3125320">yeah.</span> <span m="3125540">The</span> <span m="3125800">dot</span> <span m="3126290">domain</span> <span m="3126750">is</span> <span m="3126980">just</span> <span m="3127110">another domain.</span> <span m="3127600">And</span> <span m="3127760">they</span> <span m="3127900">similarly</span> <span m="3128130">have</span> <span m="3128350">this</span> <span m="3129140">mechanism</span> <span m="3129760">implemented</span> <span m="3129830">as well.</span> <span m="3130250">So</span> <span m="3130670">actually</span> <span m="3130730">dot</span> <span m="3131030">and</span> <span m="3131280">dot</span> <span m="3131410">com</span> <span m="3131746">now</span> <span m="3132082">implement</span> <span m="3132420">DNS</span> <span m="3132520">SEC,</span> <span m="3133120">and</span> <span m="3133490">there's</span> <span m="3133626">all</span> <span m="3133763">these</span> <span m="3133900">records</span> <span m="3134260">there</span> <span m="3134500">that</span> <span m="3134590">say,</span> <span m="3134850">well,</span> <span m="3135842">.in</span> <span m="3137400">is</span> <span m="3137470">a</span> <span m="3137550">domain</span> <span m="3137780">name that</span> <span m="3138045">exists,</span> <span m="3138540">and</span> <span m="3138820">dot</span> <span m="3139270">something</span> <span m="3139580">else</span> <span m="3139820">exists,</span> <span m="3140350">and</span> <span m="3140700">there's</span> <span m="3141170">nothing</span> <span m="3141610">in between.</span> <span m="3141915">So there's</span> <span m="3142220">all these</span> <span m="3142703">things.</span> </p>
<p><span m="3143186">AUDIENCE: So</span> <span m="3143669">other than</span> <span m="3144152">denial of</span> <span m="3144635">service,</span> <span m="3145118">why</span> <span m="3145601">do we care</span> <span m="3146084">so much</span> <span m="3146567">about</span> <span m="3147050">repeating</span> <span m="3147533">domain</span> <span m="3148016">names within</span> <span m="3148499">mit.edu?</span> </p>
<p><span m="3149960">PROFESSOR: Well,</span> <span m="3150170">probably</span> <span m="3150500">we don't.</span> <span m="3150900">Actually,</span> <span m="3151150">there's</span> <span m="3151430">a</span> <span m="3151750">text</span> <span m="3152070">file</span> <span m="3152555">in</span> <span m="3153040">AFS</span> <span m="3153200">that</span> <span m="3153420">lists all these</span> <span m="3153810">domain names</span> <span m="3154255">at</span> <span m="3154700">MIT</span> <span m="3154955">anyway.</span> <span m="3155210">But</span> <span m="3155490">I think in</span> <span m="3155910">general,</span> <span m="3156185">some</span> <span m="3156460">companies</span> <span m="3156930">feel</span> <span m="3157310">a</span> <span m="3157520">little</span> <span m="3157840">uneasy</span> <span m="3158290">about</span> <span m="3158540">revealing</span> <span m="3158740">this.</span> <span m="3159530">They</span> <span m="3159650">often</span> <span m="3160070">have</span> <span m="3160480">internal</span> <span m="3160970">names</span> <span m="3161460">that</span> <span m="3161735">sit in</span> <span m="3162010">DNS</span> <span m="3162600">that</span> <span m="3163730">should</span> <span m="3164410">never</span> <span m="3164630">be</span> <span m="3164820">exposed to the</span> <span m="3165220">outside.</span> <span m="3166245">I think</span> <span m="3166560">it's</span> <span m="3166990">actually</span> <span m="3168420">this</span> <span m="3168660">fuzzy</span> <span m="3168790">area</span> <span m="3169150">where it was</span> <span m="3169500">never</span> <span m="3169730">really</span> <span m="3169940">formalized</span> <span m="3170250">what</span> <span m="3170560">guarantees</span> <span m="3170750">DNS</span> <span m="3171200">was</span> <span m="3171490">providing</span> <span m="3171910">to you</span> <span m="3172250">or was</span> <span m="3172490">not.</span> <span m="3172840">And</span> <span m="3172900">people</span> <span m="3173140">started</span> <span m="3173520">assuming</span> <span m="3173880">things</span> <span m="3174210">like,</span> <span m="3174350">well,</span> <span m="3174690">if</span> <span m="3175030">we</span> <span m="3175220">stick some</span> <span m="3175420">name,</span> <span m="3175910">and it's not</span> <span m="3176260">really</span> <span m="3176750">publicized</span> <span m="3177070">anywhere,</span> <span m="3177390">then</span> <span m="3177670">it's</span> <span m="3177970">probably</span> <span m="3178370">secure</span> <span m="3178510">here.</span> </p>
<p><span m="3179760">I</span> <span m="3179910">think</span> <span m="3180280">this is</span> <span m="3180530">another</span> <span m="3180850">place</span> <span m="3181410">where</span> <span m="3181530">this</span> <span m="3181700">system</span> <span m="3182360">doesn't</span> <span m="3182560">have a</span> <span m="3182960">clear</span> <span m="3183070">spec in</span> <span m="3183520">terms</span> <span m="3183760">of what</span> <span m="3183860">it</span> <span m="3183980">has and</span> <span m="3184300">doesn't</span> <span m="3184740">have to</span> <span m="3185180">provide.</span> <span m="3185930">And</span> <span m="3186350">when</span> <span m="3186510">you</span> <span m="3186660">make</span> <span m="3186960">some</span> <span m="3187480">changes like</span> <span m="3187610">this,</span> <span m="3187910">then people say,</span> <span m="3188382">oh,</span> <span m="3188854">yeah, I</span> <span m="3189326">was sort of</span> <span m="3189798">relying</span> <span m="3190270">on that.</span> <span m="3191214">Yeah.</span> </p>
<p><span m="3192158">AUDIENCE: [INAUDIBLE]</span> <span m="3192630">replay</span> <span m="3193102">attack</span> <span m="3193574">where</span> <span m="3194046">you</span> <span m="3194518">could send</span> <span m="3194990">in</span> <span m="3195410">bold</span> <span m="3195685">gap</span> <span m="3195960">signature?</span> </p>
<p><span m="3197030">PROFESSOR: Yeah,</span> <span m="3197280">there's</span> <span m="3197625">actually</span> <span m="3197970">time</span> <span m="3198180">outs on</span> <span m="3198380">these</span> <span m="3198560">things.</span> <span m="3198760">So when</span> <span m="3198850">you</span> <span m="3198930">sign</span> <span m="3199390">this,</span> <span m="3200350">you</span> <span m="3200610">actually</span> <span m="3201310">sign</span> <span m="3201690">and</span> <span m="3201840">say,</span> <span m="3202480">I'm</span> <span m="3202890">signing</span> <span m="3203160">that</span> <span m="3203430">this</span> <span m="3203680">set</span> <span m="3204120">of</span> <span m="3204560">names</span> <span m="3205370">is</span> <span m="3205580">valid</span> <span m="3206050">for,</span> <span m="3206445">I don't know,</span> <span m="3206840">a</span> <span m="3206970">week.</span> <span m="3207710">And</span> <span m="3207890">then</span> <span m="3208200">the</span> <span m="3208330">clients,</span> <span m="3208740">if they have a</span> <span m="3208870">synchronized</span> <span m="3209640">clock,</span> <span m="3210790">they</span> <span m="3210930">can</span> <span m="3211060">reject</span> <span m="3211460">old</span> <span m="3211790">signed</span> <span m="3212110">messages.</span> <span m="3213436">Make</span> <span m="3213912">sense?</span> </p>
<p><span m="3216770">All</span> <span m="3217190">right,</span> <span m="3217750">so</span> <span m="3218750">this is</span> <span m="3219005">on the</span> <span m="3219260">TCP</span> <span m="3220240">SYN</span> <span m="3222008">guessing</span> <span m="3222434">attacks.</span> <span m="3223290">Another</span> <span m="3223660">interesting</span> <span m="3224415">problem</span> <span m="3224860">that</span> <span m="3225140">also</span> <span m="3225470">comes</span> <span m="3225690">up</span> <span m="3225920">in</span> <span m="3226315">the</span> <span m="3226710">TCP</span> <span m="3226850">case</span> <span m="3227850">is</span> <span m="3228210">a</span> <span m="3228330">denial</span> <span m="3228570">of</span> <span m="3228710">service</span> <span m="3228980">attack</span> <span m="3229430">that</span> <span m="3230490">exploits</span> <span m="3231030">the</span> <span m="3231120">fact</span> <span m="3231390">that</span> <span m="3231440">the</span> <span m="3231530">server</span> <span m="3231860">has</span> <span m="3232190">to store</span> <span m="3233020">some</span> <span m="3233290">state.</span> <span m="3234160">So</span> <span m="3234550">if you</span> <span m="3234835">look at</span> <span m="3235120">this</span> <span m="3236070">handshake</span> <span m="3236540">that</span> <span m="3237000">we</span> <span m="3237460">had on</span> <span m="3237920">the</span> <span m="3238380">board before,</span> <span m="3239760">we'll</span> <span m="3240220">see that</span> <span m="3240680">when a client</span> <span m="3241140">establishes</span> <span m="3241600">a</span> <span m="3242470">connection</span> <span m="3242870">to</span> <span m="3242950">the</span> <span m="3243060">server,</span> <span m="3244230">the</span> <span m="3244330">server</span> <span m="3245520">has to</span> <span m="3245740">actually</span> <span m="3246580">remember</span> <span m="3247670">the</span> <span m="3247810">sequence</span> <span m="3248330">number</span> <span m="3248720">SNC.</span> <span m="3250440">So</span> <span m="3250730">the</span> <span m="3250810">server</span> <span m="3251090">has</span> <span m="3251250">to</span> <span m="3251330">maintain</span> <span m="3251640">some</span> <span m="3251850">data</span> <span m="3252080">structure</span> <span m="3253060">on</span> <span m="3253250">the</span> <span m="3253330">side</span> <span m="3254150">that says,</span> <span m="3254630">for</span> <span m="3254750">this</span> <span m="3255040">connection,</span> <span m="3256960">here's</span> <span m="3257320">the</span> <span m="3257380">sequence</span> <span m="3257740">number.</span> </p>
<p><span m="3258850">And</span> <span m="3258970">it's</span> <span m="3259030">going</span> <span m="3259150">to</span> <span m="3259220">say,</span> <span m="3259490">well,</span> <span m="3260090">my</span> <span m="3260390">connection</span> <span m="3260650">from</span> <span m="3260910">C</span> <span m="3260986">to</span> <span m="3261063">S</span> <span m="3261140">has</span> <span m="3261210">the</span> <span m="3261520">sequence</span> <span m="3262210">number</span> <span m="3263410">SNC.</span> <span m="3266250">And</span> <span m="3266340">the</span> <span m="3266410">reason</span> <span m="3266720">the</span> <span m="3266790">server</span> <span m="3267290">has to</span> <span m="3267630">store</span> <span m="3268000">this</span> <span m="3268140">table</span> <span m="3268510">is</span> <span m="3268880">because</span> <span m="3269360">the</span> <span m="3269860">server</span> <span m="3270130">needs</span> <span m="3270340">to</span> <span m="3272400">figure</span> <span m="3272780">out</span> <span m="3273280">what</span> <span m="3273545">SNC</span> <span m="3274270">value</span> <span m="3274600">to</span> <span m="3274930">accept</span> <span m="3275070">here</span> <span m="3275520">later.</span> <span m="3277340">Does this</span> <span m="3277790">make</span> <span m="3277910">sense?</span> </p>
<p><span m="3278660">AUDIENCE: [INAUDIBLE]</span> <span m="3280035">SNS?</span> </p>
<p><span m="3281570">PROFESSOR: Yeah,</span> <span m="3281890">the server</span> <span m="3282255">also needs</span> <span m="3282620">SNS</span> <span m="3283110">I</span> <span m="3283230">guess,</span> <span m="3283583">yeah.</span> <span m="3288120">But it</span> <span m="3288300">turns</span> <span m="3288430">out</span> <span m="3288735">that--</span> <span m="3289040">well,</span> <span m="3289280">yeah,</span> <span m="3289530">you're</span> <span m="3290020">right.</span> <span m="3291770">And</span> <span m="3292320">the</span> <span m="3292490">problem</span> <span m="3294290">is</span> <span m="3294860">that--</span> <span m="3297300">actually, yeah,</span> <span m="3297380">you're</span> <span m="3297840">right.</span> <span m="3297950">SNS</span> <span m="3298360">is actually</span> <span m="3298690">much more important.</span> <span m="3298945">Sorry,</span> <span m="3299200">yeah.</span> <span m="3300235">[INAUDIBLE]</span> <span m="3301555">SNS</span> <span m="3301830">is</span> <span m="3302280">actually</span> <span m="3302540">much</span> <span m="3302720">more</span> <span m="3302850">important.</span> <span m="3303070">Because</span> <span m="3303400">SNS is</span> <span m="3303750">how</span> <span m="3303880">you know that you're</span> <span m="3304371">talking</span> <span m="3304534">to</span> <span m="3304698">the</span> <span m="3304862">right guy.</span> </p>
<p><span m="3308790">The</span> <span m="3308990">problem</span> <span m="3309260">is</span> <span m="3309410">that</span> <span m="3311030">there's</span> <span m="3311290">no</span> <span m="3311500">real</span> <span m="3311770">bound</span> <span m="3312075">on the size</span> <span m="3312380">of</span> <span m="3312640">this</span> <span m="3312840">table.</span> <span m="3313710">So</span> <span m="3313810">you</span> <span m="3314340">might</span> <span m="3314540">get</span> <span m="3314760">packets</span> <span m="3315130">from</span> <span m="3315270">some</span> <span m="3315730">machine.</span> <span m="3316910">You don't</span> <span m="3317090">even know</span> <span m="3317480">who</span> <span m="3317560">sent it.</span> <span m="3317650">You just get a</span> <span m="3317980">packet that</span> <span m="3318240">looks</span> <span m="3318430">like</span> <span m="3318560">this</span> <span m="3318690">with</span> <span m="3319000">a</span> <span m="3319460">source</span> <span m="3319810">address</span> <span m="3320160">that</span> <span m="3320320">claims to be</span> <span m="3320673">C.</span> </p>
<p><span m="3321610">And</span> <span m="3321950">in order</span> <span m="3322290">to</span> <span m="3322570">potentially</span> <span m="3323040">accept</span> <span m="3323675">a</span> <span m="3323960">connection</span> <span m="3324420">later</span> <span m="3324730">from</span> <span m="3324930">this</span> <span m="3325330">IP</span> <span m="3325670">address,</span> <span m="3326140">you</span> <span m="3326230">have</span> <span m="3326480">to</span> <span m="3326900">create</span> <span m="3327170">this</span> <span m="3327270">table</span> <span m="3327710">entry.</span> <span m="3328435">And</span> <span m="3329950">these</span> <span m="3330120">table</span> <span m="3330390">entries</span> <span m="3330660">are</span> <span m="3330830">somewhat</span> <span m="3331230">long lived.</span> <span m="3331680">Because</span> <span m="3332150">maybe</span> <span m="3332470">someone is</span> <span m="3332790">connecting</span> <span m="3332846">to</span> <span m="3332902">you</span> <span m="3332958">from</span> <span m="3333014">a</span> <span m="3333070">really</span> <span m="3333345">far</span> <span m="3333620">away</span> <span m="3334010">place.</span> <span m="3334346">There's</span> <span m="3334682">lots of</span> <span m="3335020">packet</span> <span m="3335330">loss.</span> <span m="3335690">It</span> <span m="3335840">might</span> <span m="3336090">be</span> <span m="3336730">not for</span> <span m="3338570">maybe</span> <span m="3338660">a</span> <span m="3338960">minute</span> <span m="3339200">until</span> <span m="3339660">someone</span> <span m="3340090">finishes</span> <span m="3340340">this</span> <span m="3340740">TCP</span> <span m="3341240">handshake</span> <span m="3341510">in the</span> <span m="3341780">worst</span> <span m="3342060">case.</span> </p>
<p><span m="3342730">So</span> <span m="3343070">you</span> <span m="3343190">have</span> <span m="3343550">to store</span> <span m="3343830">this</span> <span m="3344020">state</span> <span m="3344580">in</span> <span m="3344800">your</span> <span m="3344980">TCP</span> <span m="3345100">stack</span> <span m="3345710">for</span> <span m="3346000">a</span> <span m="3346070">relatively</span> <span m="3346365">long</span> <span m="3346660">time.</span> <span m="3347980">And</span> <span m="3348070">there's</span> <span m="3348250">no</span> <span m="3348400">way</span> <span m="3348640">to</span> <span m="3349470">guess</span> <span m="3349760">whether</span> <span m="3350030">this</span> <span m="3350230">is</span> <span m="3350350">a</span> <span m="3350630">valid</span> <span m="3350930">connection</span> <span m="3351280">or</span> <span m="3351580">not.</span> <span m="3352640">So</span> <span m="3352890">one</span> <span m="3353430">denial of</span> <span m="3353770">service</span> <span m="3354010">attack</span> <span m="3354300">that</span> <span m="3355000">people</span> <span m="3355240">discovered</span> <span m="3355710">against</span> <span m="3356430">most</span> <span m="3356710">TCP</span> <span m="3356990">stacks</span> <span m="3357530">is</span> <span m="3357790">to</span> <span m="3358050">simply</span> <span m="3358340">send</span> <span m="3358690">lots</span> <span m="3358865">of</span> <span m="3359040">packets</span> <span m="3359380">like</span> <span m="3359600">this.</span> </p>
<p><span m="3361670">So</span> <span m="3362530">if</span> <span m="3362670">I'm</span> <span m="3362870">an</span> <span m="3362940">attacker,</span> <span m="3363630">then</span> <span m="3363930">I'll</span> <span m="3364090">just send</span> <span m="3364180">lots of</span> <span m="3364430">SYN</span> <span m="3364850">packets</span> <span m="3364980">to a</span> <span m="3365200">particular</span> <span m="3365580">server</span> <span m="3365840">and</span> <span m="3366150">get</span> <span m="3366340">it</span> <span m="3366730">to fill</span> <span m="3366860">up</span> <span m="3367255">its</span> <span m="3367650">table.</span> <span m="3368930">And</span> <span m="3369630">the</span> <span m="3369870">problem</span> <span m="3370180">is</span> <span m="3370490">that</span> <span m="3371280">in</span> <span m="3371662">the</span> <span m="3372044">best</span> <span m="3372426">case,</span> <span m="3372810">maybe the</span> <span m="3373145">attacker</span> <span m="3373312">just</span> <span m="3373480">always</span> <span m="3373710">uses</span> <span m="3373870">the</span> <span m="3374080">same</span> <span m="3374230">source</span> <span m="3374480">IP</span> <span m="3375410">address.</span> </p>
<p><span m="3376720">In</span> <span m="3376760">that</span> <span m="3376950">case,</span> <span m="3377860">you</span> <span m="3377950">can</span> <span m="3378060">just</span> <span m="3378240">say,</span> <span m="3378570">well,</span> <span m="3378800">every</span> <span m="3379270">client</span> <span m="3379700">machine</span> <span m="3379930">is</span> <span m="3380020">allowed</span> <span m="3380080">two</span> <span m="3380930">entries</span> <span m="3381130">in</span> <span m="3381360">my table,</span> <span m="3381710">or</span> <span m="3381890">something</span> <span m="3382090">like</span> <span m="3382270">this.</span> <span m="3383340">And</span> <span m="3383700">then</span> <span m="3383730">the</span> <span m="3384060">attacker can</span> <span m="3384550">use</span> <span m="3384700">up</span> <span m="3384890">two</span> <span m="3385010">table</span> <span m="3385210">entries</span> <span m="3385580">but</span> <span m="3385730">not</span> <span m="3385870">much</span> <span m="3386050">more.</span> <span m="3386745">The</span> <span m="3387100">problem,</span> <span m="3387375">of course,</span> <span m="3387650">is</span> <span m="3388040">that</span> <span m="3388430">the</span> <span m="3388930">attacker</span> <span m="3389100">can fake these</span> <span m="3389430">client IP</span> <span m="3389840">addresses,</span> <span m="3390125">make</span> <span m="3390410">them</span> <span m="3390900">look</span> <span m="3391270">random.</span> <span m="3392250">And</span> <span m="3392390">then for the</span> <span m="3392840">server,</span> <span m="3393100">it's</span> <span m="3393190">going</span> <span m="3393290">to</span> <span m="3393330">be</span> <span m="3393430">very</span> <span m="3393630">difficult</span> <span m="3393980">to</span> <span m="3394040">distinguish</span> <span m="3394530">whether</span> <span m="3394730">this is</span> <span m="3395040">an</span> <span m="3395320">attacker</span> <span m="3395600">trying to</span> <span m="3395880">connect</span> <span m="3396000">to</span> <span m="3396350">me</span> <span m="3396800">or</span> <span m="3396990">some</span> <span m="3397345">client I've never</span> <span m="3397700">heard of</span> <span m="3398080">before.</span> </p>
<p><span m="3398510">So</span> <span m="3399000">if</span> <span m="3399280">you're</span> <span m="3399410">some</span> <span m="3399750">website</span> <span m="3400190">that's</span> <span m="3400310">supposed to</span> <span m="3400700">accept</span> <span m="3401150">connections</span> <span m="3401320">from</span> <span m="3401660">anywhere in</span> <span m="3401810">the</span> <span m="3402280">world,</span> <span m="3402850">this is</span> <span m="3403280">going to be a big</span> <span m="3403710">problem.</span> <span m="3404275">Because</span> <span m="3404630">either</span> <span m="3405010">you</span> <span m="3405390">deny access</span> <span m="3405760">to</span> <span m="3406250">everyone,</span> <span m="3406870">or</span> <span m="3407670">you</span> <span m="3408080">have</span> <span m="3408270">a</span> <span m="3408330">store</span> <span m="3408610">state</span> <span m="3408960">for</span> <span m="3409280">all</span> <span m="3409440">these</span> <span m="3410190">mostly</span> <span m="3410580">fake</span> <span m="3411080">connection</span> <span m="3411540">attempts.</span> <span m="3412716">Does that</span> <span m="3413110">make</span> <span m="3413250">sense?</span> </p>
<p><span m="3415020">So</span> <span m="3415130">this</span> <span m="3415190">is</span> <span m="3415250">a</span> <span m="3415310">bit</span> <span m="3415370">of</span> <span m="3415430">a</span> <span m="3415490">problem</span> <span m="3415880">for</span> <span m="3416315">TCP,</span> <span m="3416750">and</span> <span m="3417100">in</span> <span m="3417230">fact</span> <span m="3417480">for</span> <span m="3417990">most</span> <span m="3418610">protocols</span> <span m="3419530">that</span> <span m="3420800">allow</span> <span m="3420900">some</span> <span m="3421240">sort of</span> <span m="3421610">connection</span> <span m="3421990">initiation,</span> <span m="3422610">and</span> <span m="3422680">the</span> <span m="3422760">server</span> <span m="3423200">has to store</span> <span m="3423690">state.</span> <span m="3424970">So</span> <span m="3425220">there's</span> <span m="3425420">some</span> <span m="3425760">fixes.</span> <span m="3425890">We'll</span> <span m="3426120">talk</span> <span m="3426270">about in</span> <span m="3426460">a</span> <span m="3426520">second</span> <span m="3427170">what</span> <span m="3427490">workaround</span> <span m="3427910">TCP</span> <span m="3428330">implements</span> <span m="3428880">to</span> <span m="3428970">try</span> <span m="3429160">to</span> <span m="3429280">deal with</span> <span m="3429590">this</span> <span m="3429900">problem.</span> <span m="3430285">This</span> <span m="3430670">is</span> <span m="3430850">called</span> <span m="3431100">SYN</span> <span m="3431550">flooding</span> <span m="3432290">in</span> <span m="3432670">TCP.</span> </p>
<p><span m="3433830">But</span> <span m="3434000">in</span> <span m="3434140">general,</span> <span m="3434580">this</span> <span m="3434630">is</span> <span m="3434950">a problem that's</span> <span m="3435270">worth</span> <span m="3435460">knowing</span> <span m="3436050">about</span> <span m="3436420">and</span> <span m="3436720">trying</span> <span m="3437030">to</span> <span m="3437220">avoid</span> <span m="3437870">in</span> <span m="3438050">any</span> <span m="3438340">protocol</span> <span m="3438560">you</span> <span m="3438690">design</span> <span m="3439090">on top</span> <span m="3439410">as</span> <span m="3439870">well.</span> <span m="3439975">So</span> <span m="3440080">you</span> <span m="3440240">want</span> <span m="3440350">to</span> <span m="3440390">make</span> <span m="3440560">sure</span> <span m="3441195">that</span> <span m="3441470">the</span> <span m="3441580">server</span> <span m="3441850">doesn't</span> <span m="3442120">have to</span> <span m="3442430">keep</span> <span m="3442620">state</span> <span m="3443700">until</span> <span m="3444150">it</span> <span m="3444400">can</span> <span m="3444520">actually</span> <span m="3444830">authenticate</span> <span m="3445130">and</span> <span m="3445490">identify,</span> <span m="3445745">who is</span> <span m="3446000">the</span> <span m="3446410">client?</span> </p>
<p><span m="3447560">Because</span> <span m="3447830">by that time,</span> <span m="3448100">if</span> <span m="3448170">you've</span> <span m="3448240">identified</span> <span m="3448520">who</span> <span m="3449010">the</span> <span m="3449290">client</span> <span m="3449630">is, you've</span> <span m="3449860">authenticated</span> <span m="3449990">them</span> <span m="3450520">somehow,</span> <span m="3451340">then</span> <span m="3451406">you</span> <span m="3451473">can</span> <span m="3451540">actually</span> <span m="3451940">make a</span> <span m="3452130">decision,</span> <span m="3452290">well,</span> <span m="3452710">every</span> <span m="3452980">client</span> <span m="3453400">is</span> <span m="3453550">allowed</span> <span m="3453610">to</span> <span m="3453970">only</span> <span m="3454190">connect</span> <span m="3454515">once,</span> <span m="3455160">or</span> <span m="3455240">something.</span> <span m="3455920">And</span> <span m="3456200">then I'm</span> <span m="3456310">not</span> <span m="3456490">going</span> <span m="3456630">to keep</span> <span m="3456790">more</span> <span m="3457010">state.</span> </p>
<p><span m="3457780">Here,</span> <span m="3457900">the</span> <span m="3458020">problem</span> <span m="3458360">is</span> <span m="3458740">you're</span> <span m="3459870">guaranteeing</span> <span m="3460240">that</span> <span m="3460605">you're</span> <span m="3460970">storing</span> <span m="3461240">state</span> <span m="3461900">before</span> <span m="3462230">you</span> <span m="3462320">have</span> <span m="3462570">any</span> <span m="3462865">idea</span> <span m="3462889">who</span> <span m="3462914">it</span> <span m="3462938">is</span> <span m="3462963">that</span> <span m="3463061">is</span> <span m="3463160">connecting</span> <span m="3463455">to you.</span> <span m="3466670">So</span> <span m="3467010">let's look at</span> <span m="3467360">how</span> <span m="3467710">you</span> <span m="3467890">can</span> <span m="3468040">actually</span> <span m="3468330">solve</span> <span m="3468920">this</span> <span m="3469980">SYN</span> <span m="3470350">flooding</span> <span m="3470720">attack</span> <span m="3471100">where</span> <span m="3472030">the</span> <span m="3472150">server</span> <span m="3472690">accumulates</span> <span m="3473070">lots of</span> <span m="3473480">state.</span> </p>
<p><span m="3474850">So</span> <span m="3475180">of course,</span> <span m="3475410">if</span> <span m="3475680">you could</span> <span m="3475950">change</span> <span m="3476470">TCP</span> <span m="3477170">again,</span> <span m="3477530">you could</span> <span m="3477990">fix</span> <span m="3478063">this</span> <span m="3478136">pretty</span> <span m="3478210">easily</span> <span m="3478660">by</span> <span m="3480030">using</span> <span m="3480290">cryptography</span> <span m="3480810">or</span> <span m="3481250">something</span> <span m="3481820">or</span> <span m="3482300">changing</span> <span m="3482780">exactly</span> <span m="3483140">who's</span> <span m="3483540">responsible</span> <span m="3483925">for</span> <span m="3484310">storing what</span> <span m="3484670">state.</span> <span m="3485130">The</span> <span m="3485590">problem is</span> <span m="3485970">we</span> <span m="3486210">have</span> <span m="3486320">TCP</span> <span m="3486540">as</span> <span m="3486800">is.</span> <span m="3487100">And</span> <span m="3488390">could</span> <span m="3488500">we</span> <span m="3488690">fix</span> <span m="3488950">this</span> <span m="3489060">problem</span> <span m="3489530">without</span> <span m="3490090">changing</span> <span m="3490450">the</span> <span m="3490830">TCP wire</span> <span m="3491310">protocol?</span> <span m="3492860">So</span> <span m="3492870">this is,</span> <span m="3493120">again,</span> <span m="3493600">an</span> <span m="3493710">exercise</span> <span m="3493970">in</span> <span m="3494230">trying</span> <span m="3494580">to</span> <span m="3494980">figure</span> <span m="3495200">out,</span> <span m="3495505">well, what</span> <span m="3495810">exactly</span> <span m="3496710">tricks</span> <span m="3497180">we could</span> <span m="3497555">play</span> <span m="3497930">or</span> <span m="3498120">exactly</span> <span m="3498400">what</span> <span m="3498720">assumptions</span> <span m="3499150">we</span> <span m="3499620">could</span> <span m="3499730">relax</span> <span m="3500250">and</span> <span m="3500390">still</span> <span m="3501470">stick</span> <span m="3501750">to the</span> <span m="3502030">TCP</span> <span m="3502290">header</span> <span m="3502510">format</span> <span m="3502951">and other</span> <span m="3503392">things.</span> </p>
<p><span m="3504715">And</span> <span m="3505550">the</span> <span m="3505820">trick</span> <span m="3506610">is</span> <span m="3506790">to</span> <span m="3507300">in fact</span> <span m="3507590">figure</span> <span m="3507910">out</span> <span m="3508060">a</span> <span m="3508380">clever</span> <span m="3508640">way</span> <span m="3508900">to</span> <span m="3509040">make</span> <span m="3509240">the</span> <span m="3509330">server</span> <span m="3509640">stateless</span> <span m="3510700">without</span> <span m="3511270">having</span> <span m="3511500">to--</span> <span m="3511880">so</span> <span m="3512246">the</span> <span m="3512612">server isn't</span> <span m="3512980">going to</span> <span m="3513470">have</span> <span m="3513670">to keep this</span> <span m="3513930">table</span> <span m="3514270">around</span> <span m="3514920">in</span> <span m="3515080">memory.</span> <span m="3516460">And</span> <span m="3516560">the way we're</span> <span m="3516810">going</span> <span m="3516930">to</span> <span m="3517030">do</span> <span m="3517210">this</span> <span m="3517840">is</span> <span m="3518310">by</span> <span m="3519050">carefully</span> <span m="3519730">choosing</span> <span m="3520470">SMS.</span> <span m="3522140">Instead</span> <span m="3522450">of</span> <span m="3522530">using</span> <span m="3522850">this</span> <span m="3522970">formula</span> <span m="3523305">we</span> <span m="3523640">were</span> <span m="3523770">looking</span> <span m="3523990">at</span> <span m="3524150">before,</span> <span m="3524495">where</span> <span m="3524840">we were</span> <span m="3525180">to</span> <span m="3525480">add this</span> <span m="3525700">function,</span> <span m="3527210">we're</span> <span m="3527650">instead</span> <span m="3528160">going</span> <span m="3528280">to</span> <span m="3529630">choose</span> <span m="3529915">this</span> <span m="3530810">sequence</span> <span m="3531170">number</span> <span m="3531380">in a</span> <span m="3531560">different</span> <span m="3531920">way.</span> </p>
<p><span m="3532710">And</span> <span m="3534300">I'll</span> <span m="3534670">give you</span> <span m="3534850">exactly</span> <span m="3535270">the</span> <span m="3535420">formula.</span> <span m="3535540">And</span> <span m="3535660">then</span> <span m="3535780">we'll</span> <span m="3535900">talk</span> <span m="3536100">about</span> <span m="3536380">why</span> <span m="3536640">this</span> <span m="3536830">is</span> <span m="3536950">actually</span> <span m="3537280">interesting</span> <span m="3537510">and</span> <span m="3537710">what</span> <span m="3538060">nice</span> <span m="3538200">properties it</span> <span m="3538690">has.</span> <span m="3539530">So</span> <span m="3539780">if</span> <span m="3539990">the</span> <span m="3540100">server</span> <span m="3540410">detects</span> <span m="3540490">that it's</span> <span m="3541020">under</span> <span m="3541260">this</span> <span m="3541480">kind</span> <span m="3541700">of</span> <span m="3541790">attack,</span> <span m="3542650">it's</span> <span m="3542800">going</span> <span m="3542890">to</span> <span m="3542960">switch</span> <span m="3543230">into</span> <span m="3543350">this mode</span> <span m="3543650">where it</span> <span m="3544060">chooses</span> <span m="3544880">SNS</span> <span m="3546890">using</span> <span m="3547120">this</span> <span m="3547360">formula</span> <span m="3548590">of</span> <span m="3551782">applying</span> <span m="3552510">basically</span> <span m="3552680">the</span> <span m="3552920">same</span> <span m="3553350">or</span> <span m="3553550">similar</span> <span m="3554050">kind</span> <span m="3554210">of</span> <span m="3554320">function</span> <span m="3554650">F</span> <span m="3554900">we</span> <span m="3554980">saw</span> <span m="3555130">before.</span> <span m="3558470">And</span> <span m="3558730">what it's</span> <span m="3558900">going</span> <span m="3559050">to</span> <span m="3559100">apply</span> <span m="3559460">it to</span> <span m="3560100">is</span> <span m="3560470">the</span> <span m="3561220">source</span> <span m="3561540">IP,</span> <span m="3563150">destination</span> <span m="3563470">IP,</span> <span m="3563930">the</span> <span m="3564240">same things</span> <span m="3564830">as</span> <span m="3565100">before,</span> <span m="3565652">source</span> <span m="3566104">port,</span> <span m="3568820">destination</span> <span m="3569170">port,</span> <span m="3570100">and</span> <span m="3570620">also</span> <span m="3571320">timestamp,</span> <span m="3575920">and</span> <span m="3576870">also</span> <span m="3577340">a key in</span> <span m="3577570">here</span> <span m="3577890">as well.</span> </p>
<p><span m="3579420">And</span> <span m="3579830">we're</span> <span m="3579950">going</span> <span m="3580040">to</span> <span m="3580295">concatenate</span> <span m="3580550">it</span> <span m="3581120">with</span> <span m="3582740">a</span> <span m="3582980">timestamp</span> <span m="3583025">as</span> <span m="3583070">well.</span> <span m="3585430">So</span> <span m="3586060">this</span> <span m="3586126">timestamp</span> <span m="3586193">is</span> <span m="3586260">going</span> <span m="3586380">to</span> <span m="3586420">be</span> <span m="3586550">fairly</span> <span m="3587000">coarse</span> <span m="3587300">grained.</span> <span m="3587665">It's</span> <span m="3588030">going to</span> <span m="3588380">go in order</span> <span m="3588740">of minutes.</span> <span m="3589160">So</span> <span m="3589870">every</span> <span m="3590120">minute, the</span> <span m="3590550">timestamp</span> <span m="3591070">ticks</span> <span m="3591190">off</span> <span m="3591310">by</span> <span m="3591600">one.</span> <span m="3592290">It's a</span> <span m="3592635">very</span> <span m="3592980">coarse grained</span> <span m="3593680">time.</span> </p>
<p><span m="3594560">And</span> <span m="3596770">there's</span> <span m="3596850">probably</span> <span m="3597190">some</span> <span m="3597390">split</span> <span m="3598200">between</span> <span m="3599070">this</span> <span m="3599190">part of</span> <span m="3599600">the</span> <span m="3599780">header and</span> <span m="3600060">this</span> <span m="3600200">part</span> <span m="3600660">of the</span> <span m="3601000">header.</span> <span m="3601270">This</span> <span m="3601535">timestamp</span> <span m="3601667">doesn't</span> <span m="3601800">need a</span> <span m="3601850">whole</span> <span m="3602340">lot of</span> <span m="3602620">bits.</span> <span m="3602900">So</span> <span m="3603950">I</span> <span m="3604320">forget</span> <span m="3604560">exactly</span> <span m="3604890">what</span> <span m="3605150">this</span> <span m="3605310">protocol</span> <span m="3605880">does</span> <span m="3606340">in</span> <span m="3606650">real</span> <span m="3606910">machines.</span> <span m="3607000">But you</span> <span m="3607350">could</span> <span m="3607490">easily</span> <span m="3607760">imagine</span> <span m="3608420">maybe</span> <span m="3608800">using</span> <span m="3609455">8 bits.</span> <span m="3609730">For the</span> <span m="3610190">timestamp,</span> <span m="3610450">I'm</span> <span m="3610855">going to be using</span> <span m="3611260">24</span> <span m="3611680">bits</span> <span m="3612100">for</span> <span m="3612300">this</span> <span m="3612790">chunk</span> <span m="3613465">of</span> <span m="3613770">the</span> <span m="3613940">sequence</span> <span m="3614200">number.</span> </p>
<p><span m="3615920">All</span> <span m="3616180">right,</span> <span m="3616850">so</span> <span m="3617270">why</span> <span m="3617530">is</span> <span m="3617790">this</span> <span m="3618070">a</span> <span m="3618160">good</span> <span m="3618350">plan?</span> <span m="3618830">What's</span> <span m="3619300">going on</span> <span m="3619500">here?</span> <span m="3619850">Why</span> <span m="3620200">this weird</span> <span m="3620540">formula?</span> <span m="3621990">So</span> <span m="3622100">I</span> <span m="3622150">think</span> <span m="3622570">you</span> <span m="3622610">have to</span> <span m="3622650">remember,</span> <span m="3623130">one</span> <span m="3623370">was</span> <span m="3623500">the</span> <span m="3623730">property</span> <span m="3624210">that we</span> <span m="3624285">were</span> <span m="3624360">trying</span> <span m="3624590">to</span> <span m="3624630">achieve</span> <span m="3625120">of the</span> <span m="3625200">sequence</span> <span m="3625600">number.</span> <span m="3626920">So</span> <span m="3627180">there's</span> <span m="3627700">two</span> <span m="3627890">things</span> <span m="3628220">going on.</span> <span m="3628580">One</span> <span m="3628870">is there's</span> <span m="3629170">this</span> <span m="3629340">defense</span> <span m="3629740">against</span> <span m="3630100">duplicated</span> <span m="3630536">packets</span> <span m="3631844">that</span> <span m="3632280">we</span> <span m="3632380">were</span> <span m="3632500">trying</span> <span m="3632760">to</span> <span m="3632820">achieve</span> <span m="3633240">by--</span> <span m="3633660">maybe</span> <span m="3634080">the</span> <span m="3634567">formula is still</span> <span m="3635054">here.</span> <span m="3635541">Nope--</span> <span m="3636030">oh,</span> <span m="3636330">yeah, yeah,</span> <span m="3636630">here.</span> </p>
<p><span m="3637030">Right,</span> <span m="3637190">so</span> <span m="3637750">just</span> <span m="3637880">to</span> <span m="3637950">compare</span> <span m="3638260">these</span> <span m="3638460">guys--</span> <span m="3638730">so</span> <span m="3639210">when</span> <span m="3639430">we're</span> <span m="3639800">not</span> <span m="3640210">under</span> <span m="3640590">attack,</span> <span m="3640930">we</span> <span m="3641440">were</span> <span m="3641590">previously</span> <span m="3642100">maintaining</span> <span m="3642590">this</span> <span m="3642720">old</span> <span m="3643060">style</span> <span m="3643370">sequence</span> <span m="3643790">number</span> <span m="3644620">scheme</span> <span m="3645390">to</span> <span m="3645560">prevent</span> <span m="3646020">duplicate</span> <span m="3646270">packets</span> <span m="3646680">from</span> <span m="3646890">previous</span> <span m="3647220">connections,</span> <span m="3647510">all this good</span> <span m="3647800">stuff.</span> <span m="3649860">It turns out</span> <span m="3650020">people</span> <span m="3650340">couldn't</span> <span m="3650650">figure</span> <span m="3650900">out</span> <span m="3651120">a way</span> <span m="3651235">to</span> <span m="3651350">defend</span> <span m="3651730">against</span> <span m="3652080">these</span> <span m="3652330">kinds</span> <span m="3652670">of</span> <span m="3652880">SYN</span> <span m="3653340">flooding attacks</span> <span m="3653800">without</span> <span m="3654160">giving</span> <span m="3654430">up</span> <span m="3654590">on</span> <span m="3654700">this</span> <span m="3654870">property,</span> <span m="3655990">so</span> <span m="3656130">basically</span> <span m="3656260">saying,</span> <span m="3656620">well,</span> <span m="3657170">here's</span> <span m="3657370">one</span> <span m="3657740">plan that works</span> <span m="3658110">well</span> <span m="3658390">in some</span> <span m="3658670">situations.</span> <span m="3659670">Here's a</span> <span m="3659840">different</span> <span m="3660010">plan where</span> <span m="3660240">we'll</span> <span m="3660750">give</span> <span m="3660960">up</span> <span m="3661460">on</span> <span m="3661610">that</span> <span m="3661800">ISN</span> <span m="3662330">old</span> <span m="3662530">style</span> <span m="3662910">component.</span> </p>
<p><span m="3663760">And</span> <span m="3663940">instead,</span> <span m="3664425">we'll</span> <span m="3664710">focus</span> <span m="3665120">on</span> <span m="3665630">just</span> <span m="3666120">ensuring</span> <span m="3666890">that</span> <span m="3668150">if</span> <span m="3668360">someone</span> <span m="3668870">presents</span> <span m="3669150">us</span> <span m="3669430">this</span> <span m="3669910">sequence</span> <span m="3670330">number</span> <span m="3670600">S</span> <span m="3671770">in</span> <span m="3672050">response</span> <span m="3672305">to a packet,</span> <span m="3673460">like</span> <span m="3673580">here,</span> <span m="3674840">then</span> <span m="3675130">we</span> <span m="3675260">know</span> <span m="3675825">it</span> <span m="3675900">must've</span> <span m="3676170">been</span> <span m="3676330">the</span> <span m="3676400">right</span> <span m="3676700">client.</span> <span m="3678150">So</span> <span m="3679030">remember</span> <span m="3679300">that in</span> <span m="3679595">order</span> <span m="3679742">to</span> <span m="3679890">prevent</span> <span m="3681240">IP</span> <span m="3681610">spoofing</span> <span m="3681990">attacks,</span> <span m="3682710">we sort</span> <span m="3682890">of</span> <span m="3683090">rely</span> <span m="3683140">on this</span> <span m="3683420">SNS</span> <span m="3683570">value.</span> <span m="3683850">So</span> <span m="3684130">if</span> <span m="3684583">the</span> <span m="3685490">server</span> <span m="3686160">sends</span> <span m="3686340">this</span> <span m="3686400">SNS</span> <span m="3686990">value</span> <span m="3687410">to some client,</span> <span m="3687860">then</span> <span m="3688310">hopefully</span> <span m="3689080">only</span> <span m="3689400">that client</span> <span m="3689665">can send</span> <span m="3689930">us</span> <span m="3690020">back the</span> <span m="3690140">correct</span> <span m="3690470">SNS</span> <span m="3690800">value,</span> <span m="3691237">finish</span> <span m="3691674">establishing</span> <span m="3692111">the</span> <span m="3692548">connection.</span> </p>
<p><span m="3692985">And</span> <span m="3693422">this is</span> <span m="3693860">why you</span> <span m="3694040">had</span> <span m="3694120">to</span> <span m="3694570">store it</span> <span m="3694640">in</span> <span m="3694950">this</span> <span m="3695060">table</span> <span m="3695120">over</span> <span m="3695470">here.</span> <span m="3696220">Because</span> <span m="3696390">otherwise,</span> <span m="3697070">how</span> <span m="3697360">do</span> <span m="3697430">you</span> <span m="3697500">know</span> <span m="3697730">if this</span> <span m="3697980">is</span> <span m="3698110">a</span> <span m="3698430">real</span> <span m="3698700">response</span> <span m="3699025">or a fake</span> <span m="3699350">response?</span> <span m="3700610">And</span> <span m="3700950">the</span> <span m="3701050">reason</span> <span m="3701320">for using</span> <span m="3701450">this</span> <span m="3701770">function</span> <span m="3702100">F</span> <span m="3702340">here</span> <span m="3702660">is</span> <span m="3703000">that</span> <span m="3703680">now</span> <span m="3704060">we</span> <span m="3704200">can</span> <span m="3704810">maybe</span> <span m="3705110">not</span> <span m="3705540">store</span> <span m="3705760">this</span> <span m="3705950">table</span> <span m="3706300">in</span> <span m="3706430">memory.</span> <span m="3707670">And</span> <span m="3707790">instead,</span> <span m="3708900">when</span> <span m="3709160">a connection</span> <span m="3709963">attempt</span> <span m="3710870">arrives</span> <span m="3711320">here,</span> <span m="3711760">we're</span> <span m="3711923">going</span> <span m="3712086">to</span> <span m="3712250">compute</span> <span m="3712630">SNS</span> <span m="3713110">according</span> <span m="3713480">to</span> <span m="3713590">this</span> <span m="3713830">formula</span> <span m="3714170">over</span> <span m="3714360">here</span> <span m="3715110">and</span> <span m="3715230">just</span> <span m="3715440">send it</span> <span m="3715770">back</span> <span m="3716120">to</span> <span m="3716330">whatever</span> <span m="3716780">client</span> <span m="3717210">pretends to</span> <span m="3717620">have</span> <span m="3717910">connected to us.</span> </p>
<p><span m="3719250">And</span> <span m="3719700">then we'll</span> <span m="3719990">forget</span> <span m="3720260">all</span> <span m="3720470">about this</span> <span m="3720730">connection.</span> <span m="3721960">And</span> <span m="3722220">then if this</span> <span m="3722480">third</span> <span m="3722930">packet</span> <span m="3723180">eventually</span> <span m="3723580">comes</span> <span m="3723920">through,</span> <span m="3725040">and</span> <span m="3725510">its</span> <span m="3725730">SNS</span> <span m="3725870">value</span> <span m="3726460">here</span> <span m="3727290">matches</span> <span m="3727830">what</span> <span m="3728040">we would</span> <span m="3728200">expect</span> <span m="3728590">to</span> <span m="3728660">see,</span> <span m="3729230">then</span> <span m="3729550">we'll</span> <span m="3729830">say,</span> <span m="3729980">oh</span> <span m="3730120">yeah,</span> <span m="3730430">this</span> <span m="3730620">must've</span> <span m="3731040">been</span> <span m="3731520">someone</span> <span m="3731990">got</span> <span m="3732090">our</span> <span m="3732360">response from</span> <span m="3732615">step</span> <span m="3732870">two</span> <span m="3733310">and finally</span> <span m="3733750">sent it back</span> <span m="3734190">to us.</span> </p>
<p><span m="3736390">And</span> <span m="3736720">now we finally commit</span> <span m="3737050">after step</span> <span m="3737270">three</span> <span m="3737495">to</span> <span m="3737720">storing</span> <span m="3738630">a</span> <span m="3738690">real</span> <span m="3738980">entry for this</span> <span m="3739260">TCP</span> <span m="3739691">connection</span> <span m="3740122">in</span> <span m="3740553">memory.</span> <span m="3741846">So</span> <span m="3742280">this is</span> <span m="3742700">a way</span> <span m="3742970">to</span> <span m="3743240">sort</span> <span m="3743333">of</span> <span m="3743426">defer</span> <span m="3743520">the</span> <span m="3743800">storage</span> <span m="3743900">of</span> <span m="3744000">this</span> <span m="3744660">state</span> <span m="3745350">at</span> <span m="3745490">the</span> <span m="3745560">server</span> <span m="3746470">by</span> <span m="3747120">requiring</span> <span m="3747710">the</span> <span m="3747800">server,</span> <span m="3748260">the</span> <span m="3748380">client,</span> <span m="3748820">to</span> <span m="3749220">echo back this exact</span> <span m="3749620">value.</span> <span m="3750420">And</span> <span m="3750550">by</span> <span m="3751020">constructing it</span> <span m="3751160">in</span> <span m="3751280">this</span> <span m="3751710">careful</span> <span m="3752000">way,</span> <span m="3752730">we</span> <span m="3752840">can</span> <span m="3752910">actually</span> <span m="3753230">check</span> <span m="3753610">whether</span> <span m="3753830">the</span> <span m="3754050">client</span> <span m="3754400">just</span> <span m="3754590">made up</span> <span m="3755020">this</span> <span m="3755450">value,</span> <span m="3755790">or if</span> <span m="3756150">it's</span> <span m="3756280">the</span> <span m="3756710">real thing</span> <span m="3757182">we're</span> <span m="3757654">expecting.</span> <span m="3758598">Does that</span> <span m="3759070">make</span> <span m="3759542">sense?</span> </p>
<p><span m="3760486">AUDIENCE: [INAUDIBLE]</span> <span m="3761430">SNC</span> <span m="3762374">[INAUDIBLE]?</span> </p>
<p><span m="3763320">PROFESSOR: Yeah,</span> <span m="3763655">so</span> <span m="3763990">SNC now,</span> <span m="3764310">we</span> <span m="3764450">basically</span> <span m="3764840">don't</span> <span m="3765000">store</span> <span m="3765490">it.</span> <span m="3766620">It's</span> <span m="3767030">maybe</span> <span m="3767310">not</span> <span m="3767610">great.</span> <span m="3768570">But</span> <span m="3769739">so</span> <span m="3770218">it</span> <span m="3770697">is.</span> <span m="3772134">So</span> <span m="3772613">in fact,</span> <span m="3773092">I</span> <span m="3773571">guess</span> <span m="3774050">what really</span> <span m="3774140">happens</span> <span m="3774470">is</span> <span m="3775515">in--</span> <span m="3778980">I</span> <span m="3779280">didn't show</span> <span m="3779430">it here.</span> <span m="3779650">But</span> <span m="3779980">there's</span> <span m="3780430">probably</span> <span m="3780820">going to</span> <span m="3781210">be</span> <span m="3782800">sort of</span> <span m="3783060">a</span> <span m="3783190">null</span> <span m="3783320">data</span> <span m="3784760">field</span> <span m="3785000">here</span> <span m="3785435">that</span> <span m="3785870">says this</span> <span m="3786170">packet</span> <span m="3786500">has</span> <span m="3786710">no</span> <span m="3786870">data.</span> <span m="3787560">But</span> <span m="3787880">it still</span> <span m="3788290">includes</span> <span m="3788340">the</span> <span m="3788390">sequence</span> <span m="3788800">number</span> <span m="3789050">SNC</span> <span m="3790220">just</span> <span m="3790680">because</span> <span m="3790770">there's</span> <span m="3791290">a</span> <span m="3791750">field</span> <span m="3792080">for</span> <span m="3792300">it.</span> </p>
<p><span m="3792790">So</span> <span m="3793120">this</span> <span m="3793227">is</span> <span m="3793335">how</span> <span m="3793442">the</span> <span m="3793550">server</span> <span m="3793990">can</span> <span m="3794413">reconstruct what this</span> <span m="3794836">SNC</span> <span m="3795259">value is.</span> <span m="3796530">Because</span> <span m="3796760">the</span> <span m="3796800">client</span> <span m="3797210">is going to</span> <span m="3797620">include</span> <span m="3797705">it</span> <span m="3797790">in this packet</span> <span m="3798190">anyway.</span> <span m="3798970">It wasn't</span> <span m="3799235">relevant</span> <span m="3799500">before.</span> <span m="3799810">But</span> <span m="3799990">it sort of is</span> <span m="3800300">relevant</span> <span m="3800737">now.</span> <span m="3802050">And</span> <span m="3802780">we</span> <span m="3802843">weren't</span> <span m="3802906">going</span> <span m="3803033">to</span> <span m="3803160">check</span> <span m="3803575">it against</span> <span m="3803990">anything.</span> <span m="3804820">But</span> <span m="3805220">it</span> <span m="3806020">turns</span> <span m="3806130">out</span> <span m="3806330">to</span> <span m="3806420">be</span> <span m="3806950">pretty</span> <span m="3807200">much</span> <span m="3807370">good</span> <span m="3807600">enough.</span> </p>
<p><span m="3808210">It has</span> <span m="3808530">some</span> <span m="3808815">unfortunate</span> <span m="3809100">consequences.</span> <span m="3809770">Like</span> <span m="3810216">if this</span> <span m="3810662">is--</span> <span m="3812430">well,</span> <span m="3812830">there's</span> <span m="3813120">some</span> <span m="3813385">complicated</span> <span m="3813650">things you</span> <span m="3813920">might</span> <span m="3814515">abuse</span> <span m="3814830">here.</span> <span m="3815100">But</span> <span m="3815310">it doesn't</span> <span m="3815410">seem to</span> <span m="3815670">be</span> <span m="3815990">that</span> <span m="3816280">bad.</span> <span m="3817330">It</span> <span m="3817710">seems</span> <span m="3817900">certainly</span> <span m="3818180">better</span> <span m="3818560">than</span> <span m="3818730">the</span> <span m="3818810">server</span> <span m="3819370">filling up</span> <span m="3819510">its</span> <span m="3819800">memory</span> <span m="3820210">and</span> <span m="3820360">swapping</span> <span m="3820510">serving</span> <span m="3820660">requests all together.</span> </p>
<p><span m="3823370">And</span> <span m="3823720">then</span> <span m="3824070">we</span> <span m="3824190">don't</span> <span m="3824380">include</span> <span m="3824790">in</span> <span m="3824910">this</span> <span m="3825070">computation.</span> <span m="3825630">Because</span> <span m="3825910">the</span> <span m="3826190">only</span> <span m="3826480">thing</span> <span m="3826690">we</span> <span m="3826960">care</span> <span m="3827100">about</span> <span m="3827290">here</span> <span m="3828110">is</span> <span m="3828570">offloaded</span> <span m="3829070">the</span> <span m="3829425">storage of</span> <span m="3829780">this</span> <span m="3830120">table</span> <span m="3830980">and</span> <span m="3831410">making</span> <span m="3831432">sure</span> <span m="3831455">that</span> <span m="3831477">the</span> <span m="3831500">only</span> <span m="3831710">connections</span> <span m="3832130">that</span> <span m="3832360">eventually</span> <span m="3832520">you</span> <span m="3832640">do</span> <span m="3833030">get</span> <span m="3833250">established</span> <span m="3834290">are</span> <span m="3834680">legitimate</span> <span m="3834950">clients.</span> <span m="3836075">Because</span> <span m="3836450">therefore,</span> <span m="3836815">we</span> <span m="3837180">can say,</span> <span m="3837510">well,</span> <span m="3838110">if</span> <span m="3838520">this</span> <span m="3838630">client</span> <span m="3838965">is</span> <span m="3839300">establishing</span> <span m="3839680">a million connections</span> <span m="3840120">to</span> <span m="3840720">me,</span> <span m="3840990">I'll</span> <span m="3841190">stop accepting</span> <span m="3841600">connections</span> <span m="3841830">from</span> <span m="3842050">him.</span> </p>
<p><span m="3842200">That's easy</span> <span m="3842687">enough, finally.</span> <span m="3844150">The</span> <span m="3844240">problem</span> <span m="3844590">is</span> <span m="3844800">that</span> <span m="3845710">all these</span> <span m="3845990">source</span> <span m="3846320">addresses,</span> <span m="3846710">if they're</span> <span m="3847110">spoofed,</span> <span m="3847705">are</span> <span m="3848330">hard</span> <span m="3848640">to</span> <span m="3848750">distinguish</span> <span m="3849180">from</span> <span m="3849580">legitimate</span> <span m="3849980">clients.</span> <span m="3851630">Make</span> <span m="3852105">sense?</span> <span m="3852580">Yeah.</span> </p>
<p><span m="3853530">AUDIENCE: Would</span> <span m="3854005">you need to store the</span> <span m="3854955">timestamp?</span> </p>
<p><span m="3855910">PROFESSOR: Ahh,</span> <span m="3856190">so</span> <span m="3856470">the</span> <span m="3856670">clever</span> <span m="3857000">thing,</span> <span m="3857310">the</span> <span m="3857340">reason this</span> <span m="3857800">timestamp</span> <span m="3858360">is</span> <span m="3858440">sort</span> <span m="3858610">of</span> <span m="3858770">on</span> <span m="3858940">the</span> <span m="3859030">slide</span> <span m="3859310">here,</span> <span m="3860280">is</span> <span m="3860670">that</span> <span m="3861290">when</span> <span m="3861530">we</span> <span m="3861660">receive</span> <span m="3862140">this</span> <span m="3862340">SNS</span> <span m="3862810">value</span> <span m="3863170">in</span> <span m="3863260">step</span> <span m="3863520">three,</span> <span m="3863920">we</span> <span m="3864320">need to</span> <span m="3864620">figure</span> <span m="3864820">out,</span> <span m="3865415">how</span> <span m="3865880">do you</span> <span m="3866220">compute</span> <span m="3866560">the</span> <span m="3866583">input</span> <span m="3866606">to</span> <span m="3866630">this</span> <span m="3866780">function</span> <span m="3867150">F</span> <span m="3867690">to</span> <span m="3867800">check</span> <span m="3868010">whether it's</span> <span m="3868280">correct?</span> <span m="3869000">So</span> <span m="3869100">actually,</span> <span m="3869430">we</span> <span m="3869500">take</span> <span m="3869700">the</span> <span m="3869870">timestamp</span> <span m="3870367">from the end</span> <span m="3870864">of the packet,</span> <span m="3871860">and</span> <span m="3871970">we</span> <span m="3872030">use</span> <span m="3872280">that</span> <span m="3873010">inside</span> <span m="3873510">of</span> <span m="3873650">this</span> <span m="3874170">computation.</span> </p>
<p><span m="3875710">Everything</span> <span m="3876070">else</span> <span m="3876300">we</span> <span m="3876460">can</span> <span m="3876505">reconstruct.</span> <span m="3876970">We</span> <span m="3877110">know</span> <span m="3877250">who</span> <span m="3877390">just</span> <span m="3877610">sent us</span> <span m="3877900">the</span> <span m="3878120">third</span> <span m="3878480">step</span> <span m="3878795">and</span> <span m="3879110">packet.</span> <span m="3879330">And</span> <span m="3880000">we</span> <span m="3880160">have</span> <span m="3880370">all</span> <span m="3880530">these</span> <span m="3880740">fields.</span> <span m="3881230">And we</span> <span m="3881250">have</span> <span m="3881430">our</span> <span m="3881610">key, which is,</span> <span m="3882010">again,</span> <span m="3882130">still</span> <span m="3882590">secret.</span> <span m="3883760">And</span> <span m="3884240">this</span> <span m="3884720">timestamp</span> <span m="3885200">just comes from</span> <span m="3885460">the end of</span> <span m="3885570">the</span> <span m="3885660">sequence,</span> <span m="3886000">from the</span> <span m="3886230">last</span> <span m="3886510">8</span> <span m="3886640">bits.</span> <span m="3887810">And</span> <span m="3887970">then</span> <span m="3888240">it</span> <span m="3888510">might be</span> <span m="3888660">that</span> <span m="3888730">we'll</span> <span m="3890490">reject</span> <span m="3891040">timestamps</span> <span m="3891335">that</span> <span m="3891630">are</span> <span m="3892220">too</span> <span m="3892540">old,</span> <span m="3893670">just</span> <span m="3893935">disallow</span> <span m="3894650">old</span> <span m="3895090">connections.</span> <span m="3895780">Yeah.</span> </p>
<p><span m="3896280">AUDIENCE: So</span> <span m="3896768">I'm</span> <span m="3897256">guessing</span> <span m="3897353">the</span> <span m="3897451">reason</span> <span m="3897464">you</span> <span m="3897478">only</span> <span m="3897492">use</span> <span m="3897506">this</span> <span m="3897520">when</span> <span m="3897534">you're</span> <span m="3897548">under</span> <span m="3897646">attack</span> <span m="3897744">is because</span> <span m="3898232">you lose</span> <span m="3898720">8 bits</span> <span m="3899208">of security,</span> <span m="3899696">or</span> <span m="3900184">whatever?</span> </p>
<p><span m="3901160">PROFESSOR: Yes,</span> <span m="3901648">it's</span> <span m="3902136">not great.</span> <span m="3902630">It</span> <span m="3902730">has</span> <span m="3903330">many</span> <span m="3903570">bad</span> <span m="3903790">properties.</span> <span m="3904120">One</span> <span m="3904220">is</span> <span m="3904520">you</span> <span m="3905530">sort</span> <span m="3905740">of</span> <span m="3905880">lose</span> <span m="3906135">8 bits of</span> <span m="3906390">security</span> <span m="3906816">in some sense.</span> <span m="3907668">Because</span> <span m="3908094">now</span> <span m="3908520">the</span> <span m="3908825">unguessable</span> <span m="3909130">part</span> <span m="3909440">is</span> <span m="3909620">just</span> <span m="3909880">24</span> <span m="3910140">bits</span> <span m="3910210">instead</span> <span m="3910900">of</span> <span m="3911610">32</span> <span m="3911970">bits.</span> <span m="3913250">Another</span> <span m="3913550">problem</span> <span m="3914220">is</span> <span m="3914810">what</span> <span m="3915000">happens</span> <span m="3915540">if</span> <span m="3916890">you</span> <span m="3917130">lose</span> <span m="3917570">certain</span> <span m="3917890">packets?</span> <span m="3918750">So</span> <span m="3920710">if</span> <span m="3921510">this</span> <span m="3922000">packet</span> <span m="3922490">is</span> <span m="3922980">lost--</span> <span m="3924580">so it's</span> <span m="3924940">typically,</span> <span m="3925075">in</span> <span m="3925210">TCP,</span> <span m="3926163">there's</span> <span m="3926536">someone</span> <span m="3927020">responsible</span> <span m="3927425">for</span> <span m="3927830">retransmitting</span> <span m="3928190">something</span> <span m="3928580">if</span> <span m="3928710">a</span> <span m="3928840">particular</span> <span m="3928970">packet</span> <span m="3929560">is</span> <span m="3929700">lost.</span> <span m="3930540">And</span> <span m="3930750">in</span> <span m="3930990">TCP,</span> <span m="3931420">if</span> <span m="3931600">the</span> <span m="3931760">third</span> <span m="3932170">packet</span> <span m="3932610">is</span> <span m="3932910">lost,</span> <span m="3933870">then</span> <span m="3934580">the</span> <span m="3934700">client</span> <span m="3935110">might</span> <span m="3935380">not be</span> <span m="3935480">waiting</span> <span m="3935780">for</span> <span m="3935880">anything.</span> <span m="3936490">Or</span> <span m="3936720">sorry,</span> <span m="3937850">maybe</span> <span m="3938250">the</span> <span m="3938600">protocol we're</span> <span m="3939040">running</span> <span m="3939280">on</span> <span m="3939500">top</span> <span m="3939860">of this</span> <span m="3940110">TCP</span> <span m="3940390">connection</span> <span m="3940850">is</span> <span m="3940990">one</span> <span m="3941350">where</span> <span m="3941480">the</span> <span m="3941650">server is</span> <span m="3941860">supposed to</span> <span m="3942120">say</span> <span m="3943190">something</span> <span m="3943640">initially.</span> </p>
<p><span m="3943900">So</span> <span m="3944160">I</span> <span m="3944370">connect.</span> <span m="3945290">I</span> <span m="3945390">just</span> <span m="3945850">listen.</span> <span m="3946470">And</span> <span m="3947430">in</span> <span m="3947760">the</span> <span m="3947810">SMTP,</span> <span m="3948400">for</span> <span m="3948560">example,</span> <span m="3948960">the server is</span> <span m="3949250">supposed</span> <span m="3949810">to</span> <span m="3950040">send me</span> <span m="3950130">some</span> <span m="3950270">sort</span> <span m="3950430">of</span> <span m="3950470">an</span> <span m="3950510">initial</span> <span m="3950790">greeting</span> <span m="3951160">in</span> <span m="3951485">the</span> <span m="3951810">protocol.</span> <span m="3953370">So</span> <span m="3953490">OK,</span> <span m="3953790">suppose</span> <span m="3953990">I'm connecting</span> <span m="3954240">to an</span> <span m="3954590">SMTP</span> <span m="3955018">server.</span> <span m="3955446">I</span> <span m="3955874">send my</span> <span m="3956302">third packet.</span> <span m="3957160">I</span> <span m="3957250">think</span> <span m="3957450">I'm</span> <span m="3957650">done.</span> <span m="3958120">I'm</span> <span m="3958590">just</span> <span m="3958720">waiting for</span> <span m="3958840">the</span> <span m="3959160">server</span> <span m="3959480">to tell</span> <span m="3959670">me,</span> <span m="3960795">greetings</span> <span m="3961200">as an</span> <span m="3961600">SMTP</span> <span m="3962000">server.</span> <span m="3962190">Please</span> <span m="3962360">send</span> <span m="3962660">mail.</span> </p>
<p><span m="3964430">This packet</span> <span m="3964600">could</span> <span m="3964890">get</span> <span m="3965070">lost.</span> <span m="3965440">And in</span> <span m="3965720">real</span> <span m="3965870">TCP,</span> <span m="3966830">the</span> <span m="3966970">way</span> <span m="3967130">this</span> <span m="3967380">gets</span> <span m="3967610">handled</span> <span m="3968340">is</span> <span m="3968600">that</span> <span m="3969060">the</span> <span m="3969240">server</span> <span m="3969790">from</span> <span m="3970100">step</span> <span m="3970410">two</span> <span m="3971360">remembers</span> <span m="3971860">that,</span> <span m="3972120">hey,</span> <span m="3972400">I</span> <span m="3972540">sent</span> <span m="3972770">this</span> <span m="3972910">response.</span> <span m="3973860">I</span> <span m="3973970">never</span> <span m="3974200">heard</span> <span m="3974390">back,</span> <span m="3974690">this third</span> <span m="3975080">thing.</span> <span m="3975880">So</span> <span m="3976135">it's the</span> <span m="3976390">server</span> <span m="3976820">that's</span> <span m="3977051">supposed</span> <span m="3977283">to</span> <span m="3977746">resend</span> <span m="3978209">this packet</span> <span m="3978672">to</span> <span m="3979135">trigger the</span> <span m="3979598">client to</span> <span m="3980061">resend</span> <span m="3980524">this</span> <span m="3980987">third packet.</span> </p>
<p><span m="3982840">Of</span> <span m="3982900">course,</span> <span m="3983170">if the</span> <span m="3983270">server isn't</span> <span m="3983740">storing</span> <span m="3983920">any</span> <span m="3984120">state,</span> <span m="3984530">it has no</span> <span m="3984670">idea</span> <span m="3984870">what to</span> <span m="3985340">resend.</span> <span m="3986660">So</span> <span m="3987320">this</span> <span m="3987480">actually</span> <span m="3987720">makes</span> <span m="3988400">connection</span> <span m="3988560">establishment</span> <span m="3988720">potentially</span> <span m="3990840">programmatic</span> <span m="3992120">where you</span> <span m="3992370">could</span> <span m="3992520">enter</span> <span m="3992700">this</span> <span m="3992820">weird state</span> <span m="3992950">where</span> <span m="3993120">both</span> <span m="3993370">sides</span> <span m="3993640">are</span> <span m="3993710">waiting</span> <span m="3994180">for</span> <span m="3994320">each</span> <span m="3994750">other.</span> <span m="3995460">Well,</span> <span m="3995680">the</span> <span m="3995732">server</span> <span m="3995785">doesn't</span> <span m="3995837">even</span> <span m="3995890">know</span> <span m="3996130">that it's</span> <span m="3996460">waiting</span> <span m="3996700">for</span> <span m="3996800">anything.</span> <span m="3997390">And</span> <span m="3997450">the</span> <span m="3997550">client</span> <span m="3997910">is</span> <span m="3998270">waiting</span> <span m="3998356">for</span> <span m="3998443">the</span> <span m="3998530">server.</span> <span m="3999180">And the</span> <span m="3999530">server</span> <span m="3999693">basically</span> <span m="3999856">dropped</span> <span m="4000020">responsibility</span> <span m="4000560">by</span> <span m="4000730">not</span> <span m="4000910">storing</span> <span m="4001200">state.</span> <span m="4002250">So</span> <span m="4002400">this</span> <span m="4002590">is</span> <span m="4003500">another</span> <span m="4003790">reason</span> <span m="4004070">why</span> <span m="4004550">you</span> <span m="4004830">don't run this in</span> <span m="4005110">production</span> <span m="4005380">mode</span> <span m="4005780">all the</span> <span m="4006125">time.</span> <span m="4006470">Yeah.</span> </p>
<p><span m="4007216">AUDIENCE: Presumably</span> <span m="4007590">also</span> <span m="4008050">you could</span> <span m="4008895">have</span> <span m="4009280">data</span> <span m="4009615">commissions</span> <span m="4009950">if you</span> <span m="4010754">establish</span> <span m="4011156">two</span> <span m="4011560">very</span> <span m="4012150">short-lived</span> <span m="4012610">connections</span> <span m="4013070">right</span> <span m="4013530">after each</span> <span m="4013990">other</span> <span m="4014450">from the same</span> <span m="4014910">host.</span> </p>
<p><span m="4015600">PROFESSOR: Absolutely,</span> <span m="4015830">yeah, yeah.</span> <span m="4016105">So another thing is,</span> <span m="4016590">of</span> <span m="4016750">course,</span> <span m="4017160">because</span> <span m="4017540">we</span> <span m="4017670">gave</span> <span m="4017970">up</span> <span m="4018370">on using</span> <span m="4018776">this</span> <span m="4019182">ISN</span> <span m="4019590">old</span> <span m="4019880">style</span> <span m="4020170">part,</span> <span m="4021340">we</span> <span m="4021460">now give</span> <span m="4021700">up</span> <span m="4021950">protection</span> <span m="4022360">against</span> <span m="4023080">these</span> <span m="4023810">multiple</span> <span m="4024190">connections</span> <span m="4024630">in a short</span> <span m="4024760">time period</span> <span m="4025080">being</span> <span m="4025400">independent</span> <span m="4026470">from</span> <span m="4026600">one</span> <span m="4026680">another.</span> <span m="4027400">So I think</span> <span m="4027740">there's</span> <span m="4028420">a</span> <span m="4028520">number</span> <span m="4028840">of trade-offs.</span> <span m="4029322">We just</span> <span m="4029804">talked about</span> <span m="4030286">three.</span> <span m="4030770">There's</span> <span m="4030880">several</span> <span m="4031140">more</span> <span m="4031320">things</span> <span m="4031550">you worry</span> <span m="4031885">about.</span> </p>
<p><span m="4032830">But</span> <span m="4034840">it's not</span> <span m="4035040">great.</span> <span m="4035790">If</span> <span m="4036262">we could</span> <span m="4036734">design a protocol</span> <span m="4037206">from</span> <span m="4037442">scratch</span> <span m="4037678">to be better,</span> <span m="4038150">we could just</span> <span m="4038622">have a</span> <span m="4039100">separate</span> <span m="4039330">nice</span> <span m="4040170">64-bit</span> <span m="4040710">header for</span> <span m="4041030">this</span> <span m="4041390">and a</span> <span m="4041610">64-bit</span> <span m="4041910">value</span> <span m="4042190">for</span> <span m="4042310">this.</span> <span m="4043130">And</span> <span m="4043290">then</span> <span m="4043680">we could</span> <span m="4043790">enable this</span> <span m="4044200">all</span> <span m="4044360">the time</span> <span m="4044750">without</span> <span m="4044870">giving up the</span> <span m="4045210">other stuff</span> <span m="4045550">and</span> <span m="4045735">all</span> <span m="4045920">these nice</span> <span m="4046290">things.</span> <span m="4048151">Yeah.</span> </p>
<p><span m="4048648">AUDIENCE: I</span> <span m="4049145">just</span> <span m="4049244">had</span> <span m="4049343">one</span> <span m="4049443">quick</span> <span m="4049542">question</span> <span m="4049642">on the SNS.</span> <span m="4051133">In</span> <span m="4051630">step two,</span> <span m="4052127">[INAUDIBLE],</span> <span m="4053130">do</span> <span m="4053613">they</span> <span m="4053709">have</span> <span m="4053757">to</span> <span m="4053806">be</span> <span m="4053902">the</span> <span m="4053999">same?</span> </p>
<p><span m="4056432">PROFESSOR: This</span> <span m="4056895">SNS and</span> <span m="4057358">this SNS?</span> </p>
<p><span m="4057821">AUDIENCE: Mhm.</span> </p>
<p><span m="4058750">PROFESSOR: Yeah,</span> <span m="4059090">because</span> <span m="4059350">otherwise,</span> <span m="4061400">the</span> <span m="4061840">server</span> <span m="4062480">has</span> <span m="4062710">no</span> <span m="4063650">way</span> <span m="4064040">to conclude</span> <span m="4064510">that this</span> <span m="4064980">client</span> <span m="4065450">got our</span> <span m="4065920">packet.</span> <span m="4067330">If</span> <span m="4067800">the</span> <span m="4068270">server</span> <span m="4068740">didn't check that</span> <span m="4069210">this SNS</span> <span m="4070160">was</span> <span m="4070430">the</span> <span m="4070530">same value as</span> <span m="4071020">before,</span> <span m="4071620">then</span> <span m="4072610">these</span> <span m="4072770">actually</span> <span m="4073270">would be even</span> <span m="4073560">worse.</span> </p>
<p><span m="4074696">Because</span> <span m="4075120">I could</span> <span m="4075250">fake a</span> <span m="4075440">connection from</span> <span m="4075570">some</span> <span m="4076030">arbitrary</span> <span m="4076405">IP</span> <span m="4076780">address,</span> <span m="4077400">then</span> <span m="4077870">get this</span> <span m="4078340">response.</span> <span m="4078810">Maybe</span> <span m="4079225">I</span> <span m="4079640">don't even</span> <span m="4080090">get</span> <span m="4080260">it,</span> <span m="4080490">because it goes to a</span> <span m="4080860">different</span> <span m="4081000">IP.</span> <span m="4081320">Then</span> <span m="4081740">I establish a</span> <span m="4082330">connection</span> <span m="4082690">from</span> <span m="4082870">some</span> <span m="4083100">other</span> <span m="4083400">IP</span> <span m="4083640">address.</span> <span m="4084700">And</span> <span m="4084980">then the</span> <span m="4085130">server</span> <span m="4085263">is</span> <span m="4085396">maintaining</span> <span m="4085530">a</span> <span m="4085983">whole</span> <span m="4086436">live connection.</span> <span m="4086890">Probably</span> <span m="4087032">a</span> <span m="4087174">server</span> <span m="4087316">crosses</span> <span m="4087742">another</span> <span m="4088168">side</span> <span m="4088594">waiting for me</span> <span m="4089020">to send data</span> <span m="4089450">and</span> <span m="4089610">so on.</span> </p>
<p><span m="4090800">AUDIENCE: But</span> <span m="4091300">the</span> <span m="4091480">timestamp</span> <span m="4091840">is going to be different,</span> <span m="4092330">right?</span> <span m="4093660">So</span> <span m="4093940">how can the</span> <span m="4094090">server</span> <span m="4094804">recalculate</span> <span m="4095288">that</span> <span m="4095449">with</span> <span m="4095610">a</span> <span m="4095772">new</span> <span m="4096256">timestamp</span> <span m="4096740">and</span> <span m="4096982">null</span> <span m="4097224">the</span> <span m="4097385">one</span> <span m="4097546">before</span> <span m="4097708">if it</span> <span m="4098192">doesn't</span> <span m="4098676">store any</span> <span m="4099160">state?</span> </p>
<p><span m="4100130">PROFESSOR: So</span> <span m="4100590">the</span> <span m="4100670">way this works is</span> <span m="4100890">these</span> <span m="4101340">timestamps,</span> <span m="4101790">as I</span> <span m="4101859">was saying,</span> <span m="4102100">are</span> <span m="4102260">course</span> <span m="4102359">grained.</span> <span m="4102760">So</span> <span m="4103040">they're</span> <span m="4103125">on</span> <span m="4103210">a</span> <span m="4103295">scale</span> <span m="4103380">of</span> <span m="4103939">minutes.</span> <span m="4104899">So</span> <span m="4105350">if</span> <span m="4105777">you</span> <span m="4106204">connect within the same minute,</span> <span m="4106631">then</span> <span m="4107060">you're in</span> <span m="4107520">good</span> <span m="4107640">shape.</span> <span m="4110540">And</span> <span m="4110910">if</span> <span m="4110946">you</span> <span m="4110983">connect</span> <span m="4111020">on</span> <span m="4111056">the</span> <span m="4111093">minute</span> <span m="4111130">boundary,</span> <span m="4111550">well,</span> <span m="4111880">too bad.</span> </p>
<p><span m="4113820">Yet</span> <span m="4114220">another problem with</span> <span m="4114580">the</span> <span m="4114960">scheme--</span> <span m="4115220">it's</span> <span m="4115569">imperfect</span> <span m="4116090">in</span> <span m="4116210">many</span> <span m="4116450">ways.</span> <span m="4117155">But</span> <span m="4117540">most</span> <span m="4117824">operating systems,</span> <span m="4118389">including</span> <span m="4118670">Linux,</span> <span m="4119180">actually</span> <span m="4119760">have</span> <span m="4120020">ways</span> <span m="4120270">of</span> <span m="4120359">detecting</span> <span m="4120830">if</span> <span m="4121060">there's</span> <span m="4121779">too</span> <span m="4122029">many entries</span> <span m="4122590">building</span> <span m="4122899">up</span> <span m="4123140">in this</span> <span m="4123270">table</span> <span m="4123649">that aren't</span> <span m="4124120">being</span> <span m="4124320">completed.</span> <span m="4124689">It</span> <span m="4125160">switches</span> <span m="4125410">to this</span> <span m="4125729">other</span> <span m="4126000">scheme</span> <span m="4126490">instead</span> <span m="4126750">to</span> <span m="4127010">make</span> <span m="4127240">sure</span> <span m="4127359">it doesn't</span> <span m="4127510">overflow</span> <span m="4127840">this</span> <span m="4128170">table.</span> <span m="4128590">Yeah.</span> </p>
<p><span m="4129071">AUDIENCE: So</span> <span m="4129552">if the</span> <span m="4130033">attacker has</span> <span m="4130514">control of a</span> <span m="4130995">lot of IP</span> <span m="4131476">addresses,</span> <span m="4132438">and</span> <span m="4132919">they do this,</span> <span m="4133400">and even</span> <span m="4133881">if you</span> <span m="4134362">switch</span> <span m="4134843">it the same--</span> </p>
<p><span m="4135324">PROFESSOR: Yeah,</span> <span m="4135819">so then actually</span> <span m="4136069">there's</span> <span m="4136520">not</span> <span m="4136770">much you</span> <span m="4136870">can</span> <span m="4137160">do.</span> <span m="4138670">The</span> <span m="4138779">reason</span> <span m="4139140">that</span> <span m="4139240">we</span> <span m="4139340">were</span> <span m="4139490">so</span> <span m="4139779">worried</span> <span m="4140060">about</span> <span m="4140270">this</span> <span m="4140409">scheme</span> <span m="4140549">in</span> <span m="4140689">the</span> <span m="4140750">first</span> <span m="4141069">place</span> <span m="4141274">is</span> <span m="4141479">because</span> <span m="4142149">we</span> <span m="4142380">wanted</span> <span m="4142750">to</span> <span m="4143350">filter</span> <span m="4143660">out</span> <span m="4143920">or</span> <span m="4144180">somehow</span> <span m="4144485">distinguish</span> <span m="4144790">between</span> <span m="4144930">the attacker</span> <span m="4145040">and the</span> <span m="4145310">good</span> <span m="4145916">guys.</span> <span m="4146828">And</span> <span m="4147284">if the</span> <span m="4147740">attacker</span> <span m="4147910">has</span> <span m="4148350">more</span> <span m="4148609">IP</span> <span m="4149050">addresses</span> <span m="4149290">and</span> <span m="4149680">just</span> <span m="4149950">controls</span> <span m="4150205">more</span> <span m="4150460">machines</span> <span m="4150810">than the</span> <span m="4150890">good</span> <span m="4151060">guys,</span> <span m="4151420">then</span> <span m="4151700">he</span> <span m="4151840">can</span> <span m="4151990">just</span> <span m="4152180">connect</span> <span m="4152330">to our</span> <span m="4152430">server</span> <span m="4152720">and</span> <span m="4153109">request</span> <span m="4153540">lots of</span> <span m="4153779">web pages</span> <span m="4153990">or</span> <span m="4154920">maintain</span> <span m="4155380">connections.</span> </p>
<p><span m="4156210">And</span> <span m="4156540">it's</span> <span m="4156680">very</span> <span m="4156850">hard</span> <span m="4157189">then</span> <span m="4157640">for the</span> <span m="4157840">server</span> <span m="4158100">to</span> <span m="4158189">distinguish</span> <span m="4158760">whether</span> <span m="4159109">these</span> <span m="4159380">are</span> <span m="4159800">legitimate</span> <span m="4160120">clients</span> <span m="4160404">or</span> <span m="4160689">just</span> <span m="4161060">the</span> <span m="4161170">attacker</span> <span m="4161455">tying</span> <span m="4161740">up</span> <span m="4162020">resources of the</span> <span m="4162285">server.</span> <span m="4163350">So</span> <span m="4163800">you're</span> <span m="4164155">absolutely</span> <span m="4164510">right.</span> <span m="4164880">This</span> <span m="4165210">only</span> <span m="4165590">addresses</span> <span m="4165979">the</span> <span m="4166270">case</span> <span m="4166569">where</span> <span m="4166689">the</span> <span m="4166819">attacker</span> <span m="4167170">has</span> <span m="4167890">a</span> <span m="4167950">small</span> <span m="4168350">number of</span> <span m="4168500">IP</span> <span m="4168630">addresses</span> <span m="4169060">and</span> <span m="4169540">wants to</span> <span m="4169979">amplify</span> <span m="4170840">his</span> <span m="4171100">effect.</span> </p>
<p><span m="4172130">But</span> <span m="4172400">it</span> <span m="4172670">is</span> <span m="4173250">a</span> <span m="4173689">worry.</span> <span m="4174109">And</span> <span m="4174550">in</span> <span m="4174779">fact,</span> <span m="4176200">today</span> <span m="4176939">it</span> <span m="4177310">might</span> <span m="4177439">be</span> <span m="4177529">that</span> <span m="4177700">some</span> <span m="4177870">attackers</span> <span m="4178330">control</span> <span m="4178819">a</span> <span m="4178840">large</span> <span m="4179109">number</span> <span m="4179340">of</span> <span m="4179430">compromised</span> <span m="4179910">machines,</span> <span m="4180830">like</span> <span m="4181000">just</span> <span m="4181200">desktop</span> <span m="4181310">machines</span> <span m="4181610">of</span> <span m="4181910">someone</span> <span m="4182140">that</span> <span m="4182290">didn't</span> <span m="4182529">patch</span> <span m="4182679">their</span> <span m="4183160">machine</span> <span m="4183479">correctly.</span> <span m="4184380">And</span> <span m="4184479">then they</span> <span m="4184649">can</span> <span m="4184819">just</span> <span m="4185350">mount</span> <span m="4185620">denial</span> <span m="4185890">of</span> <span m="4185966">service</span> <span m="4186043">attacks</span> <span m="4186580">from</span> <span m="4186960">this</span> <span m="4187270">distributed</span> <span m="4187729">set of</span> <span m="4187880">machines</span> <span m="4188250">all over the</span> <span m="4188630">world.</span> <span m="4188960">And</span> <span m="4189437">that's</span> <span m="4189914">pretty hard to</span> <span m="4190391">defend</span> <span m="4190870">against.</span> </p>
<p><span m="4193680">So</span> <span m="4193779">another</span> <span m="4194160">actually</span> <span m="4194425">interesting</span> <span m="4194690">thing</span> <span m="4194880">I</span> <span m="4194920">want</span> <span m="4195100">to</span> <span m="4195640">mention</span> <span m="4196030">is</span> <span m="4197470">denial</span> <span m="4197800">of</span> <span m="4197850">service</span> <span m="4198110">attacks,</span> <span m="4198490">but</span> <span m="4198720">in</span> <span m="4198900">the</span> <span m="4201190">particular</span> <span m="4201890">way</span> <span m="4202200">that</span> <span m="4203020">other</span> <span m="4203320">protocols</span> <span m="4203680">make</span> <span m="4203970">them</span> <span m="4204330">worse.</span> <span m="4205630">I</span> <span m="4205860">guess</span> <span m="4206010">other</span> <span m="4206270">protocols</span> <span m="4206670">allow</span> <span m="4206950">denial of service</span> <span m="4207230">attacks</span> <span m="4207340">in the</span> <span m="4207650">first</span> <span m="4207870">place.</span> <span m="4208090">I'm</span> <span m="4208160">sorry.</span> <span m="4208920">But</span> <span m="4209215">there</span> <span m="4209510">are</span> <span m="4209670">some that are</span> <span m="4210040">protocols</span> <span m="4210530">that are</span> <span m="4210690">particularly</span> <span m="4211150">susceptible</span> <span m="4211890">to</span> <span m="4212040">abuse.</span> <span m="4213370">And</span> <span m="4215170">probably</span> <span m="4215570">a</span> <span m="4215680">good</span> <span m="4215820">example</span> <span m="4216280">of that</span> <span m="4216510">is,</span> <span m="4216820">again,</span> <span m="4217085">this</span> <span m="4217350">DNS</span> <span m="4217580">protocol</span> <span m="4217700">that</span> <span m="4218180">we were</span> <span m="4218330">looking</span> <span m="4218580">at</span> <span m="4218700">before.</span> </p>
<p><span m="4219150">So</span> <span m="4219580">the</span> <span m="4219830">DNS</span> <span m="4220155">protocol--</span> <span m="4221420">we</span> <span m="4221537">still</span> <span m="4221655">have</span> <span m="4221772">it</span> <span m="4221890">here--</span> <span m="4222600">involves</span> <span m="4222915">the</span> <span m="4223230">client</span> <span m="4223930">sending</span> <span m="4224510">a</span> <span m="4224590">request</span> <span m="4224990">to</span> <span m="4225050">the</span> <span m="4225180">server</span> <span m="4225940">and</span> <span m="4226110">the</span> <span m="4226350">server</span> <span m="4226750">sending a</span> <span m="4226890">response</span> <span m="4227380">back to the</span> <span m="4227860">client.</span> <span m="4229300">And</span> <span m="4230010">in</span> <span m="4230730">many</span> <span m="4231020">cases,</span> <span m="4231480">the</span> <span m="4231590">response</span> <span m="4232840">is</span> <span m="4233010">larger</span> <span m="4233380">than</span> <span m="4233490">the</span> <span m="4233610">request.</span> <span m="4234310">The request</span> <span m="4234730">could</span> <span m="4234943">be</span> <span m="4235050">just,</span> <span m="4235370">tell</span> <span m="4235800">me about</span> <span m="4235840">mit.edu.</span> <span m="4236890">And</span> <span m="4237150">the</span> <span m="4237270">response</span> <span m="4237700">might</span> <span m="4237890">be</span> <span m="4237990">all</span> <span m="4238210">the</span> <span m="4238290">records</span> <span m="4238710">the</span> <span m="4238790">server</span> <span m="4239050">has</span> <span m="4239300">about mit.edu--</span> <span m="4240086">the</span> <span m="4240480">email</span> <span m="4240860">address,</span> <span m="4241290">the</span> <span m="4241360">mail</span> <span m="4241640">server</span> <span m="4241990">for mit.edu,</span> <span m="4242670">the</span> <span m="4243000">assigned</span> <span m="4243600">record</span> <span m="4243990">if</span> <span m="4244210">it's</span> <span m="4244660">using</span> <span m="4245000">DNS</span> <span m="4245330">SEC, and so on.</span> </p>
<p><span m="4246030">So</span> <span m="4246210">the</span> <span m="4246500">query</span> <span m="4246940">might</span> <span m="4247190">be</span> <span m="4247310">100</span> <span m="4247530">bytes.</span> <span m="4247630">The</span> <span m="4248050">response</span> <span m="4248450">could</span> <span m="4248850">well be</span> <span m="4248900">over</span> <span m="4249245">1,000</span> <span m="4249590">bytes.</span> <span m="4250946">So</span> <span m="4251350">suppose</span> <span m="4251610">that</span> <span m="4251870">you</span> <span m="4251970">want</span> <span m="4252230">to</span> <span m="4252850">flood</span> <span m="4253120">some</span> <span m="4253493">guy</span> <span m="4253866">with</span> <span m="4254240">lots of</span> <span m="4254707">packets</span> <span m="4255174">or</span> <span m="4255641">lots of</span> <span m="4256108">bandwidth.</span> <span m="4257510">Well,</span> <span m="4257870">you</span> <span m="4257970">might only</span> <span m="4258410">be</span> <span m="4258520">able</span> <span m="4258770">to</span> <span m="4258840">send</span> <span m="4259110">a</span> <span m="4259370">small amount of</span> <span m="4259390">bandwidth.</span> </p>
<p><span m="4260240">But</span> <span m="4260500">what you</span> <span m="4260630">could</span> <span m="4260840">do</span> <span m="4261150">is</span> <span m="4261510">you</span> <span m="4261670">could</span> <span m="4261945">fake</span> <span m="4262220">queries</span> <span m="4262600">to</span> <span m="4262700">DNS</span> <span m="4263030">servers</span> <span m="4263360">on</span> <span m="4263510">behalf</span> <span m="4263770">of</span> <span m="4263870">that</span> <span m="4264060">guy.</span> <span m="4264725">So</span> <span m="4265090">you only</span> <span m="4265170">have to</span> <span m="4265490">send</span> <span m="4265770">100</span> <span m="4266050">bytes</span> <span m="4266170">to some</span> <span m="4266220">DNS</span> <span m="4266710">server</span> <span m="4267410">pretending to</span> <span m="4267860">be</span> <span m="4267970">a</span> <span m="4268050">query</span> <span m="4268310">from</span> <span m="4268420">that</span> <span m="4268840">poor</span> <span m="4269050">guy.</span> <span m="4270360">And</span> <span m="4270835">the DNS</span> <span m="4271310">server is</span> <span m="4271520">going to</span> <span m="4272000">send 1,000</span> <span m="4272360">bytes</span> <span m="4272620">to him</span> <span m="4272880">on your</span> <span m="4273340">behalf.</span> </p>
<p><span m="4274260">So</span> <span m="4274410">this</span> <span m="4274600">is</span> <span m="4275676">a</span> <span m="4276100">problematic</span> <span m="4276510">feature</span> <span m="4276850">of</span> <span m="4277200">this</span> <span m="4277380">protocol.</span> <span m="4277920">Because</span> <span m="4278220">it</span> <span m="4278260">allows</span> <span m="4278495">you</span> <span m="4278730">to</span> <span m="4278900">amplify</span> <span m="4279490">bandwidth</span> <span m="4279930">attacks.</span> <span m="4281510">And</span> <span m="4282250">partly</span> <span m="4282520">for the same</span> <span m="4282900">reason</span> <span m="4283210">we were</span> <span m="4283360">talking</span> <span m="4283590">about</span> <span m="4283955">with</span> <span m="4284320">TCP's</span> <span m="4284930">SYN</span> <span m="4285080">flooding</span> <span m="4285350">attacks,</span> <span m="4286250">it's</span> <span m="4286390">very</span> <span m="4286600">hard</span> <span m="4286950">for</span> <span m="4287220">the</span> <span m="4287360">server,</span> <span m="4288010">for</span> <span m="4288100">the</span> <span m="4288340">DNS server,</span> <span m="4288740">in</span> <span m="4288810">this</span> <span m="4288960">case,</span> <span m="4289570">to</span> <span m="4289670">know</span> <span m="4289850">whether</span> <span m="4290070">this request</span> <span m="4290260">is</span> <span m="4290370">valid</span> <span m="4290670">or</span> <span m="4291010">not.</span> <span m="4292110">Because</span> <span m="4292350">there's</span> <span m="4292550">no</span> <span m="4293000">authentication</span> <span m="4293692">or</span> <span m="4294040">no</span> <span m="4294420">sort</span> <span m="4294546">of</span> <span m="4294673">sequence</span> <span m="4294800">number</span> <span m="4295110">exchanges</span> <span m="4295420">going</span> <span m="4295660">on</span> <span m="4295980">to tell that</span> <span m="4296310">this</span> <span m="4296510">is</span> <span m="4296600">the</span> <span m="4296690">right</span> <span m="4296980">guy </span> <span m="4297270">connecting to you,</span> <span m="4297720">et cetera.</span> </p>
<p><span m="4299520">So</span> <span m="4299670">in fact this</span> <span m="4299870">is</span> <span m="4300550">still</span> <span m="4300940">a problem</span> <span m="4301180">in</span> <span m="4301495">DNS</span> <span m="4301810">today.</span> <span m="4302450">And</span> <span m="4302620">it</span> <span m="4302680">gets</span> <span m="4303020">used</span> <span m="4304250">quite</span> <span m="4304550">frequently</span> <span m="4305180">to</span> <span m="4305450">attack</span> <span m="4305750">people</span> <span m="4306080">with</span> <span m="4306300">bandwidth</span> <span m="4306665">attacks.</span> <span m="4307730">So</span> <span m="4308380">if</span> <span m="4308520">you</span> <span m="4308600">have</span> <span m="4308800">a</span> <span m="4308860">certain</span> <span m="4309350">amount of</span> <span m="4309706">bandwidth,</span> <span m="4310420">you'll</span> <span m="4310600">be</span> <span m="4310930">that much</span> <span m="4311130">more</span> <span m="4311280">effective</span> <span m="4311600">if</span> <span m="4311710">you</span> <span m="4311850">reflect</span> <span m="4312310">your</span> <span m="4312460">attack off of</span> <span m="4312915">a</span> <span m="4313370">DNS</span> <span m="4313635">server.</span> </p>
<p><span m="4314380">And</span> <span m="4314860">these</span> <span m="4315170">DNS</span> <span m="4315400">servers</span> <span m="4315900">are</span> <span m="4316010">very</span> <span m="4316280">well</span> <span m="4316510">provisioned.</span> <span m="4317400">And</span> <span m="4317720">they</span> <span m="4317990">basically have</span> <span m="4318200">to</span> <span m="4318270">respond</span> <span m="4318620">to</span> <span m="4318710">every</span> <span m="4319070">query</span> <span m="4319460">out</span> <span m="4319700">there.</span> <span m="4320140">Because</span> <span m="4320390">if they</span> <span m="4320750">stop</span> <span m="4321050">responding</span> <span m="4321440">to</span> <span m="4321500">requests,</span> <span m="4321960">then</span> <span m="4322330">probably</span> <span m="4322580">some</span> <span m="4322845">legitimate</span> <span m="4323110">requests</span> <span m="4323220">are</span> <span m="4323440">going to get</span> <span m="4323530">dropped.</span> <span m="4324030">So this</span> <span m="4324530">is a</span> <span m="4324780">big</span> <span m="4325020">problem</span> <span m="4325370">in practice.</span> <span m="4325858">Yeah.</span> </p>
<p><span m="4326346">AUDIENCE: So</span> <span m="4326834">if you can still</span> <span m="4327322">see it on</span> <span m="4327810">the DNS</span> <span m="4328298">server,</span> <span m="4328786">[INAUDIBLE]</span> <span m="4333666">requests</span> <span m="4334154">and never reply</span> <span m="4334642">to--</span> </p>
<p><span m="4335140">PROFESSOR: Right,</span> <span m="4335490">yeah,</span> <span m="4335800">so it's</span> <span m="4336040">possible</span> <span m="4336570">to</span> <span m="4336720">maybe</span> <span m="4337400">modify</span> <span m="4337820">the</span> <span m="4337900">DNS</span> <span m="4338220">server</span> <span m="4338500">to</span> <span m="4338930">keep</span> <span m="4339220">some</span> <span m="4339460">sort</span> <span m="4339670">of</span> <span m="4339750">state</span> <span m="4340190">like</span> <span m="4340430">this.</span> </p>
<p><span m="4340840">AUDIENCE: That's</span> <span m="4341226">the reason</span> <span m="4341612">why</span> <span m="4342000">this still</span> <span m="4342400">works</span> <span m="4342520">now,</span> <span m="4342965">because they</span> <span m="4343410">don't</span> <span m="4343536">store</span> <span m="4343663">state?</span> </p>
<p><span m="4344170">PROFESSOR: Yeah,</span> <span m="4344460">well</span> <span m="4344750">I</span> <span m="4344850">think</span> <span m="4345090">some</span> <span m="4345320">people</span> <span m="4345600">are</span> <span m="4345670">starting</span> <span m="4346020">to</span> <span m="4346390">modify</span> <span m="4347130">DNS</span> <span m="4347380">server</span> <span m="4347770">to try to</span> <span m="4348075">store</span> <span m="4348630">state.</span> <span m="4349015">A</span> <span m="4349400">lot of</span> <span m="4349490">times,</span> <span m="4349810">there's</span> <span m="4350130">so</span> <span m="4350450">many</span> <span m="4350680">DNS</span> <span m="4350910">servers</span> <span m="4351240">out</span> <span m="4351470">there</span> <span m="4352020">that</span> <span m="4352130">it</span> <span m="4352190">doesn't</span> <span m="4352470">matter.</span> <span m="4353520">Even</span> <span m="4353825">if</span> <span m="4354130">you</span> <span m="4354430">appear</span> <span m="4354640">to</span> <span m="4355280">do</span> <span m="4355890">10</span> <span m="4356160">queries</span> <span m="4356430">against</span> <span m="4356910">every</span> <span m="4357302">DNS server,</span> <span m="4358086">that's</span> <span m="4358480">still</span> <span m="4358610">every</span> <span m="4358780">packet gets</span> <span m="4359020">amplified</span> <span m="4359440">by</span> <span m="4359790">some</span> <span m="4360700">significant</span> <span m="4361200">factor.</span> <span m="4362060">And</span> <span m="4362610">they</span> <span m="4362750">have</span> <span m="4363050">to</span> <span m="4363130">respond.</span> <span m="4363450">Because</span> <span m="4363740">maybe that</span> <span m="4363910">client</span> <span m="4364120">really</span> <span m="4364570">is trying to</span> <span m="4365030">issue this</span> <span m="4365490">query.</span> <span m="4366810">So</span> <span m="4366840">this</span> <span m="4366893">is a</span> <span m="4366946">problem.</span> <span m="4367000">Yeah,</span> <span m="4367470">so you're right,</span> <span m="4367800">if this</span> <span m="4367980">was</span> <span m="4368450">one</span> <span m="4368740">DNS</span> <span m="4368850">server,</span> <span m="4369190">then this</span> <span m="4369530">would</span> <span m="4369730">be</span> <span m="4370170">maybe</span> <span m="4370330">not as</span> <span m="4370520">big of</span> <span m="4370630">a</span> <span m="4370740">deal.</span> </p>
<p><span m="4371170">The</span> <span m="4371610">problem</span> <span m="4371980">is also</span> <span m="4372350">that the root</span> <span m="4372720">servers</span> <span m="4373015">for</span> <span m="4373310">DNS,</span> <span m="4373870">for</span> <span m="4373970">example,</span> <span m="4374500">aren't</span> <span m="4374690">a</span> <span m="4374770">single</span> <span m="4375080">machine.</span> <span m="4375430">It's</span> <span m="4375530">actually</span> <span m="4376060">racks</span> <span m="4376335">and</span> <span m="4376610">racks</span> <span m="4376720">of</span> <span m="4377060">servers.</span> <span m="4377360">Because</span> <span m="4377590">they're</span> <span m="4377760">so</span> <span m="4378120">heavily</span> <span m="4378320">used.</span> <span m="4379120">And</span> <span m="4380110">trying</span> <span m="4380530">to</span> <span m="4380650">maintain</span> <span m="4381180">a</span> <span m="4381240">state</span> <span m="4381535">across</span> <span m="4381633">all</span> <span m="4381731">these</span> <span m="4381830">machines</span> <span m="4382085">is</span> <span m="4382340">probably</span> <span m="4382920">nontrivial.</span> <span m="4383430">So</span> <span m="4384410">as</span> <span m="4384880">it</span> <span m="4385130">gets</span> <span m="4385380">abused</span> <span m="4385580">more,</span> <span m="4385710">probably it will</span> <span m="4385920">be</span> <span m="4386040">more</span> <span m="4386540">worthwhile</span> <span m="4386655">to</span> <span m="4386770">maintain</span> <span m="4387170">this state.</span> </p>
<p><span m="4389650">I</span> <span m="4389730">guess</span> <span m="4389980">a</span> <span m="4390080">general</span> <span m="4390470">principle</span> <span m="4390930">you want to</span> <span m="4391160">follow</span> <span m="4392160">in</span> <span m="4392890">any</span> <span m="4393090">protocol--</span> <span m="4394040">well,</span> <span m="4395120">might be a good</span> <span m="4395340">principle--</span> <span m="4396620">is</span> <span m="4396960">to</span> <span m="4397170">make</span> <span m="4397340">the</span> <span m="4397450">client</span> <span m="4397790">do</span> <span m="4397940">at</span> <span m="4398070">least</span> <span m="4398290">as</span> <span m="4398390">much</span> <span m="4398600">work</span> <span m="4398820">as the</span> <span m="4399060">server</span> <span m="4399510">is doing.</span> <span m="4399855">So</span> <span m="4400200">here,</span> <span m="4400540">the</span> <span m="4400770">problem is</span> <span m="4400980">the</span> <span m="4401120">client</span> <span m="4401510">isn't</span> <span m="4401810">doing as</span> <span m="4401990">much</span> <span m="4402270">work</span> <span m="4402450">as</span> <span m="4402530">the</span> <span m="4402610">server.</span> <span m="4403310">That's</span> <span m="4403490">why the</span> <span m="4403760">server</span> <span m="4404130">can</span> <span m="4404660">help</span> <span m="4404860">the</span> <span m="4404990">client</span> <span m="4405280">amplify</span> <span m="4405585">this effect.</span> </p>
<p><span m="4407280">If</span> <span m="4407400">you</span> <span m="4407560">were</span> <span m="4407760">redesigning</span> <span m="4408420">DNS</span> <span m="4408740">from scratch,</span> <span m="4409120">and</span> <span m="4409246">this</span> <span m="4409373">was</span> <span m="4409500">really</span> <span m="4409750">your</span> <span m="4409960">big</span> <span m="4410110">concern,</span> <span m="4410970">then</span> <span m="4411410">it'd</span> <span m="4411530">probably</span> <span m="4411805">be</span> <span m="4412080">fairly</span> <span m="4412310">straightforward</span> <span m="4412840">to</span> <span m="4412900">fix this.</span> <span m="4413510">The</span> <span m="4413610">client</span> <span m="4413980">has</span> <span m="4414150">to</span> <span m="4414240">send</span> <span m="4414810">a</span> <span m="4414910">request</span> <span m="4415320">that</span> <span m="4416200">has</span> <span m="4417350">extra</span> <span m="4417670">padding</span> <span m="4418060">bytes</span> <span m="4418340">just</span> <span m="4418540">there</span> <span m="4418920">just</span> <span m="4419110">wasting</span> <span m="4419510">bandwidth.</span> <span m="4420090">And</span> <span m="4420390">then the</span> <span m="4420570">server</span> <span m="4421410">is</span> <span m="4421550">going</span> <span m="4421670">to</span> <span m="4421860">respond</span> <span m="4422250">back</span> <span m="4422610">with a</span> <span m="4422690">response</span> <span m="4423210">that's</span> <span m="4423635">at</span> <span m="4424060">most as</span> <span m="4424200">big as</span> <span m="4424410">that.</span> </p>
<p><span m="4424880">And if</span> <span m="4425195">you</span> <span m="4425510">want</span> <span m="4425570">a</span> <span m="4425600">response</span> <span m="4425630">that's</span> <span m="4425985">bigger,</span> <span m="4426340">maybe</span> <span m="4426400">the</span> <span m="4426550">server</span> <span m="4426710">will</span> <span m="4426890">say,</span> <span m="4427000">sorry,</span> <span m="4427035">your</span> <span m="4427070">padding</span> <span m="4427335">wasn't big</span> <span m="4427600">enough.</span> <span m="4428036">Send</span> <span m="4428472">me more</span> <span m="4428908">padding.</span> <span m="4429780">And</span> <span m="4430300">this</span> <span m="4430530">way,</span> <span m="4430920">you</span> <span m="4431170">guarantee</span> <span m="4431760">that</span> <span m="4432050">the</span> <span m="4432210">DNS</span> <span m="4432280">server</span> <span m="4432520">cannot</span> <span m="4432970">be</span> <span m="4433020">used</span> <span m="4433300">ever</span> <span m="4433630">to</span> <span m="4433860">amplify</span> <span m="4434730">these</span> <span m="4435070">kinds</span> <span m="4435370">of</span> <span m="4435780">bandwidth</span> <span m="4436170">attacks.</span> </p>
<p><span m="4438950">Actually,</span> <span m="4439340">these</span> <span m="4439520">kinds</span> <span m="4439690">of</span> <span m="4439770">problems</span> <span m="4440050">happen</span> <span m="4440570">also</span> <span m="4441070">at</span> <span m="4441770">higher</span> <span m="4442010">levels</span> <span m="4442330">as well.</span> <span m="4442390">So</span> <span m="4442660">in</span> <span m="4442840">web</span> <span m="4443010">applications,</span> <span m="4444080">you</span> <span m="4444430">often</span> <span m="4444660">have</span> <span m="4445450">web</span> <span m="4445790">services</span> <span m="4446400">that</span> <span m="4446650">do</span> <span m="4446820">lots</span> <span m="4447120">and</span> <span m="4447136">lots</span> <span m="4447153">of</span> <span m="4447170">computation</span> <span m="4447505">on</span> <span m="4447840">behalf</span> <span m="4448060">of</span> <span m="4448340">a</span> <span m="4448400">single</span> <span m="4448920">request.</span> <span m="4449960">And</span> <span m="4450050">there's</span> <span m="4450150">often</span> <span m="4450450">denial</span> <span m="4450770">of</span> <span m="4450840">service</span> <span m="4450910">attacks</span> <span m="4450945">at</span> <span m="4450980">that</span> <span m="4451050">level</span> <span m="4451200">where</span> <span m="4452480">adversaries</span> <span m="4453760">know</span> <span m="4454130">that</span> <span m="4454290">a</span> <span m="4454340">certain</span> <span m="4454590">operation</span> <span m="4454930">is</span> <span m="4455030">very</span> <span m="4455200">expensive,</span> <span m="4455455">and</span> <span m="4455710">they'll</span> <span m="4455880">just</span> <span m="4456330">ask</span> <span m="4456640">for</span> <span m="4456740">that</span> <span m="4456840">operation</span> <span m="4457290">to</span> <span m="4457420">be done</span> <span m="4457640">over</span> <span m="4457910">and</span> <span m="4457970">over</span> <span m="4458210">again.</span> <span m="4458940">And</span> <span m="4460010">unless</span> <span m="4460340">you</span> <span m="4460510">carefully</span> <span m="4460880">design your</span> <span m="4461280">protocol</span> <span m="4461535">and</span> <span m="4461790">application</span> <span m="4462520">to</span> <span m="4463190">allow</span> <span m="4463460">the</span> <span m="4463570">client</span> <span m="4463990">to prove</span> <span m="4464210">that,</span> <span m="4464470">oh, I'm</span> <span m="4464610">burning</span> <span m="4464810">at</span> <span m="4465010">least as</span> <span m="4465290">much</span> <span m="4465490">work</span> <span m="4465710">as</span> <span m="4465790">you,</span> <span m="4467040">or</span> <span m="4467230">something</span> <span m="4467460">like</span> <span m="4467650">this,</span> <span m="4468670">then</span> <span m="4469025">it's</span> <span m="4469380">hard to</span> <span m="4469869">defend</span> <span m="4470358">against</span> <span m="4470847">these things</span> <span m="4471336">as well.</span> <span m="4472803">Make</span> <span m="4473292">sense?</span> </p>
<p><span m="4474760">All</span> <span m="4475200">right,</span> <span m="4475560">so</span> <span m="4475920">I guess</span> <span m="4476235">the</span> <span m="4476550">last</span> <span m="4476800">thing</span> <span m="4476950">I</span> <span m="4476980">want</span> <span m="4477110">to</span> <span m="4477170">briefly</span> <span m="4477660">touch</span> <span m="4477900">on</span> <span m="4478350">about the</span> <span m="4478620">paper</span> <span m="4478990">we talked about as</span> <span m="4479477">well</span> <span m="4480451">is</span> <span m="4480940">these routing attacks.</span> <span m="4481150">And the reason</span> <span m="4481530">these</span> <span m="4482260">attacks</span> <span m="4482640">are</span> <span m="4482800">interesting</span> <span m="4483120">is</span> <span m="4483240">they're</span> <span m="4483860">maybe</span> <span m="4483940">popping</span> <span m="4484320">up</span> <span m="4484460">a</span> <span m="4484520">level</span> <span m="4485090">above</span> <span m="4485500">these</span> <span m="4486090">protocol</span> <span m="4486740">transport</span> <span m="4487140">level</span> <span m="4487360">issues.</span> <span m="4488200">And</span> <span m="4488770">look at</span> <span m="4489160">what</span> <span m="4489320">goes</span> <span m="4489520">wrong</span> <span m="4489870">in an</span> <span m="4490140">application.</span> </p>
<p><span m="4490910">And</span> <span m="4491240">the routing</span> <span m="4491620">protocol is a</span> <span m="4491940">particularly</span> <span m="4492650">interesting</span> <span m="4492960">example.</span> <span m="4493450">Because</span> <span m="4494150">it's</span> <span m="4494290">often</span> <span m="4494620">the</span> <span m="4494720">place</span> <span m="4495070">where</span> <span m="4496360">trust</span> <span m="4496790">and</span> <span m="4496980">sort of</span> <span m="4497180">initial</span> <span m="4497870">configuration</span> <span m="4498560">gets</span> <span m="4498670">bootstrapped</span> <span m="4499026">in</span> <span m="4499382">the</span> <span m="4499740">first</span> <span m="4499970">place.</span> <span m="4501230">And</span> <span m="4502510">it's</span> <span m="4502820">easy</span> <span m="4503050">to</span> <span m="4503340">sort of</span> <span m="4503570">get</span> <span m="4503730">that wrong.</span> <span m="4504200">And</span> <span m="4504540">even</span> <span m="4504900">today,</span> <span m="4505370">there's</span> <span m="4505515">not</span> <span m="4505660">great</span> <span m="4506080">authentication</span> <span m="4506610">mechanisms</span> <span m="4507800">for</span> <span m="4507990">that.</span> </p>
<p><span m="4508790">Perhaps</span> <span m="4509130">the</span> <span m="4509590">clearest</span> <span m="4509770">example</span> <span m="4510260">is</span> <span m="4510400">the</span> <span m="4510690">DHCP</span> <span m="4511125">protocol</span> <span m="4511560">that all</span> <span m="4511940">of you guys</span> <span m="4512380">use</span> <span m="4512540">when</span> <span m="4512750">you</span> <span m="4513090">open</span> <span m="4513390">a computer</span> <span m="4513660">or</span> <span m="4513750">connect</span> <span m="4513840">to</span> <span m="4513930">some</span> <span m="4514360">wireless</span> <span m="4514430">or</span> <span m="4514950">wired</span> <span m="4515370">network.</span> <span m="4516140">The</span> <span m="4516310">computer just</span> <span m="4516750">sends</span> <span m="4516980">out a</span> <span m="4517140">packet</span> <span m="4517490">saying,</span> <span m="4517850">I</span> <span m="4518010">want an</span> <span m="4518270">IP</span> <span m="4518540">address</span> <span m="4518970">and</span> <span m="4519220">other</span> <span m="4519610">stuff.</span> <span m="4520370">And</span> <span m="4520820">some</span> <span m="4521050">DHCP</span> <span m="4521520">server at</span> <span m="4521810">MIT</span> <span m="4522710">typically</span> <span m="4523090">receives</span> <span m="4523430">that</span> <span m="4523610">packet</span> <span m="4523900">and</span> <span m="4524020">sends</span> <span m="4524190">you</span> <span m="4524270">back,</span> <span m="4524595">here's</span> <span m="4525350">an</span> <span m="4525780">IP</span> <span m="4526520">address that</span> <span m="4526790">you should</span> <span m="4527300">use.</span> <span m="4528010">And</span> <span m="4528200">also</span> <span m="4528390">here's</span> <span m="4528740">a</span> <span m="4528850">DNS</span> <span m="4529090">server</span> <span m="4529420">you</span> <span m="4529540">should use,</span> <span m="4529790">and</span> <span m="4529890">other</span> <span m="4530330">interesting</span> <span m="4530960">configuration</span> <span m="4531230">data.</span> </p>
<p><span m="4533030">And</span> <span m="4533110">the</span> <span m="4533170">problem is</span> <span m="4533580">that</span> <span m="4534420">the</span> <span m="4534840">DHCP</span> <span m="4535000">request</span> <span m="4535200">packet</span> <span m="4535590">is just</span> <span m="4535980">broadcasting</span> <span m="4536235">on the</span> <span m="4536490">local</span> <span m="4536910">network</span> <span m="4537670">trying</span> <span m="4537990">to</span> <span m="4538110">reach</span> <span m="4538390">the</span> <span m="4538620">DHCP</span> <span m="4538840">server.</span> <span m="4539040">Because</span> <span m="4539480">you</span> <span m="4539550">actually</span> <span m="4539740">don't</span> <span m="4539930">know</span> <span m="4540110">what</span> <span m="4540350">the</span> <span m="4540600">DHCP</span> <span m="4541000">is</span> <span m="4541180">going</span> <span m="4541280">to</span> <span m="4541340">be</span> <span m="4541550">ahead of time.</span> <span m="4541940">You're</span> <span m="4542230">just plugging</span> <span m="4542630">into</span> <span m="4542680">the</span> <span m="4542780">network,</span> <span m="4543120">the</span> <span m="4543190">first</span> <span m="4543380">time</span> <span m="4543630">you've been</span> <span m="4544045">here,</span> <span m="4544460">let's</span> <span m="4544670">say.</span> <span m="4545310">And</span> <span m="4545890">your</span> <span m="4546170">client</span> <span m="4547010">doesn't</span> <span m="4547240">know</span> <span m="4547420">what</span> <span m="4547740">else to</span> <span m="4547800">do</span> <span m="4547970">or</span> <span m="4548370">who</span> <span m="4548620">to trust.</span> </p>
<p><span m="4549770">And</span> <span m="4550370">consequently,</span> <span m="4551250">any</span> <span m="4551410">machine</span> <span m="4551880">on the</span> <span m="4552230">local</span> <span m="4552680">network</span> <span m="4552890">could</span> <span m="4553220">intercept</span> <span m="4553650">these</span> <span m="4553830">DHCP</span> <span m="4554270">requests</span> <span m="4554660">and</span> <span m="4555110">respond</span> <span m="4555470">back</span> <span m="4556020">with</span> <span m="4556190">any</span> <span m="4556480">IP</span> <span m="4556800">address</span> <span m="4557030">that</span> <span m="4557090">the</span> <span m="4557170">client could</span> <span m="4557550">use,</span> <span m="4557790">and</span> <span m="4558240">also</span> <span m="4558500">maybe</span> <span m="4558900">tell the</span> <span m="4559010">client,</span> <span m="4559150">hey</span> <span m="4559590">you</span> <span m="4559870">should</span> <span m="4560050">use my</span> <span m="4560180">DNS</span> <span m="4560300">server</span> <span m="4560730">instead</span> <span m="4560910">of the</span> <span m="4560940">real</span> <span m="4561160">one.</span> <span m="4561710">And</span> <span m="4561790">then</span> <span m="4561900">you</span> <span m="4561980">could</span> <span m="4562240">intercept</span> <span m="4562385">those</span> <span m="4562530">future</span> <span m="4562820">DNS</span> <span m="4563360">requests</span> <span m="4563690">from the client</span> <span m="4564040">and so on.</span> <span m="4564890">That</span> <span m="4565390">make sense?</span> </p>
<p><span m="4566900">So</span> <span m="4566996">I</span> <span m="4567093">think</span> <span m="4567190">these</span> <span m="4567480">protocols</span> <span m="4567810">are</span> <span m="4567870">fairly</span> <span m="4568450">tricky</span> <span m="4568670">to get</span> <span m="4568910">right.</span> <span m="4569640">And</span> <span m="4570040">on a</span> <span m="4570100">global</span> <span m="4570420">scale,</span> <span m="4570820">the</span> <span m="4570920">protocols</span> <span m="4571290">like</span> <span m="4571460">BGP</span> <span m="4572300">allow</span> <span m="4572390">any</span> <span m="4572780">participant</span> <span m="4573230">to</span> <span m="4573730">announce</span> <span m="4574140">a</span> <span m="4574230">particular</span> <span m="4574540">IP</span> <span m="4574940">address</span> <span m="4575230">prefix</span> <span m="4575960">for</span> <span m="4576235">the</span> <span m="4576510">world</span> <span m="4576850">to</span> <span m="4577710">sort of</span> <span m="4578120">know</span> <span m="4578250">about</span> <span m="4578505">and</span> <span m="4578760">route</span> <span m="4578930">packets</span> <span m="4579420">toward</span> <span m="4579625">the</span> <span m="4579830">attacker.</span> <span m="4581200">There's</span> <span m="4581560">certainly</span> <span m="4581680">been</span> <span m="4582085">attacks</span> <span m="4582490">where</span> <span m="4582910">some</span> <span m="4584190">router</span> <span m="4584700">participating</span> <span m="4585053">in</span> <span m="4585406">BGP</span> <span m="4586150">says,</span> <span m="4586450">oh,</span> <span m="4586930">I'm</span> <span m="4588730">a</span> <span m="4589040">very</span> <span m="4589280">quick</span> <span m="4589413">way</span> <span m="4589546">to</span> <span m="4589680">reach this</span> <span m="4590050">particular</span> <span m="4590440">IP</span> <span m="4590730">address</span> <span m="4591010">range.</span> <span m="4591830">And</span> <span m="4592010">then all the routers</span> <span m="4592360">in</span> <span m="4592535">the</span> <span m="4592710">world</span> <span m="4592950">say,</span> <span m="4593340">OK,</span> <span m="4593755">sure,</span> <span m="4594170">we'll</span> <span m="4594360">send those</span> <span m="4594520">packets</span> <span m="4594970">to</span> <span m="4595080">you.</span> </p>
<p><span m="4596090">And</span> <span m="4598640">probably</span> <span m="4599010">the</span> <span m="4599080">most</span> <span m="4599470">frequent</span> <span m="4599800">abuse</span> <span m="4600040">of</span> <span m="4600130">this</span> <span m="4600330">is</span> <span m="4600440">by</span> <span m="4600600">spammers</span> <span m="4600920">who want</span> <span m="4601240">to send</span> <span m="4601620">spam,</span> <span m="4602432">but</span> <span m="4602840">their</span> <span m="4603260">old</span> <span m="4603510">IP</span> <span m="4603765">addresses</span> <span m="4604020">are</span> <span m="4604330">blacklisted</span> <span m="4604600">everywhere,</span> <span m="4604720">because</span> <span m="4604800">they</span> <span m="4605270">are</span> <span m="4605380">sending</span> <span m="4605540">spam.</span> <span m="4606000">So</span> <span m="4606490">they</span> <span m="4606620">just</span> <span m="4606920">pick some</span> <span m="4607060">random</span> <span m="4607330">IP</span> <span m="4607560">address.</span> <span m="4607910">They</span> <span m="4608280">announce</span> <span m="4608680">that,</span> <span m="4608760">oh yeah,</span> <span m="4609065">this IP</span> <span m="4609370">address is now</span> <span m="4609700">here.</span> <span m="4610540">And then they</span> <span m="4611010">sort of</span> <span m="4611470">announce</span> <span m="4611670">this IP</span> <span m="4611840">address,</span> <span m="4612290">send spam</span> <span m="4612655">from it,</span> <span m="4613020">and</span> <span m="4613180">then</span> <span m="4613410">disconnect.</span> <span m="4614080">And</span> <span m="4616240">it gets</span> <span m="4616410">abused a</span> <span m="4616470">fair</span> <span m="4616725">amount</span> <span m="4616980">this</span> <span m="4617140">way.</span> </p>
<p><span m="4617935">It's</span> <span m="4618340">sort of</span> <span m="4618540">getting</span> <span m="4619450">less</span> <span m="4619660">now.</span> <span m="4620420">But</span> <span m="4620640">it's</span> <span m="4620830">kind</span> <span m="4620960">of</span> <span m="4621050">hard to</span> <span m="4621320">fix.</span> <span m="4621590">Because</span> <span m="4622180">in</span> <span m="4622550">order</span> <span m="4623160">to</span> <span m="4623250">fix</span> <span m="4623505">it,</span> <span m="4624010">you</span> <span m="4624290">have</span> <span m="4624560">to</span> <span m="4625030">know</span> <span m="4625330">whether</span> <span m="4625650">someone</span> <span m="4625900">really</span> <span m="4626170">owns that</span> <span m="4626380">IP</span> <span m="4626670">address</span> <span m="4626900">or</span> <span m="4627080">not.</span> <span m="4627570">And</span> <span m="4627630">it's</span> <span m="4627690">hard</span> <span m="4627750">to</span> <span m="4627850">do</span> <span m="4628040">without</span> <span m="4628530">establishing</span> <span m="4629100">some</span> <span m="4629630">global</span> <span m="4629980">database</span> <span m="4630460">of,</span> <span m="4630840">maybe,</span> <span m="4631110">cryptographic</span> <span m="4631795">keys</span> <span m="4632100">for</span> <span m="4632240">every</span> <span m="4632820">ISP</span> <span m="4633360">in</span> <span m="4633420">the</span> <span m="4633500">world.</span> <span m="4633890">And</span> <span m="4634560">it</span> <span m="4634760">takes</span> <span m="4635560">quite</span> <span m="4635710">a</span> <span m="4635730">bit</span> <span m="4635820">of</span> <span m="4635900">effort</span> <span m="4636150">by</span> <span m="4636250">someone</span> <span m="4636510">to</span> <span m="4636900">build</span> <span m="4637225">this</span> <span m="4637550">database.</span> </p>
<p><span m="4638080">The</span> <span m="4638560">same</span> <span m="4638625">actually</span> <span m="4638690">applies</span> <span m="4638830">to</span> <span m="4639280">DNS</span> <span m="4639480">SEC</span> <span m="4639550">as</span> <span m="4639920">well.</span> <span m="4640640">In</span> <span m="4640740">order</span> <span m="4640890">to</span> <span m="4641530">know</span> <span m="4641800">which</span> <span m="4642170">signature</span> <span m="4642460">to look</span> <span m="4642710">for</span> <span m="4642940">in</span> <span m="4643220">DNS,</span> <span m="4643350">you have</span> <span m="4643540">to have</span> <span m="4643770">a</span> <span m="4644710">cryptographic</span> <span m="4645010">key</span> <span m="4645310">associated</span> <span m="4645690">with</span> <span m="4645820">every</span> <span m="4646075">entity</span> <span m="4646202">in</span> <span m="4646330">the</span> <span m="4646430">world.</span> <span m="4647420">And</span> <span m="4647770">it's not</span> <span m="4647950">there</span> <span m="4648170">now.</span> <span m="4649000">Maybe it'll</span> <span m="4649280">get</span> <span m="4649360">built</span> <span m="4649580">up</span> <span m="4649680">slowly.</span> <span m="4650010">But it's</span> <span m="4650420">certainly</span> <span m="4650920">one big</span> <span m="4651420">problem</span> <span m="4651910">for</span> <span m="4652230">adopting</span> <span m="4652440">DNS</span> <span m="4652780">SEC.</span> </p>
<p><span m="4654910">All</span> <span m="4654970">right,</span> <span m="4655620">so</span> <span m="4655720">I</span> <span m="4655780">guess</span> <span m="4656900">the</span> <span m="4657210">thing to take away</span> <span m="4657490">from this</span> <span m="4657770">is</span> <span m="4657980">maybe</span> <span m="4658110">just a</span> <span m="4658140">bunch</span> <span m="4658320">of</span> <span m="4658450">lessons</span> <span m="4658750">about</span> <span m="4659190">what</span> <span m="4659380">not to</span> <span m="4659620">do</span> <span m="4659900">in</span> <span m="4660010">general</span> <span m="4660430">in</span> <span m="4660815">protocols.</span> <span m="4661200">But</span> <span m="4661350">also</span> <span m="4661500">actually</span> <span m="4661700">one</span> <span m="4661900">thing</span> <span m="4662040">I</span> <span m="4662070">want</span> <span m="4662210">to</span> <span m="4662250">mention</span> <span m="4662570">is that</span> <span m="4663390">while</span> <span m="4664580">probably</span> <span m="4665060">secrecy</span> <span m="4665610">and</span> <span m="4665830">integrity</span> <span m="4666390">are</span> <span m="4666560">good</span> <span m="4666750">properties</span> <span m="4667150">and driving</span> <span m="4667290">force</span> <span m="4667410">of</span> <span m="4667870">higher</span> <span m="4668120">levels</span> <span m="4668390">of</span> <span m="4668430">abstraction,</span> <span m="4669170">like</span> <span m="4669460">in</span> <span m="4669800">cryptographic</span> <span m="4670360">protocols</span> <span m="4670850">in</span> <span m="4670950">the</span> <span m="4671050">application--</span> <span m="4671730">and</span> <span m="4672060">we'll look</span> <span m="4672160">at that</span> <span m="4672460">in next</span> <span m="4672780">lectures--</span> <span m="4673220">one</span> <span m="4673440">thing</span> <span m="4673525">that</span> <span m="4673610">you</span> <span m="4674050">really do</span> <span m="4674250">want</span> <span m="4674430">from the</span> <span m="4674760">network</span> <span m="4675113">is</span> <span m="4675466">some sort of</span> <span m="4675820">availability</span> <span m="4676135">and</span> <span m="4676292">DOS</span> <span m="4676800">resistance.</span> <span m="4677680">Because</span> <span m="4677750">these</span> <span m="4677960">properties</span> <span m="4678330">are</span> <span m="4678650">much</span> <span m="4678790">harder</span> <span m="4679050">to</span> <span m="4679130">achieve</span> <span m="4679440">at</span> <span m="4679500">higher</span> <span m="4679740">levels</span> <span m="4680020">in the</span> <span m="4680270">stack.</span> </p>
<p><span m="4680850">So you</span> <span m="4681140">really</span> <span m="4681360">want to</span> <span m="4681520">avoid</span> <span m="4681590">things</span> <span m="4682000">like</span> <span m="4682440">maybe these</span> <span m="4682800">amplification</span> <span m="4683150">attacks,</span> <span m="4684410">maybe</span> <span m="4684710">these</span> <span m="4685900">SYN</span> <span m="4686190">flooding</span> <span m="4686500">attacks,</span> <span m="4687830">maybe</span> <span m="4688100">these</span> <span m="4688640">RST</span> <span m="4688850">attacks</span> <span m="4689250">where you can</span> <span m="4689740">shoot down</span> <span m="4690070">an</span> <span m="4690350">arbitrary</span> <span m="4690740">person's</span> <span m="4691150">connection.</span> <span m="4691680">These</span> <span m="4691870">are</span> <span m="4691930">things</span> <span m="4692160">that</span> <span m="4692260">are</span> <span m="4692370">really</span> <span m="4692590">damaging</span> <span m="4693090">at</span> <span m="4693130">the</span> <span m="4693170">low</span> <span m="4693410">level</span> <span m="4694030">and</span> <span m="4694360">that are</span> <span m="4694470">hard to fix</span> <span m="4694830">higher</span> <span m="4695360">up.</span> <span m="4696190">But</span> <span m="4696590">the</span> <span m="4696680">integrity</span> <span m="4697460">and</span> <span m="4697660">confidentiality</span> <span m="4699190">you</span> <span m="4699415">can</span> <span m="4699640">more</span> <span m="4699870">or</span> <span m="4699890">less</span> <span m="4700170">solve with</span> <span m="4700510">encryption.</span> <span m="4700780">And</span> <span m="4701050">we'll</span> <span m="4701570">talk</span> <span m="4701820">about</span> <span m="4702000">how</span> <span m="4702160">we do</span> <span m="4702290">that</span> <span m="4702580">in</span> <span m="4702725">the</span> <span m="4702870">next</span> <span m="4703240">lecture</span> <span m="4703310">on</span> <span m="4703610">Cerberus.</span> <span m="4703910">See you guys</span> <span m="4704210">then.</span> </p>
</div>
        <div id="vid_related" itemprop="description" class="tabContent hide">
<h2 class="subhead">Free Downloads</h2>
<h3 class="subsubhead">Video</h3>
<ul>
<li>iTunes U (<a href="https://itunes.apple.com/us/itunes-u/id1017908130">MP4 - 174MB</a>)</li>
<li>Internet Archive (<a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec12_300k.mp4">MP4 - 174MB</a>)</li>
</ul>
<br>
<h3 class="subsubhead">Caption</h3>
<ul>
<li>English-US (<a href="../../../contents/video-lectures/lecture-12-network-security/BZTWXl9QNK8.srt">SRT</a>)</li>
</ul>
</div>
    
   </div>  




      					 
        <div class="" id="parent-fieldname-bottom_html_area">
            
            
        </div>
    
               </main><!--Course_inner_media tag close -->
           		</div>
<!--Course_wrapper tag close -->
            </div>
<!--left tag close -->
            <aside id="right">
                <!--Begin Right Portion -->
                    <div>
    



</div>

                	<div>
    



</div>


        <div class="" id="parent-fieldname-rsi_top_html_area">
            
            
        </div>
    

<!-- RSI google ad space-->



<div id="google_ads">    
    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <script type="text/javascript">var googletag = googletag || {}; googletag.cmd = googletag.cmd || [];</script>
    <script type="text/javascript">
googletag.cmd.push(function() {googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_A_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_A_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_B_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_B_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_C_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_C_DL').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
 googletag.enableServices();
});</script>
    <script language="javascript" type="text/javascript">
googletag.cmd.push(function() {googletag.pubads().set("TYPE","HOUSE");googletag.pubads().set("DEPARTMENT","6");googletag.pubads().set("CRS_BEG2","85");googletag.pubads().set("CRS_END","8");googletag.pubads().set("SESSION","F");googletag.pubads().set("YEAR","14");})
</script>
    
    <div id="VIDEO_INDIVIDUAL_SLOT_A_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_A_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_B_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_B_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_C_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_C_DL'); });</script>
    </div>
</div>

<!-- End RSI ads--> 


<div>
    



</div>

            </aside><!--Right div close -->
            <div class="clear"></div>
        </div>
<!--grid tag close -->
      </div>
		
		<footer id="bottom">
			<div id="grid">
				
<div id="portletwrapper-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572" class="portletWrapper kssattr-portlethash-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572">
<div class="portletStaticText portlet-static-site-footer"><div id="footer">
<nav aria-label="Footer">     <nav id="foot-c1" class="grid_2 alpha" aria-labelledby="f-find-courses">       <span class="footer" id="f-find-courses" aria-hidden="true">Find Courses</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Find by Topic</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-number/">Find by Course Number</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-department/">Find by Department</a></li>
    <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights</a></li>
    <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
    <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    <li><a href="https://ocw.mit.edu/courses/translated-courses/">Translated Courses</a></li>
</ul>
</nav>
<div id="foot-c2" class="grid_2"><nav aria-labelledby="f-for-educators">         <span id="f-for-educators" class="footer" aria-hidden="true">For Educators</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
    <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal </a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
    <li><a href="https://openlearning.mit.edu/campus/digital-innovations/" aria-label="External Link: Residential Digital Innovations">Residential Digital Innovations </a></li>
    <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
</ul>
</nav></div>
<nav class="grid_2" id="foot-c3" aria-labelledby="f-donate">       <span id="f-donate" class="footer" aria-hidden="true">Give Now</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
    <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
    <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
    <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
    <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
</ul>
</nav>
<div class="grid_2" id="foot-c4">
<nav aria-labelledby="f-about">         <span id="f-about" class="footer" aria-hidden="true">About</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/about/">About OpenCourseWare</a></li>
    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
    <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
    <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
</ul>
</nav><!--about-->       <nav aria-labelledby="f-tools">         <span id="f-tools" class="footer" aria-hidden="true">Tools</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/help/">Help &amp; FAQs</a></li>
    <li><a href="https://ocw.mit.edu/about/contactus">Contact Us</a></li>
    <li><a href="https://accessibility.mit.edu/" target="_blank">Accessibility</a></li>
    <li><a href="https://ocw.mit.edu/help/site-map/">Site Map</a></li>
    <li><a href="../../../common/terms/index.htm">Privacy &amp; Terms of Use</a></li>
    <li><a href="https://ocw.mit.edu/help/rss/">RSS Feeds</a></li>
</ul>
</nav><!--tools-->
</div>
</nav> <aside style="min-height: 289px;" aria-labelledby="f-our-corporate-supporters" class="grid_4 omega" id="foot-c5">           <span aria-hidden="true" class="footer" id="f-our-corporate-supporters">Our Corporate Supporters</span>           <!-- HOME_CORP_LOGO_1 -->
<div id="div-gpt-ad-1388181177156-0" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-0'); });
            </script></div>
<!-- HOME_CORP_LOGO_2 -->
<div id="div-gpt-ad-1388181177156-1" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-1'); });
            </script></div>
<!-- HOME_CORP_LOGO_3 -->
<div id="div-gpt-ad-1388181177156-2" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-2'); });
            </script></div>
<!-- HOME_CORP_LOGO_4 -->
<div id="div-gpt-ad-1388181177156-3" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-3'); });
            </script></div>
<!-- HOME_CORP_LOGO_5 -->
<div id="div-gpt-ad-1388181177156-4" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-4'); });
              </script></div>
<!-- HOME_CORP_LOGO_6 -->
<div id="div-gpt-ad-1388181177156-5" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-5'); });
              </script></div>
</aside>
<div class="grid_12 alpha omega" itemprop="publisher" itemscope="" itemtype="http://schema.org/CollegeOrUniversity">
<h4 class="footer" style="border-top: thin solid #d5c9ba; padding-top: 10px; margin-bottom: 10px;">About <span itemprop="name">MIT OpenCourseWare</span>
</h4>
<p style="color: #999; font-size: 1em; line-height: 1.5em; margin-top: 10px;" itemprop="description">MIT OpenCourseWare is an online publication of materials from over 2,500 MIT courses, freely sharing knowledge with learners and educators around the world. <a href="https://ocw.mit.edu/about/">Learn more »</a></p>
</div>
<div id="foot-copy" class="grid_12 alpha omega" style="border-top: none;">
<a href="http://web.mit.edu"><img src="../../../common/images/logo_mit.png" alt="Massachusetts Institute of Technology logo and name." style="width: 195; height: 44;"></a><a href="https://openlearning.mit.edu/"><img src="https://ocw.mit.edu/images/mitol_logo.png" alt="MIT Open Learning logo and name." style="width: 265; height: 50; vertical-align: top; padding-left:30px;"></a><a href="https://www.oeglobal.org/"><img src="https://ocw.mit.edu/images/oeg_logo.gif" alt="Open Education Consortium logo." style="width: 219px; height: 59px; vertical-align: top; padding-left:20px;"></a><a rel="license" itemprop="useRightsUrl" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="../../../common/images/cc_by-nc-sa.png" alt="Creative Commons logo with terms BY-NC-SA." style="width: 126px; height: 44px; margin-right: 0; padding-left: 20px;"></a>
<p class="copyright">© 2001–2018<br>
Massachusetts Institute of Technology</p>
<p style="font-size: 0.9em; margin-bottom: 15px;">Your use of the MIT OpenCourseWare site and materials is subject to our <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license">Creative Commons License</a> and other <a href="../../../common/terms/index.htm" rel="cc:morePermissions">terms of use</a>.</p>
</div>
</div></div>

</div>





                
			</div> <!-- bottom grid end -->
		</footer><!-- footer bottom end -->


   </body>
 </html>
