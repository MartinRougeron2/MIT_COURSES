<!DOCTYPE html><html lang="en">
      
      
        
    
    
    
    

      
      
      <head>
        <meta charset="utf-8">
        <meta name="format-detection" content="telephone=no">  
        
        <title>Lecture 16: Side-Channel Attacks | Lecture Videos | Computer Systems Security | Electrical Engineering and Computer Science | MIT OpenCourseWare</title>
    <!-- Begin Automatic Metadata Insertion -->
    <meta content="6-858-computer-systems-security-fall-2014" name="WT.cg_n">
    <meta content="Lecture 16: Side-Channel Attacks" name="WT.cg_s">
    <meta content="In this lecture, Professor Zeldovich discusses side-channel attacks, specifically timing attacks." name="Description">
    <meta content="Zeldovich, Nickolai" name="Author">
    <meta content="6.858,side-channel attack,timing attack,RSA,Computer Design and Engineering,Software Design and Engineering" name="keywords">
    <meta content="6.858 Computer Systems Security | Lecture 16: Side-Channel Attacks" name="Search_Display">
    <meta content="Computer Design and Engineering" itemprop="about">
    <meta content="Software Design and Engineering" itemprop="about">
    <!-- End Automatic Metadata Insertion -->

	<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/grid.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/base.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/menu.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.bubblepopup.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/search.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses_new.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.jscrollpane.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/media_tabs.css">
	<link href="../../../common/xml/ocwcc.rdf" type="application/rdf+xml" rel="metadata">
	<link rel="canonical" href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-16-side-channel-attacks/">
	<link rel="apple-touch-icon" href="../../../common/images/apple-touch-icon.png">
	
	
      
	
	<script type="text/javascript" src="../../../common/scripts/jquery.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-media-utils-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.bubblepopup.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery-ui.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.jscrollpane.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/expandy.js"></script>
	<script type="text/javascript" src="../../../common/scripts/bubble-popup-offline.js"></script>
	
	
	
    <script type="text/javascript">
      $(document).ready(function() {
        $("#tabs").tabs();
        IpadScroller();
      });
    </script>
    
    
    
    
    
    
      
       
		 

        
        
        

        
        
        
        
        
        
        
        
        
      </head>
    <body itemscope itemtype="http://schema.org/WebPage">
        
	

        <header id="top">
			<div id="grid">
				
				
					
<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572">
<div class="portletStaticText portlet-static-site-header">
<!--googleoff: index-->
<div class="grid_6 alpha" id="banner"><a href="https://ocw.mit.edu/"><img src="../../../common/images/ocw_mast.png" class="logo" alt="MIT OpenCourseWare, Massachusetts Institute of Technology"></a></div>
<div class="grid_6 omega" id="subscribe">
<aside class="module" aria-label="Connect with OCW">
<table class="social">
    <tbody>
        <tr>
            <td class="socialbutton"><a aria-label="Subscribe to the OCW Newsletter" href="https://ocw.mit.edu/subscribe/index.htm?utm_source=header"><img src="../../../common/images/trans.gif" alt="An icon depicting an envelope.">Subscribe to the OCW Newsletter</a></td>
            <td>
<a aria-label="Facebook" href="https://facebook.com/mitocw"><img src="../../../common/images/icon_fb.png" alt="Click to visit our Facebook page."></a>  <a aria-label="Instagram" href="https://www.instagram.com/mitocw/"><img src="https://ocw.mit.edu/images/icon_ig.png" alt="Click to visit our Instagram page."></a> <a aria-label="Twitter" href="https://twitter.com/mitocw"><img src="https://ocw.mit.edu/images/icon_twitter.png" alt="Click to visit our Twitter feed."></a><a aria-label="YouTube" href="https://www.youtube.com/mitocw" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_yt.png" alt="Click to visit our YouTube page."></a><span style="font-size: 12.208px;">   </span><a aria-label="Open Matters blog on WordPress" href="https://www.ocw-openmatters.org/" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_wp.png" alt="Click to visit our blog on WordPress."></a>
</td>
        </tr>
    </tbody>
</table>
</aside><nav aria-label="Help Links" class="helplinks">     <a aria-label="OCW Site Help" href="https://ocw.mit.edu/help">Help</a><span aria-hidden="true">|</span>     <a href="../../../common/about/contactus.htm">Contact Us</a>   </nav>
</div>
<div class="clear"> </div>
<!--googleon: index-->
</div>

</div>

<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75">
<div class="portletStaticText portlet-static-mega-menu"><div><nav id="mega" class="grid_8 alpha" aria-label="Site">
<ul id="menu" role="presentation">
    <li id="menu_home">
<a href="https://ocw.mit.edu/" aria-label="Homepage"><img src="../../../common/images/top-nav_home.png" class="home_icon" alt="Click for site home page."></a><!-- Begin Home Item -->
</li>
    <!-- End Home Item -->
    <li id="drop_1" aria-label="Find Courses">
<a href="#" aria-hidden="true">FIND COURSES</a><!-- Begin 5 columns Item -->
    <div class="dropdown_5columns-a mega-courses">
    <div class="col_1a">
    <div class="row_1a">
<nav aria-labelledby="mm-find-courses-by">     <span id="mm-find-courses-by" class="nav" aria-hidden="true">Find courses by:</span>
    <ul class="find_by" role="presentation">
        <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Topic</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-number/">MIT Course Number</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-department/">Department</a></li>
    </ul>
    </nav>     <nav aria-labelledby="mm-collections">     <span id="mm-collections" class="nav" aria-hidden="true">Collections</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Lectures</a></li>
        <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
        <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
        <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    </ul>
    </nav>     <nav class="col_1b" aria-labelledby="mm-translated-courses">     <span id="mm-translated-courses" class="nav" aria-hidden="true" style="line-height: 1.3;">Cross-Disciplinary Topic Lists</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/energy-courses">Energy</a></li>
        <li><a href="https://ocw.mit.edu/courses/entrepreneurship">Entrepreneurship</a></li>
        <li><a href="https://ocw.mit.edu/courses/environment-courses">Environment</a></li>
        <li><a href="https://ocw.mit.edu/courses/intro-programming">Introductory Programming</a></li>
        <li><a href="https://ocw.mit.edu/courses/life-sciences">Life Sciences</a></li>
        <li><a href="https://ocw.mit.edu/courses/transportation-courses">Transportation</a></li>
    </ul>
    </nav>
</div>
    <div class="row_1b"><nav aria-labelledby="mm-cross-disciplinary-topic-lists">     <span id="mm-cross-disciplinary-topic-lists" class="nav" aria-hidden="true">Translated Courses</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/translated-courses/traditional-chinese" aria-label="Traditional Chinese">繁體字 / Traditional Chinese</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/turkish" aria-label="Turkish">Türkçe / Turkish</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/korean" aria-label="Korean">(비디오)한국 / Korean</a></li>
    </ul>
    </nav></div>
    </div>
    </div>
    </li>
    <li id="drop_2">
<a href="#" aria-label="For Educators">For Educators</a>
    <div class="dropdown_1column-a" style="width: 270px;"><nav aria-labelledby="mm-find-courses-by">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/chalk-radio-podcast">Chalk Radio Podcast</a></li>
        <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
        <li><a href="https://openlearning.mit.edu/campus/digital-innovations/">Residential Digital Innovations </a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_3">
<a href="#" aria-hidden="true">Give Now</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="Donate">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
        <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
        <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
        <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
        <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_4">
<a href="#" aria-hidden="true">About</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="About">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/about/">About MIT OpenCourseWare</a></li>
        <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
        <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
        <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
        <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
        <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
    </ul>
    </nav></div>
    </li>
</ul>
</nav></div></div>

</div>





<!--googleoff: index-->
<script>
  (function() {
	var cx = '012626166551961672889:owjdpuboktq';
	var gcse = document.createElement('script');
	gcse.type = 'text/javascript';
	gcse.async = true;
	gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(gcse, s);
  })();
  window.onload = function(){
	document.getElementById('gsc-i-id1').placeholder = 'Search';	
  };

$(document).ready(function(){

$('.advanceSearch a').keydown(function(event){showSearchTips($(this),event);})
$('#searchTipsModal').keydown(function(event){showSearchTips($(this),event);})

function showSearchTips(obj,evt) {
// if pressed enter key
	if ( evt.which == 13 || evt.which == 32) {
		showModal();
		ga('send', 'pageview', "AdvanceSearch");
		$(".advanceSearch a").attr('aria-expanded', 'true');
		$('.searchTipsModal').focus();
		evt.preventDefault();
		}
	if ( evt.which == 27 ) {
		hideModal();
		$(".advanceSearch a").attr('aria-expanded', 'false');
		var modal = document.getElementById('searchTipsModal');
		modal.style.display = "none";
		$(".advanceSearch a").focus();
		evt.preventDefault();
		}
}

});
function showModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "block";
	ga('send', 'pageview', "AdvanceSearch");
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", true);
	window.setTimeout(function () {
    document.getElementById('searchTipsModal').focus(); }, 0);
}

function hideModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "none";
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", false);
}
</script>
<div id="search" role="search" class="grid_4 omega">
    	<table class="search">
				<tbody>
					<tr>
						<td><div class="searchboxheader"><searchbox-only resultsurl="/search/ocwsearch.htm"></searchbox-only></div></td>
						<td>
							<div class="advanceSearch">
								<a id="searchTipsBtn" onclick="showModal();" href="#" role="button" aria-label="search tips" aria-expanded="false" aria-describedby="searchtips">Search Tips</a>

								<!-- The Modal -->
								<div id="searchTipsModal" class="modal" tabindex="-1">
								  <!-- Modal content -->
									<div class="modal-content">
										<div class="modal-body">
											<button class="close" onclick="hideModal();" aria-label="close">X</button>
											<span>
												<b>Exclude words from your search</b>
												<br>Put - in front of a word you want to leave out. For example, jaguar speed -car
												<br><br>
												<b>Search for an exact match</b>
												<br>Put a word or phrase inside quotes. For example, "tallest building".
												<br><br>
												<b>Search for wildcards or unknown words</b>
												<br>Put a * in your word or phrase where you want to leave a placeholder. For example, "largest * in the world".
												<br><br>
												<b>Search within a range of numbers</b>
												<br>Put .. between two numbers. For example, camera $50..$100.
												<br><br>
												<b>Combine searches</b>
												<br>Put "OR" between each search query. For example,  marathon OR race.
												<br><br>
											</span>
										</div>
								  </div>
								</div>
							</div>
						</td>
					</tr>
				</tbody>
		</table>
</div>
<div class="clear"></div>
<!--googleon: index-->
<!-- *end header* -->

				
				
			</div>
<!-- top grid end -->
		</header><!-- top end -->
			
		<div id="center_media">
      	<div id="grid">
      		<div id="left">
        		<nav id="breadcrumb_media" aria-label="Breadcrumb">
                	<p>

    <a href="https://ocw.mit.edu/">Home</a>
    
        »
        
    
    
        
            <a href="https://ocw.mit.edu/courses">Courses</a>
            
                »
                
            
            
         
    
    
        
            <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science">Electrical Engineering and Computer Science</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/index.htm">Computer Systems Security</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/video-lectures/index.htm">Lecture Videos</a>
            
                »
                
            
            
         
    
    
        
            
            
            Lecture 16: Side-Channel Attacks
         
    
</p>

            	</nav>
            	<div class="clear"></div>
        		<div id="media_title">
        		<h1 class="title" itemprop="name" property="dct:title">
        <span class="" id="parent-fieldname-title">
            Lecture 16: Side-Channel Attacks
        </span>
    </h1>
        		</div>
           		<div class="clear"></div>
           		<div id="course_wrapper_media">
           			<nav id="course_nav" aria-label="Course">
           				<script language="javascript" type="text/javascript">
function toggleMenu(objID) {
  if (!document.getElementById) return;
  var ob = document.getElementById(objID);
  ob.className = (ob.className == 'selected')?'': 'selected';
}
function toggleClass(id)
{
  var divtoggleClass= document.getElementById(id);
  divtoggleClass.className = (divtoggleClass.className == 'mO')?'mC': 'mO';
  return false;
}
function changeAlt(id)
{
  id.alt = (id.alt == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
  id.title = (id.title == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
}
</script>
<!--Left Nav Starts -->


	<ul>			  
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/index.htm">
		                  Course Home  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/syllabus/index.htm">
		                  Syllabus  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/calendar/index.htm">
		                  Calendar  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/readings/index.htm">
		                  Readings  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/lecture-notes/index.htm">
		                  Lecture Notes  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="selected">
			   			<a href="../../../contents/video-lectures/index.htm">
		                  Lecture Videos  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/labs/index.htm">
		                  Labs  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/exams/index.htm">
		                  Exams  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/final-project/index.htm">
		                  Final Project  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/related-resources/index.htm">
		                  Related Resources  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    
		    
         	
	<!--second tal block close-->  
	
</ul>


<!--Left Nav Ends -->





           			</nav>
           			<main id="course_inner_media" aria-labelledby="media_title">
      					 
        <div class="" id="parent-fieldname-text">
            
            
        </div>
    
      					     
    
    



<script type="text/javascript">var caption_embed_1 ={'English - US': '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-16-side-channel-attacks/3v5Von-oNUg.srt'}</script>     
     <div id="media-embed">
         <div class="attention_message" id="embed_1">
<p>Flash and JavaScript are required for this feature.</p>
<p>Download the video from <a href="https://itunes.apple.com/us/itunes-u/id1017908130">iTunes U</a> or the <a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec16_300k.mp4">Internet Archive</a>.</p>
</div>
     </div>
    
     <script type="text/javascript">ocw_embed_chapter_media('embed_1', 'https://www.youtube.com/v/3v5Von-oNUg', 'youtube', '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-16-side-channel-attacks', 'https://img.youtube.com/vi/3v5Von-oNUg/0.jpg',0,0, 'https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-16-side-channel-attacks/3v5Von-oNUg.srt')</script>
	 
	 
	 		
	 		<div id="transcript1"></div>
				 <script type="text/javascript">createThreePlayParams(2, 662959, "embed_1", 0, 0)</script>
			 
	

     <div id="media_resource_next_prev_nav" style="margin-top: 1em;">
        <p>
        
            <a href="../../../contents/video-lectures/lecture-15-medical-software/index.htm">
                <img src="../../../common/images/btn_previous_resource.png" style="margin: 0 30px 0 50px;" alt="Previous track" title="Previous track"></a>
     	
     	
        
            <a href="../../../contents/video-lectures/lecture-17-user-authentication/index.htm"> 
                <img src="../../../common/images/btn_next_resource.png" alt="Next track" title="Next track"></a>
       
       </p>
     </div>
 


<script type="text/javascript">
		window.onload=function(){
		init();
		
		}
		var tabLinks = new Array();
		var contentDivs = new Array();
		function init() {
		  // Grab the tab links and content divs from the page
		  var tabListItems = document.getElementById('tabs').childNodes;
		  for ( var i = 0; i < tabListItems.length; i++ ) {
			if ( tabListItems[i].nodeName == "LI" ) {
			  var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
			  var id = getHash( tabLink.getAttribute('href') );
			  tabLinks[id] = tabLink;
			  contentDivs[id] = document.getElementById( id );
			}
		  }
		  // Assign onclick events to the tab links, and
		  // highlight the first tab
		  var i = 0;
		  for ( var id in tabLinks ) {
			tabLinks[id].onclick = showTab;
			tabLinks[id].onfocus = function() { this.blur() };
			if ( i == 0 ) tabLinks[id].className = 'selected';
			i++;
		  }
		  // Hide all content divs except the first
		  var i = 0;
		  for ( var id in contentDivs ) {
			if ( i != 0 ) contentDivs[id].className = 'tabContent hide';
			i++;
		  }
		}
		function showTab() {
		  var selectedId = getHash( this.getAttribute('href') );
		  // Highlight the selected tab, and dim all others.
		  // Also show the selected content div, and hide all others.
		  for ( var id in contentDivs ) {
			if ( id == selectedId ) {
			  tabLinks[id].className = 'selected';
			  contentDivs[id].className = 'tabContent';
			} else {
			  tabLinks[id].className = '';
			  contentDivs[id].className = 'tabContent hide';
			}
		  }
		  // Stop the browser following the link
		  return false;
		}
		function getFirstChildWithTagName( element, tagName ) {
		  for ( var i = 0; i < element.childNodes.length; i++ ) {
			if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
		  }
		}
		function getHash( url ) {
		  var hashPos = url.lastIndexOf ( '#' );
		  return url.substring( hashPos + 1 );
		}
 </script>	
 

  <div id="media_tabs">
     
        <ul id="tabs">
            <li class="first">
                <a href="#vid_about" class="selected">About this Video</a>
            </li>
            <li class="">
                <a href="#vid_index" class="">Playlist</a>
            </li>
            <li class="">
                <a href="#vid_playlist" class="">Transcript</a>
            </li>
            <li class="">
                <a href="#vid_related" class="">Download this Video</a>
            </li>
        </ul>
   
        <div id="vid_about" itemprop="description" class="tabContent">
<p><strong>Description:</strong> In this lecture, Professor Zeldovich discusses side-channel attacks, specifically timing attacks.</p>  <p><strong>Instructor:</strong> Nickolai Zeldovich</p>
</div>
        <div id="vid_index" itemprop="description" class="tabContent hide">
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-1-introduction-threat-models/index.htm">
<img src="https://img.youtube.com/vi/GqmQg-cszw4/default.jpg" title="Lecture 1: Introduction, Threat Models" alt="Lecture 1: Introduction, Threat Models">
<p>Lecture 1: Introduction, Th...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-2-control-hijacking-attacks/index.htm">
<img src="https://img.youtube.com/vi/r4KjHEgg9Wg/default.jpg" title="Lecture 2: Control Hijacking Attacks" alt="Lecture 2: Control Hijacking Attacks">
<p>Lecture 2: Control Hijackin...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-3-buffer-overflow-exploits-and-defenses/index.htm">
<img src="https://img.youtube.com/vi/xSQxaie_h1o/default.jpg" title="Lecture 3: Buffer Overflow Exploits and Defenses" alt="Lecture 3: Buffer Overflow Exploits and Defenses">
<p>Lecture 3: Buffer Overflow ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-4-privilege-separation/index.htm">
<img src="https://img.youtube.com/vi/dNl22h1kW1k/default.jpg" title="Lecture 4: Privilege Separation" alt="Lecture 4: Privilege Separation">
<p>Lecture 4: Privilege Separa...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-6-capabilities/index.htm">
<img src="https://img.youtube.com/vi/TQhmua7Z2cY/default.jpg" title="Lecture 6: Capabilities" alt="Lecture 6: Capabilities">
<p>Lecture 6: Capabilities</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-7-sandboxing-native-code/index.htm">
<img src="https://img.youtube.com/vi/I0Psvvky-44/default.jpg" title="Lecture 7: Sandboxing Native Code	" alt="Lecture 7: Sandboxing Native Code	">
<p>Lecture 7: Sandboxing Nativ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-8-web-security-model/index.htm">
<img src="https://img.youtube.com/vi/eRJ_r8WF1Y0/default.jpg" title="Lecture 8: Web Security Model" alt="Lecture 8: Web Security Model">
<p>Lecture 8: Web Security Model</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-9-securing-web-applications/index.htm">
<img src="https://img.youtube.com/vi/WlmKwIe9z1Q/default.jpg" title="Lecture 9: Securing Web Applications" alt="Lecture 9: Securing Web Applications">
<p>Lecture 9: Securing Web App...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-10-symbolic-execution/index.htm">
<img src="https://img.youtube.com/vi/yRVZPvHYHzw/default.jpg" title="Lecture 10: Symbolic Execution" alt="Lecture 10: Symbolic Execution">
<p>Lecture 10: Symbolic Execution</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-11-ur-web/index.htm">
<img src="https://img.youtube.com/vi/XMEFdofERLI/default.jpg" title="Lecture 11: Ur/Web" alt="Lecture 11: Ur/Web">
<p>Lecture 11: Ur/Web</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-12-network-security/index.htm">
<img src="https://img.youtube.com/vi/BZTWXl9QNK8/default.jpg" title="Lecture 12: Network Security" alt="Lecture 12: Network Security">
<p>Lecture 12: Network Security</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-13-network-protocols/index.htm">
<img src="https://img.youtube.com/vi/QOtA76ga_fY/default.jpg" title="Lecture 13: Network Protocols" alt="Lecture 13: Network Protocols">
<p>Lecture 13: Network Protocols</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-14-ssl-and-https/index.htm">
<img src="https://img.youtube.com/vi/q1OF_0ICt9A/default.jpg" title="Lecture 14: SSL and HTTPS" alt="Lecture 14: SSL and HTTPS">
<p>Lecture 14: SSL and HTTPS</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-15-medical-software/index.htm">
<img src="https://img.youtube.com/vi/bA3xCpYLA34/default.jpg" title="Lecture 15: Medical Software" alt="Lecture 15: Medical Software">
<p>Lecture 15: Medical Software</p></a>
</div>
<div class="related-media-thumbnail-nolink">
<div class="now-playing-resource">Now Playing</div>
<img src="https://img.youtube.com/vi/3v5Von-oNUg/default.jpg" title="Lecture 16: Side-Channel Attacks" alt="Lecture 16: Side-Channel Attacks">
<p>Lecture 16: Side-Channel At...</p>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-17-user-authentication/index.htm">
<img src="https://img.youtube.com/vi/MT7X17ZRo1U/default.jpg" title="Lecture 17: User Authentication" alt="Lecture 17: User Authentication">
<p>Lecture 17: User Authentica...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-18-private-browsing/index.htm">
<img src="https://img.youtube.com/vi/YTWXAFJf8bw/default.jpg" title="Lecture 18: Private Browsing" alt="Lecture 18: Private Browsing">
<p>Lecture 18: Private Browsing</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-19-anonymous-communication/index.htm">
<img src="https://img.youtube.com/vi/OgGTJIgNewE/default.jpg" title="Lecture 19: Anonymous Communication" alt="Lecture 19: Anonymous Communication">
<p>Lecture 19: Anonymous Commu...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-20-mobile-phone-security/index.htm">
<img src="https://img.youtube.com/vi/uT7BXusDgDM/default.jpg" title="Lecture 20: Mobile Phone Security" alt="Lecture 20: Mobile Phone Security">
<p>Lecture 20: Mobile Phone Se...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-21-data-tracking/index.htm">
<img src="https://img.youtube.com/vi/WG5UbMrUiLU/default.jpg" title="Lecture 21: Data Tracking" alt="Lecture 21: Data Tracking">
<p>Lecture 21: Data Tracking</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-22-guest-lecture-by-mit-is-t/index.htm">
<img src="https://img.youtube.com/vi/2PO8h1pVW50/default.jpg" title="Lecture 22: Guest Lecture by MIT IS&amp;T" alt="Lecture 22: Guest Lecture by MIT IS&amp;T">
<p>Lecture 22: Guest Lecture b...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-23-security-economics/index.htm">
<img src="https://img.youtube.com/vi/8PdnOZI7H5E/default.jpg" title="Lecture 23: Security Economics" alt="Lecture 23: Security Economics">
<p>Lecture 23: Security Economics</p></a>
</div>
</div>
        <div id="vid_playlist" itemprop="description" class="tabContent hide">
<ul><li><a class="transcript-link" title="Open in a new window." alt="Open in a new window." style="text-decoration: none; font-size: 1.0em;" target="_blank" text-decoration: none font-size: href="../../../contents/video-lectures/lecture-16-side-channel-attacks/3v5Von-oNUg.pdf"> Download English-US transcript (PDF)</a></li></ul>
<p><span m="90">The</span> <span m="170">following</span> <span m="610">content</span> <span m="1120">is</span> <span m="1230">provided</span> <span m="1670">under</span> <span m="1950">a</span> <span m="1980">Creative</span> <span m="2430">Commons</span> <span m="2830">license.</span> <span m="3810">Your</span> <span m="3920">support</span> <span m="4420">will</span> <span m="4560">help</span> <span m="4820">MIT</span> <span m="5310">OpenCourseWare</span> <span m="6050">continue</span> <span m="6540">to</span> <span m="6690">offer</span> <span m="7000">high</span> <span m="7210">quality</span> <span m="7720">educational</span> <span m="8360">resources</span> <span m="8940">for</span> <span m="9080">free.</span> <span m="10160">To</span> <span m="10260">make</span> <span m="10340">a</span> <span m="10400">donation</span> <span m="11100">or</span> <span m="11340">to</span> <span m="11450">view</span> <span m="11660">additional</span> <span m="12070">materials</span> <span m="12690">from</span> <span m="12860">hundreds</span> <span m="13190">of</span> <span m="13300">MIT</span> <span m="13680">courses,</span> <span m="15000">visit</span> <span m="15160">MIT</span> <span m="15690">OpenCourseWare</span> <span m="16590">at</span> <span m="16830">ocw.mit.edu.</span> </p>
<p><span m="26700">PROFESSOR: All right,</span> <span m="26960">guys,</span> <span m="27400">let's</span> <span m="27800">get</span> <span m="28060">started.</span> <span m="29030">So today,</span> <span m="29330">we're going to</span> <span m="29737">talk about</span> <span m="30144">side-channel</span> <span m="30551">attacks,</span> <span m="31330">which</span> <span m="31540">is</span> <span m="32910">a general</span> <span m="33110">class</span> <span m="33850">of</span> <span m="34070">problems</span> <span m="34500">that</span> <span m="35802">comes</span> <span m="36250">up in</span> <span m="36470">all</span> <span m="36610">kinds</span> <span m="36820">of</span> <span m="36900">systems.</span> <span m="38870">Broadly,</span> <span m="39280">side-channel</span> <span m="39720">attacks</span> <span m="40160">are</span> <span m="40320">situations</span> <span m="40830">where</span> <span m="41020">you haven't</span> <span m="41460">thought</span> <span m="41590">about</span> <span m="41660">some</span> <span m="42010">information</span> <span m="42570">that</span> <span m="42790">your</span> <span m="43220">system</span> <span m="43450">might be</span> <span m="43600">revealing.</span> </p>
<p><span m="44810">So</span> <span m="45190">typically,</span> <span m="45480">you</span> <span m="45770">have</span> <span m="46590">multiple</span> <span m="47110">components</span> <span m="47370">that you</span> <span m="47630">[INAUDIBLE]</span> <span m="47860">maybe</span> <span m="48290">a</span> <span m="48720">user</span> <span m="49010">talking</span> <span m="49300">to some</span> <span m="49760">server.</span> <span m="50480">And</span> <span m="50580">you're</span> <span m="50780">thinking,</span> <span m="51210">great,</span> <span m="51670">I</span> <span m="52300">know</span> <span m="52500">exactly</span> <span m="52730">all</span> <span m="52940">the bits</span> <span m="53387">going over</span> <span m="53834">some</span> <span m="54281">wire</span> <span m="54728">[INAUDIBLE]</span> <span m="55175">server,</span> <span m="56069">and</span> <span m="56970">those are</span> <span m="57300">secure.</span> <span m="57600">But</span> <span m="58240">it's</span> <span m="58380">often</span> <span m="58840">easy</span> <span m="59140">to</span> <span m="59240">miss</span> <span m="59670">some</span> <span m="60015">information</span> <span m="60360">revealed,</span> <span m="60796">either</span> <span m="61232">by</span> <span m="61670">user</span> <span m="62320">or</span> <span m="62560">by</span> <span m="62930">server.</span> <span m="63830">So</span> <span m="64135">the</span> <span m="64440">example</span> <span m="64906">that</span> <span m="65840">the paper</span> <span m="66020">for</span> <span m="66430">today</span> <span m="66970">talks</span> <span m="67310">about</span> <span m="67800">is a</span> <span m="68183">situation</span> <span m="68950">where</span> <span m="69330">the</span> <span m="69640">timing</span> <span m="70010">of the messages</span> <span m="70465">between</span> <span m="70920">the user and</span> <span m="71403">the server</span> <span m="72370">reveals</span> <span m="72900">some</span> <span m="73100">additional</span> <span m="73480">information</span> <span m="74570">that</span> <span m="74810">you</span> <span m="75050">wouldn't</span> <span m="75420">have</span> <span m="75590">otherwise</span> <span m="76070">learned</span> <span m="76370">by</span> <span m="76540">just</span> <span m="76970">observing</span> <span m="77410">the</span> <span m="77530">bits</span> <span m="78310">flowing</span> <span m="78690">between</span> <span m="79040">these</span> <span m="79270">two</span> <span m="79390">guys.</span> </p>
<p><span m="80930">But</span> <span m="81030">In</span> <span m="81110">fact,</span> <span m="81320">there's</span> <span m="82010">a</span> <span m="82080">much</span> <span m="82340">broader</span> <span m="83240">class</span> <span m="83670">of</span> <span m="83800">side-channels</span> <span m="84650">you</span> <span m="84720">might worry</span> <span m="84990">about.</span> <span m="85790">Originally,</span> <span m="86290">side-channels</span> <span m="87370">showed</span> <span m="87660">up,</span> <span m="88550">or</span> <span m="88680">people</span> <span m="88930">discovered</span> <span m="89340">them</span> <span m="89570">in</span> <span m="89650">the</span> <span m="89730">'40s</span> <span m="90640">when</span> <span m="90820">they</span> <span m="90940">discovered</span> <span m="91360">that</span> <span m="91740">when</span> <span m="91900">you</span> <span m="92200">start</span> <span m="92540">typing</span> <span m="92830">characters</span> <span m="93440">on a</span> <span m="93770">teletype</span> <span m="94430">the</span> <span m="95190">electronics,</span> <span m="95970">or</span> <span m="96100">the</span> <span m="96390">electrical</span> <span m="96850">machinery</span> <span m="97110">in</span> <span m="97540">the</span> <span m="97750">teletype,</span> <span m="97910">would</span> <span m="98310">emit</span> <span m="98760">RF radiation.</span> <span m="99580">And</span> <span m="99990">you</span> <span m="100190">can</span> <span m="100810">hook up</span> <span m="101140">an oscilloscope</span> <span m="101520">nearby</span> <span m="101920">and</span> <span m="102340">just</span> <span m="102520">watch</span> <span m="102740">the</span> <span m="102860">characters</span> <span m="103270">being</span> <span m="103400">typed</span> <span m="103620">out</span> <span m="104490">by</span> <span m="105020">monitoring</span> <span m="105570">the</span> <span m="105720">frequency</span> <span m="106950">or</span> <span m="107230">RF frequencies</span> <span m="107730">that</span> <span m="108230">are</span> <span m="108730">going out</span> <span m="108980">of this</span> <span m="109160">machine.</span> <span m="109800">So</span> <span m="110500">RF radiation</span> <span m="111230">is</span> <span m="112000">a</span> <span m="112190">classic</span> <span m="112610">example</span> <span m="113130">of</span> <span m="113240">a</span> <span m="113700">side-channel</span> <span m="114410">that</span> <span m="114600">you</span> <span m="114730">might</span> <span m="115660">worry</span> <span m="115950">about.</span> </p>
<p><span m="117490">And there's</span> <span m="118540">lots</span> <span m="118810">of</span> <span m="118900">examples</span> <span m="119960">lots</span> <span m="120120">of</span> <span m="120220">other</span> <span m="120400">examples</span> <span m="120880">that people</span> <span m="121220">have looked</span> <span m="121570">at,</span> <span m="122400">almost</span> <span m="122730">anything.</span> <span m="122900">So</span> <span m="123420">power</span> <span m="123730">usage</span> <span m="124440">is</span> <span m="124936">another</span> <span m="126840">side-channel</span> <span m="127380">you</span> <span m="127430">might</span> <span m="127650">worry</span> <span m="127890">about.</span> <span m="128259">So</span> <span m="128800">your</span> <span m="128910">computer</span> <span m="129280">is</span> <span m="129360">probably</span> <span m="129620">going</span> <span m="129750">to</span> <span m="129800">use</span> <span m="130160">different</span> <span m="130430">amounts</span> <span m="130699">of</span> <span m="130820">power</span> <span m="131200">depending</span> <span m="131550">on</span> <span m="131670">what</span> <span m="131850">exactly</span> <span m="132230">it's computing.</span> <span m="133970">I'm gonna go into</span> <span m="135050">other</span> <span m="135310">clever</span> <span m="135590">examples</span> <span m="135900">of</span> <span m="136210">sound</span> <span m="137200">turns out</span> <span m="137450">to also</span> <span m="137760">leak</span> <span m="137940">stuff.</span> </p>
<p><span m="139330">There's</span> <span m="139640">a</span> <span m="139945">[? cute ?]</span> <span m="140250">paper</span> <span m="140650">that</span> <span m="140820">you</span> <span m="140910">can</span> <span m="141080">look</span> <span m="141260">at.</span> <span m="141740">The</span> <span m="142010">people</span> <span m="143026">listen</span> <span m="143502">to a</span> <span m="143980">printer</span> <span m="144320">and</span> <span m="144620">based</span> <span m="144890">on</span> <span m="144980">the</span> <span m="145060">sound</span> <span m="145430">the printer</span> <span m="145690">is making</span> <span m="146240">you can</span> <span m="146500">tell</span> <span m="146760">what</span> <span m="146970">characters</span> <span m="147540">it's</span> <span m="147650">printing.</span> <span m="148670">This is</span> <span m="149260">especially</span> <span m="149810">easy</span> <span m="150060">to</span> <span m="150210">do for</span> <span m="150530">dot matrix</span> <span m="151020">printers</span> <span m="151510">that make</span> <span m="151880">this</span> <span m="152130">very</span> <span m="152450">annoying</span> <span m="152770">sound</span> <span m="153113">when</span> <span m="153456">they're printing.</span> </p>
<p><span m="155180">And</span> <span m="156350">in general,</span> <span m="156850">a</span> <span m="157350">good</span> <span m="157510">thing</span> <span m="157700">to</span> <span m="157930">think</span> <span m="158260">about,</span> <span m="158690">Kevin</span> <span m="159400">on</span> <span m="159530">Monday's</span> <span m="159840">lecture</span> <span m="160120">also</span> <span m="160330">mentioned</span> <span m="161330">some interesting</span> <span m="161990">side-channels</span> <span m="162670">that he's running through in</span> <span m="163966">his research.</span> <span m="165700">But,</span> <span m="166450">in</span> <span m="166510">particular,</span> <span m="168370">here</span> <span m="168830">we're</span> <span m="168990">going</span> <span m="169090">to</span> <span m="169450">look</span> <span m="169740">at</span> <span m="170300">the</span> <span m="170620">specific</span> <span m="171120">side-channel</span> <span m="171880">that</span> <span m="172590">David Brumley</span> <span m="173050">and</span> <span m="173500">Dan Boneh</span> <span m="174160">looked</span> <span m="174390">at</span> <span m="174870">in</span> <span m="175350">their</span> <span m="175760">paper--</span> <span m="176080">I guess</span> <span m="176400">about</span> <span m="176610">10</span> <span m="176760">years</span> <span m="176990">ago</span> <span m="177200">now--</span> <span m="177780">where</span> <span m="178110">they were</span> <span m="178250">able</span> <span m="178660">to</span> <span m="178730">extract</span> <span m="179095">a</span> <span m="179460">cryptographic</span> <span m="179800">key</span> <span m="180920">out of</span> <span m="181200">a</span> <span m="181290">web</span> <span m="181470">server</span> <span m="181960">running</span> <span m="182290">Apache</span> <span m="183170">by</span> <span m="183430">measuring</span> <span m="183820">the</span> <span m="183970">timing</span> <span m="184310">of</span> <span m="184640">different</span> <span m="184920">responses</span> <span m="186310">to</span> <span m="186600">different</span> <span m="186880">input</span> <span m="187130">packets</span> <span m="187690">from</span> <span m="188530">the</span> <span m="189140">adversarial</span> <span m="190140">client.</span> </p>
<p><span m="191520">And</span> <span m="193090">in</span> <span m="193200">this</span> <span m="193330">particular</span> <span m="193590">case,</span> <span m="194150">they're</span> <span m="194330">going</span> <span m="194530">after a</span> <span m="194570">cryptographic</span> <span m="195530">key.</span> <span m="195990">In</span> <span m="196250">fact,</span> <span m="196510">many</span> <span m="196770">side-channel</span> <span m="197010">attacks</span> <span m="197860">target</span> <span m="198090">cryptographic</span> <span m="198500">keys</span> <span m="199120">partly</span> <span m="199380">because</span> <span m="200790">it's</span> <span m="200940">a</span> <span m="200980">little</span> <span m="201200">bit</span> <span m="201440">tricky</span> <span m="201740">to</span> <span m="201850">get</span> <span m="202090">lots</span> <span m="202610">of</span> <span m="202810">data</span> <span m="203160">through</span> <span m="203740">a</span> <span m="203830">side-channel.</span> <span m="204800">And</span> <span m="205280">cryptographic</span> <span m="205650">keys</span> <span m="206020">are</span> <span m="206110">one situation</span> <span m="206410">where</span> <span m="206840">getting</span> <span m="207270">a</span> <span m="207330">small</span> <span m="207680">number</span> <span m="208140">of bits</span> <span m="208810">helps</span> <span m="209070">you</span> <span m="209210">a</span> <span m="209260">lot.</span> <span m="210050">So</span> <span m="210700">in their</span> <span m="210990">attack</span> <span m="211490">they're</span> <span m="211800">able to</span> <span m="211880">extract</span> <span m="212490">maybe</span> <span m="212870">about</span> <span m="213630">200</span> <span m="214710">256</span> <span m="215330">bits</span> <span m="215930">or</span> <span m="216080">so.</span> </p>
<p><span m="216760">And</span> <span m="217100">just</span> <span m="217310">from</span> <span m="217400">those</span> <span m="217880">200ish</span> <span m="218290">bits,</span> <span m="218530">they're</span> <span m="218970">able</span> <span m="219300">to</span> <span m="219400">break</span> <span m="219800">the</span> <span m="220120">cryptographic</span> <span m="220420">key</span> <span m="220840">of</span> <span m="221060">this</span> <span m="221220">web</span> <span m="221585">server.</span> <span m="222300">Whereas,</span> <span m="223110">if</span> <span m="223220">you're</span> <span m="223350">trying</span> <span m="223590">to</span> <span m="223660">leak</span> <span m="223890">some</span> <span m="224090">database</span> <span m="224730">full of</span> <span m="224990">Social</span> <span m="225310">Security</span> <span m="225680">numbers,</span> <span m="226140">then</span> <span m="226720">that'll</span> <span m="226850">be</span> <span m="226940">a</span> <span m="227000">lot</span> <span m="227340">of</span> <span m="227470">bits</span> <span m="227840">you</span> <span m="228340">have</span> <span m="228460">to leak</span> <span m="228720">to get</span> <span m="228960">out</span> <span m="229240">of</span> <span m="229280">this</span> <span m="229890">database.</span> <span m="231082">So</span> <span m="231430">that's why</span> <span m="231720">many</span> <span m="231890">of</span> <span m="231990">these</span> <span m="232170">side-channels,</span> <span m="233290">if</span> <span m="233430">you'll</span> <span m="233820">see</span> <span m="233990">them</span> <span m="234400">later</span> <span m="234740">on,</span> <span m="235160">they</span> <span m="235270">often</span> <span m="235670">focus</span> <span m="235860">on</span> <span m="236210">getting</span> <span m="237720">small</span> <span m="238510">secrets</span> <span m="239020">out,</span> <span m="239240">might be</span> <span m="239460">cryptographic</span> <span m="239880">keys</span> <span m="240720">or</span> <span m="241400">passwords.</span> <span m="242850">But</span> <span m="243020">in</span> <span m="243100">general,</span> <span m="243440">this</span> <span m="243770">is</span> <span m="244100">applicable</span> <span m="244560">to</span> <span m="244630">lots</span> <span m="244970">of</span> <span m="245800">other</span> <span m="246610">situations</span> <span m="246980">as</span> <span m="247350">well.</span> </p>
<p><span m="249210">And</span> <span m="249730">one</span> <span m="250140">cool</span> <span m="250360">thing</span> <span m="250500">about</span> <span m="250670">this</span> <span m="250790">paper,</span> <span m="251230">before</span> <span m="251470">we</span> <span m="251820">jump</span> <span m="252040">into</span> <span m="252360">the</span> <span m="252460">details,</span> <span m="253180">is</span> <span m="253410">that</span> <span m="254210">they</span> <span m="254340">show</span> <span m="254480">that you</span> <span m="254850">actually</span> <span m="255220">do this</span> <span m="255590">over</span> <span m="255780">the</span> <span m="255910">network.</span> <span m="256459">So</span> <span m="257070">as</span> <span m="257190">you</span> <span m="257310">probably</span> <span m="258000">figured out</span> <span m="258300">from reading</span> <span m="258595">this paper,</span> <span m="258890">they</span> <span m="259010">have</span> <span m="259140">to</span> <span m="259240">do</span> <span m="259339">a</span> <span m="259430">lot</span> <span m="259690">of</span> <span m="259790">careful</span> <span m="260269">work</span> <span m="260560">to</span> <span m="261190">tease</span> <span m="261459">out</span> <span m="261730">these</span> <span m="262070">minute</span> <span m="262510">differences</span> <span m="263150">in</span> <span m="263390">timing</span> <span m="263780">information.</span> <span m="264670">So</span> <span m="265100">if</span> <span m="265230">you</span> <span m="265410">actually</span> <span m="265680">compute</span> <span m="266040">out</span> <span m="266300">the</span> <span m="266380">numbers</span> <span m="266950">from</span> <span m="267500">this</span> <span m="267630">paper,</span> <span m="268290">it</span> <span m="268390">turns</span> <span m="268650">out</span> <span m="268950">that</span> <span m="269440">each</span> <span m="269730">request</span> <span m="270880">that</span> <span m="271170">they</span> <span m="271330">sent</span> <span m="271590">to</span> <span m="271650">the</span> <span m="271780">server</span> <span m="273190">differs</span> <span m="273810">from</span> <span m="274180">potentially</span> <span m="274540">another</span> <span m="275020">[? website ?]</span> <span m="275365">by</span> <span m="275990">an order of</span> <span m="276450">1 to</span> <span m="276890">2</span> <span m="277960">microseconds,</span> <span m="279310">which</span> <span m="279480">is</span> <span m="280010">pretty</span> <span m="280250">tiny.</span> </p>
<p><span m="281280">So</span> <span m="282420">you</span> <span m="282540">have</span> <span m="282700">to</span> <span m="283640">be</span> <span m="284100">quite</span> <span m="284360">careful,</span> <span m="284950">and</span> <span m="286240">all</span> <span m="286580">of our</span> <span m="286680">network</span> <span m="287000">it</span> <span m="287080">might</span> <span m="287250">be</span> <span m="287330">hard</span> <span m="287620">to</span> <span m="287720">tell</span> <span m="288000">whether</span> <span m="288880">some</span> <span m="289100">server</span> <span m="289540">took</span> <span m="290080">1</span> <span m="290460">or</span> <span m="290550">2</span> <span m="290680">microseconds</span> <span m="291320">longer</span> <span m="291880">to</span> <span m="291960">process</span> <span m="292320">your</span> <span m="292460">request</span> <span m="292830">or</span> <span m="292940">not.</span> <span m="293750">And</span> <span m="294510">as</span> <span m="294630">a</span> <span m="294670">result,</span> <span m="295610">it</span> <span m="295770">was</span> <span m="296080">not</span> <span m="296390">so</span> <span m="296610">clear</span> <span m="297120">for</span> <span m="297500">whether</span> <span m="297970">you</span> <span m="298150">could</span> <span m="298580">mount</span> <span m="298880">this</span> <span m="299010">kind</span> <span m="299170">of</span> <span m="299250">attack</span> <span m="299650">over</span> <span m="299960">a very</span> <span m="300300">noisy</span> <span m="300640">network.</span> <span m="301060">And</span> <span m="301160">these</span> <span m="301310">guys</span> <span m="301990">were</span> <span m="302530">one</span> <span m="302770">of</span> <span m="303030">the</span> <span m="303170">first</span> <span m="303460">people</span> <span m="303690">to</span> <span m="303790">show</span> <span m="304060">that</span> <span m="304270">you</span> <span m="304350">can</span> <span m="304440">actually</span> <span m="304650">do</span> <span m="304750">this</span> <span m="305020">over</span> <span m="305260">a</span> <span m="305350">real</span> <span m="306280">ethernet</span> <span m="306620">network</span> <span m="307170">with</span> <span m="307370">a server</span> <span m="307770">sitting in</span> <span m="308170">one</span> <span m="308430">place,</span> <span m="308695">a</span> <span m="308960">client</span> <span m="309200">sitting</span> <span m="309600">somewhere</span> <span m="309960">else.</span> <span m="310680">And</span> <span m="310800">you</span> <span m="310860">could</span> <span m="310980">actually</span> <span m="311290">measure</span> <span m="311570">these</span> <span m="311770">differences</span> <span m="312460">partly</span> <span m="312750">by</span> <span m="312900">averaging,</span> <span m="313490">partly</span> <span m="313880">through</span> <span m="314550">other</span> <span m="314800">tricks.</span> <span m="316740">All right,</span> <span m="317160">does that</span> <span m="317280">make</span> <span m="317410">sense,</span> <span m="318716">the</span> <span m="319060">overall</span> <span m="319610">side-channel</span> <span m="320380">stuff?</span> </p>
<p><span m="321510">All right.</span> <span m="321770">So</span> <span m="321850">the</span> <span m="321950">plan</span> <span m="322470">for</span> <span m="322700">the</span> <span m="322780">rest</span> <span m="322970">of this</span> <span m="323130">lecture</span> <span m="323860">is</span> <span m="324170">we'll</span> <span m="324400">first</span> <span m="324830">dive</span> <span m="325090">into</span> <span m="325790">the</span> <span m="325890">details</span> <span m="326550">of</span> <span m="327250">this</span> <span m="327460">RSA</span> <span m="327990">cryptosystem</span> <span m="328890">that</span> <span m="329180">these</span> <span m="329380">guys</span> <span m="329600">use.</span> <span m="329800">Then</span> <span m="330500">we'll</span> <span m="330790">not look</span> <span m="331020">at</span> <span m="331200">exactly</span> <span m="331570">why</span> <span m="331830">it's secure</span> <span m="332480">or</span> <span m="332660">not</span> <span m="333250">but</span> <span m="333380">we'll</span> <span m="333580">look</span> <span m="333760">at</span> <span m="333930">how</span> <span m="334010">do</span> <span m="334070">you</span> <span m="334280">implement</span> <span m="334790">it</span> <span m="334900">because</span> <span m="335150">that</span> <span m="335300">turns</span> <span m="335490">out</span> <span m="335610">to</span> <span m="335650">be</span> <span m="335810">critical</span> <span m="336300">for</span> <span m="336560">exploiting</span> <span m="337980">this</span> <span m="338260">particular</span> <span m="338670">side-channel.</span> <span m="339350">They</span> <span m="339950">carefully</span> <span m="340430">leverage</span> <span m="340890">various</span> <span m="341270">details</span> <span m="341620">of the</span> <span m="341740">implementation</span> <span m="342800">to</span> <span m="343000">figure</span> <span m="343330">out</span> <span m="343590">when</span> <span m="343760">there are</span> <span m="343930">some</span> <span m="344120">things</span> <span m="344390">faster</span> <span m="344830">or</span> <span m="344970">slower.</span> <span m="346190">And then</span> <span m="346370">we'll</span> <span m="346680">pop</span> <span m="346820">back</span> <span m="346960">out</span> <span m="347420">once</span> <span m="347600">we</span> <span m="347690">understand</span> <span m="348080">how</span> <span m="348480">RSA is</span> <span m="348810">implemented.</span> <span m="349210">Then</span> <span m="349610">we'll</span> <span m="349910">come</span> <span m="350100">back</span> <span m="350740">and</span> <span m="351190">figure</span> <span m="351500">out</span> <span m="351730">how do you</span> <span m="351950">attack</span> <span m="352410">it, how do you</span> <span m="352690">attack</span> <span m="353070">all</span> <span m="353180">these</span> <span m="353320">different</span> <span m="353580">organizations</span> <span m="354250">that</span> <span m="354500">RSA</span> <span m="354730">has.</span> <span m="356040">Sounds</span> <span m="356180">good?</span> <span m="357580">All right.</span> </p>
<p><span m="358710">So</span> <span m="359530">I</span> <span m="359600">guess</span> <span m="359780">let's</span> <span m="359900">start</span> <span m="360150">off</span> <span m="360320">by</span> <span m="360440">looking</span> <span m="360760">at</span> <span m="360900">the</span> <span m="361140">high</span> <span m="361410">level</span> <span m="361680">plan</span> <span m="361990">for</span> <span m="363050">RSA.</span> <span m="364200">So</span> <span m="364850">RSA</span> <span m="365040">is a</span> <span m="365320">pretty</span> <span m="365660">widely</span> <span m="366060">used</span> <span m="366870">public</span> <span m="367240">key</span> <span m="367840">cryptosystem.</span> <span m="368940">We've</span> <span m="369290">mentioned</span> <span m="369630">these</span> <span m="369820">guys</span> <span m="370330">a</span> <span m="370370">couple</span> <span m="370580">of weeks</span> <span m="370800">ago</span> <span m="371090">in</span> <span m="371220">general</span> <span m="372040">in</span> <span m="372230">certificates,</span> <span m="372930">in</span> <span m="373010">the</span> <span m="373090">context</span> <span m="373410">of</span> <span m="373480">certificates.</span> <span m="374690">But</span> <span m="374850">now</span> <span m="375000">we're</span> <span m="375110">going</span> <span m="375210">to</span> <span m="375270">look</span> <span m="375440">at</span> <span m="376130">actually</span> <span m="376470">how</span> <span m="376660">it</span> <span m="376810">works.</span> <span m="377100">So</span> <span m="377720">typically</span> <span m="378500">there's</span> <span m="379000">3</span> <span m="379220">things</span> <span m="379420">you</span> <span m="379500">have</span> <span m="379650">to</span> <span m="379750">worry</span> <span m="380010">about.</span> <span m="380710">So</span> <span m="381260">there's</span> <span m="381940">generating</span> <span m="382400">a</span> <span m="382470">key,</span> <span m="383060">encrypting,</span> <span m="383880">and</span> <span m="384060">decrypting.</span> <span m="385290">So</span> <span m="385390">for</span> <span m="385640">RSA,</span> <span m="385860">the way</span> <span m="386070">you</span> <span m="386160">generate</span> <span m="386740">a</span> <span m="387065">key</span> <span m="387940">is</span> <span m="388890">you actually</span> <span m="389220">pick</span> <span m="389780">2</span> <span m="390340">large</span> <span m="390860">prime</span> <span m="391360">integers.</span> <span m="392220">So</span> <span m="392460">you're</span> <span m="392700">going</span> <span m="392800">to</span> <span m="392850">pick</span> <span m="393340">2</span> <span m="393490">primes,</span> <span m="394220">p and q.</span> </p>
<p><span m="395500">And</span> <span m="396970">in</span> <span m="397080">the</span> <span m="397180">paper,</span> <span m="398890">these</span> <span m="399120">guys</span> <span m="400130">focus</span> <span m="400600">on</span> <span m="401440">p and q,</span> <span m="402020">which</span> <span m="402240">are</span> <span m="402430">about</span> <span m="403170">512</span> <span m="404102">bits</span> <span m="405060">each.</span> <span m="405810">So</span> <span m="406410">this</span> <span m="406560">is</span> <span m="406660">typically</span> <span m="407360">called</span> <span m="408060">1,024</span> <span m="408800">bit</span> <span m="409170">RSA</span> <span m="409730">because</span> <span m="410150">the</span> <span m="410600">resulting</span> <span m="411200">product</span> <span m="411690">of</span> <span m="411800">these</span> <span m="412010">primes that</span> <span m="412380">you're</span> <span m="412570">going</span> <span m="412670">to</span> <span m="412720">use</span> <span m="412920">in</span> <span m="412980">a</span> <span m="413050">second</span> <span m="413710">is</span> <span m="413970">a</span> <span m="414500">1,000</span> <span m="414730">bit</span> <span m="414950">integer</span> <span m="415280">number.</span> <span m="416500">These</span> <span m="416690">days,</span> <span m="417075">that's</span> <span m="417460">probably</span> <span m="417730">not</span> <span m="418060">a</span> <span m="418120">particularly</span> <span m="418610">good</span> <span m="418880">choice</span> <span m="419360">for</span> <span m="419520">the</span> <span m="419630">size</span> <span m="420050">of</span> <span m="420180">your</span> <span m="420650">RSA</span> <span m="420995">key</span> <span m="421340">because</span> <span m="422060">it</span> <span m="422170">makes</span> <span m="422420">it</span> <span m="422840">relatively</span> <span m="423440">easy</span> <span m="424520">for</span> <span m="424860">attackers</span> <span m="425240">to</span> <span m="425340">factor</span> <span m="425700">this--</span> <span m="426660">not</span> <span m="426860">trivial</span> <span m="427270">but</span> <span m="427850">certainly</span> <span m="428170">viable.</span> <span m="429080">So</span> <span m="429180">if</span> <span m="429990">10</span> <span m="430140">years</span> <span m="430360">ago,</span> <span m="430580">this</span> <span m="430740">seemed</span> <span m="430940">like</span> <span m="431090">a</span> <span m="431520">potentially</span> <span m="431770">sensible</span> <span m="432170">parameter,</span> <span m="432560">now</span> <span m="433160">if</span> <span m="433290">you're</span> <span m="433430">actually</span> <span m="433770">building</span> <span m="434100">a system,</span> <span m="434520">you should</span> <span m="434703">probably</span> <span m="434795">pick</span> <span m="435070">a</span> <span m="435360">2,000</span> <span m="435980">or</span> <span m="436100">3,000</span> <span m="436780">or even</span> <span m="436840">4,000</span> <span m="437670">bit</span> <span m="438440">RSA</span> <span m="438660">key.</span> <span m="439866">Well,</span> <span m="440230">that's</span> <span m="440450">what</span> <span m="440850">RSA</span> <span m="441690">key</span> <span m="441930">size</span> <span m="442260">means</span> <span m="442590">is</span> <span m="442700">the</span> <span m="442790">size</span> <span m="443120">of</span> <span m="443220">these</span> <span m="443500">primes.</span> </p>
<p><span m="444620">And</span> <span m="444780">then,</span> <span m="445550">for</span> <span m="445730">convenience,</span> <span m="446280">we're</span> <span m="446380">going</span> <span m="446480">to</span> <span m="446670">talk</span> <span m="446880">about</span> <span m="447130">the</span> <span m="447190">number</span> <span m="447520">n,</span> <span m="447900">which</span> <span m="448140">is</span> <span m="448250">just</span> <span m="448400">the</span> <span m="448480">product</span> <span m="449480">of</span> <span m="449620">these</span> <span m="449850">2</span> <span m="449950">primes,</span> <span m="450820">p</span> <span m="450990">times</span> <span m="451400">q.</span> <span m="453130">All right.</span> <span m="453510">So</span> <span m="453610">now</span> <span m="453650">we</span> <span m="453850">know</span> <span m="454010">how</span> <span m="454070">to</span> <span m="454220">generate</span> <span m="454530">a</span> <span m="454840">key,</span> <span m="455490">now</span> <span m="455630">we</span> <span m="455700">need</span> <span m="455830">to</span> <span m="455920">figure</span> <span m="456370">out--</span> <span m="456990">well</span> <span m="457380">this</span> <span m="457480">is</span> <span m="458170">at least</span> <span m="458440">part</span> <span m="458630">of</span> <span m="458700">a</span> <span m="458880">key--</span> <span m="459460">now</span> <span m="459810">we're going</span> <span m="459950">to</span> <span m="459990">have</span> <span m="460100">to</span> <span m="460230">figure</span> <span m="460580">out</span> <span m="460740">how</span> <span m="460980">we're</span> <span m="461110">going</span> <span m="461220">to</span> <span m="461350">encrypt</span> <span m="462180">and</span> <span m="463070">decrypt</span> <span m="463650">messages.</span> <span m="465060">And</span> <span m="465750">the</span> <span m="465910">way</span> <span m="466080">we're</span> <span m="466210">going</span> <span m="466310">to</span> <span m="466820">encrypt</span> <span m="467270">and</span> <span m="467430">decrypt</span> <span m="467810">messages</span> <span m="468280">is</span> <span m="468920">by</span> <span m="469640">exponentiating</span> <span m="470590">numbers</span> <span m="471390">modulo</span> <span m="472180">this</span> <span m="472670">number</span> <span m="473170">n.</span> </p>
<p><span m="474320">So</span> <span m="474410">it</span> <span m="474510">seems</span> <span m="474630">a</span> <span m="474710">little</span> <span m="475370">weird,</span> <span m="475780">but</span> <span m="475940">let's</span> <span m="476610">go</span> <span m="476900">with</span> <span m="477280">it for a</span> <span m="477440">second.</span> <span m="477790">So</span> <span m="478065">if</span> <span m="478340">you</span> <span m="478440">want</span> <span m="478540">to</span> <span m="478590">encrypt</span> <span m="478970">a message,</span> <span m="480520">then</span> <span m="481210">we're</span> <span m="481340">going</span> <span m="481430">to</span> <span m="481530">take</span> <span m="482140">a</span> <span m="482230">message</span> <span m="482630">m</span> <span m="483560">and</span> <span m="483840">transform</span> <span m="484510">it</span> <span m="485190">into</span> <span m="485730">m</span> <span m="486670">to</span> <span m="486800">the</span> <span m="487010">power</span> <span m="487490">e</span> <span m="488750">mod</span> <span m="489170">m.</span> <span m="491920">So</span> <span m="492370">e</span> <span m="492690">is</span> <span m="492810">going</span> <span m="492910">to</span> <span m="492970">be</span> <span m="493080">some</span> <span m="493220">exponent--</span> <span m="493710">we'll</span> <span m="493960">talk</span> <span m="494120">about</span> <span m="494460">how</span> <span m="494570">to</span> <span m="494730">choose</span> <span m="494900">it in</span> <span m="495010">a</span> <span m="495060">second.</span> <span m="495640">But</span> <span m="496140">this is how</span> <span m="496610">we're</span> <span m="496875">going to</span> <span m="497140">encrypt</span> <span m="497560">a message.</span> </p>
<p><span m="497880">We'll</span> <span m="498000">just</span> <span m="498220">take</span> <span m="498570">this</span> <span m="498740">message</span> <span m="499140">as</span> <span m="499790">an</span> <span m="499990">integer</span> <span m="500340">number</span> <span m="501230">and</span> <span m="501340">just</span> <span m="501470">exponentiate</span> <span m="502140">it.</span> <span m="503260">And</span> <span m="503400">then</span> <span m="503980">we'll</span> <span m="504140">see</span> <span m="504320">why</span> <span m="504620">this</span> <span m="504810">works</span> <span m="505100">in</span> <span m="505180">a</span> <span m="505230">second,</span> <span m="505610">but</span> <span m="506650">let's</span> <span m="506970">call</span> <span m="507180">this</span> <span m="507690">guy</span> <span m="508180">c,</span> <span m="508800">ciphertext.</span> <span m="510500">Then</span> <span m="510870">to</span> <span m="510960">decrypt</span> <span m="511460">it,</span> <span m="513289">we're</span> <span m="513419">going</span> <span m="513510">to</span> <span m="513940">somehow</span> <span m="515010">find</span> <span m="516039">an</span> <span m="516539">interesting</span> <span m="516900">other</span> <span m="517150">exponent</span> <span m="517799">where</span> <span m="517940">you</span> <span m="517990">can</span> <span m="518130">take</span> <span m="518299">a</span> <span m="518360">ciphertext</span> <span m="519155">c</span> <span m="519760">and</span> <span m="520070">if</span> <span m="520230">you</span> <span m="520390">exponentiate</span> <span m="520863">it</span> <span m="521336">to</span> <span m="521929">some</span> <span m="522100">power</span> <span m="522580">d</span> <span m="523650">mod</span> <span m="523970">m,</span> <span m="525510">then</span> <span m="525740">you'll</span> <span m="525900">magically</span> <span m="526440">get</span> <span m="526570">back</span> <span m="526860">the</span> <span m="526930">same</span> <span m="527270">message</span> <span m="528080">m.</span> <span m="529500">So</span> <span m="529750">this is the</span> <span m="529880">general</span> <span m="530170">plan:</span> <span m="530660">To</span> <span m="530750">encrypt,</span> <span m="531180">you</span> <span m="531550">exponentiate.</span> <span m="532290">To decrypt,</span> <span m="532620">you</span> <span m="532950">exponentiate</span> <span m="533540">by</span> <span m="533710">another</span> <span m="534900">exponent.</span> </p>
<p><span m="536700">And</span> <span m="537000">in</span> <span m="537070">general,</span> <span m="537420">it</span> <span m="537450">seems</span> <span m="537590">a</span> <span m="537670">little</span> <span m="537990">hard</span> <span m="538270">to</span> <span m="538340">figure</span> <span m="538570">out</span> <span m="538690">how</span> <span m="538900">we're</span> <span m="538990">going</span> <span m="539100">to</span> <span m="539200">come</span> <span m="539410">up</span> <span m="539590">with</span> <span m="539660">these</span> <span m="539860">two</span> <span m="539990">magic</span> <span m="540330">numbers</span> <span m="540660">that</span> <span m="540840">somehow</span> <span m="541730">end</span> <span m="541980">up</span> <span m="542400">giving</span> <span m="542660">us</span> <span m="542800">back</span> <span m="543030">the</span> <span m="543130">same</span> <span m="543380">message.</span> <span m="544390">But</span> <span m="544840">it</span> <span m="544960">turns</span> <span m="545250">out</span> <span m="545630">that</span> <span m="546280">if</span> <span m="546420">you</span> <span m="546570">look</span> <span m="546890">at</span> <span m="548825">how</span> <span m="549300">exponentiation</span> <span m="550150">works</span> <span m="550640">or</span> <span m="550750">multiplication</span> <span m="551450">works,</span> <span m="552000">modulo</span> <span m="552510">of</span> <span m="552780">this</span> <span m="553060">number</span> <span m="553440">n.</span> <span m="554340">Then</span> <span m="555010">there's</span> <span m="555170">this</span> <span m="555380">cool</span> <span m="555540">property</span> <span m="556110">that</span> <span m="557530">if</span> <span m="557750">you</span> <span m="560870">have</span> <span m="561430">any</span> <span m="561620">number</span> <span m="561980">x,</span> <span m="562670">and</span> <span m="562800">you</span> <span m="562960">raise</span> <span m="563310">it</span> <span m="563890">to</span> <span m="564180">what's</span> <span m="564440">called</span> <span m="564710">a</span> <span m="565340">[? order ?]</span> <span m="565595">of</span> <span m="565850">phi</span> <span m="566000">function</span> <span m="567350">of</span> <span m="567635">n--</span> <span m="569336">maybe I'll</span> <span m="570280">use</span> <span m="570680">more</span> <span m="570970">board space</span> <span m="571230">for this.</span> <span m="572215">This seems</span> <span m="572610">important.</span> </p>
<p><span m="573790">So</span> <span m="574570">if</span> <span m="574700">you</span> <span m="574800">take</span> <span m="575030">x</span> <span m="575350">and</span> <span m="575450">you</span> <span m="575590">raise</span> <span m="575810">it</span> <span m="576000">to</span> <span m="576780">phi</span> <span m="577186">of</span> <span m="577592">n,</span> <span m="577998">then</span> <span m="579440">this</span> <span m="579630">is</span> <span m="579780">going</span> <span m="579900">to</span> <span m="579960">be</span> <span m="580130">equal</span> <span m="580560">to</span> <span m="581015">1</span> <span m="582430">mod</span> <span m="582990">m.</span> <span m="584370">And</span> <span m="585140">this</span> <span m="585590">phi</span> <span m="585830">function</span> <span m="586580">for</span> <span m="586830">our</span> <span m="587090">particular</span> <span m="587480">choice</span> <span m="587720">of</span> <span m="587820">n</span> <span m="588260">is</span> <span m="588420">pretty</span> <span m="588830">straightforward,</span> <span m="589440">it's</span> <span m="589580">actually</span> <span m="589960">p</span> <span m="590370">minus</span> <span m="590740">1</span> <span m="591520">times</span> <span m="592940">q</span> <span m="593080">minus</span> <span m="593430">1.</span> <span m="594600">So</span> <span m="596550">this</span> <span m="596990">gives</span> <span m="597160">us</span> <span m="597260">hope</span> <span m="597500">that</span> <span m="597660">maybe</span> <span m="597920">if</span> <span m="598070">we</span> <span m="598460">pick</span> <span m="599460">ed</span> <span m="600290">so</span> <span m="600590">that</span> <span m="601060">e</span> <span m="601220">times</span> <span m="601560">d</span> <span m="602270">is</span> <span m="602840">5n</span> <span m="603260">plus</span> <span m="603550">1,</span> <span m="604970">then</span> <span m="605190">we're</span> <span m="605340">in</span> <span m="605440">good</span> <span m="605490">shape.</span> <span m="606370">Because</span> <span m="606710">then</span> <span m="607290">any</span> <span m="607490">message</span> <span m="607790">m</span> <span m="608500">we</span> <span m="608650">exponentiate</span> <span m="608955">it</span> <span m="609260">to</span> <span m="609550">e</span> <span m="610100">and</span> <span m="610320">d,</span> <span m="611200">we</span> <span m="611340">get</span> <span m="611530">back</span> <span m="612030">1</span> <span m="612300">times</span> <span m="612770">m</span> <span m="613080">because</span> <span m="613830">our</span> <span m="614430">ed</span> <span m="614790">product</span> <span m="616380">is</span> <span m="616570">going</span> <span m="616700">to</span> <span m="616760">be</span> <span m="617050">roughly</span> <span m="617910">5n</span> <span m="618600">plus</span> <span m="619140">1,</span> <span m="619420">or</span> <span m="619470">maybe</span> <span m="619740">some</span> <span m="620520">constant</span> <span m="622690">alpha</span> <span m="623430">times</span> <span m="623810">5n</span> <span m="624070">plus</span> <span m="624390">1.</span> <span m="625700">Does this</span> <span m="625810">make</span> <span m="625980">sense?</span> <span m="626320">This</span> <span m="626470">is</span> <span m="627060">why</span> <span m="628120">the</span> <span m="628230">message</span> <span m="628460">is</span> <span m="628590">going</span> <span m="628900">to get</span> <span m="629210">decrypted</span> <span m="629680">correctly.</span> <span m="630800">And</span> <span m="631240">it</span> <span m="631520">turns</span> <span m="631750">out</span> <span m="631980">that</span> <span m="632180">there's</span> <span m="632410">a</span> <span m="632990">reasonably</span> <span m="633420">straightforward</span> <span m="633900">algorithm</span> <span m="634910">if</span> <span m="635130">you</span> <span m="635270">know</span> <span m="636030">this</span> <span m="636190">phi</span> <span m="636650">value</span> <span m="638010">for</span> <span m="638340">how</span> <span m="638540">to</span> <span m="638660">compute</span> <span m="639880">d</span> <span m="640140">given</span> <span m="640400">an e</span> <span m="640690">or</span> <span m="641090">e given</span> <span m="641450">a d.</span> <span m="642670">All right.</span> <span m="642930">Question.</span> </p>
<p><span m="643770">AUDIENCE:</span> <span m="643970">Isn't 1</span> <span m="644340">mod n</span> <span m="644773">just 1?</span> </p>
<p><span m="645640">PROFESSOR: Yeah,</span> <span m="646190">so</span> <span m="646300">far</span> <span m="646730">we</span> <span m="647030">add</span> <span m="647590">one</span> <span m="648170">more.</span> <span m="648710">Sorry?</span> </p>
<p><span m="650048">AUDIENCE:</span> <span m="650537">Like,</span> <span m="651026">up</span> <span m="651515">over there.</span> </p>
<p><span m="652493">PROFESSOR: Yeah, this one?</span> </p>
<p><span m="653471">AUDIENCE: Yeah.</span> </p>
<p><span m="655430">PROFESSOR: Isn't</span> <span m="655980">1 mod n just 1?</span> <span m="657200">Sorry,</span> <span m="657730">I</span> <span m="657840">mean</span> <span m="658260">this.</span> <span m="658820">So</span> <span m="658950">when I</span> <span m="659130">say</span> <span m="659620">this</span> <span m="659870">1</span> <span m="660195">n,</span> <span m="660520">it means that</span> <span m="660795">both</span> <span m="661070">sides</span> <span m="661520">taken</span> <span m="661991">1n</span> <span m="662462">are equal.</span> <span m="664820">So</span> <span m="665420">what this</span> <span m="665540">means</span> <span m="665670">is</span> <span m="666866">if</span> <span m="667230">you</span> <span m="667650">want</span> <span m="667990">to think</span> <span m="668120">of</span> <span m="668370">mod</span> <span m="668790">as literally</span> <span m="669120">an</span> <span m="669583">operator,</span> <span m="670046">you</span> <span m="670509">would write</span> <span m="670972">this guy</span> <span m="671900">mod m</span> <span m="672060">equals</span> <span m="672350">1</span> <span m="672860">mod</span> <span m="673150">m.</span> <span m="674150">So that's</span> <span m="674420">what mod m</span> <span m="674670">on the side means.</span> <span m="675440">Like,</span> <span m="675880">the whole</span> <span m="676320">equality</span> <span m="676610">is</span> <span m="676900">mod m.</span> <span m="678325">Sorry for the</span> <span m="678800">[INAUDIBLE].</span> <span m="681175">Make sense?</span> <span m="682610">All right.</span> </p>
<p><span m="684120">So</span> <span m="684395">what</span> <span m="684670">this</span> <span m="685090">basically</span> <span m="685290">means</span> <span m="685765">for</span> <span m="686240">RSA is</span> <span m="686715">that</span> <span m="687190">we're</span> <span m="687665">going to</span> <span m="689250">pick</span> <span m="689640">some</span> <span m="690225">value</span> <span m="691210">e.</span> <span m="692150">So</span> <span m="692440">e</span> <span m="692730">is going to</span> <span m="693187">be our</span> <span m="693644">encryption</span> <span m="694101">value.</span> <span m="694558">And then</span> <span m="695015">from e</span> <span m="695472">we're going to</span> <span m="695929">generate</span> <span m="696386">d</span> <span m="697300">to be</span> <span m="698500">basically</span> <span m="701180">1</span> <span m="701520">over</span> <span m="701815">e</span> <span m="702950">mod</span> <span m="704533">phi</span> <span m="704964">of n.</span> <span m="705826">And there's</span> <span m="706260">some</span> <span m="706640">Euclidean</span> <span m="707280">algorithms</span> <span m="707665">you</span> <span m="708050">can</span> <span m="708537">use to</span> <span m="709024">do</span> <span m="709511">this</span> <span m="709998">computation</span> <span m="710485">efficiently.</span> <span m="711460">But</span> <span m="712120">in order</span> <span m="712470">to do this</span> <span m="712765">you</span> <span m="713060">actually</span> <span m="713390">have to</span> <span m="713700">know</span> <span m="714010">this</span> <span m="714180">phi</span> <span m="714570">of n,</span> <span m="715580">which</span> <span m="716180">requires</span> <span m="716730">knowing</span> <span m="717120">the</span> <span m="717240">factorization</span> <span m="718120">of</span> <span m="718740">our</span> <span m="718960">number</span> <span m="719240">n into</span> <span m="719730">p and q.</span> </p>
<p><span m="722100">All right.</span> <span m="722410">So</span> <span m="722880">finally,</span> <span m="724750">RSA</span> <span m="725340">ends</span> <span m="725480">up</span> <span m="725820">being</span> <span m="728190">a</span> <span m="728370">system where</span> <span m="728600">the public</span> <span m="729120">key</span> <span m="729780">is</span> <span m="730340">this</span> <span m="730440">number</span> <span m="730810">n</span> <span m="731668">and this</span> <span m="732156">encryption</span> <span m="732644">exponent e.</span> <span m="733132">So</span> <span m="733620">n and e</span> <span m="734108">are</span> <span m="734596">public,</span> <span m="735090">and</span> <span m="735310">d</span> <span m="735540">should</span> <span m="735840">be</span> <span m="736080">private.</span> <span m="736750">So then</span> <span m="737010">anyone</span> <span m="737435">can</span> <span m="737860">exponentiate</span> <span m="738340">a message</span> <span m="738820">to</span> <span m="739150">encrypt</span> <span m="739430">it</span> <span m="739680">for you.</span> <span m="740320">But</span> <span m="740660">only you</span> <span m="740930">know</span> <span m="741240">this value</span> <span m="741615">d</span> <span m="741990">and</span> <span m="742452">therefore</span> <span m="742914">can</span> <span m="743376">decrypt</span> <span m="743838">messages.</span> <span m="745230">And</span> <span m="745760">as</span> <span m="745850">long</span> <span m="746070">as</span> <span m="746160">you</span> <span m="746220">don't</span> <span m="746400">know</span> <span m="746730">this</span> <span m="747540">factorization</span> <span m="748330">of</span> <span m="748950">p and q,</span> <span m="750090">of</span> <span m="750370">n</span> <span m="750650">to p and q,</span> <span m="751200">then you</span> <span m="751520">don't</span> <span m="752240">know</span> <span m="752690">what this</span> <span m="753070">[? phi del ?]</span> <span m="753350">is.</span> <span m="753785">And</span> <span m="754220">as a result, it's</span> <span m="754655">actually</span> <span m="755090">difficult</span> <span m="755580">to</span> <span m="755690">compute</span> <span m="755870">this</span> <span m="756230">d</span> <span m="756550">value.</span> <span m="757470">So</span> <span m="757900">this is</span> <span m="758090">roughly</span> <span m="758390">what</span> <span m="759070">RSA</span> <span m="759300">is.</span> <span m="761580">High</span> <span m="761750">level.</span> <span m="763370">Does this</span> <span m="763750">make</span> <span m="764190">sense?</span> <span m="765510">All right.</span> </p>
<p><span m="765950">So</span> <span m="766260">there's</span> <span m="766380">2 things</span> <span m="766840">I want to</span> <span m="767300">talk</span> <span m="767480">about</span> <span m="767810">now</span> <span m="768140">that we</span> <span m="768570">at least</span> <span m="768965">have</span> <span m="769360">the</span> <span m="769755">basic</span> <span m="770150">[? implementation ?]</span> <span m="771120">for</span> <span m="771150">RSA.</span> <span m="772590">There's</span> <span m="773390">tricks</span> <span m="773660">to use</span> <span m="773930">it</span> <span m="774410">correctly</span> <span m="774890">and</span> <span m="775370">pitfalls</span> <span m="775850">and how</span> <span m="776330">to use</span> <span m="776810">RSA.</span> <span m="777250">And then</span> <span m="777695">there's</span> <span m="777806">all</span> <span m="777917">kinds</span> <span m="778028">of</span> <span m="778140">implementation</span> <span m="778750">tricks</span> <span m="779210">on how</span> <span m="779410">do you</span> <span m="779920">actually</span> <span m="780450">implement</span> <span m="782230">[? root ?]</span> <span m="782440">code</span> <span m="783090">to</span> <span m="783870">do</span> <span m="784100">these</span> <span m="784250">exponentiations</span> <span m="785430">and</span> <span m="785912">do</span> <span m="786394">them</span> <span m="786876">efficiently.</span> <span m="787360">There's</span> <span m="787730">actually</span> <span m="787940">more</span> <span m="788290">trivial</span> <span m="788640">because</span> <span m="789110">these</span> <span m="789300">are</span> <span m="789655">all</span> <span m="790010">large</span> <span m="790460">numbers,</span> <span m="790894">these are</span> <span m="791328">1,000</span> <span m="791762">bit</span> <span m="792196">integers</span> <span m="792630">that</span> <span m="792730">can't</span> <span m="792930">just do</span> <span m="793290">a multiply</span> <span m="793700">instruction</span> <span m="794170">for.</span> <span m="795730">Probably going to take</span> <span m="796810">a</span> <span m="797180">fair</span> <span m="797440">amount</span> <span m="797700">of time</span> <span m="798156">to do</span> <span m="798612">these</span> <span m="799068">operations.</span> <span m="800440">All right.</span> </p>
<p><span m="800930">So</span> <span m="801300">the first</span> <span m="801500">thing</span> <span m="801640">I want to</span> <span m="801840">mention</span> <span m="802310">is</span> <span m="802740">the</span> <span m="803980">various</span> <span m="804330">RSA</span> <span m="806056">pitfalls.</span> <span m="806470">One</span> <span m="806650">of them</span> <span m="806910">we're</span> <span m="807270">actually</span> <span m="807630">going to</span> <span m="807990">rely</span> <span m="808430">on</span> <span m="809160">in a</span> <span m="809545">little</span> <span m="809930">bit.</span> <span m="811310">One</span> <span m="811590">property</span> <span m="812910">is,</span> <span m="813215">that</span> <span m="814330">it's</span> <span m="815050">multiplicative.</span> <span m="818827">So</span> <span m="819278">what</span> <span m="819730">I</span> <span m="819840">mean</span> <span m="820040">by</span> <span m="820170">this</span> <span m="820510">is</span> <span m="821005">that</span> <span m="821310">suppose</span> <span m="821480">we</span> <span m="821600">have</span> <span m="822010">2 messages.</span> <span m="823600">Suppose</span> <span m="823880">we have</span> <span m="824180">m0</span> <span m="825460">and</span> <span m="825810">m1.</span> <span m="826950">And</span> <span m="827950">suppose</span> <span m="828360">I encrypt</span> <span m="828770">these guys,</span> <span m="829196">so I encrypt</span> <span m="829622">m0,</span> <span m="830900">I'm</span> <span m="831050">going to get</span> <span m="831440">m0</span> <span m="831850">to</span> <span m="832150">the</span> <span m="832310">power</span> <span m="832720">e</span> <span m="833320">mod</span> <span m="833540">n.</span> <span m="835612">And</span> <span m="836076">if</span> <span m="836540">I encrypt</span> <span m="836850">m1,</span> <span m="837310">then</span> <span m="837390">I'd get</span> <span m="838510">m1</span> <span m="838912">to the</span> <span m="839314">e</span> <span m="840845">mod n.</span> <span m="842840">The</span> <span m="842920">problem</span> <span m="843310">is--</span> <span m="844200">not</span> <span m="845330">necessarily</span> <span m="845800">a</span> <span m="845850">problem</span> <span m="846220">but</span> <span m="846500">could</span> <span m="846660">be</span> <span m="847030">a</span> <span m="847230">surprise</span> <span m="848090">to</span> <span m="848570">someone</span> <span m="848940">using</span> <span m="849120">RSA--</span> <span m="849840">it's</span> <span m="849960">very</span> <span m="850200">easy</span> <span m="850720">to</span> <span m="850830">generate</span> <span m="851300">an</span> <span m="851430">encryption</span> <span m="851890">of</span> <span m="852300">m0</span> <span m="852630">times</span> <span m="852980">m1</span> <span m="853450">because</span> <span m="853920">you</span> <span m="854260">just</span> <span m="854480">multiply</span> <span m="854940">these</span> <span m="855150">2</span> <span m="855280">numbers.</span> <span m="855940">If</span> <span m="855970">you</span> <span m="856530">multiply</span> <span m="856920">these</span> <span m="857310">guys</span> <span m="857490">out,</span> <span m="858310">you're</span> <span m="858480">going</span> <span m="858610">to</span> <span m="858940">get</span> <span m="859310">m0</span> <span m="859920">m1</span> <span m="862260">to</span> <span m="862610">the</span> <span m="862960">e</span> <span m="863520">mod</span> <span m="863750">n.</span> </p>
<p><span m="866500">This</span> <span m="866810">is</span> <span m="867150">a</span> <span m="867490">correct</span> <span m="867930">encryption</span> <span m="868680">under</span> <span m="868920">this</span> <span m="869120">simplistic</span> <span m="869480">use</span> <span m="869840">of</span> <span m="869940">RSA</span> <span m="870820">for</span> <span m="871490">the</span> <span m="871760">value</span> <span m="872660">m0</span> <span m="872995">times</span> <span m="873330">m1.</span> <span m="874512">I mean</span> <span m="874960">at this</span> <span m="875340">point,</span> <span m="875680">it's not</span> <span m="875955">a</span> <span m="876230">huge</span> <span m="876430">problem</span> <span m="876930">because</span> <span m="877250">if</span> <span m="877510">you</span> <span m="877710">aren't</span> <span m="877900">able</span> <span m="878300">to decrypt it,</span> <span m="878555">you're</span> <span m="878810">just</span> <span m="879100">able</span> <span m="879360">to</span> <span m="879450">construct</span> <span m="880060">this</span> <span m="880410">encrypted</span> <span m="880885">message.</span> <span m="881940">But</span> <span m="883000">it</span> <span m="883120">might be</span> <span m="883310">that</span> <span m="883430">the</span> <span m="883580">overall</span> <span m="883905">system</span> <span m="885140">maybe</span> <span m="885360">allows</span> <span m="885700">you</span> <span m="886040">to decrypt</span> <span m="886290">certain messages.</span> <span m="886786">And</span> <span m="887282">if</span> <span m="887778">it allows</span> <span m="888274">you to decrypt</span> <span m="888770">this message</span> <span m="889270">that</span> <span m="889520">you</span> <span m="889690">construct</span> <span m="890110">yourself,</span> <span m="890820">maybe</span> <span m="891140">you can</span> <span m="891210">now go</span> <span m="891560">back</span> <span m="891840">and</span> <span m="892255">figure out</span> <span m="892670">what are</span> <span m="892990">these messages.</span> <span m="893820">So</span> <span m="894010">it's</span> <span m="894250">maybe</span> <span m="894520">not</span> <span m="894810">a</span> <span m="895100">great</span> <span m="895370">plan</span> <span m="895834">to</span> <span m="898620">be ignorant of this fact.</span> <span m="900310">This</span> <span m="900620">has</span> <span m="900820">certainly</span> <span m="901240">come</span> <span m="901430">back</span> <span m="901740">to</span> <span m="902110">bite</span> <span m="902700">a</span> <span m="903170">number</span> <span m="903440">of</span> <span m="903850">protocols</span> <span m="904000">that</span> <span m="904230">use</span> <span m="904460">RSA.</span> <span m="905720">There's</span> <span m="905880">one</span> <span m="906180">property,</span> <span m="906530">we'll</span> <span m="906780">actually</span> <span m="906950">use</span> <span m="907250">it</span> <span m="907505">as</span> <span m="907760">a</span> <span m="908197">defensive</span> <span m="908634">mechanism</span> <span m="909510">towards</span> <span m="909850">the</span> <span m="910030">end</span> <span m="910365">of</span> <span m="910700">the lecture.</span> </p>
<p><span m="911450">Another</span> <span m="911740">property</span> <span m="912060">of</span> <span m="912250">RSA</span> <span m="912730">that</span> <span m="913835">you</span> <span m="914180">probably</span> <span m="914390">want</span> <span m="914660">to</span> <span m="914720">watch</span> <span m="914960">out</span> <span m="915170">for</span> <span m="915910">is</span> <span m="916260">the</span> <span m="916710">fact</span> <span m="917174">that</span> <span m="917638">it's</span> <span m="918102">deterministic.</span> <span m="921350">So</span> <span m="921980">in</span> <span m="922190">this</span> <span m="922560">[? naive ?]</span> <span m="923350">implementation</span> <span m="923695">that</span> <span m="924040">I just</span> <span m="924140">described</span> <span m="924630">here,</span> <span m="925608">if</span> <span m="926096">you take</span> <span m="926584">a message m</span> <span m="927072">and you</span> <span m="927316">encrypt</span> <span m="927560">it,</span> <span m="928048">you're</span> <span m="928540">going to get</span> <span m="928760">m</span> <span m="929165">to the e</span> <span m="929570">mod n,</span> <span m="929870">which</span> <span m="930220">is</span> <span m="930570">a</span> <span m="930920">deterministic</span> <span m="931200">function</span> <span m="932100">of</span> <span m="932390">the</span> <span m="932850">message.</span> <span m="933296">So</span> <span m="933742">if you</span> <span m="934188">encrypt it</span> <span m="934634">again,</span> <span m="935080">you'll get</span> <span m="935526">exactly the</span> <span m="935972">same encryption.</span> </p>
<p><span m="936870">This</span> <span m="937040">is not</span> <span m="937380">surprising</span> <span m="937940">but</span> <span m="938250">it might</span> <span m="938430">not</span> <span m="938590">be a</span> <span m="938730">desirable</span> <span m="939210">property</span> <span m="939570">because</span> <span m="940280">if</span> <span m="940420">I</span> <span m="940510">see</span> <span m="940880">you send</span> <span m="941240">send some</span> <span m="941330">message</span> <span m="942070">encrypted</span> <span m="942200">with</span> <span m="942490">RSA,</span> <span m="944090">and</span> <span m="944220">I</span> <span m="944260">want</span> <span m="944460">to know</span> <span m="944620">what</span> <span m="944870">it is,</span> <span m="945950">it</span> <span m="946080">might</span> <span m="946340">be</span> <span m="946500">hard for me</span> <span m="946940">to decrypt</span> <span m="947230">it.</span> <span m="947370">But</span> <span m="947500">I can try</span> <span m="947980">different</span> <span m="948300">things</span> <span m="948570">and</span> <span m="948770">I can see,</span> <span m="948890">well are</span> <span m="949060">you</span> <span m="949430">sending</span> <span m="949730">this</span> <span m="949900">message?</span> <span m="950290">I'll</span> <span m="950530">encrypt it</span> <span m="950805">and see if</span> <span m="951080">you</span> <span m="951240">get</span> <span m="951690">the same</span> <span m="951940">ciphertext.</span> <span m="952600">And</span> <span m="952940">if so,</span> <span m="953170">then</span> <span m="953690">I'll know</span> <span m="954110">that's what</span> <span m="954230">you</span> <span m="954525">encrypted.</span> <span m="954820">Because</span> <span m="955090">all</span> <span m="955360">I need</span> <span m="955860">to</span> <span m="956240">encrypt</span> <span m="956366">a</span> <span m="956493">message</span> <span m="956620">is the</span> <span m="956960">publicly</span> <span m="957220">known</span> <span m="958040">public</span> <span m="958500">key,</span> <span m="958710">which is</span> <span m="959056">n</span> <span m="959750">and</span> <span m="959910">the</span> <span m="959990">number</span> <span m="960290">e.</span> <span m="961850">So</span> <span m="962080">that's</span> <span m="962460">not</span> <span m="963070">so</span> <span m="963250">great.</span> <span m="964140">And</span> <span m="964480">you</span> <span m="964820">might</span> <span m="964950">want to</span> <span m="965310">watch out</span> <span m="965720">for</span> <span m="965861">this</span> <span m="966003">property</span> <span m="966145">if</span> <span m="966570">you're</span> <span m="966995">actually</span> <span m="967420">using</span> <span m="967760">RSA.</span> <span m="969140">So all</span> <span m="969590">of these</span> <span m="969700">[? primitives are ?]</span> <span m="970140">probably</span> <span m="970430">a</span> <span m="970950">little</span> <span m="971120">bit</span> <span m="971520">hard</span> <span m="971890">to</span> <span m="972260">use</span> <span m="973010">directly.</span> </p>
<p><span m="974340">What</span> <span m="974540">people</span> <span m="975270">do</span> <span m="975430">in</span> <span m="975580">practice</span> <span m="976970">in</span> <span m="977090">order</span> <span m="977320">to</span> <span m="977430">avoid</span> <span m="978210">these</span> <span m="978480">problems</span> <span m="978960">with RSA</span> <span m="979550">is</span> <span m="980035">they</span> <span m="980520">encode the message</span> <span m="980900">in a</span> <span m="981240">certain</span> <span m="981510">way</span> <span m="981690">before</span> <span m="982130">encrypting</span> <span m="982180">it.</span> <span m="983030">Instead</span> <span m="983425">of</span> <span m="983820">directly</span> <span m="984500">exponentiating</span> <span m="984775">a</span> <span m="985050">message,</span> <span m="985790">it actually</span> <span m="986030">takes</span> <span m="986130">some</span> <span m="986530">function</span> <span m="987040">of</span> <span m="987190">a message,</span> <span m="988020">and</span> <span m="988570">then</span> <span m="988830">they</span> <span m="989200">encrypt</span> <span m="989500">that.</span> <span m="991680">mod n.</span> <span m="993096">And</span> <span m="993592">this</span> <span m="994088">function</span> <span m="994584">f,</span> <span m="995940">the</span> <span m="996730">right</span> <span m="997050">one</span> <span m="997345">to use</span> <span m="997640">these</span> <span m="997840">days,</span> <span m="998190">is probably</span> <span m="998830">something</span> <span m="998970">called</span> <span m="999580">optimal</span> <span m="1000170">asymmetric</span> <span m="1000622">encryption</span> <span m="1001526">padding,</span> <span m="1001978">O</span> <span m="1002430">A</span> <span m="1002710">E</span> <span m="1002990">P.</span> <span m="1003420">You can</span> <span m="1003850">look</span> <span m="1004080">it</span> <span m="1004220">up.</span> <span m="1005595">It's</span> <span m="1005870">something</span> <span m="1006265">coded</span> <span m="1006660">that</span> <span m="1007290">has</span> <span m="1007580">two</span> <span m="1007870">interesting</span> <span m="1008150">properties.</span> </p>
<p><span m="1009310">First of all,</span> <span m="1009670">it</span> <span m="1010340">injects</span> <span m="1010910">randomness.</span> <span m="1011390">You</span> <span m="1011830">can</span> <span m="1012270">think of</span> <span m="1012710">f</span> <span m="1013150">of</span> <span m="1013590">n</span> <span m="1014030">as</span> <span m="1014550">generating</span> <span m="1015795">1,000</span> <span m="1016430">bit</span> <span m="1016800">message</span> <span m="1017230">that</span> <span m="1017680">you're going</span> <span m="1018130">to encrypt.</span> <span m="1018580">Part</span> <span m="1019030">of this message</span> <span m="1019480">is</span> <span m="1019930">going to</span> <span m="1020380">be your</span> <span m="1020830">message</span> <span m="1021050">m</span> <span m="1021390">in the</span> <span m="1021730">middle here.</span> <span m="1022065">So</span> <span m="1022400">that</span> <span m="1022560">you can</span> <span m="1022740">get it</span> <span m="1023050">back</span> <span m="1023300">when you decrypt, of course.</span> <span m="1023420">[INAUDIBLE].</span> <span m="1024890">So</span> <span m="1025369">there's</span> <span m="1025589">2</span> <span m="1025890">interesting</span> <span m="1026109">things</span> <span m="1026190">you</span> <span m="1026300">want to do.</span> <span m="1026599">You</span> <span m="1026849">want</span> <span m="1026879">to</span> <span m="1026909">put</span> <span m="1026939">in</span> <span m="1026969">some</span> <span m="1027000">randomness</span> <span m="1027579">here,</span> <span m="1028339">some</span> <span m="1028829">value</span> <span m="1029220">r</span> <span m="1029539">so that</span> <span m="1029859">when you</span> <span m="1030069">encrypt</span> <span m="1030420">the message</span> <span m="1030640">multiple</span> <span m="1031069">times,</span> <span m="1031410">you'll</span> <span m="1031560">get</span> <span m="1031730">different</span> <span m="1032050">results</span> <span m="1032490">out</span> <span m="1032839">of</span> <span m="1033099">each</span> <span m="1033359">time</span> <span m="1033740">so then</span> <span m="1034160">it's not</span> <span m="1034560">deterministic</span> <span m="1034960">anymore.</span> </p>
<p><span m="1036069">And</span> <span m="1036359">in order</span> <span m="1036760">to</span> <span m="1037210">defeat this</span> <span m="1037490">multiplicative</span> <span m="1038150">property</span> <span m="1038390">and</span> <span m="1038880">other</span> <span m="1039370">kinds of</span> <span m="1039860">problems,</span> <span m="1040350">you're</span> <span m="1040840">going</span> <span m="1041330">to put in</span> <span m="1041820">some fixed padding</span> <span m="1042310">here.</span> <span m="1043010">You</span> <span m="1043210">can</span> <span m="1043490">think of</span> <span m="1043829">this as</span> <span m="1044400">an</span> <span m="1044740">altering</span> <span m="1045040">sequence</span> <span m="1045260">of</span> <span m="1045339">1</span> <span m="1045424">0</span> <span m="1045510">1</span> <span m="1045596">0</span> <span m="1046025">1</span> <span m="1046369">0.</span> <span m="1047089">You can</span> <span m="1047409">do better things.</span> <span m="1048044">But roughly</span> <span m="1048359">it's</span> <span m="1048810">some</span> <span m="1049160">predictable</span> <span m="1049647">sequence</span> <span m="1050134">that</span> <span m="1050621">you</span> <span m="1051108">put</span> <span m="1051595">in</span> <span m="1052082">here and</span> <span m="1052570">whenever</span> <span m="1052680">you decrypt,</span> <span m="1053395">you</span> <span m="1053660">make</span> <span m="1053940">sure</span> <span m="1054080">the</span> <span m="1054220">sequence is</span> <span m="1054710">still</span> <span m="1055030">there.</span> <span m="1055590">Even</span> <span m="1056080">in</span> <span m="1056270">multiplication</span> <span m="1057030">it's</span> <span m="1057295">going</span> <span m="1057560">to</span> <span m="1057990">destroy</span> <span m="1058790">this bit</span> <span m="1059210">power.</span> <span m="1060570">And</span> <span m="1061030">then</span> <span m="1061670">you</span> <span m="1061770">should</span> <span m="1061950">be</span> <span m="1062060">clear</span> <span m="1062406">that</span> <span m="1062752">someone</span> <span m="1063100">tampered</span> <span m="1063597">with</span> <span m="1064094">my message</span> <span m="1064591">and</span> <span m="1065088">reject</span> <span m="1065585">it.</span> <span m="1066082">And</span> <span m="1066579">if</span> <span m="1067076">it's</span> <span m="1067573">still</span> <span m="1068070">there,</span> <span m="1068567">then</span> <span m="1069070">presumably,</span> <span m="1069756">sometimes</span> <span m="1070220">provably,</span> <span m="1071220">no one</span> <span m="1071520">tampered</span> <span m="1071840">with</span> <span m="1071960">your</span> <span m="1072070">message,</span> <span m="1072440">and</span> <span m="1072810">as a</span> <span m="1073160">result</span> <span m="1073621">you should be</span> <span m="1074082">able to</span> <span m="1074543">accept it.</span> <span m="1075004">And</span> <span m="1075465">treat</span> <span m="1075926">message</span> <span m="1076387">m</span> <span m="1076848">as</span> <span m="1077309">correctly encrypted</span> <span m="1077770">by someone.</span> <span m="1079140">Make sense?</span> <span m="1080820">Yeah?</span> </p>
<p><span m="1081220">AUDIENCE:</span> <span m="1081490">If the attacker</span> <span m="1081720">knows</span> <span m="1082430">how big</span> <span m="1082922">the pad is,</span> <span m="1083414">can't</span> <span m="1083906">they</span> <span m="1085250">put a</span> <span m="1085610">1</span> <span m="1085960">in</span> <span m="1086460">the</span> <span m="1086960">lowest</span> <span m="1087460">place</span> <span m="1087960">and then</span> <span m="1089460">[INAUDIBLE]</span> <span m="1090960">under</span> <span m="1091460">multiplication?</span> </p>
<p><span m="1093460">PROFESSOR: Yeah,</span> <span m="1093870">maybe.</span> <span m="1094165">It's</span> <span m="1094460">a</span> <span m="1094610">little</span> <span m="1094830">bit</span> <span m="1095040">tricky</span> <span m="1095496">because</span> <span m="1096410">this</span> <span m="1096440">randomness</span> <span m="1096560">is going</span> <span m="1096700">to</span> <span m="1096880">bleed</span> <span m="1097060">over.</span> <span m="1097510">So</span> <span m="1097950">the</span> <span m="1098300">particular</span> <span m="1098650">construction</span> <span m="1098980">of</span> <span m="1099130">this</span> <span m="1099440">O A E</span> <span m="1099840">P</span> <span m="1100170">is</span> <span m="1100270">a</span> <span m="1100320">little</span> <span m="1100430">bit</span> <span m="1100580">more</span> <span m="1100820">sophisticated</span> <span m="1101300">than</span> <span m="1101520">this.</span> <span m="1102740">But</span> <span m="1102990">if</span> <span m="1103100">you</span> <span m="1103200">imagine</span> <span m="1103990">this</span> <span m="1104420">is</span> <span m="1104850">integer</span> <span m="1105210">multiplication</span> <span m="1105890">not</span> <span m="1107120">bit-wise</span> <span m="1107390">multiplication.</span> <span m="1108160">And</span> <span m="1109030">so</span> <span m="1109530">this</span> <span m="1109800">randomness</span> <span m="1110140">is going</span> <span m="1110330">to</span> <span m="1110550">bleed</span> <span m="1110720">over</span> <span m="1110970">somewhere,</span> <span m="1111530">and</span> <span m="1112350">you</span> <span m="1112610">can</span> <span m="1112850">construct</span> <span m="1113280">O A</span> <span m="1113740">E</span> <span m="1114080">P scheme</span> <span m="1114420">such</span> <span m="1114700">that</span> <span m="1115350">this</span> <span m="1115710">doesn't</span> <span m="1116630">happen.</span> <span m="1117896">[INAUDIBLE]</span> <span m="1119780">Make</span> <span m="1120210">sense?</span> <span m="1121720">All right.</span> </p>
<p><span m="1122390">So</span> <span m="1122670">it turns</span> <span m="1122955">out that</span> <span m="1123240">basically</span> <span m="1123730">you</span> <span m="1123790">shouldn't</span> <span m="1124040">really</span> <span m="1124220">use</span> <span m="1124340">this</span> <span m="1124640">RSA</span> <span m="1125100">math</span> <span m="1125450">directly,</span> <span m="1125930">you should</span> <span m="1126170">use some</span> <span m="1126410">library</span> <span m="1126675">in</span> <span m="1126940">practice</span> <span m="1127470">that</span> <span m="1127880">implements</span> <span m="1128450">all</span> <span m="1128760">those</span> <span m="1129590">things</span> <span m="1129880">correctly</span> <span m="1130160">for</span> <span m="1130530">you.</span> <span m="1131340">And</span> <span m="1131780">use it just as</span> <span m="1132220">an</span> <span m="1132660">encrypt/decrypt</span> <span m="1133540">parameter.</span> <span m="1133980">But</span> <span m="1134460">it turns out</span> <span m="1134830">these</span> <span m="1135020">details</span> <span m="1135210">will</span> <span m="1135440">come</span> <span m="1135690">in</span> <span m="1135840">and</span> <span m="1136000">matter</span> <span m="1136390">for</span> <span m="1136620">us</span> <span m="1136730">because</span> <span m="1136960">we're</span> <span m="1137110">actually</span> <span m="1137660">trying</span> <span m="1137870">to</span> <span m="1137930">figure</span> <span m="1138170">out</span> <span m="1138270">how</span> <span m="1138370">to</span> <span m="1138450">break</span> <span m="1138940">or</span> <span m="1139030">how to</span> <span m="1139350">attack an</span> <span m="1139670">existing</span> <span m="1140520">RSA</span> <span m="1141030">implementation.</span> </p>
<p><span m="1143300">So</span> <span m="1144456">in</span> <span m="1144860">particular</span> <span m="1145800">the</span> <span m="1146240">attack</span> <span m="1146520">from</span> <span m="1146780">this</span> <span m="1146960">paper</span> <span m="1147100">is going</span> <span m="1147250">to</span> <span m="1147300">exploit</span> <span m="1147990">the</span> <span m="1148080">fact</span> <span m="1148750">that</span> <span m="1149250">the</span> <span m="1149370">server</span> <span m="1149725">is</span> <span m="1150080">going</span> <span m="1150280">to</span> <span m="1150430">check</span> <span m="1150775">for this</span> <span m="1151120">padding</span> <span m="1151580">when</span> <span m="1151720">they</span> <span m="1151850">get</span> <span m="1152050">a</span> <span m="1152130">message.</span> <span m="1153210">So</span> <span m="1153990">this</span> <span m="1154200">is how</span> <span m="1154510">we're going to</span> <span m="1154770">time</span> <span m="1155990">how</span> <span m="1156170">long</span> <span m="1156400">it</span> <span m="1156490">takes</span> <span m="1156710">a server</span> <span m="1157130">to decrypt.</span> <span m="1157770">We're</span> <span m="1158060">going</span> <span m="1158350">to send</span> <span m="1158710">some</span> <span m="1159540">random</span> <span m="1160230">message,</span> <span m="1160640">or</span> <span m="1160900">some</span> <span m="1161280">carefully</span> <span m="1161690">constructed</span> <span m="1162240">message.</span> <span m="1162545">But</span> <span m="1162850">the</span> <span m="1163140">message</span> <span m="1163430">wasn't</span> <span m="1163740">constructed</span> <span m="1164480">by</span> <span m="1164930">taking</span> <span m="1165250">a</span> <span m="1165310">real</span> <span m="1165900">m</span> <span m="1166243">and</span> <span m="1166586">encrypting</span> <span m="1166930">it.</span> </p>
<p><span m="1167330">We're</span> <span m="1167420">going</span> <span m="1167540">to</span> <span m="1167840">construct</span> <span m="1168330">a</span> <span m="1168400">careful</span> <span m="1168850">ciphertext</span> <span m="1169580">integer</span> <span m="1169980">value.</span> <span m="1171300">And</span> <span m="1171720">the server</span> <span m="1172140">is going</span> <span m="1172560">to decrypt it,</span> <span m="1173020">it's</span> <span m="1173160">going to</span> <span m="1173490">decrypt</span> <span m="1173920">to</span> <span m="1174250">some</span> <span m="1174580">nonsense,</span> <span m="1174700">and the</span> <span m="1174810">padding</span> <span m="1175190">is</span> <span m="1175560">going to</span> <span m="1175930">not</span> <span m="1176240">match</span> <span m="1176590">with</span> <span m="1176720">a</span> <span m="1176740">very</span> <span m="1176960">high</span> <span m="1177100">probability.</span> <span m="1177820">And</span> <span m="1178030">immediately</span> <span m="1178340">the server is</span> <span m="1178580">going</span> <span m="1178690">to</span> <span m="1178780">reject it.</span> <span m="1180090">And</span> <span m="1180550">the</span> <span m="1180650">reason</span> <span m="1180970">this is</span> <span m="1181180">going</span> <span m="1181310">to</span> <span m="1181370">be</span> <span m="1181490">good</span> <span m="1181720">for</span> <span m="1181910">us</span> <span m="1182080">is</span> <span m="1182160">because</span> <span m="1182530">it will</span> <span m="1182790">tell us</span> <span m="1183065">exactly</span> <span m="1183340">how long</span> <span m="1183840">it took</span> <span m="1184340">the server</span> <span m="1184700">to get</span> <span m="1185060">to</span> <span m="1185280">this point,</span> <span m="1185460">just</span> <span m="1185770">do</span> <span m="1185940">the RSA</span> <span m="1186190">decryption,</span> <span m="1187250">get</span> <span m="1187430">this</span> <span m="1187560">message,</span> <span m="1188010">check the</span> <span m="1188300">padding,</span> <span m="1188710">and</span> <span m="1189095">reject it.</span> <span m="1190460">So that's</span> <span m="1190870">what we're</span> <span m="1191280">going to be</span> <span m="1191400">measuring</span> <span m="1192030">in</span> <span m="1192320">this</span> <span m="1192620">attack</span> <span m="1192900">from</span> <span m="1193010">the</span> <span m="1193100">paper.</span> <span m="1194290">Does that</span> <span m="1194710">make</span> <span m="1194850">sense?</span> <span m="1196140">So there's some</span> <span m="1196250">integrity</span> <span m="1196710">component to the</span> <span m="1197500">the</span> <span m="1197520">message that</span> <span m="1197880">allows us</span> <span m="1198240">to</span> <span m="1198710">time</span> <span m="1199180">the</span> <span m="1199310">decryption</span> <span m="1199920">leading</span> <span m="1200200">up</span> <span m="1200460">to it.</span> <span m="1202800">All right.</span> </p>
<p><span m="1203625">So</span> <span m="1203910">now</span> <span m="1204040">let's</span> <span m="1204350">talk</span> <span m="1204550">about</span> <span m="1204800">how</span> <span m="1204930">to</span> <span m="1205070">do you</span> <span m="1205510">actually implement</span> <span m="1205970">RSA.</span> <span m="1207180">So</span> <span m="1207370">the</span> <span m="1207660">core</span> <span m="1207950">of it</span> <span m="1208230">is</span> <span m="1208510">really this</span> <span m="1208990">exponentiation,</span> <span m="1209940">which</span> <span m="1211290">is</span> <span m="1211780">not exactly</span> <span m="1212035">trivial</span> <span m="1212290">to do</span> <span m="1212610">as</span> <span m="1212930">I was</span> <span m="1212950">mentioning</span> <span m="1213300">earlier</span> <span m="1213580">because</span> <span m="1213970">all</span> <span m="1214200">these</span> <span m="1214480">numbers are</span> <span m="1214860">very</span> <span m="1215120">large</span> <span m="1215430">integers.</span> <span m="1215880">So</span> <span m="1216440">the</span> <span m="1216730">message</span> <span m="1217080">itself</span> <span m="1217470">is</span> <span m="1217580">going</span> <span m="1217690">to</span> <span m="1217770">be</span> <span m="1218020">at</span> <span m="1218600">least,</span> <span m="1218820">in this paper,</span> <span m="1219310">1,000</span> <span m="1219665">bit</span> <span m="1220020">integer.</span> <span m="1220830">And</span> <span m="1221010">the</span> <span m="1221265">exponent</span> <span m="1221520">itself</span> <span m="1222020">is</span> <span m="1222120">also</span> <span m="1222370">going</span> <span m="1222490">to</span> <span m="1222530">be</span> <span m="1222720">pretty</span> <span m="1222940">large.</span> </p>
<p><span m="1223810">The encryption</span> <span m="1224100">exponent</span> <span m="1224440">is</span> <span m="1224680">at least</span> <span m="1224910">well</span> <span m="1225350">known.</span> <span m="1226180">But the</span> <span m="1226280">decryption exponent</span> <span m="1226720">better</span> <span m="1226970">be</span> <span m="1227150">also</span> <span m="1227530">a large</span> <span m="1227860">integer</span> <span m="1228620">also</span> <span m="1229030">on</span> <span m="1229120">the</span> <span m="1229170">order</span> <span m="1229530">of</span> <span m="1229610">1,000</span> <span m="1229920">bits.</span> <span m="1230255">So</span> <span m="1230590">you</span> <span m="1230850">have</span> <span m="1231110">a 1,000</span> <span m="1231590">bit integer</span> <span m="1232070">you want to</span> <span m="1232240">exponentiate</span> <span m="1232900">to</span> <span m="1232970">another</span> <span m="1233280">1,000 bit</span> <span m="1233730">integer</span> <span m="1234110">power</span> <span m="1234920">modulo</span> <span m="1235900">some other</span> <span m="1236185">1,000</span> <span m="1236470">bit integer</span> <span m="1236945">n</span> <span m="1237960">that's</span> <span m="1238030">going</span> <span m="1238170">to</span> <span m="1238220">be</span> <span m="1238300">a</span> <span m="1238350">little</span> <span m="1238560">messy,</span> <span m="1239050">if</span> <span m="1239270">you</span> <span m="1239420">just</span> <span m="1239580">do</span> <span m="1239830">[? the naive thing. ?]</span> <span m="1241220">So</span> <span m="1241650">almost everyone</span> <span m="1242000">has</span> <span m="1242210">lots</span> <span m="1242580">of</span> <span m="1242950">optimizations</span> <span m="1243920">in</span> <span m="1244320">their</span> <span m="1244500">RSA</span> <span m="1244843">implementations</span> <span m="1245530">to</span> <span m="1245950">make</span> <span m="1246110">this</span> <span m="1246310">go</span> <span m="1246970">a</span> <span m="1247040">little</span> <span m="1247240">bit</span> <span m="1247380">faster.</span> </p>
<p><span m="1248640">And</span> <span m="1248940">there's</span> <span m="1249810">four</span> <span m="1250730">optimizations</span> <span m="1251350">that</span> <span m="1251620">matter</span> <span m="1251970">for</span> <span m="1252090">the</span> <span m="1252190">purpose</span> <span m="1252540">of</span> <span m="1252760">this</span> <span m="1252930">attack.</span> <span m="1253420">There is</span> <span m="1253490">actually</span> <span m="1253920">more</span> <span m="1254200">tricks that</span> <span m="1254570">you can</span> <span m="1254710">play,</span> <span m="1254940">but</span> <span m="1255600">the</span> <span m="1255980">most</span> <span m="1256190">important</span> <span m="1256510">ones</span> <span m="1256780">are</span> <span m="1256870">these.</span> <span m="1257100">So</span> <span m="1257300">first</span> <span m="1258670">there's</span> <span m="1259000">something</span> <span m="1259410">called</span> <span m="1259890">the</span> <span m="1260410">Chinese</span> <span m="1261120">remainder</span> <span m="1262130">theorem,</span> <span m="1262780">or</span> <span m="1262960">C</span> <span m="1263390">R</span> <span m="1263820">T.</span> <span m="1264600">And</span> <span m="1265910">just</span> <span m="1266230">to remind</span> <span m="1266490">you</span> <span m="1266640">from</span> <span m="1267140">grade</span> <span m="1267420">school</span> <span m="1267770">or</span> <span m="1268160">high</span> <span m="1268310">school</span> <span m="1268540">maybe</span> <span m="1269500">what</span> <span m="1270250">this</span> <span m="1270730">remainder</span> <span m="1271090">theorem</span> <span m="1271530">says.</span> </p>
<p><span m="1272330">It</span> <span m="1272880">actually</span> <span m="1273100">says</span> <span m="1273380">that</span> <span m="1273570">if</span> <span m="1273700">you</span> <span m="1273790">have</span> <span m="1275170">two</span> <span m="1275350">numbers</span> <span m="1276380">and</span> <span m="1277970">you</span> <span m="1278370">have</span> <span m="1278680">some</span> <span m="1278980">value</span> <span m="1279320">x</span> <span m="1279700">and you know</span> <span m="1280170">that x</span> <span m="1280880">is</span> <span m="1281030">equal</span> <span m="1281410">to</span> <span m="1282220">a1</span> <span m="1283840">mod p.</span> <span m="1285360">And</span> <span m="1285755">you know</span> <span m="1286150">that</span> <span m="1286540">x</span> <span m="1287100">is</span> <span m="1287240">equal</span> <span m="1287530">to</span> <span m="1287710">a2</span> <span m="1289470">mod q,</span> <span m="1290870">where</span> <span m="1291200">p and</span> <span m="1291530">q</span> <span m="1291980">are</span> <span m="1292210">prime</span> <span m="1292490">numbers.</span> <span m="1293350">And</span> <span m="1293450">this</span> <span m="1294750">modular</span> <span m="1295580">equality</span> <span m="1295970">applies</span> <span m="1296200">to</span> <span m="1296440">the</span> <span m="1296500">whole</span> <span m="1297540">equation.</span> <span m="1298790">Then</span> <span m="1300140">it</span> <span m="1300270">turns</span> <span m="1300520">out</span> <span m="1300835">that</span> <span m="1301150">there's</span> <span m="1301410">a</span> <span m="1301450">unique</span> <span m="1301880">solution</span> <span m="1302450">to</span> <span m="1302540">this</span> <span m="1302920">is</span> <span m="1303030">mod</span> <span m="1303300">p</span> <span m="1303570">q.</span> <span m="1303650">So</span> <span m="1303930">there's</span> <span m="1304210">are</span> <span m="1304360">some</span> <span m="1305350">x</span> <span m="1305720">equals</span> <span m="1306090">to</span> <span m="1306250">some</span> <span m="1306520">x</span> <span m="1306810">prime</span> <span m="1308060">mod</span> <span m="1309340">pq.</span> <span m="1312210">And in</span> <span m="1312660">fact,</span> <span m="1313010">there's</span> <span m="1313230">a</span> <span m="1313280">unique</span> <span m="1313740">such</span> <span m="1313960">x</span> <span m="1314240">prime,</span> <span m="1315050">and</span> <span m="1315900">it's</span> <span m="1316060">actually</span> <span m="1316280">very</span> <span m="1316510">efficient</span> <span m="1316890">to compute.</span> <span m="1317170">So</span> <span m="1317450">the</span> <span m="1317530">Chinese</span> <span m="1317970">remainder</span> <span m="1318300">theorem</span> <span m="1319100">also</span> <span m="1319450">comes</span> <span m="1319700">with</span> <span m="1319810">an</span> <span m="1319890">algorithm</span> <span m="1320840">for</span> <span m="1321340">how to</span> <span m="1321793">compute</span> <span m="1322246">this unique</span> <span m="1322700">x</span> <span m="1323070">prime</span> <span m="1324370">that's</span> <span m="1324460">equal</span> <span m="1324730">to</span> <span m="1325050">x</span> <span m="1325350">mod</span> <span m="1325620">pq</span> <span m="1326310">given</span> <span m="1326830">the</span> <span m="1326920">values</span> <span m="1327230">a1</span> <span m="1327520">and</span> <span m="1327890">a2</span> <span m="1328810">mod</span> <span m="1329300">p and</span> <span m="1329680">q,</span> <span m="1330460">respectively.</span> <span m="1332570">Make</span> <span m="1332730">sense?</span> </p>
<p><span m="1335170">OK,</span> <span m="1335400">so</span> <span m="1335530">how</span> <span m="1335860">can</span> <span m="1336090">you</span> <span m="1336220">use this</span> <span m="1336570">Chinese</span> <span m="1336860">remainder</span> <span m="1337150">theorem</span> <span m="1337495">to</span> <span m="1337840">speed</span> <span m="1338060">up</span> <span m="1338910">modular</span> <span m="1339910">exponentiation?</span> <span m="1342580">So</span> <span m="1342690">the</span> <span m="1342870">way</span> <span m="1343070">this</span> <span m="1343220">is</span> <span m="1343330">going</span> <span m="1343440">to</span> <span m="1343480">help</span> <span m="1343820">us</span> <span m="1344130">is</span> <span m="1344520">that</span> <span m="1345190">if</span> <span m="1345280">you</span> <span m="1345360">notice</span> <span m="1345740">all</span> <span m="1345940">the</span> <span m="1346020">time</span> <span m="1346350">we're</span> <span m="1346500">doing</span> <span m="1346710">this</span> <span m="1347560">computational</span> <span m="1348025">of</span> <span m="1348490">some</span> <span m="1349510">bunch</span> <span m="1349965">of stuff</span> <span m="1350420">modulo</span> <span m="1351400">n,</span> <span m="1351680">which</span> <span m="1351850">is</span> <span m="1352010">p</span> <span m="1352180">times</span> <span m="1352530">q.</span> <span m="1353710">And</span> <span m="1354390">the</span> <span m="1354480">Chinese</span> <span m="1354770">remainder</span> <span m="1354850">theorem</span> <span m="1355135">says</span> <span m="1355420">that</span> <span m="1355630">if you</span> <span m="1356000">want</span> <span m="1356250">the</span> <span m="1356330">value</span> <span m="1356850">of</span> <span m="1356940">something</span> <span m="1357270">mod</span> <span m="1357350">p</span> <span m="1357650">times</span> <span m="1357880">q,</span> <span m="1359100">it</span> <span m="1359260">suffices</span> <span m="1359780">to</span> <span m="1359880">compute</span> <span m="1360190">the</span> <span m="1360260">value</span> <span m="1360600">of</span> <span m="1360670">that</span> <span m="1360870">thing</span> <span m="1361310">mod</span> <span m="1361670">p</span> <span m="1362320">and</span> <span m="1362410">the</span> <span m="1362470">value</span> <span m="1362770">of</span> <span m="1362820">that</span> <span m="1362990">thing</span> <span m="1363150">mod</span> <span m="1363520">q.</span> <span m="1364746">And</span> <span m="1365152">then</span> <span m="1365558">use the</span> <span m="1365964">Chinese</span> <span m="1366370">remainder</span> <span m="1366460">theorem</span> <span m="1366610">to</span> <span m="1366970">figure</span> <span m="1367200">out</span> <span m="1367330">the</span> <span m="1367430">unique</span> <span m="1367730">solution</span> <span m="1368320">to</span> <span m="1368810">what</span> <span m="1368960">this</span> <span m="1369120">thing</span> <span m="1369330">is</span> <span m="1369815">mod p</span> <span m="1370130">times</span> <span m="1370940">q.</span> <span m="1373220">All right,</span> <span m="1373710">why is</span> <span m="1373995">this</span> <span m="1374280">faster?</span> <span m="1375516">Seems</span> <span m="1375930">like</span> <span m="1376090">you're</span> <span m="1376230">basically</span> <span m="1376500">doing</span> <span m="1376770">the</span> <span m="1376850">same</span> <span m="1377040">thing</span> <span m="1377240">twice,</span> <span m="1378335">and</span> <span m="1378810">that's</span> <span m="1379210">more work</span> <span m="1379390">to recombine it</span> <span m="1381450">Is this</span> <span m="1381700">going to save me</span> <span m="1381985">anything?</span> <span m="1382270">Yeah?</span> </p>
<p><span m="1382762">AUDIENCE:</span> <span m="1383254">[INAUDIBLE]</span> </p>
<p><span m="1386700">PROFESSOR: Well,</span> <span m="1387430">they're</span> <span m="1387620">certainly</span> <span m="1387840">smaller,</span> <span m="1388270">they're</span> <span m="1388630">not that</span> <span m="1388920">smaller.</span> <span m="1389280">And</span> <span m="1389490">so</span> <span m="1389800">p and q,</span> <span m="1390090">so</span> <span m="1390540">n</span> <span m="1390790">is</span> <span m="1391315">1,000 bits,</span> <span m="1391570">p and q</span> <span m="1391950">are</span> <span m="1392275">both</span> <span m="1392600">500</span> <span m="1393140">bits,</span> <span m="1393390">they're</span> <span m="1393510">not</span> <span m="1393760">quite</span> <span m="1394200">to</span> <span m="1394400">the</span> <span m="1394630">machine</span> <span m="1394970">word</span> <span m="1395210">size</span> <span m="1395600">yet.</span> <span m="1396360">But</span> <span m="1397220">it is</span> <span m="1397460">going</span> <span m="1397560">to</span> <span m="1397600">help</span> <span m="1397860">us</span> <span m="1398000">because</span> <span m="1398690">most</span> <span m="1398980">of</span> <span m="1399050">the</span> <span m="1399140">stuff</span> <span m="1399360">we're</span> <span m="1399510">doing</span> <span m="1399850">in</span> <span m="1400190">this</span> <span m="1400430">computation</span> <span m="1401340">is</span> <span m="1401910">all</span> <span m="1402050">these</span> <span m="1402220">multiplications.</span> <span m="1403160">And</span> <span m="1403330">roughly</span> <span m="1404000">multiplication</span> <span m="1404800">is</span> <span m="1405030">quadratic</span> <span m="1405850">in</span> <span m="1406000">the</span> <span m="1406100">size of</span> <span m="1406530">the thing</span> <span m="1406680">you're</span> <span m="1406810">multiplying</span> <span m="1407820">because</span> <span m="1409050">the</span> <span m="1409540">grade school</span> <span m="1409960">method</span> <span m="1410090">of</span> <span m="1410220">multiplication</span> <span m="1410840">you</span> <span m="1410910">take</span> <span m="1411120">all</span> <span m="1411300">the</span> <span m="1411400">digits</span> <span m="1411980">and</span> <span m="1412330">multiply</span> <span m="1412645">them</span> <span m="1412960">by</span> <span m="1413110">all the</span> <span m="1413210">other</span> <span m="1413530">digits in the</span> <span m="1413850">number.</span> </p>
<p><span m="1414910">And</span> <span m="1415540">as</span> <span m="1415700">a</span> <span m="1415730">result,</span> <span m="1416460">doing</span> <span m="1417530">exponentiation</span> <span m="1418430">multiplication</span> <span m="1418785">is</span> <span m="1419140">roughly</span> <span m="1419440">quadratic</span> <span m="1419900">in</span> <span m="1419990">the input</span> <span m="1420320">side.</span> <span m="1420650">So</span> <span m="1421120">if</span> <span m="1421320">we</span> <span m="1421840">shrink</span> <span m="1423002">the</span> <span m="1423370">value of</span> <span m="1423620">p,</span> <span m="1425080">we</span> <span m="1425280">basically</span> <span m="1425380">go</span> <span m="1425640">from</span> <span m="1425790">1,000</span> <span m="1426260">bits</span> <span m="1426460">to</span> <span m="1426750">512</span> <span m="1427040">bits,</span> <span m="1427250">we</span> <span m="1427620">reduce</span> <span m="1427875">the</span> <span m="1428130">size</span> <span m="1428190">of</span> <span m="1428485">our</span> <span m="1428780">input</span> <span m="1428870">by</span> <span m="1429210">2.</span> <span m="1429830">So</span> <span m="1430000">this</span> <span m="1430200">means</span> <span m="1430540">all this</span> <span m="1430680">multiplication</span> <span m="1431025">exponentiation</span> <span m="1431370">is</span> <span m="1431890">going</span> <span m="1432000">to</span> <span m="1432040">be</span> <span m="1432140">roughly</span> <span m="1432990">4</span> <span m="1433300">times</span> <span m="1433700">cheaper.</span> <span m="1434930">So</span> <span m="1435185">even though</span> <span m="1435440">we do</span> <span m="1435550">it</span> <span m="1435710">twice,</span> <span m="1436900">each time</span> <span m="1437235">is</span> <span m="1437570">4</span> <span m="1437750">times</span> <span m="1437980">faster.</span> <span m="1438530">So</span> <span m="1439040">overall,</span> <span m="1439490">the</span> <span m="1439580">CRT</span> <span m="1440300">optimization</span> <span m="1440920">is</span> <span m="1441300">going</span> <span m="1441640">to give</span> <span m="1441750">us</span> <span m="1442080">basically</span> <span m="1442430">a</span> <span m="1442540">2x</span> <span m="1443520">performance</span> <span m="1444120">boost</span> <span m="1445180">for</span> <span m="1446130">doing any</span> <span m="1446920">RSA</span> <span m="1447270">operation</span> <span m="1447720">both,</span> <span m="1448080">in the encryption</span> <span m="1448440">and</span> <span m="1448705">decryption</span> <span m="1448970">side.</span> <span m="1450694">That</span> <span m="1451125">make</span> <span m="1451825">sense?</span> <span m="1454220">All right.</span> <span m="1455570">So</span> <span m="1455690">that's</span> <span m="1455950">the</span> <span m="1456530">first</span> <span m="1456790">optimization</span> <span m="1457310">that</span> <span m="1457770">most</span> <span m="1458220">people</span> <span m="1458540">use.</span> </p>
<p><span m="1460250">The</span> <span m="1460850">second</span> <span m="1461240">thing</span> <span m="1461515">that</span> <span m="1462890">most</span> <span m="1463370">implementations</span> <span m="1463930">do</span> <span m="1464550">is</span> <span m="1464960">a</span> <span m="1465340">technique</span> <span m="1465890">called</span> <span m="1466290">sliding</span> <span m="1466790">windows.</span> <span m="1472620">And</span> <span m="1474060">we'll</span> <span m="1474470">look</span> <span m="1474650">at</span> <span m="1474730">this</span> <span m="1474810">implementation</span> <span m="1475180">in</span> <span m="1475550">2</span> <span m="1475860">steps</span> <span m="1476200">so</span> <span m="1477170">this</span> <span m="1477540">implementation</span> <span m="1477910">is going</span> <span m="1478020">to</span> <span m="1478290">be</span> <span m="1478470">concerned</span> <span m="1479060">with</span> <span m="1479840">what</span> <span m="1480280">basic</span> <span m="1480590">operations</span> <span m="1481110">are</span> <span m="1481210">going</span> <span m="1481320">to</span> <span m="1481380">perform</span> <span m="1481740">to do</span> <span m="1482100">this</span> <span m="1482710">exponentiation.</span> <span m="1484390">Suppose</span> <span m="1484770">you</span> <span m="1484870">have</span> <span m="1485660">some</span> <span m="1486140">ciphertext</span> <span m="1486240">c</span> <span m="1487300">that's</span> <span m="1487580">now</span> <span m="1488010">500</span> <span m="1488130">bits</span> <span m="1489000">because</span> <span m="1489585">you</span> <span m="1489910">were</span> <span m="1490200">not</span> <span m="1490420">doing</span> <span m="1490640">mod p</span> <span m="1490950">or mod</span> <span m="1491190">q.</span> <span m="1492155">We</span> <span m="1492450">have a</span> <span m="1492940">500</span> <span m="1493400">bit</span> <span m="1493965">c</span> <span m="1494580">and,</span> <span m="1494850">similarly,</span> <span m="1495630">roughly a</span> <span m="1496080">500 bit</span> <span m="1497190">d</span> <span m="1498270">as</span> <span m="1498400">well.</span> </p>
<p><span m="1500185">So</span> <span m="1500610">how</span> <span m="1500955">do</span> <span m="1501300">we raise</span> <span m="1501700">c</span> <span m="1502200">to</span> <span m="1502510">the power</span> <span m="1502820">d?</span> <span m="1504070">I guess</span> <span m="1504385">the</span> <span m="1504700">stupid</span> <span m="1505070">way</span> <span m="1505240">that</span> <span m="1505680">is</span> <span m="1505800">to</span> <span m="1505900">take</span> <span m="1506130">c</span> <span m="1506630">and</span> <span m="1506810">keep</span> <span m="1507040">multiplying</span> <span m="1507720">d</span> <span m="1507910">times.</span> <span m="1508740">But</span> <span m="1508920">d is</span> <span m="1509170">very</span> <span m="1509410">big,</span> <span m="1509840">it's 2 to</span> <span m="1509920">the</span> <span m="1510340">500.</span> <span m="1510770">So</span> <span m="1511230">that's</span> <span m="1511390">never going to</span> <span m="1511790">finish.</span> <span m="1512940">So</span> <span m="1513910">a</span> <span m="1514300">more</span> <span m="1514690">amenable,</span> <span m="1515350">or</span> <span m="1515500">more</span> <span m="1515870">performant,</span> <span m="1516780">plan</span> <span m="1517985">is</span> <span m="1518250">to</span> <span m="1518340">do</span> <span m="1518540">what's</span> <span m="1518830">called</span> <span m="1519570">repeat</span> <span m="1519950">of</span> <span m="1520090">squaring.</span> <span m="1520810">So</span> <span m="1521305">that's</span> <span m="1522160">the</span> <span m="1522660">step</span> <span m="1523040">before</span> <span m="1523420">sliding</span> <span m="1523830">windows.</span> </p>
<p><span m="1524880">So this</span> <span m="1525165">technique</span> <span m="1525450">called</span> <span m="1525850">repeated</span> <span m="1526210">squaring</span> <span m="1531190">looks</span> <span m="1531380">like</span> <span m="1531540">this.</span> <span m="1531860">So if</span> <span m="1532000">you</span> <span m="1532090">want</span> <span m="1532220">to</span> <span m="1532620">compute</span> <span m="1533890">c</span> <span m="1535580">to</span> <span m="1536900">the</span> <span m="1536990">power</span> <span m="1538590">2</span> <span m="1539460">x,</span> <span m="1540580">then</span> <span m="1541055">you</span> <span m="1541530">can</span> <span m="1542000">actually</span> <span m="1542230">compute</span> <span m="1542370">c</span> <span m="1542450">to</span> <span m="1542730">the x</span> <span m="1543540">and</span> <span m="1543700">then</span> <span m="1544050">square</span> <span m="1544365">it.</span> <span m="1546080">So in</span> <span m="1546180">our naive</span> <span m="1546230">plan,</span> <span m="1546830">computing</span> <span m="1547250">c</span> <span m="1547530">to</span> <span m="1547990">the</span> <span m="1548200">2x</span> <span m="1548760">would have</span> <span m="1549210">involved</span> <span m="1549590">us making twice</span> <span m="1549930">as</span> <span m="1550060">many</span> <span m="1550350">iterations</span> <span m="1550850">of</span> <span m="1551000">multiplying</span> <span m="1551440">because</span> <span m="1551710">it's</span> <span m="1552200">multiplying</span> <span m="1552660">c</span> <span m="1552950">twice</span> <span m="1553280">many</span> <span m="1553480">times.</span> <span m="1553710">But in fact,</span> <span m="1553920">you</span> <span m="1554030">could</span> <span m="1554280">be</span> <span m="1554520">clever</span> <span m="1555100">and just</span> <span m="1555220">compute</span> <span m="1555490">c</span> <span m="1555650">to the</span> <span m="1556000">x</span> <span m="1556170">and then</span> <span m="1556430">square</span> <span m="1556940">it</span> <span m="1557060">later.</span> <span m="1558336">So</span> <span m="1558720">this</span> <span m="1558920">works</span> <span m="1559140">well,</span> <span m="1559460">and</span> <span m="1560260">this means</span> <span m="1560610">that</span> <span m="1561240">if</span> <span m="1561370">you're</span> <span m="1562360">computing</span> <span m="1563540">c</span> <span m="1564010">to</span> <span m="1564325">some</span> <span m="1564640">even</span> <span m="1565120">exponent,</span> <span m="1565485">this</span> <span m="1565850">works.</span> <span m="1566810">And</span> <span m="1567130">conversely,</span> <span m="1567180">if</span> <span m="1567430">you're</span> <span m="1567680">computing</span> <span m="1568340">c</span> <span m="1568780">to some</span> <span m="1569230">2x</span> <span m="1569470">plus</span> <span m="1569760">1,</span> <span m="1570540">then</span> <span m="1570720">you</span> <span m="1570810">could</span> <span m="1570890">imagine</span> <span m="1571310">this</span> <span m="1571450">is</span> <span m="1571570">just</span> <span m="1571870">c</span> <span m="1572340">to the x</span> <span m="1572810">squared</span> <span m="1573780">times</span> <span m="1574610">another</span> <span m="1574880">c.</span> <span m="1576461">So</span> <span m="1576900">this is</span> <span m="1577200">what's</span> <span m="1577300">called</span> <span m="1577500">repeated</span> <span m="1577820">squaring.</span> </p>
<p><span m="1578770">And</span> <span m="1579700">this</span> <span m="1579940">now</span> <span m="1580240">allows</span> <span m="1580700">us</span> <span m="1580840">to</span> <span m="1581010">compute</span> <span m="1582160">these</span> <span m="1582900">exponentiations,</span> <span m="1583375">or</span> <span m="1583850">modular</span> <span m="1584260">exponentiations,</span> <span m="1585790">in</span> <span m="1585970">a</span> <span m="1586660">time</span> <span m="1587210">that's</span> <span m="1587600">basically</span> <span m="1588040">linear</span> <span m="1588650">in</span> <span m="1588860">the</span> <span m="1589580">size</span> <span m="1589980">of</span> <span m="1590295">the</span> <span m="1590610">exponent.</span> <span m="1591200">So</span> <span m="1591620">for</span> <span m="1592046">every</span> <span m="1592472">bit</span> <span m="1592900">in</span> <span m="1592970">the</span> <span m="1593390">exponent,</span> <span m="1594110">we're</span> <span m="1594330">going</span> <span m="1594450">to</span> <span m="1594570">either</span> <span m="1596130">square</span> <span m="1596590">something</span> <span m="1597090">or</span> <span m="1597380">square</span> <span m="1597670">something</span> <span m="1598100">then</span> <span m="1598200">do an</span> <span m="1598310">extra</span> <span m="1598730">multiplication.</span> <span m="1600760">So</span> <span m="1600920">that's</span> <span m="1601400">the plan</span> <span m="1601800">for</span> <span m="1602612">repeated</span> <span m="1603270">squaring.</span> <span m="1603920">So</span> <span m="1604020">now</span> <span m="1604120">we</span> <span m="1604250">can</span> <span m="1605052">at least</span> <span m="1605504">have</span> <span m="1605956">non-embarrassing</span> <span m="1606408">run</span> <span m="1606860">times</span> <span m="1607290">for</span> <span m="1607430">computing</span> <span m="1608360">modular</span> <span m="1609120">exponents.</span> <span m="1610045">Does</span> <span m="1610370">this</span> <span m="1610520">make</span> <span m="1610660">sense,</span> <span m="1611840">why</span> <span m="1612040">this</span> <span m="1612360">is working</span> <span m="1612600">and</span> <span m="1613020">why</span> <span m="1613230">it's</span> <span m="1613540">faster?</span> </p>
<p><span m="1614780">All right, so</span> <span m="1615050">what's</span> <span m="1615360">this sliding</span> <span m="1615780">windows</span> <span m="1616280">trick</span> <span m="1616610">that</span> <span m="1617230">the</span> <span m="1617630">paper</span> <span m="1617890">talks</span> <span m="1618160">about?</span> <span m="1618930">So</span> <span m="1619250">this is a</span> <span m="1619330">little</span> <span m="1619560">bit</span> <span m="1620700">more</span> <span m="1620970">sophisticated</span> <span m="1621650">than</span> <span m="1622090">this</span> <span m="1622500">repeating</span> <span m="1622890">squaring</span> <span m="1623160">business.</span> <span m="1624050">And</span> <span m="1624560">basically</span> <span m="1626700">the</span> <span m="1626995">squaring</span> <span m="1627780">is</span> <span m="1627910">going</span> <span m="1628020">to</span> <span m="1628090">be</span> <span m="1628320">pretty</span> <span m="1628500">much</span> <span m="1628970">inevitable.</span> <span m="1629690">But</span> <span m="1630110">what</span> <span m="1630460">the</span> <span m="1630960">sliding</span> <span m="1631450">windows</span> <span m="1631880">optimization</span> <span m="1632235">is</span> <span m="1632590">trying</span> <span m="1632990">do</span> <span m="1633450">is</span> <span m="1634210">reduce</span> <span m="1634780">the</span> <span m="1634850">overhead</span> <span m="1635460">of</span> <span m="1635770">multiplying</span> <span m="1636080">by this</span> <span m="1636390">extra</span> <span m="1637040">c</span> <span m="1637570">down</span> <span m="1637810">here.</span> </p>
<p><span m="1638656">So suppose if</span> <span m="1639152">you have</span> <span m="1639650">some</span> <span m="1640210">number</span> <span m="1640760">that</span> <span m="1641300">has</span> <span m="1642030">several</span> <span m="1642910">1</span> <span m="1643350">bits</span> <span m="1643710">in the</span> <span m="1644070">exponent,</span> <span m="1644740">for</span> <span m="1644870">every</span> <span m="1645170">1 bit</span> <span m="1645470">in</span> <span m="1645710">the</span> <span m="1645910">exponent</span> <span m="1646150">in</span> <span m="1646330">the</span> <span m="1646410">binder</span> <span m="1646720">of</span> <span m="1647030">presentation,</span> <span m="1647485">you're going</span> <span m="1647940">to have</span> <span m="1648395">do this</span> <span m="1648850">step</span> <span m="1649305">instead of this</span> <span m="1649760">step.</span> <span m="1650670">Because</span> <span m="1651130">for every</span> <span m="1652020">odd</span> <span m="1652480">number,</span> <span m="1652805">you're</span> <span m="1653130">going to have</span> <span m="1653480">to</span> <span m="1653680">multiply</span> <span m="1653920">by</span> <span m="1654010">c.</span> <span m="1654610">So</span> <span m="1654960">these</span> <span m="1655150">guys</span> <span m="1655210">would</span> <span m="1655400">like</span> <span m="1655610">to not</span> <span m="1656000">multiply</span> <span m="1656280">by</span> <span m="1656560">this</span> <span m="1656740">c</span> <span m="1656860">as</span> <span m="1657000">often.</span> </p>
<p><span m="1657930">So the</span> <span m="1658930">plan</span> <span m="1659885">is</span> <span m="1660200">to</span> <span m="1660390">precompute</span> <span m="1661350">different</span> <span m="1662590">powers</span> <span m="1663060">of</span> <span m="1663320">c.</span> <span m="1664950">So</span> <span m="1665450">what we're</span> <span m="1665710">going</span> <span m="1665910">to do</span> <span m="1665950">is we're</span> <span m="1666170">going to</span> <span m="1666520">generate</span> <span m="1666930">a</span> <span m="1667225">table</span> <span m="1668100">that says,</span> <span m="1668340">well, here's the</span> <span m="1668490">value of</span> <span m="1669260">c to</span> <span m="1669640">the</span> <span m="1669980">x--</span> <span m="1670840">sorry,</span> <span m="1671470">c</span> <span m="1672110">to</span> <span m="1672310">the</span> <span m="1672420">1--</span> <span m="1673020">here's</span> <span m="1673445">the value</span> <span m="1673870">of</span> <span m="1674370">c to the</span> <span m="1674660">3,</span> <span m="1674950">c</span> <span m="1675400">to the</span> <span m="1675520">7.</span> <span m="1676540">And</span> <span m="1676890">I think</span> <span m="1676960">[? in open ?]</span> <span m="1677310">as a</span> <span m="1677490">cell,</span> <span m="1677960">it</span> <span m="1678080">goes</span> <span m="1678290">up</span> <span m="1678500">to</span> <span m="1679530">c</span> <span m="1679970">to the</span> <span m="1680190">31st.</span> <span m="1682020">So</span> <span m="1682490">this</span> <span m="1682610">table</span> <span m="1683510">is</span> <span m="1683650">going</span> <span m="1684400">to</span> <span m="1684490">just be</span> <span m="1684780">precomputed</span> <span m="1685460">when</span> <span m="1685600">you</span> <span m="1685690">want</span> <span m="1685860">to</span> <span m="1685960">do</span> <span m="1686230">some</span> <span m="1686650">modular</span> <span m="1687740">exponentiation.</span> <span m="1688640">You're</span> <span m="1689030">going</span> <span m="1689140">to</span> <span m="1689220">precompute</span> <span m="1689630">all</span> <span m="1689930">the</span> <span m="1690020">slots</span> <span m="1690380">in this</span> <span m="1690530">table.</span> <span m="1691660">And</span> <span m="1691780">then</span> <span m="1691910">when</span> <span m="1692100">you want to</span> <span m="1692390">do</span> <span m="1692680">this</span> <span m="1692880">exponentiation,</span> <span m="1694020">instead</span> <span m="1694340">of</span> <span m="1694740">doing the</span> <span m="1695040">repeated</span> <span m="1695350">squaring</span> <span m="1695560">and</span> <span m="1695830">multiplying</span> <span m="1696110">by this</span> <span m="1696390">c</span> <span m="1696850">every</span> <span m="1697170">time,</span> </p>
<p><span m="1699070">You're</span> <span m="1699510">going to use a</span> <span m="1699630">different</span> <span m="1699960">formula.</span> <span m="1700420">It says</span> <span m="1700540">as well</span> <span m="1700940">if</span> <span m="1701420">you</span> <span m="1701680">have</span> <span m="1702400">c</span> <span m="1702685">to the</span> <span m="1702970">32x</span> <span m="1703760">plus</span> <span m="1704990">some</span> <span m="1705380">y,</span> <span m="1706580">well</span> <span m="1707070">you</span> <span m="1707110">can</span> <span m="1707290">do</span> <span m="1707410">c</span> <span m="1707730">to the x,</span> <span m="1708840">and</span> <span m="1709020">you can</span> <span m="1709130">do</span> <span m="1709190">repeated</span> <span m="1709570">squaring--</span> <span m="1711770">very</span> <span m="1711910">much</span> <span m="1712620">like</span> <span m="1712800">before--</span> <span m="1713510">this is</span> <span m="1713820">to</span> <span m="1713900">get</span> <span m="1714170">the</span> <span m="1714420">32,</span> <span m="1714660">there's</span> <span m="1715460">like</span> <span m="1716180">5</span> <span m="1716540">powers of</span> <span m="1716940">2</span> <span m="1717090">here</span> <span m="1718250">times</span> <span m="1719470">c</span> <span m="1719910">to the</span> <span m="1720380">y.</span> <span m="1721560">And</span> <span m="1721760">c</span> <span m="1721910">to the</span> <span m="1722050">y,</span> <span m="1722420">you</span> <span m="1722530">can</span> <span m="1722750">get</span> <span m="1722790">out of</span> <span m="1723180">this table.</span> <span m="1724055">So</span> <span m="1724510">you can</span> <span m="1724780">see</span> <span m="1724910">that</span> <span m="1725030">we're doing</span> <span m="1725740">the</span> <span m="1725940">same number of</span> <span m="1726230">squaring</span> <span m="1726770">as</span> <span m="1726870">before</span> <span m="1727280">here.</span> <span m="1728280">But</span> <span m="1728680">we</span> <span m="1728760">don't</span> <span m="1728900">have</span> <span m="1729010">to</span> <span m="1729100">multiply</span> <span m="1729670">by</span> <span m="1730270">c</span> <span m="1730950">as</span> <span m="1731150">many</span> <span m="1731370">times.</span> <span m="1732270">You're</span> <span m="1732400">going</span> <span m="1732500">to</span> <span m="1732870">fish</span> <span m="1733110">it</span> <span m="1733450">out of</span> <span m="1733790">this table</span> <span m="1734400">and do</span> <span m="1734670">several</span> <span m="1735020">multiplies</span> <span m="1735290">by</span> <span m="1735570">c</span> <span m="1735890">for</span> <span m="1736210">the cost</span> <span m="1736580">of a</span> <span m="1736950">single</span> <span m="1737320">multiply.</span> <span m="1739030">This</span> <span m="1739315">make sense?</span> <span m="1740522">Yeah?</span> </p>
<p><span m="1740983">AUDIENCE:</span> <span m="1741444">How do you</span> <span m="1741905">determine</span> <span m="1742366">x and y</span> <span m="1742827">in the first place?</span> </p>
<p><span m="1744210">PROFESSOR: How do</span> <span m="1744360">determine</span> <span m="1744820">y?</span> </p>
<p><span m="1745125">AUDIENCE:</span> <span m="1745430">X and y.</span> </p>
<p><span m="1746156">PROFESSOR: Oh,</span> <span m="1746520">OK.</span> <span m="1747000">So</span> <span m="1747390">let's</span> <span m="1747450">look</span> <span m="1748030">at that.</span> <span m="1748380">So</span> <span m="1749330">for</span> <span m="1751260">repeated</span> <span m="1751620">squaring,</span> <span m="1752750">well</span> <span m="1753020">actually</span> <span m="1753290">in</span> <span m="1753470">both cases,</span> <span m="1754100">what</span> <span m="1754330">you</span> <span m="1754635">want to do</span> <span m="1754940">is you</span> <span m="1755120">want</span> <span m="1755240">to</span> <span m="1755480">look</span> <span m="1755900">at</span> <span m="1756120">the</span> <span m="1756350">exponent</span> <span m="1757240">that</span> <span m="1757380">you're</span> <span m="1757650">trying</span> <span m="1757920">to</span> <span m="1758070">use</span> <span m="1758680">in</span> <span m="1758930">a</span> <span m="1759220">binary</span> <span m="1760150">representation.</span> <span m="1761830">So</span> <span m="1762500">suppose</span> <span m="1762620">I'm</span> <span m="1762810">trying</span> <span m="1763090">to</span> <span m="1763430">compute</span> <span m="1763760">the</span> <span m="1763830">value</span> <span m="1764130">of</span> <span m="1764240">c</span> <span m="1764920">to</span> <span m="1765330">the</span> <span m="1765740">exponent,</span> <span m="1766180">I don't</span> <span m="1766620">know,</span> <span m="1767020">1</span> <span m="1767120">0</span> <span m="1768114">1</span> <span m="1768611">1</span> <span m="1769108">0</span> <span m="1769605">1</span> <span m="1770102">0,</span> <span m="1770600">and</span> <span m="1771100">maybe there's</span> <span m="1771600">more</span> <span m="1771810">bits.</span> <span m="1772755">OK,</span> <span m="1773180">so</span> <span m="1773200">if</span> <span m="1773340">we</span> <span m="1773470">wanted</span> <span m="1773770">to</span> <span m="1773980">do</span> <span m="1774480">repeated</span> <span m="1774895">squaring,</span> <span m="1775310">then</span> <span m="1775880">you</span> <span m="1776180">look</span> <span m="1776280">at</span> <span m="1776730">the</span> <span m="1776820">lowest bit</span> <span m="1777200">here--</span> <span m="1777490">it's</span> <span m="1777790">0.</span> <span m="1778410">So</span> <span m="1778820">what</span> <span m="1778970">you're</span> <span m="1779060">going</span> <span m="1779160">to</span> <span m="1779250">write</span> <span m="1779440">down</span> <span m="1779910">is</span> <span m="1780150">this is</span> <span m="1780240">equal</span> <span m="1780500">to</span> <span m="1780580">c</span> <span m="1780960">to</span> <span m="1781040">the</span> <span m="1781500">1</span> <span m="1781860">0</span> <span m="1782262">1</span> <span m="1782664">1</span> <span m="1783066">0</span> <span m="1783468">1</span> <span m="1785100">squared.</span> </p>
<p><span m="1786346">OK,</span> <span m="1786690">so</span> <span m="1786720">now</span> <span m="1787740">if</span> <span m="1788070">only</span> <span m="1788350">you knew</span> <span m="1788610">this</span> <span m="1788880">value,</span> <span m="1789205">then you</span> <span m="1789530">could</span> <span m="1789580">just square</span> <span m="1789840">it.</span> <span m="1790812">OK,</span> <span m="1791170">now we're</span> <span m="1791250">going to compute</span> <span m="1791500">this</span> <span m="1791800">guy,</span> <span m="1792100">so</span> <span m="1792410">c</span> <span m="1792650">to</span> <span m="1792760">the</span> <span m="1793240">1</span> <span m="1793490">0</span> <span m="1793932">1</span> <span m="1794374">1</span> <span m="1794816">0</span> <span m="1795260">1</span> <span m="1795510">is</span> <span m="1795650">equal</span> <span m="1795960">to--</span> <span m="1796020">well</span> <span m="1796530">here</span> <span m="1796970">we</span> <span m="1797380">can't</span> <span m="1797570">use this</span> <span m="1797750">rule</span> <span m="1797850">because it's</span> <span m="1798280">not</span> <span m="1798645">2x--</span> <span m="1799010">it's</span> <span m="1799140">going</span> <span m="1799240">to</span> <span m="1799290">be</span> <span m="1799540">to</span> <span m="1799815">the</span> <span m="1800090">x plus 1.</span> <span m="1800400">So</span> <span m="1800850">now we're</span> <span m="1801030">going to write</span> <span m="1801470">this</span> <span m="1801820">is</span> <span m="1802170">c</span> <span m="1802440">to</span> <span m="1802550">the</span> <span m="1802810">1</span> <span m="1803070">0</span> <span m="1803530">1</span> <span m="1803990">1</span> <span m="1805370">0</span> <span m="1806030">squared</span> <span m="1807160">times</span> <span m="1807440">another</span> <span m="1807790">c.</span> <span m="1809430">Because</span> <span m="1810560">it's</span> <span m="1811390">this</span> <span m="1811780">prefix</span> <span m="1812260">times</span> <span m="1812600">2</span> <span m="1813140">plus</span> <span m="1813460">this</span> <span m="1813630">one</span> <span m="1813870">of</span> <span m="1813960">m.</span> <span m="1815020">That's</span> <span m="1815280">how you fish</span> <span m="1815540">it out</span> <span m="1815875">for repeated</span> <span m="1816210">squaring.</span> </p>
<p><span m="1817140">And</span> <span m="1817510">for</span> <span m="1817690">sliding</span> <span m="1818110">window,</span> <span m="1818670">you</span> <span m="1818860">just</span> <span m="1819115">grab</span> <span m="1819370">more</span> <span m="1819600">bits</span> <span m="1819950">from</span> <span m="1820070">the</span> <span m="1820150">low</span> <span m="1820370">end.</span> <span m="1820680">So</span> <span m="1821110">if you</span> <span m="1821300">wanted</span> <span m="1821540">to</span> <span m="1821620">do</span> <span m="1821780">the</span> <span m="1822990">sliding</span> <span m="1823315">window</span> <span m="1823640">trick here</span> <span m="1824090">instead</span> <span m="1824350">of</span> <span m="1824580">taking</span> <span m="1825240">one</span> <span m="1825690">c</span> <span m="1826040">out,</span> <span m="1826860">suppose</span> <span m="1827130">we</span> <span m="1827230">do--</span> <span m="1828420">instead</span> <span m="1828590">of</span> <span m="1828710">this</span> <span m="1829040">giant</span> <span m="1829420">table--</span> <span m="1829720">maybe we do</span> <span m="1830200">3</span> <span m="1830430">bits</span> <span m="1830560">at a time.</span> <span m="1830980">So</span> <span m="1831190">we go off</span> <span m="1831480">to c</span> <span m="1831770">to</span> <span m="1831820">the</span> <span m="1831920">7th.</span> <span m="1832785">So</span> <span m="1833280">here</span> <span m="1833940">you</span> <span m="1834120">would</span> <span m="1835270">grab</span> <span m="1835610">the</span> <span m="1835690">first</span> <span m="1836110">3</span> <span m="1836290">bits,</span> <span m="1836620">and</span> <span m="1836950">that's</span> <span m="1837260">what</span> <span m="1837390">you</span> <span m="1837500">would</span> <span m="1837640">compute</span> <span m="1838108">here:</span> <span m="1839044">c</span> <span m="1839512">to the</span> <span m="1839980">1</span> <span m="1840448">0</span> <span m="1840920">1</span> <span m="1841050">to the</span> <span m="1841210">8th</span> <span m="1841570">power.</span> <span m="1842700">And</span> <span m="1842860">then,</span> <span m="1843410">the</span> <span m="1843520">rest</span> <span m="1843870">is</span> <span m="1844290">c</span> <span m="1844510">to the</span> <span m="1844990">1</span> <span m="1845295">0</span> <span m="1845600">1</span> <span m="1845915">power</span> <span m="1846770">here.</span> <span m="1848070">It's a little</span> <span m="1848520">unfortunate</span> <span m="1849130">these</span> <span m="1849490">are the</span> <span m="1849810">same thing,</span> <span m="1850120">but really</span> <span m="1850310">there's</span> <span m="1850450">more</span> <span m="1850660">bits</span> <span m="1850900">here.</span> <span m="1853190">But</span> <span m="1853280">here,</span> <span m="1853730">this</span> <span m="1853920">is</span> <span m="1854040">the</span> <span m="1854140">thing</span> <span m="1854370">that you're</span> <span m="1854625">going to</span> <span m="1854880">look up</span> <span m="1855320">in the table.</span> <span m="1855670">This is</span> <span m="1855960">c to the</span> <span m="1856250">5th</span> <span m="1856520">in</span> <span m="1857100">decimal.</span> <span m="1857760">And</span> <span m="1858632">this</span> <span m="1859070">says</span> <span m="1859180">you're</span> <span m="1859460">going to</span> <span m="1859740">keep doing</span> <span m="1860010">the sliding</span> <span m="1860210">window</span> <span m="1860590">to</span> <span m="1861043">compute</span> <span m="1861496">this value.</span> <span m="1863310">Make</span> <span m="1863565">sense?</span> </p>
<p><span m="1865140">This just</span> <span m="1865390">saves on</span> <span m="1865820">how</span> <span m="1865980">many</span> <span m="1866160">times</span> <span m="1866410">you have</span> <span m="1866900">to multiply</span> <span m="1867130">by c</span> <span m="1867550">by</span> <span m="1868370">pre-multiplying</span> <span m="1868760">it</span> <span m="1869150">a</span> <span m="1869210">bunch</span> <span m="1869420">of</span> <span m="1869530">times.</span> <span m="1870910">[? And the cell guys ?]</span> <span m="1871930">at least</span> <span m="1872110">10</span> <span m="1872270">years</span> <span m="1872500">ago</span> <span m="1872870">thought</span> <span m="1873170">that</span> <span m="1874220">going</span> <span m="1874490">up</span> <span m="1874690">to</span> <span m="1874980">32</span> <span m="1875810">power</span> <span m="1876520">was</span> <span m="1876720">the</span> <span m="1876790">best</span> <span m="1877070">plan</span> <span m="1877430">in terms</span> <span m="1877867">of efficiency</span> <span m="1878304">because there's</span> <span m="1878741">some trade off</span> <span m="1879180">here, right?</span> <span m="1880020">You</span> <span m="1880360">spend</span> <span m="1880665">time</span> <span m="1880970">preconfiguring</span> <span m="1881280">this table,</span> <span m="1881625">but</span> <span m="1881970">then</span> <span m="1882580">if</span> <span m="1882930">this table</span> <span m="1883205">is</span> <span m="1883480">too</span> <span m="1883660">giant,</span> <span m="1884400">you're not</span> <span m="1884530">going to use some entries,</span> <span m="1885650">because</span> <span m="1886860">if</span> <span m="1887090">you</span> <span m="1887260">run</span> <span m="1887440">this</span> <span m="1887560">table</span> <span m="1887870">out</span> <span m="1888100">to, I don't</span> <span m="1888370">know,</span> <span m="1888960">c</span> <span m="1889200">to</span> <span m="1889300">the</span> <span m="1889680">128</span> <span m="1890810">but</span> <span m="1890910">you're</span> <span m="1891170">computing</span> <span m="1891435">just</span> <span m="1891700">like</span> <span m="1891860">500</span> <span m="1892080">[? full bit ?]</span> <span m="1892680">exponents,</span> <span m="1893570">maybe</span> <span m="1893930">you're</span> <span m="1894200">not</span> <span m="1894590">going</span> <span m="1894800">to</span> <span m="1894920">use all these entries.</span> <span m="1895190">So it's gonna</span> <span m="1895390">be a waste</span> <span m="1895670">of time.</span> <span m="1896930">Question.</span> </p>
<p><span m="1897170">AUDIENCE:</span> <span m="1897580">[INAUDIBLE]</span> <span m="1900164">Is</span> <span m="1900660">there a reason</span> <span m="1901156">not to compute</span> <span m="1902148">the table</span> <span m="1902644">[INAUDIBLE]?</span> <span m="1904132">[INAUDIBLE].</span> </p>
<p><span m="1909460">PROFESSOR:</span> <span m="1910428">It</span> <span m="1910912">ends up</span> <span m="1911396">being</span> <span m="1911880">the case</span> <span m="1912240">that</span> <span m="1914350">you</span> <span m="1914560">don't</span> <span m="1914830">want</span> <span m="1915190">to--</span> <span m="1916450">well</span> <span m="1916660">there's</span> <span m="1916840">two</span> <span m="1916960">things</span> <span m="1917220">going</span> <span m="1917430">on.</span> <span m="1917740">One</span> <span m="1917890">is</span> <span m="1918020">that</span> <span m="1918640">you'll</span> <span m="1918950">have</span> <span m="1919190">now</span> <span m="1919640">code</span> <span m="1920040">to</span> <span m="1920160">check</span> <span m="1920440">whether</span> <span m="1920650">the</span> <span m="1920820">entry</span> <span m="1921163">is</span> <span m="1921850">filled</span> <span m="1922100">in</span> <span m="1922230">or</span> <span m="1922350">not,</span> <span m="1923040">and</span> <span m="1923320">that'll</span> <span m="1923610">probably</span> <span m="1924430">reduce</span> <span m="1924910">your</span> <span m="1925180">branch</span> <span m="1925440">predictor</span> <span m="1926015">accuracy</span> <span m="1926310">on</span> <span m="1926600">the</span> <span m="1926670">CPU</span> <span m="1927180">So it will</span> <span m="1927260">run</span> <span m="1927580">slower</span> <span m="1927870">in</span> <span m="1928160">the</span> <span m="1928270">common</span> <span m="1928640">case</span> <span m="1929010">because</span> <span m="1929320">if</span> <span m="1929440">you</span> <span m="1929910">[INAUDIBLE]</span> <span m="1930450">with</span> <span m="1930900">the entries</span> <span m="1931090">there.</span> </p>
<p><span m="1932090">Another</span> <span m="1932210">slightly</span> <span m="1932580">annoying</span> <span m="1932780">thing</span> <span m="1933240">is that it turns out</span> <span m="1934360">this</span> <span m="1934580">entry</span> <span m="1935270">leaks</span> <span m="1935560">stuff</span> <span m="1935850">through a</span> <span m="1936230">different</span> <span m="1936870">side-channel,</span> <span m="1938300">namely</span> <span m="1938440">cache</span> <span m="1939350">access</span> <span m="1939770">patterns.</span> <span m="1940670">So if</span> <span m="1940800">you</span> <span m="1940860">have</span> <span m="1941290">some</span> <span m="1941790">other</span> <span m="1942170">process</span> <span m="1942500">on the</span> <span m="1942765">same CPU,</span> <span m="1943610">you can</span> <span m="1943960">sort</span> <span m="1944120">of</span> <span m="1944230">see</span> <span m="1944510">which</span> <span m="1945100">cache</span> <span m="1945600">addresses</span> <span m="1946190">are</span> <span m="1946330">getting</span> <span m="1946650">evicted</span> <span m="1946670">out</span> <span m="1947010">of</span> <span m="1947340">the</span> <span m="1947450">cache</span> <span m="1948390">or</span> <span m="1948680">are</span> <span m="1948890">slower</span> <span m="1949760">because</span> <span m="1950190">someone</span> <span m="1950490">accessed</span> <span m="1950910">this entry</span> <span m="1951365">or this</span> <span m="1951820">entry.</span> <span m="1952730">And</span> <span m="1953080">the</span> <span m="1953420">bigger</span> <span m="1953800">this</span> <span m="1954140">table</span> <span m="1954240">gets,</span> <span m="1954780">the</span> <span m="1954960">easier</span> <span m="1955400">it</span> <span m="1955470">is</span> <span m="1955700">to</span> <span m="1955830">tell</span> <span m="1956120">what</span> <span m="1956440">the</span> <span m="1956500">exponent</span> <span m="1957190">bits</span> <span m="1957470">were.</span> </p>
<p><span m="1958630">In</span> <span m="1958760">the</span> <span m="1958900">limit,</span> <span m="1959320">this</span> <span m="1959753">table</span> <span m="1960186">is</span> <span m="1960860">gigantic</span> <span m="1961320">and</span> <span m="1962000">just</span> <span m="1962240">telling,</span> <span m="1962930">just</span> <span m="1963350">being</span> <span m="1963600">able</span> <span m="1963800">to</span> <span m="1963880">tell</span> <span m="1964160">which</span> <span m="1965030">cache</span> <span m="1965770">address</span> <span m="1966240">on</span> <span m="1966360">this</span> <span m="1966560">CPU</span> <span m="1967680">had</span> <span m="1968090">a</span> <span m="1968390">[? miss ?]</span> <span m="1968690">tells</span> <span m="1968990">you</span> <span m="1969060">that the</span> <span m="1969360">encryption</span> <span m="1969770">process</span> <span m="1970160">must have</span> <span m="1970530">accessed</span> <span m="1971100">that</span> <span m="1971290">entry in</span> <span m="1971490">the</span> <span m="1971580">table.</span> <span m="1971965">And</span> <span m="1972350">tells you</span> <span m="1972790">that,</span> <span m="1973180">oh</span> <span m="1973400">that</span> <span m="1973790">long bit sequence</span> <span m="1974680">appears</span> <span m="1974860">somewhere</span> <span m="1975450">in</span> <span m="1975580">your</span> <span m="1975770">secret</span> <span m="1976190">key</span> <span m="1976320">exponent.</span> <span m="1978170">So</span> <span m="1978910">I</span> <span m="1979276">guess</span> <span m="1979642">the answer</span> <span m="1980010">isn't</span> <span m="1980190">mathematically</span> <span m="1980930">you could</span> <span m="1981190">totally</span> <span m="1981450">fill this in</span> <span m="1981820">on</span> <span m="1982070">demand.</span> </p>
<p><span m="1983080">In</span> <span m="1983280">practice,</span> <span m="1984070">you</span> <span m="1984190">probably</span> <span m="1984490">don't</span> <span m="1984710">want</span> <span m="1984980">it</span> <span m="1985060">to be</span> <span m="1985250">that</span> <span m="1985600">giant.</span> <span m="1986550">And also,</span> <span m="1986820">if</span> <span m="1987090">you have</span> <span m="1987520">it's</span> <span m="1987950">particularly</span> <span m="1988380">giant,</span> <span m="1988810">you aren't</span> <span m="1989240">going to</span> <span m="1989670">be able to</span> <span m="1989900">use</span> <span m="1990130">entries</span> <span m="1990330">as</span> <span m="1991030">efficiently</span> <span m="1992240">as</span> <span m="1992350">well.</span> <span m="1993250">You</span> <span m="1993510">can</span> <span m="1993730">reuse</span> <span m="1994210">these</span> <span m="1994340">entries</span> <span m="1994625">as you're</span> <span m="1994910">computing.</span> <span m="1995260">[INAUDIBLE]</span> <span m="1995580">It's not</span> <span m="1995900">actually</span> <span m="1996090">that expensive</span> <span m="1996560">because</span> <span m="1997230">you</span> <span m="1998080">use</span> <span m="1998210">c</span> <span m="1998620">to the</span> <span m="1999050">cubed</span> <span m="1999460">when</span> <span m="1999870">you're</span> <span m="2000250">computing</span> <span m="2000310">c to the</span> <span m="2000420">7th</span> <span m="2000870">and</span> <span m="2001160">so on</span> <span m="2001290">and</span> <span m="2001540">so forth.</span> <span m="2003330">It's</span> <span m="2003480">not that</span> <span m="2003940">bad.</span> <span m="2005644">Make</span> <span m="2006070">sense?</span> <span m="2006800">Other</span> <span m="2007680">questions?</span> <span m="2010040">All</span> <span m="2010520">right.</span> </p>
<p><span m="2011260">So</span> <span m="2011420">this</span> <span m="2011610">is</span> <span m="2011810">the</span> <span m="2013150">repeated</span> <span m="2013840">squaring</span> <span m="2014340">and</span> <span m="2014840">sliding</span> <span m="2015250">window</span> <span m="2015470">optimization</span> <span m="2016350">that</span> <span m="2019320">open</span> <span m="2019570">[? a cell ?]</span> <span m="2020640">implements</span> <span m="2021480">[INAUDIBLE]</span> <span m="2022035">I</span> <span m="2022300">don't</span> <span m="2022410">actually</span> <span m="2022550">know</span> <span m="2022750">whether</span> <span m="2023050">they</span> <span m="2023200">still</span> <span m="2023550">have</span> <span m="2023780">the</span> <span m="2023870">same</span> <span m="2024410">size</span> <span m="2024840">of the</span> <span m="2025040">sliding</span> <span m="2025470">window</span> <span m="2025520">or</span> <span m="2025650">not.</span> <span m="2026260">But</span> <span m="2026610">it does</span> <span m="2026710">actually give</span> <span m="2027170">you</span> <span m="2027570">a fair bit</span> <span m="2027960">of</span> <span m="2028190">speed up.</span> <span m="2028460">So</span> <span m="2029150">before</span> <span m="2029660">you</span> <span m="2029790">had</span> <span m="2030190">to square</span> <span m="2031170">for</span> <span m="2031320">every</span> <span m="2031650">bit</span> <span m="2032460">in</span> <span m="2032600">the</span> <span m="2032880">exponent.</span> </p>
<p><span m="2033135">And then</span> <span m="2033390">you'd</span> <span m="2033767">have</span> <span m="2034144">to have</span> <span m="2034521">a</span> <span m="2034900">multiply</span> <span m="2035165">for</span> <span m="2035430">every</span> <span m="2035875">1 bit.</span> <span m="2037060">So</span> <span m="2037150">if</span> <span m="2037400">you</span> <span m="2037500">have</span> <span m="2038000">a</span> <span m="2038500">500</span> <span m="2038810">bit</span> <span m="2039600">exponent</span> <span m="2039800">then</span> <span m="2039990">you're</span> <span m="2040140">going</span> <span m="2040350">to do</span> <span m="2040460">500</span> <span m="2041050">squarings</span> <span m="2041840">and,</span> <span m="2042290">on</span> <span m="2042470">average,</span> <span m="2042880">roughly</span> <span m="2043570">256</span> <span m="2044740">multiplications</span> <span m="2045400">by</span> <span m="2045630">c.</span> <span m="2046980">So</span> <span m="2047030">with</span> <span m="2047230">sliding</span> <span m="2047470">windows,</span> <span m="2047770">you're going</span> <span m="2047890">to</span> <span m="2048130">still</span> <span m="2048440">do</span> <span m="2048560">the</span> <span m="2048929">512</span> <span m="2049699">squarings</span> <span m="2051030">because</span> <span m="2051150">there's</span> <span m="2051469">no</span> <span m="2052020">getting</span> <span m="2052400">around</span> <span m="2052654">that.</span> <span m="2053280">But</span> <span m="2053489">instead</span> <span m="2053750">of</span> <span m="2053920">doing</span> <span m="2054335">256</span> <span m="2054750">multiplies</span> <span m="2055300">by</span> <span m="2055440">c,</span> <span m="2056050">you're</span> <span m="2056310">going to</span> <span m="2056570">hopefully</span> <span m="2056845">do</span> <span m="2057120">way</span> <span m="2057880">fewer,</span> <span m="2059380">maybe</span> <span m="2059590">something</span> <span m="2059870">on the</span> <span m="2060125">order of</span> <span m="2060380">32</span> <span m="2060840">[INAUDIBLE]</span> <span m="2061130">multiplies</span> <span m="2061760">by</span> <span m="2061929">some</span> <span m="2062219">entry</span> <span m="2062969">in</span> <span m="2063130">this</span> <span m="2063260">table.</span> <span m="2064900">So</span> <span m="2065179">that's</span> <span m="2065641">the</span> <span m="2066103">general</span> <span m="2066565">plan.</span> <span m="2067489">[INAUDIBLE]</span> <span m="2069020">Not as dramatic</span> <span m="2069405">as</span> <span m="2069790">CRT,</span> <span m="2070330">not</span> <span m="2070679">2x,</span> <span m="2071400">but</span> <span m="2072210">it could</span> <span m="2072520">save you</span> <span m="2072750">like</span> <span m="2073090">almost</span> <span m="2073440">1.5x.</span> <span m="2077516">All</span> <span m="2077974">depending</span> <span m="2078440">on</span> <span m="2078570">exactly</span> <span m="2078830">what</span> <span m="2079090">[INAUDIBLE].</span> <span m="2080660">Make</span> <span m="2081090">sense?</span> <span m="2082870">Another</span> <span m="2083090">question</span> <span m="2083250">about</span> <span m="2083530">this?</span> <span m="2085888">All</span> <span m="2086345">right.</span> </p>
<p><span m="2087260">So</span> <span m="2087929">these</span> <span m="2088120">are</span> <span m="2088379">the</span> <span m="2088860">[? roughly ?]</span> <span m="2089030">easier</span> <span m="2089719">optimizations.</span> <span m="2090360">And</span> <span m="2090780">then</span> <span m="2091200">there's</span> <span m="2091620">two</span> <span m="2092370">clever</span> <span m="2092909">tricks</span> <span m="2093040">playing</span> <span m="2093345">with</span> <span m="2093650">numbers</span> <span m="2094070">for</span> <span m="2094190">how</span> <span m="2094370">to</span> <span m="2094520">do</span> <span m="2094889">just</span> <span m="2095320">a</span> <span m="2095409">multiplication</span> <span m="2097030">more</span> <span m="2097290">efficiently.</span> <span m="2099150">So</span> <span m="2099680">the</span> <span m="2099790">first</span> <span m="2100150">one</span> <span m="2100280">of</span> <span m="2100350">these</span> <span m="2100550">optimizations</span> <span m="2101690">that</span> <span m="2102130">we're</span> <span m="2102350">going</span> <span m="2102480">to</span> <span m="2102550">look</span> <span m="2102810">at--</span> <span m="2103510">I</span> <span m="2103910">think</span> <span m="2104080">I'll</span> <span m="2104455">raise</span> <span m="2104830">this board--</span> <span m="2106240">is</span> <span m="2106450">called</span> <span m="2106725">this</span> <span m="2107000">Montgomery</span> <span m="2108060">representation.</span> <span m="2109820">And</span> <span m="2110220">we'll see</span> <span m="2110620">in a second</span> <span m="2111070">why</span> <span m="2112800">it's</span> <span m="2113190">particularly</span> <span m="2113710">important</span> <span m="2114210">for</span> <span m="2114440">us.</span> </p>
<p><span m="2123820">So</span> <span m="2124180">the</span> <span m="2124440">problem</span> <span m="2124960">that</span> <span m="2125120">this</span> <span m="2125280">Montgomery</span> <span m="2125660">representation</span> <span m="2126700">optimization</span> <span m="2127115">is</span> <span m="2127530">trying</span> <span m="2127880">to</span> <span m="2127960">solve</span> <span m="2128330">for</span> <span m="2128520">us</span> <span m="2129150">is</span> <span m="2129560">the</span> <span m="2129650">fact</span> <span m="2130100">that</span> <span m="2130910">every</span> <span m="2131170">time</span> <span m="2131480">we</span> <span m="2131580">do</span> <span m="2131820">a</span> <span m="2132410">multiply,</span> <span m="2133170">we</span> <span m="2133330">get a</span> <span m="2133670">number</span> <span m="2133940">that keeps</span> <span m="2134210">growing</span> <span m="2134880">and</span> <span m="2134980">growing</span> <span m="2135560">and</span> <span m="2135660">growing.</span> <span m="2136650">In</span> <span m="2136780">particular,</span> <span m="2138200">both</span> <span m="2140050">in</span> <span m="2140270">sliding</span> <span m="2140550">windows</span> <span m="2140690">or</span> <span m="2140970">in</span> <span m="2141430">repeated</span> <span m="2141730">squaring,</span> <span m="2142650">actually</span> <span m="2143600">when</span> <span m="2143750">you square</span> <span m="2144160">you</span> <span m="2144470">multiply</span> <span m="2144860">2</span> <span m="2144990">numbers</span> <span m="2145300">together,</span> <span m="2146100">when you</span> <span m="2146180">multiply by</span> <span m="2146640">c to the</span> <span m="2147050">y,</span> <span m="2147460">you</span> <span m="2147510">multiply</span> <span m="2147815">2</span> <span m="2148120">numbers</span> <span m="2148260">together.</span> </p>
<p><span m="2148685">And</span> <span m="2149110">the</span> <span m="2149260">problem is</span> <span m="2149660">that</span> <span m="2149940">if</span> <span m="2150310">the inputs</span> <span m="2151620">to</span> <span m="2151750">the</span> <span m="2151850">multiplication</span> <span m="2153010">were,</span> <span m="2153650">let's</span> <span m="2153870">say,</span> <span m="2154540">512</span> <span m="2154790">bits</span> <span m="2156070">each.</span> <span m="2156910">Then</span> <span m="2157300">the</span> <span m="2157560">result</span> <span m="2158530">of</span> <span m="2158640">the</span> <span m="2158770">multiplication</span> <span m="2159140">is</span> <span m="2159510">going to be</span> <span m="2159960">1,000</span> <span m="2160370">bits.</span> <span m="2161130">And</span> <span m="2161510">then</span> <span m="2161620">you'd</span> <span m="2161670">take</span> <span m="2162030">this</span> <span m="2162550">1,000</span> <span m="2162710">bit</span> <span m="2162830">result</span> <span m="2163120">and</span> <span m="2163410">you</span> <span m="2163670">multiply</span> <span m="2163930">it again</span> <span m="2164200">by</span> <span m="2164340">something</span> <span m="2164800">like</span> <span m="2165020">five</span> <span m="2165270">[INAUDIBLE]</span> <span m="2165520">bits.</span> <span m="2165870">And now</span> <span m="2166155">it's</span> <span m="2166440">1,500</span> <span m="2166893">bits,</span> <span m="2167346">2,000</span> <span m="2167800">bits,</span> <span m="2168060">2,500</span> <span m="2168320">bits,</span> <span m="2168910">and it</span> <span m="2169050">keeps</span> <span m="2169380">growing</span> <span m="2169750">and</span> <span m="2169860">growing.</span> </p>
<p><span m="2170790">And you</span> <span m="2170920">really</span> <span m="2171200">don't</span> <span m="2171420">want</span> <span m="2171620">this</span> <span m="2171800">because</span> <span m="2172620">multiplications</span> <span m="2173430">[? quadratic ?]</span> <span m="2173850">in</span> <span m="2174300">the</span> <span m="2174370">size</span> <span m="2174750">of</span> <span m="2174850">the</span> <span m="2174930">number</span> <span m="2175660">we're</span> <span m="2175840">multiplying.</span> <span m="2177670">So</span> <span m="2177810">we</span> <span m="2177930">have</span> <span m="2178170">to</span> <span m="2178300">keep</span> <span m="2178610">the</span> <span m="2178700">size</span> <span m="2178970">of our</span> <span m="2179130">number</span> <span m="2179430">as</span> <span m="2179580">small</span> <span m="2179870">as</span> <span m="2180000">possible,</span> <span m="2180490">which</span> <span m="2180580">means</span> <span m="2181190">basically</span> <span m="2181560">512</span> <span m="2181985">bits</span> <span m="2182410">because</span> <span m="2182835">all this</span> <span m="2183260">computation</span> <span m="2183605">is</span> <span m="2184090">mod</span> <span m="2184520">p</span> <span m="2184950">or</span> <span m="2185300">mod q.</span> <span m="2187360">Yeah?</span> </p>
<p><span m="2188670">AUDIENCE: What</span> <span m="2188970">do you</span> <span m="2189110">want</span> <span m="2189380">[INAUDIBLE]?</span> </p>
<p><span m="2192510">PROFESSOR: That's</span> <span m="2192750">right,</span> <span m="2192970">yeah.</span> <span m="2193210">So</span> <span m="2193330">the</span> <span m="2193490">cool</span> <span m="2193690">thing</span> <span m="2193890">is</span> <span m="2194090">that</span> <span m="2194570">we</span> <span m="2194860">can</span> <span m="2195220">keep</span> <span m="2195450">this</span> <span m="2195610">number</span> <span m="2195900">down</span> <span m="2196240">because</span> <span m="2196780">what</span> <span m="2196940">we</span> <span m="2197060">do</span> <span m="2197380">is,</span> <span m="2197520">let's say,</span> <span m="2197640">we want</span> <span m="2197860">to</span> <span m="2197920">compute</span> <span m="2198780">c</span> <span m="2199000">to</span> <span m="2199080">the</span> <span m="2199240">x</span> <span m="2199610">just for</span> <span m="2199870">this</span> <span m="2200050">example.</span> <span m="2200730">Squared.</span> <span m="2201524">Squared</span> <span m="2201921">again.</span> <span m="2203270">Squared</span> <span m="2203360">again.</span> <span m="2204350">What you</span> <span m="2204490">could</span> <span m="2204670">do</span> <span m="2204980">is</span> <span m="2205240">you</span> <span m="2205330">compute</span> <span m="2205670">c</span> <span m="2205920">to the</span> <span m="2206265">x</span> <span m="2206610">then</span> <span m="2206850">you</span> <span m="2207020">take</span> <span m="2207360">mod</span> <span m="2208165">p,</span> <span m="2208570">let's say,</span> <span m="2209100">right.</span> <span m="2209740">Then you</span> <span m="2210000">square</span> <span m="2210430">it</span> <span m="2210770">then</span> <span m="2211100">you do</span> <span m="2211350">mod p</span> <span m="2211770">again.</span> <span m="2213110">Then</span> <span m="2213340">you</span> <span m="2213440">square</span> <span m="2213810">it</span> <span m="2213960">again,</span> <span m="2214310">and</span> <span m="2214665">then</span> <span m="2215020">you do</span> <span m="2215500">mod p</span> <span m="2215990">again.</span> <span m="2216820">And</span> <span m="2216970">so</span> <span m="2217340">on.</span> </p>
<p><span m="2217740">So this is</span> <span m="2218140">basically</span> <span m="2218450">what</span> <span m="2218750">you're</span> <span m="2219050">proposing.</span> <span m="2219330">So</span> <span m="2219580">this is</span> <span m="2219840">great.</span> <span m="2220100">In</span> <span m="2220580">fact,</span> <span m="2220800">this keeps</span> <span m="2221130">it</span> <span m="2221230">size</span> <span m="2221590">of</span> <span m="2221710">our</span> <span m="2222200">numbers</span> <span m="2222830">to</span> <span m="2223170">basically</span> <span m="2223510">five</span> <span m="2223870">total</span> <span m="2224230">bits,</span> <span m="2224555">which is</span> <span m="2224880">about as</span> <span m="2225260">small as</span> <span m="2225640">we can get.</span> <span m="2226890">This is</span> <span m="2227280">good</span> <span m="2227630">in</span> <span m="2227750">terms</span> <span m="2228010">of</span> <span m="2228310">keeping</span> <span m="2228620">down</span> <span m="2228710">the size</span> <span m="2229210">of</span> <span m="2229290">these</span> <span m="2229980">numbers</span> <span m="2230480">for</span> <span m="2230620">multiplication.</span> <span m="2231940">But</span> <span m="2232630">it's</span> <span m="2232996">actually kind of</span> <span m="2233362">expensive</span> <span m="2233730">to</span> <span m="2234010">do</span> <span m="2234510">this</span> <span m="2234670">mod p</span> <span m="2235310">operation.</span> <span m="2236920">Because</span> <span m="2237160">the</span> <span m="2237250">way</span> <span m="2237580">that you</span> <span m="2237840">do</span> <span m="2238250">mod p</span> <span m="2238620">something</span> <span m="2238930">is</span> <span m="2239240">you</span> <span m="2239740">basically</span> <span m="2240240">have to</span> <span m="2240740">do division.</span> <span m="2241740">And</span> <span m="2241860">division</span> <span m="2242125">is</span> <span m="2242390">way</span> <span m="2242590">worse</span> <span m="2242890">than</span> <span m="2242960">multiplication.</span> </p>
<p><span m="2244510">I'm</span> <span m="2245000">not going</span> <span m="2245020">to go</span> <span m="2245420">through</span> <span m="2246000">the</span> <span m="2246310">algorithms</span> <span m="2246930">for</span> <span m="2247070">division,</span> <span m="2247730">but</span> <span m="2248760">it's</span> <span m="2249940">really</span> <span m="2250270">slow.</span> <span m="2250520">You</span> <span m="2250990">usually want to</span> <span m="2251410">avoid division</span> <span m="2252220">as</span> <span m="2252430">much</span> <span m="2252660">as</span> <span m="2252760">possible.</span> <span m="2253990">Because</span> <span m="2254290">it's</span> <span m="2254450">not</span> <span m="2254620">even</span> <span m="2254840">just</span> <span m="2255040">a</span> <span m="2255220">straightforward</span> <span m="2255860">programming</span> <span m="2256240">thing,</span> <span m="2256360">you</span> <span m="2256690">have</span> <span m="2256910">to</span> <span m="2256970">do</span> <span m="2257530">some</span> <span m="2258260">approximation</span> <span m="2258615">algorithm,</span> <span m="2259290">some sort</span> <span m="2259610">of</span> <span m="2260030">Newton's</span> <span m="2260340">method</span> <span m="2260670">of</span> <span m="2260750">some</span> <span m="2260940">sort</span> <span m="2261780">and just</span> <span m="2262100">keep</span> <span m="2262270">it</span> <span m="2262430">[INAUDIBLE].</span> <span m="2263330">It's</span> <span m="2263500">going</span> <span m="2263620">to be</span> <span m="2263710">slow.</span> </p>
<p><span m="2264790">And</span> <span m="2265270">in</span> <span m="2265400">the main</span> <span m="2265600">implementation,</span> <span m="2266900">this</span> <span m="2267030">actually</span> <span m="2267290">turns</span> <span m="2267500">out</span> <span m="2267630">to</span> <span m="2267690">be</span> <span m="2267810">the</span> <span m="2267980">slowest</span> <span m="2268620">part</span> <span m="2269025">of</span> <span m="2269430">doing</span> <span m="2269790">multiplication.</span> <span m="2270640">The</span> <span m="2270700">multiplication</span> <span m="2271350">is</span> <span m="2271500">cheap.</span> <span m="2272230">But</span> <span m="2272330">then</span> <span m="2272580">doing</span> <span m="2272790">mod p</span> <span m="2273170">or</span> <span m="2273410">mod q</span> <span m="2273800">to</span> <span m="2274060">bring</span> <span m="2274350">it</span> <span m="2274500">back</span> <span m="2274770">down</span> <span m="2275020">in</span> <span m="2275140">size</span> <span m="2276210">is</span> <span m="2276420">going</span> <span m="2276620">to be</span> <span m="2277060">actually</span> <span m="2277220">more</span> <span m="2277290">expensive than</span> <span m="2277670">the</span> <span m="2278050">multiplying.</span> <span m="2279190">So that's actually</span> <span m="2279585">kind of</span> <span m="2279980">a</span> <span m="2280480">bummer.</span> </p>
<p><span m="2281480">So</span> <span m="2282230">the</span> <span m="2282460">way</span> <span m="2282660">that</span> <span m="2282790">we're</span> <span m="2282890">going</span> <span m="2283000">to</span> <span m="2283050">get</span> <span m="2283220">around</span> <span m="2283700">this</span> <span m="2284560">is</span> <span m="2285080">by</span> <span m="2286170">doing</span> <span m="2286450">this</span> <span m="2286650">multiplication,</span> <span m="2287480">this</span> <span m="2287920">clever</span> <span m="2288180">other</span> <span m="2288590">representation,</span> <span m="2290370">and</span> <span m="2290490">also</span> <span m="2290790">I'll show</span> <span m="2290960">you</span> <span m="2291080">the</span> <span m="2291260">trick</span> <span m="2291510">here.</span> <span m="2293280">Let's</span> <span m="2293450">see.</span> <span m="2294780">Bear with me</span> <span m="2295260">for a second,</span> <span m="2295740">and then</span> <span m="2296220">we'll</span> <span m="2296680">and then see</span> <span m="2297160">why</span> <span m="2297380">it's</span> <span m="2298090">so</span> <span m="2298330">fast</span> <span m="2298870">to</span> <span m="2299130">use</span> <span m="2299618">this</span> <span m="2300106">Montgomery</span> <span m="2300594">trick.</span> </p>
<p><span m="2301082">And</span> <span m="2302550">the</span> <span m="2302660">basic</span> <span m="2303130">idea</span> <span m="2303910">is</span> <span m="2304400">to</span> <span m="2304650">represent</span> <span m="2305200">numbers,</span> <span m="2306190">these</span> <span m="2306430">are</span> <span m="2306820">regular</span> <span m="2307190">numbers</span> <span m="2307830">that</span> <span m="2308656">you</span> <span m="2309070">might</span> <span m="2309300">actually</span> <span m="2309570">want</span> <span m="2309760">to</span> <span m="2309800">multiply.</span> <span m="2310852">And</span> <span m="2311234">we're</span> <span m="2311616">going to have</span> <span m="2312000">a</span> <span m="2312110">different</span> <span m="2312370">representation</span> <span m="2312980">for</span> <span m="2313070">these</span> <span m="2313280">numbers,</span> <span m="2313990">called</span> <span m="2314250">the</span> <span m="2314390">Montgomery</span> <span m="2314695">representation.</span> <span m="2317530">And</span> <span m="2318010">that</span> <span m="2318490">representation</span> <span m="2319450">is</span> <span m="2319550">actually</span> <span m="2319750">very</span> <span m="2320110">easy.</span> <span m="2321190">We</span> <span m="2321220">just</span> <span m="2321390">take</span> <span m="2321600">the</span> <span m="2321670">value</span> <span m="2321990">a</span> <span m="2322500">and</span> <span m="2322840">we multiply</span> <span m="2323245">it</span> <span m="2323990">by</span> <span m="2324200">some</span> <span m="2324490">magic</span> <span m="2324840">value</span> <span m="2325160">R.</span> </p>
<p><span m="2326000">I'll</span> <span m="2326310">tell you</span> <span m="2326560">what this</span> <span m="2326880">R is</span> <span m="2327010">in a second.</span> <span m="2328250">But</span> <span m="2328560">let's</span> <span m="2328770">first</span> <span m="2329060">figure</span> <span m="2329480">out</span> <span m="2330100">if you pick</span> <span m="2330730">some</span> <span m="2330910">arbitrary</span> <span m="2331370">value</span> <span m="2331710">R,</span> <span m="2332270">what's</span> <span m="2332460">going</span> <span m="2332560">to</span> <span m="2332600">happen</span> <span m="2332940">here?</span> <span m="2333820">So we</span> <span m="2333950">take</span> <span m="2334170">2</span> <span m="2334250">numbers,</span> <span m="2334720">a</span> <span m="2335130">and</span> <span m="2335330">b.</span> <span m="2336200">Their</span> <span m="2336625">Montgomery</span> <span m="2337210">representations</span> <span m="2338235">are</span> <span m="2339460">sort of</span> <span m="2339630">expectedly.</span> <span m="2340075">A</span> <span m="2340520">is</span> <span m="2340800">aR,</span> <span m="2341080">b</span> <span m="2341540">is</span> <span m="2341900">bR.</span> </p>
<p><span m="2342840">And</span> <span m="2343225">if</span> <span m="2343610">you want</span> <span m="2343650">to compute</span> <span m="2343980">the</span> <span m="2344120">product</span> <span m="2344450">of</span> <span m="2344580">a</span> <span m="2344690">times</span> <span m="2344990">b,</span> <span m="2345920">well in</span> <span m="2346250">Montgomery</span> <span m="2346770">space,</span> <span m="2347120">you</span> <span m="2347470">can</span> <span m="2347830">also</span> <span m="2348100">multiply</span> <span m="2348400">these</span> <span m="2348720">guys</span> <span m="2348900">out.</span> <span m="2349160">You</span> <span m="2349500">can take</span> <span m="2350080">aR</span> <span m="2351360">multiply</span> <span m="2351660">it</span> <span m="2351960">by</span> <span m="2352070">bR.</span> <span m="2353310">And</span> <span m="2353700">what</span> <span m="2354090">you get</span> <span m="2354480">here</span> <span m="2354770">is</span> <span m="2355150">ab</span> <span m="2355850">times</span> <span m="2356190">R</span> <span m="2356460">squared.</span> <span m="2357130">So</span> <span m="2357170">there are</span> <span m="2357450">two</span> <span m="2357710">Rs</span> <span m="2358080">now.</span> <span m="2358770">That's</span> <span m="2359080">kind</span> <span m="2359240">of</span> <span m="2359310">annoying,</span> <span m="2359990">but</span> <span m="2360455">you</span> <span m="2360920">can</span> <span m="2361040">divide</span> <span m="2361140">that</span> <span m="2361550">by</span> <span m="2361710">R.</span> <span m="2362570">And</span> <span m="2362780">we</span> <span m="2362890">get</span> <span m="2363440">ab</span> <span m="2364130">times</span> <span m="2364470">R.</span> <span m="2366750">So</span> <span m="2368120">this is</span> <span m="2368260">probably</span> <span m="2368610">weird</span> <span m="2369140">in</span> <span m="2369230">a</span> <span m="2369280">sense</span> <span m="2369610">that</span> <span m="2370075">why</span> <span m="2370390">would</span> <span m="2370665">you</span> <span m="2370940">multiply</span> <span m="2371070">this</span> <span m="2371280">extra</span> <span m="2371350">number.</span> <span m="2372190">But</span> <span m="2372320">let's</span> <span m="2372480">first</span> <span m="2372710">figure</span> <span m="2372890">out</span> <span m="2373040">whether</span> <span m="2373240">this</span> <span m="2373670">is</span> <span m="2374200">correct.</span> <span m="2374525">And then</span> <span m="2374850">we'll</span> <span m="2375000">figure</span> <span m="2375190">out</span> <span m="2375340">why this</span> <span m="2375510">is</span> <span m="2375690">going</span> <span m="2375800">to</span> <span m="2375840">be</span> <span m="2375940">faster.</span> </p>
<p><span m="2377290">So</span> <span m="2377640">it's</span> <span m="2377790">correct</span> <span m="2378050">in the</span> <span m="2378310">sense</span> <span m="2378460">that it's</span> <span m="2378610">very</span> <span m="2378915">easy.</span> <span m="2379220">If you want</span> <span m="2379440">to multiply</span> <span m="2379860">some</span> <span m="2380010">numbers,</span> <span m="2380840">we</span> <span m="2380940">just</span> <span m="2381120">multiply</span> <span m="2381530">by this</span> <span m="2381850">R</span> <span m="2382070">value and</span> <span m="2382520">get</span> <span m="2382942">the Montgomery</span> <span m="2383364">representation.</span> <span m="2384208">Then</span> <span m="2384630">we can</span> <span m="2384880">do</span> <span m="2385380">all these</span> <span m="2385680">multiplications</span> <span m="2385980">to</span> <span m="2386280">these</span> <span m="2386370">Montgomery</span> <span m="2386650">forms.</span> <span m="2387920">And</span> <span m="2388900">every time</span> <span m="2389380">we</span> <span m="2389840">multiply</span> <span m="2390100">2 numbers,</span> <span m="2390370">we have</span> <span m="2390640">to divide</span> <span m="2390950">by</span> <span m="2391100">R,</span> <span m="2391560">look at</span> <span m="2391830">the Montgomery</span> <span m="2392180">form</span> <span m="2392530">of</span> <span m="2392990">the</span> <span m="2393430">multiplication</span> <span m="2394050">result.</span> <span m="2394550">And</span> <span m="2395040">then when</span> <span m="2395380">we're done</span> <span m="2395800">doing</span> <span m="2396220">all of our</span> <span m="2396640">squarings,</span> <span m="2397440">multiplication,</span> <span m="2398130">all</span> <span m="2398220">this</span> <span m="2398340">stuff,</span> <span m="2398780">we're going to</span> <span m="2399310">move</span> <span m="2399360">back</span> <span m="2399660">to</span> <span m="2399730">the</span> <span m="2399890">normal,</span> <span m="2400180">regular</span> <span m="2400470">form</span> <span m="2401180">by</span> <span m="2401490">just</span> <span m="2401745">dividing</span> <span m="2402000">by</span> <span m="2402180">R</span> <span m="2402535">one</span> <span m="2402890">last</span> <span m="2403180">time.</span> </p>
<p><span m="2404890">AUDIENCE:</span> <span m="2405390">[INAUDIBLE]</span> </p>
<p><span m="2407390">PROFESSOR:</span> <span m="2407453">We're</span> <span m="2407516">now</span> <span m="2407580">going to pick</span> <span m="2407920">R to be</span> <span m="2408420">a very</span> <span m="2408660">nice</span> <span m="2408960">number.</span> <span m="2409560">And</span> <span m="2410130">in</span> <span m="2410210">particular,</span> <span m="2411080">we're going</span> <span m="2411180">to pick</span> <span m="2411520">R</span> <span m="2411900">to be</span> <span m="2412300">a very nice</span> <span m="2412550">number</span> <span m="2412880">to make</span> <span m="2413210">this</span> <span m="2413700">division</span> <span m="2414200">by</span> <span m="2414420">R</span> <span m="2415050">very</span> <span m="2415440">fast.</span> <span m="2417780">And</span> <span m="2418770">the</span> <span m="2418890">cool</span> <span m="2419110">thing</span> <span m="2419410">is</span> <span m="2419630">that</span> <span m="2420160">if</span> <span m="2420330">this</span> <span m="2420470">division</span> <span m="2420790">by</span> <span m="2420990">R</span> <span m="2421320">is going</span> <span m="2421430">to</span> <span m="2421470">be</span> <span m="2421580">very</span> <span m="2421830">fast,</span> <span m="2423120">then</span> <span m="2424560">this</span> <span m="2424790">is</span> <span m="2424830">going</span> <span m="2424930">to</span> <span m="2424990">be</span> <span m="2425090">a</span> <span m="2425150">small</span> <span m="2425610">number</span> <span m="2425980">and we're not</span> <span m="2426290">going to</span> <span m="2426560">have to</span> <span m="2426680">do</span> <span m="2426860">this</span> <span m="2427100">mod</span> <span m="2427530">q</span> <span m="2428000">very often.</span> <span m="2429460">In</span> <span m="2429570">particular,</span> <span m="2430780">aR,</span> <span m="2431350">let's</span> <span m="2431570">say,</span> <span m="2432050">is also</span> <span m="2432120">going</span> <span m="2432240">to</span> <span m="2432310">be</span> <span m="2432810">roughly</span> <span m="2433130">500</span> <span m="2433640">bits</span> <span m="2433890">because</span> <span m="2434070">it's all actually</span> <span m="2434530">mod</span> <span m="2435480">p</span> <span m="2435830">or</span> <span m="2436290">mod q.</span> <span m="2436630">So</span> <span m="2437078">aR</span> <span m="2437526">is</span> <span m="2437974">500</span> <span m="2438422">bits.</span> </p>
<p><span m="2439320">BR</span> <span m="2439490">is</span> <span m="2440020">going</span> <span m="2440200">to</span> <span m="2440320">also be</span> <span m="2440720">500</span> <span m="2440975">bits.</span> <span m="2441230">So this</span> <span m="2441500">product</span> <span m="2442330">is</span> <span m="2442440">going</span> <span m="2442560">to</span> <span m="2442610">be</span> <span m="2442730">1,000</span> <span m="2443260">bits.</span> <span m="2444160">This</span> <span m="2444370">R</span> <span m="2444700">is going</span> <span m="2445160">to be</span> <span m="2445440">this nice</span> <span m="2445720">500</span> <span m="2446280">roughly</span> <span m="2446570">bit</span> <span m="2446830">number,</span> <span m="2447670">same</span> <span m="2447690">size</span> <span m="2447870">as</span> <span m="2447950">p.</span> <span m="2448630">And if</span> <span m="2448975">we</span> <span m="2449320">can</span> <span m="2449660">make</span> <span m="2449890">this</span> <span m="2450010">division</span> <span m="2450440">to</span> <span m="2450500">be</span> <span m="2450610">fast,</span> <span m="2450925">then</span> <span m="2451670">the</span> <span m="2451760">result</span> <span m="2453080">is</span> <span m="2453200">going</span> <span m="2453310">to</span> <span m="2453360">be</span> <span m="2453540">a</span> <span m="2453860">roughly</span> <span m="2454200">500</span> <span m="2454660">bit</span> <span m="2454850">number</span> <span m="2455190">here.</span> <span m="2456030">So</span> <span m="2456150">we</span> <span m="2456300">were</span> <span m="2456460">able</span> <span m="2456940">to do</span> <span m="2457020">the multiplying</span> <span m="2457315">without</span> <span m="2457610">having</span> <span m="2457910">to do</span> <span m="2458310">an</span> <span m="2458673">extra</span> <span m="2459036">divide.</span> <span m="2459400">Dividing</span> <span m="2459820">by</span> <span m="2459990">R</span> <span m="2460220">cheaply</span> <span m="2461220">gives us</span> <span m="2461560">this</span> <span m="2461780">small</span> <span m="2462240">result,</span> <span m="2463226">getting</span> <span m="2463572">us</span> <span m="2463920">out</span> <span m="2464420">of doing</span> <span m="2464810">a</span> <span m="2464830">mod p</span> <span m="2465640">for most</span> <span m="2466040">situations.</span> </p>
<p><span m="2468360">OK,</span> <span m="2468590">so</span> <span m="2468900">what</span> <span m="2469330">is</span> <span m="2469520">this</span> <span m="2469890">weird</span> <span m="2469980">number</span> <span m="2470170">that</span> <span m="2470336">I</span> <span m="2470503">keep</span> <span m="2470670">talking</span> <span m="2471060">about?</span> <span m="2471670">Well</span> <span m="2472220">R</span> <span m="2472570">is</span> <span m="2472920">just</span> <span m="2473280">going</span> <span m="2473410">to</span> <span m="2473510">be</span> <span m="2474260">2</span> <span m="2474698">to</span> <span m="2475574">512.</span> <span m="2477944">It's</span> <span m="2478442">going</span> <span m="2478940">to be</span> <span m="2479440">1</span> <span m="2479755">followed</span> <span m="2480070">by a</span> <span m="2480405">ton</span> <span m="2480740">of</span> <span m="2481140">zeros.</span> <span m="2482930">So</span> <span m="2483850">multiplying</span> <span m="2484190">by this</span> <span m="2484290">is</span> <span m="2484430">easy,</span> <span m="2484730">you</span> <span m="2485090">just</span> <span m="2485260">append</span> <span m="2485300">a bunch</span> <span m="2485500">of</span> <span m="2485580">zeros</span> <span m="2486040">to a number.</span> <span m="2487320">Dividing</span> <span m="2489050">could</span> <span m="2489510">be</span> <span m="2489970">easy</span> <span m="2490430">if</span> <span m="2490890">the</span> <span m="2490960">low</span> <span m="2491340">bits</span> <span m="2491720">of</span> <span m="2491970">the</span> <span m="2492130">result</span> <span m="2492960">are</span> <span m="2493620">all</span> <span m="2493820">zeros.</span> <span m="2494547">So</span> <span m="2495024">if</span> <span m="2495501">you have</span> <span m="2495980">a value</span> <span m="2496795">that's</span> <span m="2497090">a</span> <span m="2497200">bunch</span> <span m="2497430">of bits</span> <span m="2497750">followed</span> <span m="2498120">by</span> <span m="2498270">512</span> <span m="2499000">zeros,</span> <span m="2499780">then</span> <span m="2500060">dividing</span> <span m="2500520">by</span> <span m="2500640">2</span> <span m="2500900">to</span> <span m="2501070">the</span> <span m="2501150">512</span> <span m="2501480">is</span> <span m="2501650">cheap.</span> <span m="2501960">You just</span> <span m="2502320">discard</span> <span m="2502680">the</span> <span m="2502840">zeros</span> <span m="2503020">on the</span> <span m="2503120">right-hand</span> <span m="2503490">side.</span> <span m="2504337">And</span> <span m="2504804">that's</span> <span m="2505271">actually the</span> <span m="2505738">correct division.</span> <span m="2507140">Does that</span> <span m="2507370">make</span> <span m="2507440">sense?</span> </p>
<p><span m="2508650">The</span> <span m="2508800">slight</span> <span m="2509030">problem</span> <span m="2509330">is</span> <span m="2509440">that</span> <span m="2509860">we actually</span> <span m="2510311">don't have</span> <span m="2510762">zeros</span> <span m="2511213">on</span> <span m="2511303">the</span> <span m="2511393">right</span> <span m="2511483">hand</span> <span m="2511573">side</span> <span m="2511664">when you</span> <span m="2512115">do this</span> <span m="2512566">multiplication.</span> <span m="2513110">These are</span> <span m="2513570">like</span> <span m="2514320">real</span> <span m="2515010">512</span> <span m="2515450">bit numbers</span> <span m="2515920">with</span> <span m="2516080">all the</span> <span m="2516160">512</span> <span m="2516455">bits</span> <span m="2516750">used.</span> <span m="2517460">So</span> <span m="2517800">this</span> <span m="2517930">will</span> <span m="2518090">be a</span> <span m="2518240">1,000</span> <span m="2518560">bit</span> <span m="2518700">number</span> <span m="2518890">[? or ?]</span> <span m="2519340">with</span> <span m="2519450">all</span> <span m="2519670">this</span> <span m="2519945">bits</span> <span m="2520220">also</span> <span m="2520890">set to</span> <span m="2521130">randomly</span> <span m="2521530">0</span> <span m="2521785">or</span> <span m="2522040">1,</span> <span m="2522360">depending on</span> <span m="2522520">what's</span> <span m="2522800">going on.</span> <span m="2523560">So</span> <span m="2523640">we</span> <span m="2523780">can't</span> <span m="2524080">just</span> <span m="2524230">discard</span> <span m="2524660">the</span> <span m="2524700">low</span> <span m="2524990">bits.</span> </p>
<p><span m="2526460">But</span> <span m="2526820">the</span> <span m="2527380">cleverness</span> <span m="2528040">comes</span> <span m="2528290">from</span> <span m="2528390">the</span> <span m="2528767">fact</span> <span m="2529144">that</span> <span m="2529900">the</span> <span m="2530070">only</span> <span m="2530370">thing</span> <span m="2530510">we</span> <span m="2530640">care</span> <span m="2530870">about</span> <span m="2531210">is the</span> <span m="2531290">value</span> <span m="2531650">of</span> <span m="2531750">this</span> <span m="2531860">thing</span> <span m="2532420">mod</span> <span m="2532870">p.</span> <span m="2534370">So</span> <span m="2534480">you</span> <span m="2534680">can always</span> <span m="2535080">add</span> <span m="2535550">multiples</span> <span m="2536070">of</span> <span m="2536355">p</span> <span m="2536640">to</span> <span m="2537310">this</span> <span m="2537880">value</span> <span m="2538610">without</span> <span m="2539010">changing</span> <span m="2539680">it</span> <span m="2539930">when</span> <span m="2540180">it's</span> <span m="2540300">equivalent</span> <span m="2540670">to</span> <span m="2540790">mod p.</span> <span m="2542380">And</span> <span m="2542560">as a result,</span> <span m="2542750">we</span> <span m="2543160">can</span> <span m="2543450">add</span> <span m="2543740">multiples</span> <span m="2544250">of</span> <span m="2544420">p</span> <span m="2545130">to</span> <span m="2545450">get</span> <span m="2545770">the</span> <span m="2545940">low</span> <span m="2546190">bits</span> <span m="2546270">to</span> <span m="2546390">all</span> <span m="2546580">be</span> <span m="2546915">zeros.</span> </p>
<p><span m="2548020">So let's look through</span> <span m="2549010">some</span> <span m="2549530">simple</span> <span m="2549990">examples.</span> <span m="2550510">I'm not</span> <span m="2550680">going to</span> <span m="2551090">write</span> <span m="2551300">out</span> <span m="2551560">512</span> <span m="2551870">bits</span> <span m="2552280">on</span> <span m="2552350">the</span> <span m="2552420">board.</span> <span m="2553390">But</span> <span m="2554030">suppose</span> <span m="2554460">that--</span> <span m="2555409">here's</span> <span m="2556367">a</span> <span m="2556846">short example.</span> <span m="2560200">Suppose</span> <span m="2560590">that we</span> <span m="2560680">have</span> <span m="2560900">a</span> <span m="2561460">situation</span> <span m="2562090">where</span> <span m="2562710">our</span> <span m="2562940">value</span> <span m="2563380">R</span> <span m="2564310">is</span> <span m="2565030">2</span> <span m="2565310">to the</span> <span m="2565480">4th.</span> <span m="2566340">So</span> <span m="2566540">it's</span> <span m="2567090">1</span> <span m="2568080">followed</span> <span m="2568365">by</span> <span m="2568650">four</span> <span m="2569330">zeros.</span> <span m="2569810">So this is</span> <span m="2570030">a</span> <span m="2570440">much</span> <span m="2570630">smaller</span> <span m="2571030">example</span> <span m="2571640">than</span> <span m="2572135">the</span> <span m="2572630">real</span> <span m="2572690">thing.</span> <span m="2573170">But let's</span> <span m="2573390">see</span> <span m="2573735">how</span> <span m="2574080">this</span> <span m="2574310">Montgomery</span> <span m="2574725">division</span> <span m="2575140">is going</span> <span m="2575270">to work</span> <span m="2575580">out.</span> <span m="2577170">So suppose</span> <span m="2577410">we're</span> <span m="2577910">going</span> <span m="2578000">to</span> <span m="2578400">try</span> <span m="2578730">to</span> <span m="2579520">compute</span> <span m="2579990">stuff</span> <span m="2580520">mod</span> <span m="2580910">q,</span> <span m="2582170">where</span> <span m="2582600">q,</span> <span m="2583240">let's</span> <span m="2583500">say,</span> <span m="2583840">is maybe</span> <span m="2584340">7.</span> <span m="2585570">So this is</span> <span m="2585970">1</span> <span m="2587000">1</span> <span m="2587330">1</span> <span m="2587990">in</span> <span m="2588130">binary</span> <span m="2588700">form.</span> <span m="2590000">And</span> <span m="2590620">what</span> <span m="2591010">we're</span> <span m="2591220">going</span> <span m="2591330">to</span> <span m="2591420">try</span> <span m="2591590">to</span> <span m="2591730">do</span> <span m="2592970">is</span> <span m="2594220">maybe</span> <span m="2594610">we did</span> <span m="2594970">some</span> <span m="2595050">multiplication.</span> <span m="2596360">And</span> <span m="2596840">this</span> <span m="2597060">value</span> <span m="2597360">aR</span> <span m="2597780">times</span> <span m="2598010">bR</span> <span m="2599040">is</span> <span m="2599210">equal</span> <span m="2599700">to</span> <span m="2601380">this</span> <span m="2601600">binary</span> <span m="2602140">presentation</span> <span m="2603160">1</span> <span m="2603598">1</span> <span m="2604036">0</span> <span m="2604912">1</span> <span m="2605350">0.</span> <span m="2606520">So</span> <span m="2606680">this</span> <span m="2606810">is</span> <span m="2606980">going</span> <span m="2607110">to</span> <span m="2607170">be</span> <span m="2608080">the</span> <span m="2608190">value</span> <span m="2608570">of</span> <span m="2608760">aR</span> <span m="2609320">times</span> <span m="2609750">bR.</span> </p>
<p><span m="2611060">How do</span> <span m="2611420">we divide</span> <span m="2611730">it by</span> <span m="2611910">R?</span> <span m="2612780">So</span> <span m="2612930">clearly</span> <span m="2613350">the</span> <span m="2613460">low</span> <span m="2613840">four</span> <span m="2614100">bits</span> <span m="2614360">aren't</span> <span m="2614670">all</span> <span m="2614860">0,</span> <span m="2615175">so</span> <span m="2615490">we</span> <span m="2615600">can't</span> <span m="2615990">just divide</span> <span m="2616370">it out.</span> <span m="2617472">But</span> <span m="2617830">we can</span> <span m="2617870">add</span> <span m="2618500">multiples</span> <span m="2619010">of</span> <span m="2619160">q.</span> <span m="2620680">In</span> <span m="2620800">particular,</span> <span m="2621860">we</span> <span m="2622000">can</span> <span m="2622250">add</span> <span m="2623760">2</span> <span m="2624260">times</span> <span m="2624525">q.</span> <span m="2625510">So</span> <span m="2625910">2q</span> <span m="2626260">is</span> <span m="2626610">equal</span> <span m="2626915">to</span> <span m="2627220">1</span> <span m="2627593">1</span> <span m="2627966">1</span> <span m="2628340">0.</span> <span m="2629700">And</span> <span m="2629910">now</span> <span m="2630470">what</span> <span m="2630910">we</span> <span m="2631140">get</span> <span m="2631520">is</span> <span m="2632820">0</span> <span m="2634910">0,</span> <span m="2635330">carry</span> <span m="2635650">a</span> <span m="2635740">1,</span> <span m="2636240">0,</span> <span m="2636740">carry</span> <span m="2637240">a</span> <span m="2637740">1,</span> <span m="2638240">1,</span> <span m="2638740">carry</span> <span m="2639240">a</span> <span m="2639740">1,</span> <span m="2640740">0</span> <span m="2641000">1.</span> <span m="2641570">I hope</span> <span m="2641880">I did</span> <span m="2642070">that</span> <span m="2642170">right.</span> <span m="2642520">So this</span> <span m="2642990">is what</span> <span m="2643260">we get.</span> <span m="2643530">So now</span> <span m="2643730">we</span> <span m="2644150">get</span> <span m="2644710">aR</span> <span m="2645346">bR</span> <span m="2646180">plus</span> <span m="2646520">2</span> <span m="2646680">cubed.</span> <span m="2647720">But</span> <span m="2647880">we</span> <span m="2647980">actually</span> <span m="2648060">don't</span> <span m="2648270">care</span> <span m="2648500">about the</span> <span m="2648980">plus 2</span> <span m="2649100">cubed.</span> <span m="2649290">It's actually</span> <span m="2649540">fine</span> <span m="2649830">because</span> <span m="2650155">all</span> <span m="2650480">we</span> <span m="2650580">care</span> <span m="2650770">about</span> <span m="2651040">is the</span> <span m="2651100">value</span> <span m="2651400">of</span> <span m="2651690">mod q.</span> </p>
<p><span m="2655190">And</span> <span m="2655600">now</span> <span m="2655670">we're</span> <span m="2655910">closer,</span> <span m="2656460">we</span> <span m="2656550">have</span> <span m="2656790">three</span> <span m="2656890">0</span> <span m="2657020">bits</span> <span m="2657380">at the</span> <span m="2657830">bottom.</span> <span m="2658070">Now</span> <span m="2658155">we</span> <span m="2658240">can</span> <span m="2658325">add</span> <span m="2658870">another</span> <span m="2659220">multiple</span> <span m="2659780">of</span> <span m="2659920">q.</span> <span m="2660190">This time</span> <span m="2660520">it's going</span> <span m="2660630">to</span> <span m="2660760">be</span> <span m="2661240">probably</span> <span m="2661790">8q.</span> <span m="2663000">So</span> <span m="2663390">we</span> <span m="2663550">add</span> <span m="2663820">1 1</span> <span m="2664285">1</span> <span m="2664750">here</span> <span m="2665765">0</span> <span m="2666080">0.</span> <span m="2666680">And if</span> <span m="2667123">we</span> <span m="2667566">add it,</span> <span m="2668010">we're</span> <span m="2668170">going</span> <span m="2668300">to</span> <span m="2668380">get,</span> <span m="2669460">let's</span> <span m="2669640">say,</span> <span m="2669905">0</span> <span m="2670170">0</span> <span m="2670666">0</span> <span m="2671162">then</span> <span m="2671658">add these</span> <span m="2672154">two guys</span> <span m="2672650">0,</span> <span m="2673150">carry</span> <span m="2673450">a</span> <span m="2673750">1,</span> <span m="2674620">0,</span> <span m="2674935">carry</span> <span m="2675250">a</span> <span m="2675590">1,</span> <span m="2676000">1</span> <span m="2676340">1.</span> <span m="2677120">I</span> <span m="2677200">think</span> <span m="2677340">that's</span> <span m="2677550">right.</span> <span m="2678250">But</span> <span m="2678700">now</span> <span m="2679060">we</span> <span m="2679210">have</span> <span m="2679910">our</span> <span m="2680230">original</span> <span m="2680610">aR</span> <span m="2680770">bR</span> <span m="2681390">plus</span> <span m="2681810">2q</span> <span m="2682000">plus</span> <span m="2682380">8q</span> <span m="2682770">is</span> <span m="2683200">equal to</span> <span m="2683657">this thing.</span> <span m="2685030">And</span> <span m="2685280">finally,</span> <span m="2685420">we can</span> <span m="2685820">divide</span> <span m="2686080">this</span> <span m="2686240">thing</span> <span m="2686470">by</span> <span m="2687150">R</span> <span m="2687680">very</span> <span m="2687900">cheaply.</span> <span m="2688720">Because</span> <span m="2689060">we</span> <span m="2689180">just</span> <span m="2689740">discard</span> <span m="2691210">the</span> <span m="2691350">low</span> <span m="2692440">four</span> <span m="2693060">zeros.</span> <span m="2694762">Make</span> <span m="2695243">sense?</span> <span m="2696205">Question.</span> </p>
<p><span m="2697167">AUDIENCE: Is aR</span> <span m="2697648">bR</span> <span m="2698129">always</span> <span m="2698610">going</span> <span m="2699091">to end</span> <span m="2699572">in,</span> <span m="2700060">I</span> <span m="2700410">guess,</span> <span m="2701150">1,024</span> <span m="2701800">zeros?</span> </p>
<p><span m="2703270">PROFESSOR: No,</span> <span m="2703760">and</span> <span m="2704250">the</span> <span m="2704540">reason</span> <span m="2704830">is</span> <span m="2705050">that--</span> <span m="2707600">OK,</span> <span m="2708021">here</span> <span m="2708442">is the</span> <span m="2708863">thing that's</span> <span m="2709284">maybe</span> <span m="2709705">confusing.</span> <span m="2710130">A</span> <span m="2710520">was,</span> <span m="2710910">let's say,</span> <span m="2711656">512</span> <span m="2712030">bits.</span> <span m="2712710">Then</span> <span m="2712960">you</span> <span m="2713350">multiply</span> <span m="2713770">it by</span> <span m="2713940">R.</span> <span m="2714315">So here,</span> <span m="2714690">you're</span> <span m="2714970">right.</span> <span m="2715470">This</span> <span m="2715970">value is</span> <span m="2716380">that</span> <span m="2716660">1,000</span> <span m="2717140">bit</span> <span m="2717300">number</span> <span m="2717750">where</span> <span m="2718310">the</span> <span m="2718370">high</span> <span m="2718620">bit</span> <span m="2718910">is</span> <span m="2719380">a,</span> <span m="2719660">the</span> <span m="2719870">high</span> <span m="2720450">512</span> <span m="2720570">bits</span> <span m="2720740">are a.</span> <span m="2720980">And the</span> <span m="2721050">low</span> <span m="2721240">bits</span> <span m="2721510">are</span> <span m="2722070">all</span> <span m="2722390">zeros.</span> <span m="2723180">But</span> <span m="2723320">then,</span> <span m="2723780">you're</span> <span m="2723900">going</span> <span m="2724010">[? to do it with ?]</span> <span m="2724360">mod</span> <span m="2724710">q</span> <span m="2725100">to</span> <span m="2725450">bring</span> <span m="2725750">it down</span> <span m="2726010">to</span> <span m="2726140">make</span> <span m="2726300">it</span> <span m="2726670">smaller.</span> <span m="2727410">And</span> <span m="2727930">in</span> <span m="2728120">general,</span> <span m="2728620">this is</span> <span m="2729095">going</span> <span m="2729190">to</span> <span m="2729285">be</span> <span m="2729380">the</span> <span m="2729475">case.</span> <span m="2729570">Because</span> <span m="2730045">[? it only ?]</span> <span m="2730520">has</span> <span m="2730995">these low</span> <span m="2731470">zeros</span> <span m="2731945">the</span> <span m="2732420">first time</span> <span m="2732895">you convert it.</span> <span m="2733370">But after</span> <span m="2733845">you do</span> <span m="2734320">a couple multiplications,</span> <span m="2734795">they're</span> <span m="2735270">going to be</span> <span m="2735750">arbitrary</span> <span m="2736390">bits.</span> <span m="2737685">So</span> <span m="2738050">these</span> <span m="2738310">guys</span> <span m="2738660">are--</span> <span m="2738800">so</span> <span m="2739550">I</span> <span m="2739820">really</span> <span m="2740120">should have</span> <span m="2740420">written</span> <span m="2740700">mod</span> <span m="2740980">q</span> <span m="2741470">here--</span> <span m="2741820">and to</span> <span m="2742300">compute</span> <span m="2742780">this mod q</span> <span m="2743260">as soon</span> <span m="2743740">as you do</span> <span m="2744060">the</span> <span m="2744290">conversion</span> <span m="2744870">to</span> <span m="2745070">keep</span> <span m="2745500">the</span> <span m="2745982">whole value</span> <span m="2746464">small.</span> </p>
<p><span m="2749356">AUDIENCE:</span> <span m="2749838">[INAUDIBLE]</span> </p>
<p><span m="2750802">PROFESSOR: Yeah,</span> <span m="2751284">so</span> <span m="2751766">the</span> <span m="2752248">initial</span> <span m="2752730">conversion</span> <span m="2752890">is expensive</span> <span m="2753460">or</span> <span m="2753874">at least</span> <span m="2754288">it's</span> <span m="2754702">as</span> <span m="2755116">expensive</span> <span m="2755530">as doing</span> <span m="2756030">a</span> <span m="2756380">regular</span> <span m="2757530">modulus</span> <span m="2758650">during</span> <span m="2758970">the</span> <span m="2759800">multiplication.</span> <span m="2761010">The</span> <span m="2761340">cool thing</span> <span m="2761460">is</span> <span m="2761755">that</span> <span m="2762050">you pay</span> <span m="2762270">this cost</span> <span m="2763180">just</span> <span m="2763460">once</span> <span m="2763770">when you</span> <span m="2763940">do</span> <span m="2764130">the conversion</span> <span m="2764230">into</span> <span m="2764703">Montgomery</span> <span m="2765176">form.</span> <span m="2766122">And</span> <span m="2766595">then,</span> <span m="2767068">instead of</span> <span m="2767541">converting it</span> <span m="2768014">back</span> <span m="2768487">at every</span> <span m="2768960">step,</span> <span m="2769240">you just</span> <span m="2769550">keep</span> <span m="2769820">it</span> <span m="2770010">in</span> <span m="2770285">Montgomery</span> <span m="2770560">form.</span> </p>
<p><span m="2771235">But</span> <span m="2771510">remember</span> <span m="2771890">that</span> <span m="2772050">in order</span> <span m="2772380">to do an</span> <span m="2772710">exponentiation</span> <span m="2773700">to</span> <span m="2774310">an</span> <span m="2774585">exponent</span> <span m="2774860">which</span> <span m="2775010">has</span> <span m="2775520">512</span> <span m="2775820">bits,</span> <span m="2776270">you're</span> <span m="2776670">saying</span> <span m="2776920">you're</span> <span m="2777070">going</span> <span m="2777180">to</span> <span m="2777220">have</span> <span m="2777480">to do</span> <span m="2778590">over</span> <span m="2778890">500</span> <span m="2779570">multiplications</span> <span m="2779995">because</span> <span m="2780420">we</span> <span m="2780900">have to</span> <span m="2781100">do at least</span> <span m="2781320">500</span> <span m="2781750">squarings</span> <span m="2782165">plus</span> <span m="2782730">then</span> <span m="2783110">some.</span> <span m="2783870">So</span> <span m="2784480">you</span> <span m="2784990">do</span> <span m="2785310">these</span> <span m="2785635">mod q</span> <span m="2785960">twice</span> <span m="2786630">and</span> <span m="2786780">then</span> <span m="2787000">you get</span> <span m="2787453">a lot of</span> <span m="2787906">cheap</span> <span m="2788360">divisions</span> <span m="2788640">if</span> <span m="2788920">you</span> <span m="2789040">stay</span> <span m="2789430">in</span> <span m="2789760">this</span> <span m="2790090">form.</span> <span m="2790370">And</span> <span m="2790530">then you</span> <span m="2790820">do</span> <span m="2791110">a</span> <span m="2791330">division by</span> <span m="2791820">R</span> <span m="2792110">to get</span> <span m="2792520">back to</span> <span m="2792720">this</span> <span m="2792990">form</span> <span m="2793520">again.</span> <span m="2794500">So</span> <span m="2794520">instead</span> <span m="2794630">of</span> <span m="2794740">doing</span> <span m="2794840">500</span> <span m="2795450">mod</span> <span m="2795650">qs</span> <span m="2796205">for</span> <span m="2796640">every</span> <span m="2796940">multiplication</span> <span m="2797230">step,</span> <span m="2797520">you</span> <span m="2797805">do</span> <span m="2798090">it</span> <span m="2798480">twice</span> <span m="2798890">mod q.</span> <span m="2799366">And</span> <span m="2799842">then you keep</span> <span m="2800318">doing</span> <span m="2800794">these</span> <span m="2801270">divisions by</span> <span m="2801750">R</span> <span m="2802160">cheaply</span> <span m="2803090">using</span> <span m="2803350">this</span> <span m="2803640">trick.</span> <span m="2805095">Question.</span> </p>
<p><span m="2805580">AUDIENCE:</span> <span m="2806550">So</span> <span m="2807035">when you're</span> <span m="2807520">adding</span> <span m="2808005">the</span> <span m="2808490">multiples</span> <span m="2808975">of q</span> <span m="2809460">and then</span> <span m="2809945">dividing by</span> <span m="2810430">R,</span> <span m="2810915">[INAUDIBLE]</span> </p>
<p><span m="2814310">PROFESSOR: Because</span> <span m="2815290">it's</span> <span m="2815595">actually</span> <span m="2815900">mod</span> <span m="2816280">q</span> <span m="2816600">means</span> <span m="2816780">the</span> <span m="2816870">remainder</span> <span m="2817460">when</span> <span m="2817500">you</span> <span m="2817580">divide</span> <span m="2818030">by</span> <span m="2818170">q.</span> <span m="2818920">So</span> <span m="2820300">x</span> <span m="2820940">plus</span> <span m="2822080">y</span> <span m="2822520">times</span> <span m="2822940">q,</span> <span m="2823860">mod</span> <span m="2824180">q</span> <span m="2826110">is</span> <span m="2826580">just</span> <span m="2827050">x.</span> </p>
<p><span m="2827990">AUDIENCE:</span> <span m="2828460">[INAUDIBLE]</span> </p>
<p><span m="2832230">PROFESSOR: So</span> <span m="2832380">in</span> <span m="2832530">this</span> <span m="2832760">case,</span> <span m="2834080">dividing</span> <span m="2834650">by--</span> <span m="2835070">so</span> <span m="2835710">another</span> <span m="2836030">sort</span> <span m="2836200">of</span> <span m="2836270">nice</span> <span m="2836540">property</span> <span m="2836970">is that</span> <span m="2837130">because</span> <span m="2837410">it's</span> <span m="2837630">all</span> <span m="2837910">modulus</span> <span m="2838930">at</span> <span m="2839050">prime</span> <span m="2839480">number--</span> <span m="2841070">it's</span> <span m="2841530">also</span> <span m="2841990">true</span> <span m="2842450">that if</span> <span m="2842910">you have</span> <span m="2843370">x</span> <span m="2844290">plus</span> <span m="2845010">yq</span> <span m="2846200">divided</span> <span m="2846680">by</span> <span m="2846880">R,</span> <span m="2848080">mod</span> <span m="2848210">q</span> <span m="2849710">is actually</span> <span m="2850040">the</span> <span m="2850150">same</span> <span m="2850400">as</span> <span m="2850710">x</span> <span m="2850970">divided</span> <span m="2851320">by</span> <span m="2851440">R</span> <span m="2852820">mod q.</span> <span m="2855790">The</span> <span m="2855990">way</span> <span m="2856110">to</span> <span m="2856480">think</span> <span m="2856710">of</span> <span m="2856920">it</span> <span m="2857090">is that</span> <span m="2857500">there's</span> <span m="2857840">no real</span> <span m="2858180">division</span> <span m="2859180">in</span> <span m="2859550">modular</span> <span m="2860020">arithmetic.</span> <span m="2860650">It's</span> <span m="2860850">just</span> <span m="2861020">an</span> <span m="2861240">inverse.</span> <span m="2861730">So</span> <span m="2862150">what</span> <span m="2862330">this</span> <span m="2862720">really says</span> <span m="2863166">is this</span> <span m="2863612">is actually</span> <span m="2864060">x</span> <span m="2864450">plus</span> <span m="2864740">yq</span> <span m="2866450">times</span> <span m="2867210">some</span> <span m="2867670">number</span> <span m="2867945">called</span> <span m="2868220">R</span> <span m="2868450">inverse.</span> <span m="2869465">And then</span> <span m="2869750">you compute</span> <span m="2870070">this</span> <span m="2870220">whole</span> <span m="2870460">thing</span> <span m="2871120">mod</span> <span m="2871470">q.</span> <span m="2872930">And</span> <span m="2873150">then</span> <span m="2873430">you</span> <span m="2873500">could</span> <span m="2873730">think</span> <span m="2873990">of</span> <span m="2874100">this as</span> <span m="2875040">x</span> <span m="2875390">times</span> <span m="2875740">R</span> <span m="2875960">inverse</span> <span m="2877210">mod</span> <span m="2877570">q</span> <span m="2879470">plus</span> <span m="2881310">y</span> <span m="2881790">[? u ?]</span> <span m="2882620">R</span> <span m="2882910">inverse</span> <span m="2883930">mod</span> <span m="2884330">q.</span> <span m="2885320">And</span> <span m="2885740">this</span> <span m="2886160">thing</span> <span m="2886540">cancels out</span> <span m="2886880">because</span> <span m="2887220">it's</span> <span m="2887380">something</span> <span m="2887820">times</span> <span m="2888140">q.</span> </p>
<p><span m="2895060">And</span> <span m="2895640">there's</span> <span m="2895930">some</span> <span m="2896190">closed</span> <span m="2896840">form</span> <span m="2897120">for</span> <span m="2897400">this thing.</span> <span m="2897856">So</span> <span m="2898312">here I</span> <span m="2898768">did it</span> <span m="2899224">by bit</span> <span m="2899680">by</span> <span m="2899940">bit,</span> <span m="2900310">2q</span> <span m="2900840">then</span> <span m="2901160">8q,</span> <span m="2901710">et cetera.</span> <span m="2902195">It's</span> <span m="2902680">actually a</span> <span m="2902920">nice</span> <span m="2903100">closed</span> <span m="2903500">formula</span> <span m="2903765">you</span> <span m="2904030">can</span> <span m="2904280">compute--</span> <span m="2905080">it's in</span> <span m="2905190">the lecture</span> <span m="2905540">notes,</span> <span m="2905890">but</span> <span m="2906330">it's</span> <span m="2906770">probably</span> <span m="2906920">not worth</span> <span m="2907260">spending</span> <span m="2907480">time on</span> <span m="2907520">the board</span> <span m="2907880">here--</span> <span m="2908440">for</span> <span m="2908870">how</span> <span m="2909050">do you</span> <span m="2909180">figure</span> <span m="2909500">out</span> <span m="2909920">what</span> <span m="2910200">multiple</span> <span m="2910500">of</span> <span m="2910800">q</span> <span m="2911215">should you</span> <span m="2911650">add</span> <span m="2912280">to</span> <span m="2912430">get</span> <span m="2912710">all the</span> <span m="2912730">low</span> <span m="2913240">bits</span> <span m="2913630">to</span> <span m="2913990">turn</span> <span m="2914437">to</span> <span m="2914884">0.</span> <span m="2915331">So</span> <span m="2915780">then</span> <span m="2916070">it turns</span> <span m="2916280">out that</span> <span m="2916470">in</span> <span m="2916640">order</span> <span m="2916760">to</span> <span m="2916890">do</span> <span m="2917060">this</span> <span m="2917375">division</span> <span m="2917690">by</span> <span m="2917890">R,</span> <span m="2918200">you</span> <span m="2918510">just</span> <span m="2918918">need</span> <span m="2919326">to compute</span> <span m="2920142">this</span> <span m="2920550">magic</span> <span m="2921250">multiple</span> <span m="2921600">of q,</span> <span m="2922230">add</span> <span m="2922636">it.</span> <span m="2923450">And</span> <span m="2923610">then</span> <span m="2924310">discard</span> <span m="2924673">the low bits</span> <span m="2925720">and</span> <span m="2926160">that brings</span> <span m="2926420">your</span> <span m="2926540">number</span> <span m="2926860">back</span> <span m="2927280">to</span> <span m="2927720">512</span> <span m="2928145">bits,</span> <span m="2929030">or</span> <span m="2929210">whatever</span> <span m="2929610">the</span> <span m="2930101">size</span> <span m="2930592">is.</span> </p>
<p><span m="2933047">OK.</span> <span m="2934029">And</span> <span m="2934520">here's</span> <span m="2935020">the</span> <span m="2935410">subtlety.</span> <span m="2935790">The</span> <span m="2936180">only</span> <span m="2936490">reason</span> <span m="2936710">we're</span> <span m="2936840">talking</span> <span m="2937100">about</span> <span m="2937330">this</span> <span m="2937470">is</span> <span m="2937630">that</span> <span m="2938400">there's</span> <span m="2938700">something</span> <span m="2939280">funny</span> <span m="2939520">going</span> <span m="2939770">on</span> <span m="2939910">here</span> <span m="2940470">that</span> <span m="2940760">is</span> <span m="2941100">going to</span> <span m="2941440">allow</span> <span m="2941510">us</span> <span m="2942090">to</span> <span m="2943670">learn</span> <span m="2944080">timing</span> <span m="2944470">information.</span> <span m="2945090">And</span> <span m="2945340">in</span> <span m="2945440">particular,</span> <span m="2946750">even</span> <span m="2947090">though</span> <span m="2947540">we</span> <span m="2947660">divided</span> <span m="2948120">by</span> <span m="2948350">R,</span> <span m="2949780">we</span> <span m="2949910">know</span> <span m="2950100">the</span> <span m="2950240">result</span> <span m="2950660">is</span> <span m="2950760">going to</span> <span m="2951070">be</span> <span m="2951260">512</span> <span m="2951637">bits.</span> <span m="2952770">But</span> <span m="2953080">it still</span> <span m="2953350">might</span> <span m="2953570">be</span> <span m="2953690">greater</span> <span m="2954150">than</span> <span m="2954370">q</span> <span m="2955123">because</span> <span m="2955566">q</span> <span m="2956010">isn't</span> <span m="2956330">exactly</span> <span m="2956640">[? up to 512 ?],</span> <span m="2956820">it's not</span> <span m="2956940">a</span> <span m="2957330">512 bit</span> <span m="2957800">number.</span> <span m="2958340">So</span> <span m="2958580">it might</span> <span m="2958880">be a</span> <span m="2958900">little</span> <span m="2959090">bit</span> <span m="2959290">less</span> <span m="2959550">than</span> <span m="2960040">R.</span> <span m="2960840">So</span> <span m="2961490">it</span> <span m="2961640">might</span> <span m="2961930">be</span> <span m="2962030">that</span> <span m="2962230">after</span> <span m="2962670">we do</span> <span m="2962935">this</span> <span m="2963200">cheap</span> <span m="2963520">division</span> <span m="2963860">by</span> <span m="2964070">R,</span> <span m="2964730">[? the way ?]</span> <span m="2965105">we</span> <span m="2965480">subtract</span> <span m="2965780">out</span> <span m="2966000">q</span> <span m="2966375">one</span> <span m="2966750">more</span> <span m="2966960">time</span> <span m="2967240">because</span> <span m="2967510">we</span> <span m="2967650">get</span> <span m="2967880">something</span> <span m="2968320">that's small</span> <span m="2969300">but</span> <span m="2969470">not</span> <span m="2969690">quite</span> <span m="2969950">small</span> <span m="2970220">enough.</span> </p>
<p><span m="2971400">So</span> <span m="2971870">there's</span> <span m="2972235">a chance</span> <span m="2972600">that after</span> <span m="2972940">doing</span> <span m="2973180">this</span> <span m="2973505">division,</span> <span m="2974740">we</span> <span m="2975005">maybe</span> <span m="2975270">have</span> <span m="2975430">to</span> <span m="2975530">also</span> <span m="2976520">subtract</span> <span m="2977210">q</span> <span m="2977420">again.</span> <span m="2979740">And</span> <span m="2979870">this</span> <span m="2980420">subtraction</span> <span m="2980900">is</span> <span m="2981380">going to be</span> <span m="2981805">part of</span> <span m="2982230">what</span> <span m="2982390">this</span> <span m="2982610">attack is</span> <span m="2982900">all</span> <span m="2983060">about.</span> <span m="2984250">It</span> <span m="2984380">turns</span> <span m="2984630">out</span> <span m="2984910">that</span> <span m="2985110">subtracting</span> <span m="2985460">this</span> <span m="2985810">q</span> <span m="2986440">adds</span> <span m="2987253">time.</span> <span m="2988060">And</span> <span m="2988810">someone</span> <span m="2989750">figured</span> <span m="2990040">out--</span> <span m="2990850">not</span> <span m="2991080">these</span> <span m="2991280">guys</span> <span m="2991660">but some</span> <span m="2991980">previous</span> <span m="2992120">work--</span> <span m="2992310">that</span> <span m="2992910">you</span> <span m="2993050">show</span> <span m="2993390">that this</span> <span m="2993730">probability</span> <span m="2995420">of</span> <span m="2995630">doing</span> <span m="2995880">this</span> <span m="2996310">thing,</span> <span m="2996700">this</span> <span m="2997020">is called</span> <span m="2997310">an</span> <span m="2997600">extractor</span> <span m="2997740">reduction.</span> <span m="3003500">This</span> <span m="3003770">probability</span> <span m="3006260">sort</span> <span m="3006390">of</span> <span m="3006530">depends</span> <span m="3007110">on</span> <span m="3007820">the</span> <span m="3008010">particular</span> <span m="3009070">value</span> <span m="3010020">that</span> <span m="3010560">you're</span> <span m="3010930">exponentiating.</span> <span m="3012410">So</span> <span m="3012990">if</span> <span m="3013230">you're</span> <span m="3013630">computing</span> <span m="3014570">x</span> <span m="3015045">to</span> <span m="3015520">the</span> <span m="3015995">d</span> <span m="3017420">mod</span> <span m="3017860">q,</span> <span m="3019790">the</span> <span m="3019900">probability</span> <span m="3020550">of</span> <span m="3020710">an</span> <span m="3020965">extra</span> <span m="3021220">reduction,</span> <span m="3022400">at</span> <span m="3022560">some</span> <span m="3022820">point</span> <span m="3023160">while</span> <span m="3023480">computing</span> <span m="3023870">x to the</span> <span m="3024260">d</span> <span m="3024400">mod</span> <span m="3024730">q,</span> <span m="3025240">is</span> <span m="3025360">going</span> <span m="3025460">to</span> <span m="3025520">be</span> <span m="3025980">equal</span> <span m="3026440">to</span> <span m="3027460">x</span> <span m="3027845">mod</span> <span m="3028230">q</span> <span m="3030230">divided</span> <span m="3030800">by</span> <span m="3031610">2R.</span> </p>
<p><span m="3036890">So</span> <span m="3037410">if</span> <span m="3037880">we're</span> <span m="3038350">going to</span> <span m="3038520">be computing</span> <span m="3038640">x</span> <span m="3039410">to the</span> <span m="3039700">mod</span> <span m="3039780">q,</span> <span m="3040390">then</span> <span m="3041040">depending</span> <span m="3041507">on</span> <span m="3041974">what the</span> <span m="3042441">value</span> <span m="3042910">of</span> <span m="3043430">x mod q</span> <span m="3043690">is,</span> <span m="3044230">whether</span> <span m="3044520">it's big</span> <span m="3044760">or</span> <span m="3044850">small,</span> <span m="3045130">you're</span> <span m="3045410">going</span> <span m="3045620">to have</span> <span m="3045920">even</span> <span m="3046000">more</span> <span m="3046410">or</span> <span m="3046620">less</span> <span m="3046890">of</span> <span m="3046970">these</span> <span m="3047190">extra</span> <span m="3047440">reductions.</span> <span m="3049080">And</span> <span m="3049430">just</span> <span m="3049780">to</span> <span m="3050150">show</span> <span m="3050450">you</span> <span m="3050850">where this</span> <span m="3050880">is going</span> <span m="3051100">to fit</span> <span m="3051400">in,</span> <span m="3051877">this is</span> <span m="3052354">actually going</span> <span m="3052831">to happen</span> <span m="3053308">in the decrypt step,</span> <span m="3053785">because</span> <span m="3054262">during the decrypt step,</span> <span m="3054739">the</span> <span m="3054835">server</span> <span m="3054931">is</span> <span m="3055027">going</span> <span m="3055123">to</span> <span m="3055220">be computing</span> <span m="3055645">c to</span> <span m="3056070">the d.</span> <span m="3057330">And</span> <span m="3058560">this</span> <span m="3058880">says</span> <span m="3059300">the</span> <span m="3059740">extractor</span> <span m="3060195">reductions</span> <span m="3060650">are going</span> <span m="3061050">to be</span> <span m="3061540">proportional</span> <span m="3061760">to how</span> <span m="3062120">close</span> <span m="3062900">x,</span> <span m="3063760">or</span> <span m="3063930">c</span> <span m="3064250">in</span> <span m="3064340">this</span> <span m="3064580">case,</span> <span m="3065160">is</span> <span m="3065590">to</span> <span m="3066020">the</span> <span m="3066450">value</span> <span m="3066880">q.</span> </p>
<p><span m="3067740">So this</span> <span m="3068100">is going</span> <span m="3068290">to be</span> <span m="3068670">worrisome,</span> <span m="3068730">right,</span> <span m="3068920">because</span> <span m="3069540">the</span> <span m="3069770">attacker</span> <span m="3070000">gets</span> <span m="3070100">to choose</span> <span m="3070570">the</span> <span m="3070865">input</span> <span m="3071160">c.</span> <span m="3072490">And</span> <span m="3073430">the</span> <span m="3073570">number</span> <span m="3073880">of extractor</span> <span m="3074190">reductions</span> <span m="3074640">is</span> <span m="3074707">going</span> <span m="3074775">to</span> <span m="3074842">be</span> <span m="3074910">proportional</span> <span m="3075510">to how</span> <span m="3075785">close</span> <span m="3076060">the</span> <span m="3076120">c</span> <span m="3076470">is</span> <span m="3076940">to</span> <span m="3076990">one</span> <span m="3077290">of</span> <span m="3077390">the factors,</span> <span m="3077850">the</span> <span m="3078227">q.</span> <span m="3078981">And</span> <span m="3079360">this is</span> <span m="3079530">how</span> <span m="3079780">you're going</span> <span m="3079950">to tell</span> <span m="3080440">I'm</span> <span m="3080700">getting</span> <span m="3080910">close</span> <span m="3081260">to</span> <span m="3081350">the</span> <span m="3081440">q,</span> <span m="3081730">or</span> <span m="3081995">I've</span> <span m="3082260">overshot</span> <span m="3082810">q.</span> <span m="3083390">And</span> <span m="3083685">all</span> <span m="3083980">of a</span> <span m="3084430">sudden,</span> <span m="3084670">there's no</span> <span m="3084820">extractor</span> <span m="3085230">reductions,</span> <span m="3085545">it's</span> <span m="3085860">probably</span> <span m="3086170">because</span> <span m="3086430">x</span> <span m="3086450">mod q</span> <span m="3086930">is very</span> <span m="3087110">small</span> <span m="3087440">the</span> <span m="3087980">x</span> <span m="3088380">is</span> <span m="3088670">q</span> <span m="3088760">plus</span> <span m="3089116">little epsilon.</span> <span m="3089472">And</span> <span m="3089830">it's</span> <span m="3089980">very</span> <span m="3090140">small.</span> <span m="3091720">So that's</span> <span m="3092400">one</span> <span m="3092820">part</span> <span m="3093240">of</span> <span m="3093660">the</span> <span m="3094080">timing</span> <span m="3094500">attack</span> <span m="3094920">we're</span> <span m="3095007">going</span> <span m="3095095">to</span> <span m="3095182">be</span> <span m="3095270">looking at</span> <span m="3095450">in a second.</span> <span m="3098770">I</span> <span m="3099105">don't</span> <span m="3099440">have</span> <span m="3099600">any</span> <span m="3099720">proof</span> <span m="3099950">that</span> <span m="3100150">this</span> <span m="3100250">actually</span> <span m="3100710">true</span> <span m="3100800">[INAUDIBLE]</span> <span m="3102740">these</span> <span m="3102940">extractor</span> <span m="3103440">reductions</span> <span m="3103930">work</span> <span m="3104420">like this.</span> <span m="3104905">Yea,</span> <span m="3105390">question.</span> </p>
<p><span m="3105680">AUDIENCE: What</span> <span m="3105970">happens</span> <span m="3106425">if you don't</span> <span m="3106880">do this</span> <span m="3107335">extra</span> <span m="3107790">reduction?</span> </p>
<p><span m="3108700">PROFESSOR:</span> <span m="3109610">Oh,</span> <span m="3109960">what</span> <span m="3110120">happens</span> <span m="3110500">if</span> <span m="3110780">you don't</span> <span m="3111160">do</span> <span m="3111200">this extractor</span> <span m="3111455">reduction?</span> <span m="3115510">You</span> <span m="3115640">can</span> <span m="3115830">avoid</span> <span m="3116130">this</span> <span m="3116260">extra</span> <span m="3116690">reduction.</span> <span m="3117850">And</span> <span m="3117990">then</span> <span m="3118280">you</span> <span m="3118740">just</span> <span m="3119157">have</span> <span m="3119574">to</span> <span m="3119991">do</span> <span m="3120410">some</span> <span m="3120740">extra</span> <span m="3121070">probably</span> <span m="3121790">modular</span> <span m="3122120">reductions</span> <span m="3122550">later.</span> <span m="3123410">I</span> <span m="3123520">think</span> <span m="3123770">the</span> <span m="3124130">math</span> <span m="3124385">just</span> <span m="3124640">works</span> <span m="3124970">out</span> <span m="3125300">nicely</span> <span m="3125610">this</span> <span m="3126080">way</span> <span m="3126500">for the</span> <span m="3126920">Montgomery</span> <span m="3127320">form.</span> <span m="3128230">I</span> <span m="3128360">think</span> <span m="3128660">for many</span> <span m="3128925">of these things</span> <span m="3129190">it's</span> <span m="3129330">actually</span> <span m="3129750">once</span> <span m="3129896">you</span> <span m="3130043">look</span> <span m="3130190">at them</span> <span m="3130620">as</span> <span m="3130850">a</span> <span m="3131060">timing</span> <span m="3131240">channel</span> <span m="3131480">[INAUDIBLE]</span> <span m="3132500">[? think ?]</span> <span m="3132830">don't do</span> <span m="3133100">this</span> <span m="3133370">at all,</span> <span m="3133780">or</span> <span m="3134380">maybe</span> <span m="3134700">you</span> <span m="3135220">should do</span> <span m="3135360">some other</span> <span m="3135690">plan.</span> <span m="3136020">So</span> <span m="3136250">you're right,</span> </p>
<p><span m="3136670">I</span> <span m="3136730">think</span> <span m="3137010">you could</span> <span m="3137140">probably</span> <span m="3138010">avoid</span> <span m="3138340">this</span> <span m="3138480">extra</span> <span m="3138880">reduction</span> <span m="3139710">and</span> <span m="3140280">probably</span> <span m="3140400">just</span> <span m="3140500">do</span> <span m="3141070">the</span> <span m="3141380">mod</span> <span m="3141720">q,</span> <span m="3142150">perhaps</span> <span m="3142280">at</span> <span m="3142400">the end.</span> <span m="3142655">I haven't</span> <span m="3142910">actually</span> <span m="3143200">tried</span> <span m="3143490">implementing</span> <span m="3144160">this.</span> <span m="3144840">But</span> <span m="3145310">it</span> <span m="3145510">seems</span> <span m="3145840">like it</span> <span m="3146170">could work.</span> <span m="3147380">It</span> <span m="3147640">might</span> <span m="3147840">be</span> <span m="3147930">that you</span> <span m="3148100">just</span> <span m="3148192">have</span> <span m="3148284">to</span> <span m="3148376">do</span> <span m="3148468">mod</span> <span m="3148560">q</span> <span m="3149020">once</span> <span m="3149390">[? there ?],</span> <span m="3149660">which you'll</span> <span m="3150070">probably</span> <span m="3150480">have</span> <span m="3150582">to</span> <span m="3150685">do</span> <span m="3150787">anyway.</span> <span m="3151300">So it's</span> <span m="3151710">not</span> <span m="3152200">super clear.</span> <span m="3152820">Maybe</span> <span m="3153120">it's</span> <span m="3153480">[INAUDIBLE]</span> <span m="3156025">probably</span> <span m="3156460">not</span> <span m="3156895">q.</span> </p>
<p><span m="3157770">So</span> <span m="3158045">in</span> <span m="3158320">light</span> <span m="3158430">of the</span> <span m="3158901">fact</span> <span m="3159372">that</span> <span m="3159843">[INAUDIBLE].</span> <span m="3164553">Actually, I shouldn't</span> <span m="3165024">speak</span> <span m="3165495">authoritatively</span> <span m="3165966">to this.</span> <span m="3166440">I haven't tired implementing this.</span> <span m="3167000">So</span> <span m="3167120">maybe</span> <span m="3167290">there's</span> <span m="3167530">some</span> <span m="3167960">deep</span> <span m="3168210">reason</span> <span m="3168360">why this</span> <span m="3168780">extractor</span> <span m="3168872">reduction</span> <span m="3168964">has</span> <span m="3169056">to</span> <span m="3169148">happen.</span> <span m="3170184">I couldn't</span> <span m="3170656">think</span> <span m="3171128">of one.</span> <span m="3173490">All</span> <span m="3173830">right,</span> <span m="3174090">questions?</span> </p>
<p><span m="3177110">So</span> <span m="3177710">here's</span> <span m="3177920">the</span> <span m="3178010">last</span> <span m="3178430">piece</span> <span m="3178730">of</span> <span m="3179060">the</span> <span m="3179160">puzzle</span> <span m="3179680">for</span> <span m="3179810">how</span> <span m="3180195">OpenSSL,</span> <span m="3180995">this library</span> <span m="3181410">that</span> <span m="3182540">this</span> <span m="3182640">paper</span> <span m="3182970">attacks</span> <span m="3184370">implements</span> <span m="3186040">multiplication.</span> <span m="3187870">So</span> <span m="3188010">this</span> <span m="3188440">Montgomery</span> <span m="3188970">trick</span> <span m="3189710">is</span> <span m="3189900">great</span> <span m="3190400">for</span> <span m="3191120">avoiding</span> <span m="3191510">the</span> <span m="3191870">mod</span> <span m="3192270">q</span> <span m="3192630">part</span> <span m="3193490">during</span> <span m="3194590">modular</span> <span m="3194930">multiplication.</span> <span m="3195630">But</span> <span m="3195980">then</span> <span m="3196445">there's</span> <span m="3196910">a</span> <span m="3197140">question</span> <span m="3197340">of how</span> <span m="3197480">do you actually</span> <span m="3197770">multiply</span> <span m="3198060">two</span> <span m="3198280">numbers</span> <span m="3198690">together.</span> <span m="3198940">So we're</span> <span m="3199270">doing</span> <span m="3199940">lower</span> <span m="3200250">and</span> <span m="3200320">lower</span> <span m="3200600">level.</span> </p>
<p><span m="3201235">So</span> <span m="3201500">suppose</span> <span m="3201660">you</span> <span m="3201980">have</span> <span m="3204865">[? the raw ?]</span> <span m="3205328">multiplication.</span> <span m="3208710">So</span> <span m="3209080">this is not even</span> <span m="3209610">modular</span> <span m="3209990">multiplication.</span> <span m="3210370">You</span> <span m="3210540">have</span> <span m="3210760">two</span> <span m="3210890">numbers,</span> <span m="3211980">a</span> <span m="3212330">and</span> <span m="3212680">b.</span> <span m="3213475">And</span> <span m="3213920">both</span> <span m="3214130">these</span> <span m="3214340">guys</span> <span m="3215090">are</span> <span m="3216690">512</span> <span m="3216910">bit</span> <span m="3217080">numbers.</span> <span m="3218636">How do you</span> <span m="3219104">multiply</span> <span m="3219572">them</span> <span m="3220040">together</span> <span m="3220250">when</span> <span m="3220670">your</span> <span m="3220945">machine</span> <span m="3221220">is only a</span> <span m="3221650">32 bit</span> <span m="3222080">machine,</span> <span m="3222400">like</span> <span m="3222600">the guys</span> <span m="3222990">in the paper,</span> <span m="3223190">or</span> <span m="3223540">a</span> <span m="3223770">64</span> <span m="3224190">bit,</span> <span m="3224560">but still,</span> <span m="3224590">same</span> <span m="3225020">thing?</span> <span m="3226226">How</span> <span m="3226690">would</span> <span m="3227010">you</span> <span m="3227430">implement</span> <span m="3227695">multiplication</span> <span m="3227960">of</span> <span m="3228290">these</span> <span m="3228410">guys?</span> <span m="3233740">Any</span> <span m="3234221">suggestions?</span> </p>
<p><span m="3236640">Well</span> <span m="3236790">I</span> <span m="3237100">guess</span> <span m="3237280">it was a</span> <span m="3237420">straightforward</span> <span m="3237780">question,</span> <span m="3238200">you</span> <span m="3238480">just</span> <span m="3238650">represent</span> <span m="3239342">a</span> <span m="3239690">and</span> <span m="3240180">b</span> <span m="3240420">as</span> <span m="3240695">a</span> <span m="3240970">sequence</span> <span m="3241170">of</span> <span m="3241630">machine</span> <span m="3241860">[? words. ?]</span> <span m="3242830">And</span> <span m="3243110">then</span> <span m="3243470">you just do</span> <span m="3243610">this</span> <span m="3244200">quadratic</span> <span m="3244960">product</span> <span m="3245290">of</span> <span m="3245380">these</span> <span m="3245680">two</span> <span m="3246110">guys.</span> <span m="3246970">[INAUDIBLE]</span> <span m="3247240">see</span> <span m="3247510">a</span> <span m="3247630">simple</span> <span m="3247910">example,</span> <span m="3248620">instead of</span> <span m="3248790">thinking</span> <span m="3248960">of a</span> <span m="3249460">512</span> <span m="3249840">bit</span> <span m="3250200">number,</span> <span m="3250682">let's think</span> <span m="3251164">of these</span> <span m="3251646">guys as</span> <span m="3252128">64</span> <span m="3252610">bit</span> <span m="3253092">numbers</span> <span m="3253574">and we're</span> <span m="3254060">on a</span> <span m="3254260">32 bit</span> <span m="3254540">machine.</span> <span m="3255720">Right.</span> <span m="3256170">So we're</span> <span m="3256475">going to</span> <span m="3256780">have values.</span> <span m="3257900">The</span> <span m="3258050">value</span> <span m="3258300">of</span> <span m="3258380">a</span> <span m="3259080">is</span> <span m="3259200">going</span> <span m="3259320">to</span> <span m="3259360">be</span> <span m="3259480">represented</span> <span m="3260100">by</span> <span m="3260690">two</span> <span m="3260820">[? very ?]</span> <span m="3260910">different</span> <span m="3261400">things.</span> </p>
<p><span m="3261960">It's</span> <span m="3262290">going</span> <span m="3262410">to</span> <span m="3262480">be,</span> <span m="3263360">let's</span> <span m="3263540">call</span> <span m="3263790">it,</span> <span m="3264290">a1</span> <span m="3265505">and</span> <span m="3266130">a0.</span> <span m="3267550">So</span> <span m="3267650">a0</span> <span m="3267900">is</span> <span m="3268150">the low</span> <span m="3268550">bit,</span> <span m="3268750">a1</span> <span m="3269020">is</span> <span m="3269110">the</span> <span m="3269160">high bit.</span> <span m="3270380">And</span> <span m="3270480">similarly,</span> <span m="3270826">we're going</span> <span m="3271172">to represent</span> <span m="3271520">b</span> <span m="3272240">as</span> <span m="3272670">two</span> <span m="3272870">things,</span> <span m="3273270">b1</span> <span m="3274610">b0.</span> <span m="3276760">So</span> <span m="3276910">then</span> <span m="3277090">a naive</span> <span m="3277550">way</span> <span m="3277830">to</span> <span m="3277930">represent</span> <span m="3278220">a</span> <span m="3278510">b</span> <span m="3279640">is</span> <span m="3279760">going</span> <span m="3279880">to</span> <span m="3279940">be</span> <span m="3280560">to</span> <span m="3281610">multiply</span> <span m="3283570">all</span> <span m="3283740">these</span> <span m="3283890">guys out.</span> <span m="3284310">So it's</span> <span m="3284570">going to</span> <span m="3284910">be</span> <span m="3285250">a</span> <span m="3286240">three</span> <span m="3286550">cell</span> <span m="3286890">number.</span> <span m="3288020">The</span> <span m="3288300">high</span> <span m="3288680">bit</span> <span m="3288920">is</span> <span m="3289250">going</span> <span m="3289390">to</span> <span m="3289450">be</span> <span m="3290220">a1</span> <span m="3290800">b1.</span> <span m="3292140">The</span> <span m="3292220">low</span> <span m="3292530">bit</span> <span m="3292880">is going</span> <span m="3293370">to be</span> <span m="3293860">a0</span> <span m="3294670">b0.</span> <span m="3295560">And</span> <span m="3295680">the</span> <span m="3295760">middle</span> <span m="3296180">word</span> <span m="3296550">is going</span> <span m="3296680">to</span> <span m="3296740">be</span> <span m="3297460">a1</span> <span m="3298190">b0</span> <span m="3298940">plus</span> <span m="3300090">a0</span> <span m="3300780">b1.</span> <span m="3301845">So</span> <span m="3302220">this is</span> <span m="3302520">how</span> <span m="3302880">you</span> <span m="3302960">do the</span> <span m="3303310">multiplication,</span> <span m="3303570">right.</span> <span m="3306330">Question?</span> </p>
<p><span m="3306940">AUDIENCE:</span> <span m="3307260">So</span> <span m="3307580">I was</span> <span m="3307920">going to</span> <span m="3308260">say</span> <span m="3308635">are you</span> <span m="3309010">using</span> <span m="3309390">[INAUDIBLE]</span> <span m="3310136">method?</span> </p>
<p><span m="3310785">PROFESSOR:</span> <span m="3311060">Yeah,</span> <span m="3311390">so this</span> <span m="3311655">is</span> <span m="3311920">like a</span> <span m="3312300">clever</span> <span m="3312680">method</span> <span m="3313060">alternative</span> <span m="3313430">for</span> <span m="3313800">doing</span> <span m="3314143">multiplication,</span> <span m="3314830">which</span> <span m="3315490">doesn't</span> <span m="3315650">involve</span> <span m="3316130">four</span> <span m="3316310">steps.</span> <span m="3316680">Here,</span> <span m="3317120">you</span> <span m="3317420">have</span> <span m="3317700">to do</span> <span m="3317910">four</span> <span m="3318080">multiplications.</span> <span m="3318435">There's</span> <span m="3318790">this</span> <span m="3319100">clever</span> <span m="3319410">other</span> <span m="3319640">method,</span> <span m="3319970">Karatsuba.</span> <span m="3320905">Do they teach</span> <span m="3321300">this in 601</span> <span m="3321470">or something</span> <span m="3322330">these</span> <span m="3322590">days?</span> </p>
<p><span m="3322890">AUDIENCE: 042.</span> </p>
<p><span m="3323290">PROFESSOR: 042,</span> <span m="3323740">excellent.</span> <span m="3324040">Yeah, that's</span> <span m="3324525">a very</span> <span m="3325010">nice</span> <span m="3325495">method.</span> <span m="3325980">Almost</span> <span m="3326250">every</span> <span m="3327370">cryptographic</span> <span m="3327580">library</span> <span m="3328000">implements</span> <span m="3328520">this.</span> <span m="3329440">And</span> <span m="3330840">for</span> <span m="3330980">those</span> <span m="3331150">of you</span> <span m="3331390">that,</span> <span m="3331800">I guess,</span> <span m="3332230">weren't undergrads</span> <span m="3332710">here,</span> <span m="3333180">since</span> <span m="3333470">we</span> <span m="3333760">have</span> <span m="3334120">grad</span> <span m="3334480">students</span> <span m="3334640">maybe</span> <span m="3334980">they</span> <span m="3335090">haven't</span> <span m="3335360">seen</span> <span m="3335410">Karatsuba.</span> <span m="3335685">I'll</span> <span m="3335960">just</span> <span m="3336290">write</span> <span m="3336580">it out</span> <span m="3336780">on the</span> <span m="3336840">board.</span> <span m="3337120">It's</span> <span m="3337260">a clever thing</span> <span m="3337710">the</span> <span m="3338000">first</span> <span m="3338190">time</span> <span m="3338380">you</span> <span m="3339530">see</span> <span m="3339860">it.</span> <span m="3340850">And</span> <span m="3341690">what</span> <span m="3341820">you</span> <span m="3341880">can</span> <span m="3342060">do</span> <span m="3342210">is</span> <span m="3342330">basically</span> <span m="3344380">compute</span> <span m="3344760">out</span> <span m="3345310">three</span> <span m="3345610">values.</span> <span m="3346310">You're</span> <span m="3346600">going to</span> <span m="3346890">compute out</span> <span m="3347100">a1</span> <span m="3348200">b1.</span> <span m="3349040">You're</span> <span m="3349240">going</span> <span m="3349333">to</span> <span m="3349426">also</span> <span m="3349520">compute</span> <span m="3350960">a1</span> <span m="3352490">minus</span> <span m="3353640">b0</span> <span m="3354450">times</span> <span m="3356890">b1</span> <span m="3359190">minus--</span> <span m="3360570">sorry--</span> <span m="3361060">a1</span> <span m="3361320">minus</span> <span m="3362490">a0,</span> <span m="3363320">b1</span> <span m="3363660">minus</span> <span m="3363920">b0.</span> <span m="3364950">And</span> <span m="3366550">a0</span> <span m="3367000">b0.</span> <span m="3368690">And</span> <span m="3369310">this</span> <span m="3369920">does</span> <span m="3370290">three</span> <span m="3370660">multiplications</span> <span m="3371125">instead</span> <span m="3371590">of</span> <span m="3371890">four.</span> <span m="3372225">And</span> <span m="3372560">it</span> <span m="3372910">turns out</span> <span m="3373260">you</span> <span m="3373376">can</span> <span m="3373493">actually</span> <span m="3373810">reconstruct</span> <span m="3375240">this</span> <span m="3375500">value</span> <span m="3376310">from</span> <span m="3376670">these</span> <span m="3377090">three</span> <span m="3377840">multiplication</span> <span m="3378440">results.</span> </p>
<p><span m="3380200">And</span> <span m="3380400">the</span> <span m="3380480">particular</span> <span m="3380820">way</span> <span m="3380990">to</span> <span m="3381110">do</span> <span m="3381310">it</span> <span m="3381675">is</span> <span m="3382590">this</span> <span m="3382810">is</span> <span m="3382920">going</span> <span m="3383050">to</span> <span m="3383110">be</span> <span m="3383880">the--</span> <span m="3388676">let</span> <span m="3389052">me</span> <span m="3389430">write it</span> <span m="3389670">out in a</span> <span m="3389870">different</span> <span m="3390300">form.</span> <span m="3391910">So</span> <span m="3392460">we're</span> <span m="3392620">going</span> <span m="3392710">to</span> <span m="3392750">have</span> <span m="3393400">2</span> <span m="3393710">to the</span> <span m="3394070">64</span> <span m="3395740">times--</span> <span m="3399600">sorry--</span> <span m="3399730">2</span> <span m="3399980">to the</span> <span m="3400300">64</span> <span m="3401010">plus</span> <span m="3402000">2</span> <span m="3402170">to</span> <span m="3402425">the</span> <span m="3402970">32</span> <span m="3404820">times</span> <span m="3407430">a1</span> <span m="3407766">b1</span> <span m="3409820">plus</span> <span m="3412430">2</span> <span m="3412710">to</span> <span m="3413085">the</span> <span m="3413930">32</span> <span m="3415250">times</span> <span m="3417370">minus</span> <span m="3417845">that</span> <span m="3418320">little guy</span> <span m="3418620">in the middle</span> <span m="3419760">a1</span> <span m="3420230">minus</span> <span m="3420810">a0</span> <span m="3423100">b1</span> <span m="3423830">minus</span> <span m="3424390">b0.</span> </p>
<p><span m="3425640">And</span> <span m="3426280">finally,</span> <span m="3427420">we're</span> <span m="3427430">going</span> <span m="3427690">to</span> <span m="3427965">do</span> <span m="3428820">2</span> <span m="3428960">to the</span> <span m="3429170">32</span> <span m="3430140">plus</span> <span m="3430520">1</span> <span m="3431460">times</span> <span m="3432710">a0</span> <span m="3433135">b0.</span> <span m="3435020">And</span> <span m="3435340">it's</span> <span m="3435660">a</span> <span m="3436110">little</span> <span m="3436390">messy,</span> <span m="3436570">but actually</span> <span m="3436920">if you</span> <span m="3437550">work</span> <span m="3437820">through</span> <span m="3437940">the</span> <span m="3438260">details,</span> <span m="3438610">you'll</span> <span m="3439400">end</span> <span m="3439600">up</span> <span m="3439980">convincing</span> <span m="3440290">yourself</span> <span m="3440620">hopefully</span> <span m="3440880">that</span> <span m="3442150">this</span> <span m="3442780">value</span> <span m="3443040">is</span> <span m="3443300">exactly</span> <span m="3443700">the</span> <span m="3444010">same</span> <span m="3444320">as</span> <span m="3445400">this</span> <span m="3445570">value.</span> <span m="3446285">So</span> <span m="3446590">it's a</span> <span m="3447390">clever.</span> <span m="3447930">But</span> <span m="3448840">nonetheless,</span> <span m="3449460">it saves</span> <span m="3449690">you</span> <span m="3450420">one</span> <span m="3450650">multiplication.</span> <span m="3451470">And</span> <span m="3451950">the way</span> <span m="3452430">we</span> <span m="3452550">apply</span> <span m="3453070">this</span> <span m="3453430">to</span> <span m="3453960">doing</span> <span m="3454670">much</span> <span m="3454940">larger</span> <span m="3455378">multiplications</span> <span m="3455816">is</span> <span m="3456254">that</span> <span m="3456692">you</span> <span m="3457600">recursively</span> <span m="3457660">keep</span> <span m="3457960">going</span> <span m="3458240">down.</span> </p>
<p><span m="3458610">So</span> <span m="3458920">if</span> <span m="3459230">you</span> <span m="3459350">have</span> <span m="3460270">512</span> <span m="3460460">bit</span> <span m="3460640">values,</span> <span m="3461570">you</span> <span m="3461750">could</span> <span m="3461970">break</span> <span m="3462370">it</span> <span m="3462460">down</span> <span m="3463170">to</span> <span m="3463270">256</span> <span m="3463520">bit</span> <span m="3463690">multiplication.</span> <span m="3464790">You</span> <span m="3465080">do</span> <span m="3465370">three</span> <span m="3466270">256</span> <span m="3466380">bit</span> <span m="3466510">multiplications.</span> <span m="3467960">And</span> <span m="3468260">then each</span> <span m="3468740">of those</span> <span m="3469140">you're going to do using</span> <span m="3469440">the</span> <span m="3469530">same</span> <span m="3469780">Karatsuba</span> <span m="3470220">trick</span> <span m="3471100">recursively.</span> <span m="3472410">And</span> <span m="3472890">eventually</span> <span m="3473100">you'll</span> <span m="3473390">get down</span> <span m="3473665">to</span> <span m="3473940">machine</span> <span m="3474300">size,</span> <span m="3474660">which</span> <span m="3474840">you can</span> <span m="3475330">just</span> <span m="3475820">do with</span> <span m="3476020">a</span> <span m="3476210">single</span> <span m="3476640">machine</span> <span m="3476986">instruction.</span> <span m="3477332">[INAUDIBLE]</span> <span m="3479766">This make</span> <span m="3480220">sense?</span> </p>
<p><span m="3482590">So</span> <span m="3483350">what's</span> <span m="3483630">the</span> <span m="3483885">timing</span> <span m="3484140">attack</span> <span m="3484400">here?</span> <span m="3484660">How do</span> <span m="3484870">these guys</span> <span m="3485260">exploit</span> <span m="3486000">this</span> <span m="3486455">Karatsuba</span> <span m="3486720">multiplication?</span> <span m="3487430">Well,</span> <span m="3488010">it</span> <span m="3488130">turns</span> <span m="3488410">out</span> <span m="3488910">that</span> <span m="3489880">OpenSSL</span> <span m="3491100">worries</span> <span m="3491720">about</span> <span m="3492160">basically</span> <span m="3492550">two</span> <span m="3492770">kinds</span> <span m="3493070">of</span> <span m="3493160">multiplications</span> <span m="3493920">that</span> <span m="3494230">you might</span> <span m="3494470">need</span> <span m="3494640">to</span> <span m="3494740">do.</span> <span m="3495850">One</span> <span m="3496320">is</span> <span m="3496400">a</span> <span m="3496500">multiplication</span> <span m="3497320">between</span> <span m="3497790">two</span> <span m="3498000">large</span> <span m="3498500">numbers</span> <span m="3498860">that</span> <span m="3499090">are</span> <span m="3499270">about the</span> <span m="3499330">same</span> <span m="3499620">size.</span> <span m="3499965">So</span> <span m="3500310">this</span> <span m="3500730">happens</span> <span m="3501040">a lot</span> <span m="3501510">when</span> <span m="3501980">we're doing</span> <span m="3502250">this</span> <span m="3502520">modular</span> <span m="3502840">exponentiation</span> <span m="3503490">because</span> <span m="3503810">all</span> <span m="3504120">the</span> <span m="3504578">values</span> <span m="3505036">we're</span> <span m="3505494">going to be multiplying</span> <span m="3505952">are</span> <span m="3506410">all going</span> <span m="3506868">to be</span> <span m="3507326">roughly</span> <span m="3507784">512</span> <span m="3508242">bits</span> <span m="3508700">in size.</span> </p>
<p><span m="3509445">So</span> <span m="3509760">when</span> <span m="3510060">we're</span> <span m="3510465">multiplying</span> <span m="3510870">by</span> <span m="3511350">c</span> <span m="3511560">to the</span> <span m="3511740">y</span> <span m="3512060">or</span> <span m="3512350">doing</span> <span m="3512640">a</span> <span m="3512985">squaring,</span> <span m="3513330">we're</span> <span m="3513740">multiplying</span> <span m="3513960">two</span> <span m="3514100">things</span> <span m="3514390">that</span> <span m="3514665">are about</span> <span m="3514940">the same</span> <span m="3515200">size.</span> <span m="3515850">And</span> <span m="3516318">then</span> <span m="3516786">this</span> <span m="3517254">Karatsuba</span> <span m="3517722">trick</span> <span m="3518190">makes</span> <span m="3518620">a lot of sense</span> <span m="3518890">because,</span> <span m="3519000">instead</span> <span m="3519310">of</span> <span m="3520080">computing</span> <span m="3520580">stuff</span> <span m="3521290">in</span> <span m="3521510">times</span> <span m="3522100">squared</span> <span m="3522400">of</span> <span m="3522700">the</span> <span m="3523005">input</span> <span m="3523310">size,</span> <span m="3523790">Karatsuba</span> <span m="3524770">is</span> <span m="3524960">roughly</span> <span m="3525710">n</span> <span m="3525960">to</span> <span m="3526060">the</span> <span m="3526280">1.58,</span> <span m="3527650">something</span> <span m="3528005">like</span> <span m="3528360">that.</span> <span m="3528740">So</span> <span m="3529120">it's</span> <span m="3529300">much</span> <span m="3529410">faster.</span> </p>
<p><span m="3530335">But</span> <span m="3530780">then</span> <span m="3531225">there's</span> <span m="3531670">this other</span> <span m="3531920">situation</span> <span m="3532490">where</span> <span m="3532750">OpenSSL</span> <span m="3533280">might be</span> <span m="3533560">multiplying</span> <span m="3534090">two</span> <span m="3534290">numbers</span> <span m="3534780">that</span> <span m="3534930">are</span> <span m="3535280">very</span> <span m="3535480">different</span> <span m="3535930">in size:</span> <span m="3536200">one</span> <span m="3536600">that's</span> <span m="3536750">very</span> <span m="3537060">big,</span> <span m="3537410">and one</span> <span m="3537770">that's</span> <span m="3537940">very</span> <span m="3538235">small.</span> <span m="3538530">And</span> <span m="3539020">in</span> <span m="3539510">that case</span> <span m="3540000">you</span> <span m="3540120">could</span> <span m="3540360">use</span> <span m="3540470">Karatsuba,</span> <span m="3540900">but</span> <span m="3541150">then</span> <span m="3542030">it's</span> <span m="3542230">going to get you</span> <span m="3542490">slower</span> <span m="3542990">than</span> <span m="3543200">doing</span> <span m="3543610">the</span> <span m="3544020">naive</span> <span m="3544330">thing.</span> <span m="3544610">Suppose</span> <span m="3544750">you're</span> <span m="3545180">trying</span> <span m="3545440">to</span> <span m="3545620">multiply</span> <span m="3546060">a</span> <span m="3546350">512 bit</span> <span m="3546660">number</span> <span m="3547000">by a</span> <span m="3547260">64</span> <span m="3547580">bit</span> <span m="3547900">number,</span> <span m="3548790">you'd</span> <span m="3548960">rather</span> <span m="3549330">just do</span> <span m="3549590">the</span> <span m="3549820">straightforward</span> <span m="3550280">thing,</span> <span m="3550555">where you just</span> <span m="3550830">multiply</span> <span m="3551370">by</span> <span m="3551850">each</span> <span m="3552010">of</span> <span m="3552220">the</span> <span m="3552290">things</span> <span m="3552710">in</span> <span m="3552795">the</span> <span m="3552880">64</span> <span m="3552965">bit</span> <span m="3553050">number</span> <span m="3554020">plus</span> <span m="3554190">2n</span> <span m="3554640">instead</span> <span m="3555000">of</span> <span m="3555360">n to the</span> <span m="3555685">1.58</span> <span m="3556010">something.</span> </p>
<p><span m="3558290">So</span> <span m="3558940">as a result,</span> <span m="3559350">the</span> <span m="3559610">OpenSSL</span> <span m="3559995">guys</span> <span m="3560765">tried to</span> <span m="3561150">be</span> <span m="3561490">clever,</span> <span m="3561900">and that's</span> <span m="3562330">where</span> <span m="3562760">often</span> <span m="3563510">problems</span> <span m="3564350">start.</span> <span m="3565760">They</span> <span m="3566280">decided</span> <span m="3567020">that</span> <span m="3567460">they'll</span> <span m="3567870">actually</span> <span m="3568280">switch dynamically</span> <span m="3568650">between</span> <span m="3569130">this</span> <span m="3569330">Karatsuba</span> <span m="3569760">efficient</span> <span m="3570110">thing</span> <span m="3570880">and</span> <span m="3571230">this</span> <span m="3572020">sort</span> <span m="3572320">of</span> <span m="3572640">grade</span> <span m="3572940">school</span> <span m="3573370">method of</span> <span m="3573600">multiplication</span> <span m="3574460">here.</span> <span m="3575450">And</span> <span m="3575920">their heuristic</span> <span m="3576290">was</span> <span m="3576660">basically</span> <span m="3577400">if</span> <span m="3577760">the</span> <span m="3577970">two</span> <span m="3578400">things you're</span> <span m="3578510">multiplying</span> <span m="3579050">are</span> <span m="3579220">exactly</span> <span m="3579870">the</span> <span m="3579960">same</span> <span m="3580280">number</span> <span m="3580680">of</span> <span m="3581310">machine</span> <span m="3581760">words,</span> <span m="3582490">so</span> <span m="3582590">they</span> <span m="3583010">at least have</span> <span m="3583300">the</span> <span m="3583370">same</span> <span m="3583620">number</span> <span m="3584024">of bits</span> <span m="3584428">up to 32-bit</span> <span m="3585640">units,</span> <span m="3586350">then</span> <span m="3586530">they'll</span> <span m="3586740">go to</span> <span m="3587050">Karatsuba.</span> <span m="3588110">And</span> <span m="3588580">if</span> <span m="3589050">the two</span> <span m="3589550">things</span> <span m="3589880">they're</span> <span m="3590130">multiplying</span> <span m="3590380">have a</span> <span m="3590580">different</span> <span m="3590910">number</span> <span m="3591290">or</span> <span m="3591370">32</span> <span m="3591670">bit</span> <span m="3591890">units,</span> <span m="3592770">then</span> <span m="3593045">they'll</span> <span m="3593540">do</span> <span m="3594330">the</span> <span m="3594520">quadratic</span> <span m="3594940">or</span> <span m="3595900">straightforward</span> <span m="3596960">or</span> <span m="3597240">regular,</span> <span m="3597660">normal</span> <span m="3598090">multiplication.</span> </p>
<p><span m="3599882">And</span> <span m="3600330">there</span> <span m="3600690">you</span> <span m="3600890">can</span> <span m="3601090">see</span> <span m="3601780">if</span> <span m="3602220">your</span> <span m="3602360">number</span> <span m="3602750">all</span> <span m="3603170">of</span> <span m="3603320">a</span> <span m="3603540">sudden</span> <span m="3603880">switches</span> <span m="3604210">to</span> <span m="3604570">be</span> <span m="3604800">a</span> <span m="3604850">little</span> <span m="3605030">bit</span> <span m="3605220">smaller,</span> <span m="3606290">then</span> <span m="3607040">you're</span> <span m="3607140">going</span> <span m="3607250">to</span> <span m="3607310">switch</span> <span m="3607630">from</span> <span m="3607890">the</span> <span m="3607990">sufficient</span> <span m="3608480">thing</span> <span m="3608710">to</span> <span m="3609000">this</span> <span m="3609300">other</span> <span m="3609670">multiplication</span> <span m="3609995">method.</span> <span m="3611240">And</span> <span m="3612070">presumably,</span> <span m="3613110">the</span> <span m="3613360">cutoff</span> <span m="3613690">point</span> <span m="3613950">isn't</span> <span m="3614030">going</span> <span m="3614210">to</span> <span m="3614280">be</span> <span m="3614420">exactly</span> <span m="3614690">smooth</span> <span m="3614960">so</span> <span m="3615310">you'll</span> <span m="3615595">be</span> <span m="3615880">able to tell</span> <span m="3616303">all of a</span> <span m="3616726">sudden,</span> <span m="3617150">it's</span> <span m="3617500">now</span> <span m="3617800">taking</span> <span m="3618240">a lot</span> <span m="3618730">longer</span> <span m="3618860">to multiply</span> <span m="3619190">or</span> <span m="3619526">a lot</span> <span m="3620200">shorter</span> <span m="3620610">to multiply</span> <span m="3621013">than</span> <span m="3621820">before.</span> <span m="3622320">And</span> <span m="3622585">that's</span> <span m="3622850">what</span> <span m="3623750">these</span> <span m="3623950">guys</span> <span m="3624570">exploit</span> <span m="3624910">in</span> <span m="3625070">their</span> <span m="3625290">timing</span> <span m="3625530">attack</span> <span m="3626000">again.</span> <span m="3626940">Does that</span> <span m="3627410">make</span> <span m="3627540">sense?</span> <span m="3628060">What's</span> <span m="3628320">going</span> <span m="3628490">on</span> <span m="3628600">with</span> <span m="3628840">the</span> <span m="3629060">[INAUDIBLE]</span> <span m="3631090">All right.</span> </p>
<p><span m="3632070">So</span> <span m="3632440">I</span> <span m="3632500">think</span> <span m="3632690">I'm</span> <span m="3632760">now</span> <span m="3633150">done</span> <span m="3633520">with</span> <span m="3634300">telling you</span> <span m="3634680">about</span> <span m="3634870">all the</span> <span m="3635290">weird</span> <span m="3636090">implementation</span> <span m="3636385">tricks</span> <span m="3636680">that</span> <span m="3637110">people</span> <span m="3637540">play</span> <span m="3637970">when</span> <span m="3638400">implementing</span> <span m="3638830">RSA</span> <span m="3639260">in practice.</span> <span m="3639590">So now</span> <span m="3640060">let's try</span> <span m="3640480">to put them</span> <span m="3640840">back</span> <span m="3641090">together</span> <span m="3641630">into</span> <span m="3642200">an</span> <span m="3642530">entire</span> <span m="3642780">web</span> <span m="3642970">server</span> <span m="3643640">and</span> <span m="3643850">figure</span> <span m="3644170">out</span> <span m="3644410">how</span> <span m="3644760">do</span> <span m="3644920">you</span> <span m="3646700">[? tickle ?]</span> <span m="3646850">all</span> <span m="3647300">these</span> <span m="3647520">interesting</span> <span m="3647940">bits</span> <span m="3648230">of the</span> <span m="3648520">implementation</span> <span m="3649540">from</span> <span m="3649960">the</span> <span m="3650412">input network</span> <span m="3650864">packet.</span> </p>
<p><span m="3652220">So</span> <span m="3653330">what</span> <span m="3653510">happens</span> <span m="3653890">in</span> <span m="3653970">a</span> <span m="3654020">web</span> <span m="3654190">server</span> <span m="3654590">is</span> <span m="3654910">that</span> <span m="3656050">the</span> <span m="3656380">web</span> <span m="3656836">server,</span> <span m="3657292">if you</span> <span m="3657750">remember</span> <span m="3658110">from</span> <span m="3658330">the</span> <span m="3658730">HTTPS</span> <span m="3659330">lecture,</span> <span m="3660120">has</span> <span m="3660420">a</span> <span m="3660510">secret</span> <span m="3660970">key.</span> <span m="3661890">And</span> <span m="3662310">it</span> <span m="3662730">uses</span> <span m="3662910">the</span> <span m="3663060">secret</span> <span m="3663520">key</span> <span m="3663950">to</span> <span m="3664110">prove</span> <span m="3664780">that</span> <span m="3665000">it's</span> <span m="3665180">the</span> <span m="3665400">correct</span> <span m="3665750">owner</span> <span m="3666090">of</span> <span m="3666430">all</span> <span m="3666820">that</span> <span m="3667080">certificate</span> <span m="3668060">in</span> <span m="3669020">the</span> <span m="3669120">HTTPS</span> <span m="3669405">protocol</span> <span m="3669690">or</span> <span m="3670070">in</span> <span m="3670450">TLS.</span> <span m="3671190">And</span> <span m="3671630">they</span> <span m="3671770">way</span> <span m="3671960">this</span> <span m="3672300">works</span> <span m="3672670">is that</span> <span m="3673995">the</span> <span m="3674410">clients</span> <span m="3674470">send</span> <span m="3674950">some</span> <span m="3675630">randomly</span> <span m="3675940">chosen</span> <span m="3676250">bits,</span> <span m="3677630">and</span> <span m="3678090">the</span> <span m="3678550">bits are</span> <span m="3679010">encrypted</span> <span m="3679470">using</span> <span m="3679800">the</span> <span m="3679880">server's</span> <span m="3680330">public</span> <span m="3680530">key.</span> <span m="3681210">And</span> <span m="3681450">the</span> <span m="3681820">server</span> <span m="3682190">in this</span> <span m="3682680">TLS</span> <span m="3683040">protocol</span> <span m="3683400">decrypts</span> <span m="3683860">this</span> <span m="3684030">message.</span> <span m="3684395">And</span> <span m="3684760">if</span> <span m="3685230">the</span> <span m="3685320">message</span> <span m="3685740">checks</span> <span m="3686050">out,</span> <span m="3686560">it</span> <span m="3686730">uses</span> <span m="3686850">those</span> <span m="3687120">random</span> <span m="3687390">bits</span> <span m="3687460">to</span> <span m="3687800">establish</span> <span m="3688283">a</span> <span m="3688766">[? session ?].</span> <span m="3689249">But</span> <span m="3689732">in</span> <span m="3690215">this</span> <span m="3690698">case,</span> <span m="3691181">the message</span> <span m="3691664">isn't going</span> <span m="3692147">to check out.</span> <span m="3692630">The</span> <span m="3693113">message is going</span> <span m="3693596">to</span> <span m="3693716">be</span> <span m="3693837">carefully</span> <span m="3693958">chosen,</span> <span m="3694079">the padding</span> <span m="3694562">bits</span> <span m="3695045">aren't</span> <span m="3695530">going to</span> <span m="3695600">match,</span> <span m="3695980">and the</span> <span m="3696360">server</span> <span m="3696700">is going</span> <span m="3697170">to return</span> <span m="3697210">error</span> <span m="3697470">as</span> <span m="3697730">soon as</span> <span m="3697810">it</span> <span m="3698090">finishes</span> <span m="3698800">encrypting</span> <span m="3699090">our</span> <span m="3699230">message.</span> <span m="3699850">And</span> <span m="3700340">that's what</span> <span m="3700830">we're going</span> <span m="3700890">to</span> <span m="3701030">time</span> <span m="3701390">here.</span> </p>
<p><span m="3702080">So</span> <span m="3702385">the</span> <span m="3702690">server--</span> <span m="3702985">you can</span> <span m="3703280">think</span> <span m="3703772">of</span> <span m="3704264">this</span> <span m="3704756">is</span> <span m="3705250">Apache</span> <span m="3706810">with</span> <span m="3707290">open</span> <span m="3707600">SSL--</span> <span m="3709368">you're</span> <span m="3709854">going</span> <span m="3710340">to get a</span> <span m="3710830">message</span> <span m="3711340">from</span> <span m="3711740">the</span> <span m="3711860">client,</span> <span m="3712500">and</span> <span m="3713230">you can</span> <span m="3713360">think of</span> <span m="3713560">this</span> <span m="3714100">as</span> <span m="3714920">a</span> <span m="3715240">ciphertext</span> <span m="3715940">c,</span> <span m="3716380">or</span> <span m="3716530">a</span> <span m="3716580">hypothetical</span> <span m="3716895">ciphertext,</span> <span m="3718350">that</span> <span m="3718830">the</span> <span m="3718940">client</span> <span m="3719400">might have</span> <span m="3719710">produced.</span> <span m="3720545">And</span> <span m="3720830">the</span> <span m="3720980">first</span> <span m="3721240">thing</span> <span m="3721370">we're</span> <span m="3721520">going</span> <span m="3721630">to</span> <span m="3721710">do</span> <span m="3722420">with</span> <span m="3722700">a</span> <span m="3723020">ciphertext c,</span> <span m="3723340">we</span> <span m="3723680">want to</span> <span m="3723770">decrypt</span> <span m="3724045">it</span> <span m="3725210">using</span> <span m="3725430">roughly</span> <span m="3725590">this</span> <span m="3725780">formula.</span> <span m="3726910">And</span> <span m="3727320">if you</span> <span m="3727360">remember</span> <span m="3727670">the</span> <span m="3727780">first</span> <span m="3728430">optimization</span> <span m="3728820">we're</span> <span m="3729210">going to</span> <span m="3729585">apply</span> <span m="3729960">is</span> <span m="3730455">the</span> <span m="3730950">Chinese</span> <span m="3731445">Remainder</span> <span m="3731940">Theorem.</span> </p>
<p><span m="3733430">So</span> <span m="3733630">the first</span> <span m="3733860">thing we're</span> <span m="3734030">going</span> <span m="3734240">to do is</span> <span m="3734340">basically</span> <span m="3734700">split</span> <span m="3735230">our</span> <span m="3735350">pipeline</span> <span m="3735640">in</span> <span m="3735750">two</span> <span m="3735880">parts.</span> <span m="3736730">We're</span> <span m="3736860">going</span> <span m="3736960">to</span> <span m="3737130">do</span> <span m="3737700">one</span> <span m="3737980">thing</span> <span m="3738240">mod p</span> <span m="3739020">another</span> <span m="3739280">thing</span> <span m="3739540">mod q</span> <span m="3740430">and</span> <span m="3740540">then</span> <span m="3740760">recombine</span> <span m="3741370">the</span> <span m="3741460">results</span> <span m="3741900">at the</span> <span m="3742180">end</span> <span m="3742460">of the day.</span> <span m="3742920">So</span> <span m="3743380">the</span> <span m="3743620">first thing</span> <span m="3743860">we're</span> <span m="3743962">going</span> <span m="3744065">to</span> <span m="3744167">do is,</span> <span m="3744270">we're actually</span> <span m="3744720">going to</span> <span m="3745170">take</span> <span m="3745620">c</span> <span m="3746070">and</span> <span m="3746520">we're</span> <span m="3746740">going</span> <span m="3747110">to</span> <span m="3747320">compute,</span> <span m="3748310">let's</span> <span m="3748580">call</span> <span m="3748970">this</span> <span m="3749890">c0,</span> <span m="3750780">which</span> <span m="3750890">is</span> <span m="3751070">going</span> <span m="3751200">to</span> <span m="3751290">be</span> <span m="3751655">equal</span> <span m="3752150">to</span> <span m="3752240">c</span> <span m="3753410">mod q.</span> <span m="3755480">And</span> <span m="3755700">we're</span> <span m="3755860">also</span> <span m="3756140">going</span> <span m="3756270">to</span> <span m="3756320">have</span> <span m="3757020">a</span> <span m="3757070">different</span> <span m="3757400">value,</span> <span m="3758340">let's</span> <span m="3758710">call it</span> <span m="3759175">c1,</span> <span m="3761035">which is</span> <span m="3761500">going to be</span> <span m="3761970">c</span> <span m="3763120">mod p.</span> <span m="3764730">And then</span> <span m="3765060">we're</span> <span m="3765140">going to do</span> <span m="3765410">the same</span> <span m="3765790">thing</span> <span m="3766250">to</span> <span m="3766750">each</span> <span m="3766930">of</span> <span m="3767080">these</span> <span m="3768110">values</span> <span m="3769090">to</span> <span m="3769270">basically</span> <span m="3769830">compute</span> <span m="3770030">c</span> <span m="3770520">to</span> <span m="3770620">the</span> <span m="3770900">d</span> <span m="3771620">mod p</span> <span m="3771905">and</span> <span m="3772190">c</span> <span m="3772410">to the</span> <span m="3772870">d</span> <span m="3773340">mod q.</span> </p>
<p><span m="3775010">And</span> <span m="3775390">here we're</span> <span m="3775845">going to</span> <span m="3776530">basically</span> <span m="3777550">initially</span> <span m="3777970">we're</span> <span m="3778070">going</span> <span m="3778170">to</span> <span m="3778270">[? starch. ?]</span> <span m="3779760">After CRT,</span> <span m="3780500">we're going to</span> <span m="3781010">switch into</span> <span m="3781370">Montgomery</span> <span m="3781675">representation</span> <span m="3782610">because</span> <span m="3782870">that's</span> <span m="3782990">going</span> <span m="3783140">to</span> <span m="3783230">make</span> <span m="3783470">our</span> <span m="3784020">multiplies</span> <span m="3784610">very</span> <span m="3784870">fast.</span> <span m="3786040">So</span> <span m="3786130">the</span> <span m="3786390">next</span> <span m="3786750">thing</span> <span m="3787160">SSL</span> <span m="3787570">is</span> <span m="3787840">going to do</span> <span m="3788150">to your</span> <span m="3788340">number,</span> <span m="3789020">it's</span> <span m="3789360">actually going</span> <span m="3789610">to compute</span> <span m="3790340">all</span> <span m="3790530">the</span> <span m="3790630">[INAUDIBLE]</span> <span m="3790940">at</span> <span m="3791250">c0</span> <span m="3791550">prime,</span> <span m="3792900">which</span> <span m="3792980">is</span> <span m="3793120">going</span> <span m="3793220">to</span> <span m="3793290">be</span> <span m="3793970">c0</span> <span m="3795060">times</span> <span m="3795430">R</span> <span m="3796416">mod q.</span> </p>
<p><span m="3798740">And</span> <span m="3799070">the</span> <span m="3799230">same</span> <span m="3799620">thing</span> <span m="3799880">down</span> <span m="3799980">here,</span> <span m="3800440">I'm not going</span> <span m="3800900">to write out</span> <span m="3801360">the</span> <span m="3801513">pipeline</span> <span m="3801666">because</span> <span m="3801820">that'll</span> <span m="3802050">look</span> <span m="3802280">the same.</span> <span m="3803200">And</span> <span m="3803360">then,</span> <span m="3804470">now that</span> <span m="3804760">we've</span> <span m="3804940">switched</span> <span m="3805520">into</span> <span m="3806225">Montgomery</span> <span m="3806490">form,</span> <span m="3807520">we can</span> <span m="3807820">finally</span> <span m="3808380">do</span> <span m="3808730">our</span> <span m="3810390">multiplications.</span> <span m="3811840">And</span> <span m="3812140">here's</span> <span m="3812390">where</span> <span m="3812880">we're going</span> <span m="3813010">to use</span> <span m="3813210">the</span> <span m="3813440">sliding</span> <span m="3813940">window</span> <span m="3814190">technique.</span> <span m="3815780">So</span> <span m="3815840">once</span> <span m="3816080">we</span> <span m="3816190">have</span> <span m="3816780">c</span> <span m="3817340">prime,</span> <span m="3817640">we can</span> <span m="3817940">actually</span> <span m="3818290">try</span> <span m="3818640">to</span> <span m="3819130">compute</span> <span m="3819800">this</span> <span m="3820330">prime</span> <span m="3822010">exponentiate</span> <span m="3822310">it</span> <span m="3822610">to</span> <span m="3822870">2d</span> <span m="3824268">mod</span> <span m="3825666">q.</span> <span m="3827460">And</span> <span m="3827980">here,</span> <span m="3828610">as</span> <span m="3828830">we're</span> <span m="3829230">computing</span> <span m="3830380">this</span> <span m="3830860">value</span> <span m="3831350">to</span> <span m="3831690">the</span> <span m="3831970">d,</span> <span m="3832250">we're going</span> <span m="3832550">to be using</span> <span m="3832950">sliding</span> <span m="3833310">windows.</span> <span m="3833990">So</span> <span m="3835120">here,</span> <span m="3835385">we're</span> <span m="3835650">going</span> <span m="3835760">to</span> <span m="3836050">do</span> <span m="3836480">sliding windows</span> <span m="3839510">for</span> <span m="3840300">the</span> <span m="3840600">bits in</span> <span m="3841090">this d</span> <span m="3841430">exponent.</span> </p>
<p><span m="3843350">And</span> <span m="3844350">also</span> <span m="3844720">we're</span> <span m="3844870">going</span> <span m="3844980">to</span> <span m="3846400">do</span> <span m="3847766">Karatsuba</span> <span m="3848450">or</span> <span m="3848940">regular</span> <span m="3849430">multiplication</span> <span m="3850450">depending</span> <span m="3851080">on</span> <span m="3852240">exactly</span> <span m="3852650">what</span> <span m="3852820">the</span> <span m="3852910">size</span> <span m="3853330">of</span> <span m="3853460">our</span> <span m="3853670">operands</span> <span m="3854260">are.</span> <span m="3855540">So</span> <span m="3855820">if</span> <span m="3855990">it</span> <span m="3856130">turns</span> <span m="3856430">out</span> <span m="3856870">that</span> <span m="3857090">the thing</span> <span m="3857380">we're</span> <span m="3857680">multiplying,</span> <span m="3858500">c0</span> <span m="3858880">prime</span> <span m="3860150">and</span> <span m="3861620">maybe</span> <span m="3861900">that</span> <span m="3862240">previously</span> <span m="3863010">squared</span> <span m="3864250">result,</span> <span m="3865070">are</span> <span m="3865190">the</span> <span m="3865320">same</span> <span m="3865640">size,</span> <span m="3865900">we're going</span> <span m="3866160">to do</span> <span m="3866370">Karatsuba.</span> <span m="3867310">If</span> <span m="3868200">c0</span> <span m="3868580">prime</span> <span m="3869030">is</span> <span m="3869480">tiny</span> <span m="3870120">but</span> <span m="3870530">some</span> <span m="3870750">previous thing</span> <span m="3871230">we're</span> <span m="3871350">multiplying</span> <span m="3871630">it</span> <span m="3871910">to</span> <span m="3872060">is big ,</span> <span m="3872497">then</span> <span m="3872934">we're</span> <span m="3873371">going</span> <span m="3873810">to do</span> <span m="3874240">quadratic</span> <span m="3874580">multiplication,</span> <span m="3875282">normal</span> <span m="3875724">multiplication.</span> <span m="3876610">There's</span> <span m="3877190">sliding</span> <span m="3877630">windows</span> <span m="3877710">coming</span> <span m="3877890">in</span> <span m="3878240">here,</span> <span m="3878520">here</span> <span m="3878800">we</span> <span m="3879060">also</span> <span m="3879320">have</span> <span m="3880050">this</span> <span m="3880610">Karatsuba</span> <span m="3882390">versus</span> <span m="3882730">normal</span> <span m="3883070">multiplying.</span> </p>
<p><span m="3885770">And</span> <span m="3886590">also</span> <span m="3887000">in</span> <span m="3887410">this</span> <span m="3887550">step,</span> <span m="3888180">the</span> <span m="3888410">extra</span> <span m="3888650">reductions</span> <span m="3888975">come</span> <span m="3889300">in.</span> <span m="3889630">Because at</span> <span m="3889960">every</span> <span m="3890390">multiply,</span> <span m="3892130">the</span> <span m="3892730">extra</span> <span m="3893220">reductions</span> <span m="3894420">are</span> <span m="3894600">going</span> <span m="3894850">to</span> <span m="3895105">be</span> <span m="3895360">proportional</span> <span m="3896900">to</span> <span m="3898050">the</span> <span m="3898325">thing</span> <span m="3898600">we're</span> <span m="3898840">exponentiating</span> <span m="3900140">mod q.</span> <span m="3900950">[INAUDIBLE]</span> <span m="3901395">just</span> <span m="3901840">plug</span> <span m="3902220">in</span> <span m="3902350">the</span> <span m="3902550">formula</span> <span m="3903640">over</span> <span m="3903980">here,</span> <span m="3904620">the</span> <span m="3904750">probability</span> <span m="3905220">extra</span> <span m="3905710">reductions</span> <span m="3905810">is</span> <span m="3905910">going</span> <span m="3906010">to</span> <span m="3906110">be</span> <span m="3906210">proportional</span> <span m="3906840">to</span> <span m="3906930">this</span> <span m="3907030">value</span> <span m="3907520">of</span> <span m="3907820">c0</span> <span m="3909360">prime</span> <span m="3910905">mod</span> <span m="3911170">q</span> <span m="3913160">divided</span> <span m="3913730">by</span> <span m="3914680">2R.</span> <span m="3919200">So</span> <span m="3919570">this is</span> <span m="3919810">where the</span> <span m="3920440">really</span> <span m="3920933">timing sensitive</span> <span m="3921426">bit is</span> <span m="3921919">going to</span> <span m="3922412">come in.</span> <span m="3922905">And there are</span> <span m="3923398">actually two</span> <span m="3923891">effects here.</span> <span m="3924384">There's this</span> <span m="3924877">Karatsuba</span> <span m="3925370">versus</span> <span m="3925870">normal</span> <span m="3926330">choice.</span> <span m="3927425">And</span> <span m="3927740">then</span> <span m="3927990">there's</span> <span m="3928130">the</span> <span m="3928300">number</span> <span m="3928610">of</span> <span m="3928850">extra</span> <span m="3929285">reductions</span> <span m="3929720">you're going to</span> <span m="3930152">be making.</span> </p>
<p><span m="3932750">So</span> <span m="3932920">we'll</span> <span m="3933110">see</span> <span m="3933250">how</span> <span m="3933420">we</span> <span m="3933490">exploit this</span> <span m="3933960">in</span> <span m="3934090">a</span> <span m="3934130">second,</span> <span m="3934480">but</span> <span m="3934750">now</span> <span m="3934800">that you</span> <span m="3935140">get</span> <span m="3935310">this</span> <span m="3935470">result</span> <span m="3936340">for</span> <span m="3936510">mod q,</span> <span m="3936800">you're</span> <span m="3937280">going</span> <span m="3937380">to</span> <span m="3937440">get</span> <span m="3937560">a</span> <span m="3937620">similar</span> <span m="3937980">result</span> <span m="3938460">mod</span> <span m="3938830">p,</span> <span m="3939560">you can</span> <span m="3939920">finally</span> <span m="3940710">recombine</span> <span m="3941450">these</span> <span m="3941710">guys</span> <span m="3942800">from</span> <span m="3943350">the</span> <span m="3943500">top</span> <span m="3943780">and</span> <span m="3943870">the</span> <span m="3943950">bottom</span> <span m="3944815">and</span> <span m="3945090">use</span> <span m="3945410">CRT.</span> <span m="3946660">And what</span> <span m="3946880">you</span> <span m="3946940">get</span> <span m="3947110">out</span> <span m="3947450">from</span> <span m="3947570">CRT</span> <span m="3948630">is</span> <span m="3949750">actually--</span> <span m="3949870">sorry</span> <span m="3950230">I</span> <span m="3950590">guess</span> <span m="3950710">we</span> <span m="3950940">need</span> <span m="3951820">a</span> <span m="3952080">first</span> <span m="3952310">convert it</span> <span m="3952810">back</span> <span m="3952960">down</span> <span m="3953794">into</span> <span m="3954630">non</span> <span m="3955110">Montgomery</span> <span m="3955570">form.</span> <span m="3956760">So</span> <span m="3956970">we're</span> <span m="3957080">going</span> <span m="3957210">to</span> <span m="3957620">get</span> <span m="3959000">first,</span> <span m="3959960">we're</span> <span m="3960380">going</span> <span m="3960480">to</span> <span m="3960540">get</span> <span m="3961070">c0</span> <span m="3961970">prime</span> <span m="3963040">to</span> <span m="3963417">the</span> <span m="3963794">d</span> <span m="3964550">divided</span> <span m="3965140">by</span> <span m="3966110">R</span> <span m="3967730">mod</span> <span m="3968005">q.</span> </p>
<p><span m="3969620">And</span> <span m="3969760">this</span> <span m="3969940">thing,</span> <span m="3971130">because</span> <span m="3971460">c0</span> <span m="3971900">prime</span> <span m="3972460">was</span> <span m="3972840">c0</span> <span m="3973190">times</span> <span m="3973480">R</span> <span m="3974600">mod</span> <span m="3974670">q,</span> <span m="3975160">if</span> <span m="3975650">we do</span> <span m="3976140">this</span> <span m="3976630">then</span> <span m="3976770">we're</span> <span m="3976870">going</span> <span m="3976990">to</span> <span m="3977170">get</span> <span m="3977400">back</span> <span m="3977720">out</span> <span m="3978490">our</span> <span m="3978850">value</span> <span m="3979260">of</span> <span m="3979520">c</span> <span m="3979820">to</span> <span m="3980120">the</span> <span m="3980510">d</span> <span m="3981290">mod</span> <span m="3981710">q.</span> <span m="3983110">And</span> <span m="3983385">we</span> <span m="3983660">get</span> <span m="3984250">c</span> <span m="3984650">to the d</span> <span m="3984955">here,</span> <span m="3985260">we're</span> <span m="3985370">going</span> <span m="3985470">to</span> <span m="3985540">get</span> <span m="3985700">to</span> <span m="3985940">c</span> <span m="3986440">to the</span> <span m="3986730">d</span> <span m="3987070">mod p</span> <span m="3987290">on</span> <span m="3987655">the bottom</span> <span m="3988020">version</span> <span m="3988290">of this</span> <span m="3988560">pipeline.</span> <span m="3989700">And</span> <span m="3990180">we can use</span> <span m="3990440">CRT</span> <span m="3991260">to get</span> <span m="3991580">the</span> <span m="3991790">value</span> <span m="3992060">of</span> <span m="3992370">c to</span> <span m="3992440">the</span> <span m="3992775">d</span> <span m="3993710">mod</span> <span m="3994185">m.</span> <span m="3995220">Sorry</span> <span m="3995390">for</span> <span m="3995690">the</span> <span m="3995940">small</span> <span m="3996310">type</span> <span m="3996640">here,</span> <span m="3996995">or</span> <span m="3997350">font size.</span> <span m="3998060">But</span> <span m="3998590">roughly</span> <span m="3998930">it's</span> <span m="3999110">the</span> <span m="3999260">same</span> <span m="3999430">thing</span> <span m="3999755">we're</span> <span m="4000080">expecting</span> <span m="4000470">here.</span> <span m="4000680">We can</span> <span m="4000870">finally</span> <span m="4001210">get</span> <span m="4001360">our</span> <span m="4001460">result.</span> <span m="4002390">And we</span> <span m="4002540">get</span> <span m="4002870">our message,</span> <span m="4003495">m.</span> </p>
<p><span m="4004305">So</span> <span m="4004710">the</span> <span m="4004990">server</span> <span m="4005470">takes</span> <span m="4005720">an</span> <span m="4005820">incoming</span> <span m="4006120">packet</span> <span m="4006420">that</span> <span m="4006760">it</span> <span m="4006940">gets,</span> <span m="4007900">runs</span> <span m="4008210">it</span> <span m="4008490">through</span> <span m="4008750">this whole</span> <span m="4009100">pipeline,</span> <span m="4011000">does</span> <span m="4011490">two</span> <span m="4011640">parts of this</span> <span m="4012140">pipeline,</span> <span m="4013134">ends up</span> <span m="4013578">with</span> <span m="4014022">a decrypted</span> <span m="4014466">message</span> <span m="4014910">m</span> <span m="4015580">that's</span> <span m="4015790">equal</span> <span m="4016060">c to</span> <span m="4016355">the</span> <span m="4016650">d</span> <span m="4016940">mod m.</span> <span m="4017627">And</span> <span m="4018024">then</span> <span m="4018421">it's</span> <span m="4018820">going to</span> <span m="4019050">check the</span> <span m="4019210">padding</span> <span m="4019465">of this</span> <span m="4019720">message.</span> <span m="4020682">And</span> <span m="4021134">in</span> <span m="4021586">this particular</span> <span m="4022040">attack,</span> <span m="4022300">because</span> <span m="4022560">we're</span> <span m="4022940">going to</span> <span m="4023320">carefully</span> <span m="4023780">construct</span> <span m="4024330">this</span> <span m="4024550">value</span> <span m="4024670">c,</span> <span m="4025320">the</span> <span m="4025460">padding</span> <span m="4025855">is</span> <span m="4026250">going to</span> <span m="4026430">actually</span> <span m="4026860">not</span> <span m="4027120">match</span> <span m="4027465">up.</span> <span m="4027810">We're</span> <span m="4027940">going</span> <span m="4028040">to</span> <span m="4028410">choose</span> <span m="4028930">the</span> <span m="4029060">value</span> <span m="4029460">c</span> <span m="4029970">according</span> <span m="4030290">to</span> <span m="4030360">some</span> <span m="4030550">other</span> <span m="4030760">heuristics</span> <span m="4031260">that</span> <span m="4031450">aren't</span> <span m="4032820">encrypting</span> <span m="4032970">a</span> <span m="4033170">real</span> <span m="4033470">message with the</span> <span m="4033790">correct padding.</span> </p>
<p><span m="4034754">So the</span> <span m="4035236">padding</span> <span m="4035718">is going to be</span> <span m="4036200">a mismatch,</span> <span m="4036510">and</span> <span m="4036820">the</span> <span m="4036930">server's</span> <span m="4037310">going</span> <span m="4037653">to need it</span> <span m="4037996">to record</span> <span m="4038340">an</span> <span m="4038423">error</span> <span m="4038506">back</span> <span m="4038590">to</span> <span m="4038673">the</span> <span m="4038756">client.</span> <span m="4038840">[? And it pulls ?]</span> <span m="4039764">the</span> <span m="4040226">connection.</span> <span m="4042080">And</span> <span m="4042410">that's</span> <span m="4042740">the</span> <span m="4043070">time that</span> <span m="4043375">we're going</span> <span m="4043680">to measure</span> <span m="4044370">to</span> <span m="4044460">figure</span> <span m="4044700">out</span> <span m="4044880">how long</span> <span m="4045290">this</span> <span m="4045420">whole</span> <span m="4045700">pipeline</span> <span m="4046170">took.</span> <span m="4048230">Makes</span> <span m="4048600">sense?</span> <span m="4049490">Questions</span> <span m="4049780">about</span> <span m="4050100">this</span> <span m="4050470">pipeline</span> <span m="4050570">and putting</span> <span m="4051070">all the</span> <span m="4051500">optimizations</span> <span m="4052030">together?</span> </p>
<p><span m="4054396">AUDIENCE:</span> <span m="4054875">[INAUDIBLE]</span> </p>
<p><span m="4061590">PROFESSOR: Yeah,</span> <span m="4061950">you're</span> <span m="4062310">probably</span> <span m="4062670">right.</span> <span m="4063070">Yes,</span> <span m="4063480">c1</span> <span m="4063590">to</span> <span m="4063860">the</span> <span m="4064120">d,</span> <span m="4064395">c0</span> <span m="4064670">to</span> <span m="4064770">the</span> <span m="4065185">d.</span> <span m="4065600">Yeah,</span> <span m="4065770">this</span> <span m="4065920">is</span> <span m="4066270">c0.</span> <span m="4066620">Yeah,</span> <span m="4067180">correct.</span> </p>
<p><span m="4069287">AUDIENCE:</span> <span m="4069774">When you divide by r</span> <span m="4070748">[INAUDIBLE],</span> <span m="4071722">isn't there</span> <span m="4072696">a</span> <span m="4073670">[INAUDIBLE]</span> <span m="4074157">on how</span> <span m="4074644">many</span> <span m="4075131">q's</span> <span m="4076105">you have to</span> <span m="4076592">have</span> <span m="4079514">to get the</span> <span m="4080001">[? little bit ?]</span> <span m="4080488">to be 0?</span> <span m="4080975">[INAUDIBLE].</span> </p>
<p><span m="4083410">PROFESSOR: Yeah,</span> <span m="4083920">so</span> <span m="4084040">there</span> <span m="4084250">might</span> <span m="4084480">be</span> <span m="4084620">extra</span> <span m="4084900">reductions</span> <span m="4085160">in</span> <span m="4085420">this</span> <span m="4085610">final</span> <span m="4086550">phase</span> <span m="4086910">as well.</span> <span m="4087190">You're</span> <span m="4087330">right.</span> <span m="4087590">So</span> <span m="4087680">potentially,</span> <span m="4088620">we</span> <span m="4088710">have</span> <span m="4088920">do this</span> <span m="4089300">divide</span> <span m="4089610">by</span> <span m="4089760">R</span> <span m="4090180">correctly.</span> <span m="4091220">So</span> <span m="4091390">we</span> <span m="4091510">probably</span> <span m="4091760">have</span> <span m="4091910">to</span> <span m="4091990">do</span> <span m="4092090">exactly</span> <span m="4092500">the</span> <span m="4092620">same</span> <span m="4092910">thing</span> <span m="4093300">as</span> <span m="4093400">we</span> <span m="4093550">saw</span> <span m="4094080">for</span> <span m="4094430">the</span> <span m="4094780">Montgomery</span> <span m="4095230">reductions</span> <span m="4095560">here.</span> <span m="4096399">When</span> <span m="4096609">we</span> <span m="4096729">do</span> <span m="4096870">this</span> <span m="4097460">divide</span> <span m="4097779">by</span> <span m="4097930">R</span> <span m="4098260">to convert</span> <span m="4098540">it</span> <span m="4098649">back.</span> <span m="4099649">So</span> <span m="4100590">it's</span> <span m="4100729">not</span> <span m="4100890">clear</span> <span m="4101130">exactly</span> <span m="4101399">how</span> <span m="4101674">many qs</span> <span m="4101950">we</span> <span m="4102040">should</span> <span m="4102180">add.</span> <span m="4102560">We should</span> <span m="4102710">figure</span> <span m="4102960">out</span> <span m="4103050">how</span> <span m="4103170">many</span> <span m="4103390">qs</span> <span m="4103640">to</span> <span m="4103720">add,</span> <span m="4104050">add</span> <span m="4104399">that</span> <span m="4104880">many,</span> <span m="4105250">kill</span> <span m="4105750">the</span> <span m="4106000">low</span> <span m="4106319">zeros,</span> <span m="4107130">and</span> <span m="4107270">then</span> <span m="4107490">do</span> <span m="4107600">mod</span> <span m="4107920">q</span> <span m="4108069">again,</span> <span m="4108329">maybe an</span> <span m="4108590">extra</span> <span m="4108970">reduction.</span> <span m="4109680">You're</span> <span m="4109850">absolutely</span> <span m="4110069">right,</span> <span m="4110250">this</span> <span m="4110350">is</span> <span m="4110819">exactly</span> <span m="4111180">the</span> <span m="4111260">same</span> <span m="4111490">kind</span> <span m="4111720">of</span> <span m="4111830">divide</span> <span m="4112120">by</span> <span m="4112270">R</span> <span m="4112420">mod</span> <span m="4112660">q</span> <span m="4113406">as</span> <span m="4113779">we</span> <span m="4113880">do</span> <span m="4114069">for</span> <span m="4114300">every</span> <span m="4114810">Montgomery</span> <span m="4115300">multiplication</span> <span m="4115750">step.</span> <span m="4118229">Make</span> <span m="4118350">sense?</span> <span m="4120689">Any</span> <span m="4120830">other</span> <span m="4121080">questions?</span> </p>
<p><span m="4123569">All</span> <span m="4123670">right.</span> <span m="4124160">So</span> <span m="4124260">how</span> <span m="4124399">do</span> <span m="4124510">you</span> <span m="4124600">exploit</span> <span m="4124920">this?</span> <span m="4125240">How</span> <span m="4125420">does</span> <span m="4125689">an</span> <span m="4125800">attacker</span> <span m="4126270">actually</span> <span m="4127069">figure</span> <span m="4127380">out</span> <span m="4127689">what</span> <span m="4127930">the</span> <span m="4128460">secret</span> <span m="4128735">key</span> <span m="4129010">of</span> <span m="4129220">the</span> <span m="4129350">server</span> <span m="4129710">is</span> <span m="4129840">by</span> <span m="4129950">measuring</span> <span m="4130380">the</span> <span m="4130510">time</span> <span m="4131420">of</span> <span m="4131630">this</span> <span m="4131800">entire</span> <span m="4132170">pipeline?</span> <span m="4134300">So</span> <span m="4134420">these</span> <span m="4134540">guys</span> <span m="4135300">have</span> <span m="4135500">a</span> <span m="4135819">plan</span> <span m="4136490">that</span> <span m="4137700">basically</span> <span m="4138160">involves</span> <span m="4138810">guessing</span> <span m="4139720">one</span> <span m="4140019">bit</span> <span m="4140319">of</span> <span m="4140779">the</span> <span m="4141460">private</span> <span m="4142090">key</span> <span m="4142500">at</span> <span m="4142689">a time.</span> <span m="4143810">And</span> <span m="4144100">what</span> <span m="4144220">they</span> <span m="4144310">mean</span> <span m="4144810">actually</span> <span m="4144950">by guessing</span> <span m="4145330">the</span> <span m="4145479">private</span> <span m="4145939">key</span> <span m="4146620">is</span> <span m="4147060">that</span> <span m="4147979">you</span> <span m="4148200">might</span> <span m="4148529">think the</span> <span m="4148710">private</span> <span m="4149220">key</span> <span m="4149520">is</span> <span m="4149660">this</span> <span m="4149939">encryption</span> <span m="4150290">exponent</span> <span m="4150960">d,</span> <span m="4151710">because</span> <span m="4152420">actually</span> <span m="4152679">you know</span> <span m="4152939">e,</span> <span m="4153332">you know</span> <span m="4153725">n,</span> <span m="4154120">that's</span> <span m="4154310">the</span> <span m="4154569">public</span> <span m="4154880">key.</span> <span m="4155160">The only</span> <span m="4155300">think you</span> <span m="4155470">don't</span> <span m="4155670">know</span> <span m="4155850">is</span> <span m="4156130">d.</span> <span m="4156849">But</span> <span m="4157288">in fact,</span> <span m="4157729">in this</span> <span m="4157810">attack</span> <span m="4158270">they</span> <span m="4158380">don't</span> <span m="4158529">go for</span> <span m="4158970">the exponent</span> <span m="4159490">d</span> <span m="4159785">directly,</span> <span m="4160080">that's</span> <span m="4160220">a little</span> <span m="4160370">bit</span> <span m="4160439">harder</span> <span m="4160840">to</span> <span m="4160920">guess.</span> </p>
<p><span m="4161810">Instead,</span> <span m="4161930">what</span> <span m="4162160">they're going</span> <span m="4162620">to go</span> <span m="4162830">for</span> <span m="4163580">is</span> <span m="4163899">the</span> <span m="4164149">value</span> <span m="4164630">q</span> <span m="4164979">or</span> <span m="4165319">the</span> <span m="4165540">value p,</span> <span m="4165890">doesn't really</span> <span m="4166100">matter</span> <span m="4166340">which</span> <span m="4166660">one.</span> <span m="4167649">Once</span> <span m="4167950">you</span> <span m="4168069">guess</span> <span m="4168600">what</span> <span m="4168840">the</span> <span m="4168920">value</span> <span m="4169330">p</span> <span m="4169720">or</span> <span m="4169899">q</span> <span m="4170180">is,</span> <span m="4171090">then</span> <span m="4171229">you</span> <span m="4171359">can</span> <span m="4171850">give</span> <span m="4172189">an n,</span> <span m="4172464">you can</span> <span m="4172740">factor</span> <span m="4172800">in the</span> <span m="4173300">p</span> <span m="4173609">times</span> <span m="4173830">q.</span> <span m="4174662">Then</span> <span m="4175080">if you</span> <span m="4175350">know</span> <span m="4175819">p times q,</span> <span m="4176290">you can</span> <span m="4176640">actually--</span> <span m="4177470">sorry--</span> <span m="4177840">if</span> <span m="4178080">you know</span> <span m="4178445">the values of</span> <span m="4178810">p and</span> <span m="4179080">q, you</span> <span m="4179359">can</span> <span m="4179859">compute</span> <span m="4180240">that phi function</span> <span m="4180700">we</span> <span m="4180810">saw</span> <span m="4180950">before.</span> <span m="4181729">That's</span> <span m="4182120">going to</span> <span m="4182420">allow you</span> <span m="4182720">to</span> <span m="4183100">get</span> <span m="4183300">the</span> <span m="4183370">value</span> <span m="4183660">d</span> <span m="4184290">from</span> <span m="4184580">the</span> <span m="4184960">value</span> <span m="4185340">e.</span> <span m="4185979">So</span> <span m="4186120">this</span> <span m="4186250">factorization</span> <span m="4186899">of the</span> <span m="4187020">value</span> <span m="4187279">m</span> <span m="4187560">is</span> <span m="4188170">hugely</span> <span m="4188490">important,</span> <span m="4188750">it should</span> <span m="4189100">be secret</span> <span m="4189450">for</span> <span m="4189793">RSA</span> <span m="4190136">to</span> <span m="4190479">remain</span> <span m="4190819">secure.</span> <span m="4191985">So these guys</span> <span m="4192450">are actually</span> <span m="4192660">going to</span> <span m="4193100">go</span> <span m="4193840">and</span> <span m="4194060">try</span> <span m="4194290">to</span> <span m="4194360">guess</span> <span m="4194810">what</span> <span m="4194990">the</span> <span m="4195060">value</span> <span m="4195350">of</span> <span m="4195520">q</span> <span m="4195830">is</span> <span m="4196540">by</span> <span m="4196800">timing</span> <span m="4197230">this</span> <span m="4197714">pipeline.</span> <span m="4199650">All right.</span> </p>
<p><span m="4200070">So</span> <span m="4200505">how</span> <span m="4200940">do</span> <span m="4201070">these guys</span> <span m="4201230">actually</span> <span m="4201900">do</span> <span m="4202100">it?</span> <span m="4202410">Well,</span> <span m="4205320">they</span> <span m="4206530">construct</span> <span m="4207650">carefully</span> <span m="4208200">chosen</span> <span m="4208690">inputs,</span> <span m="4209680">c,</span> <span m="4210280">into</span> <span m="4210480">this</span> <span m="4210760">pipeline</span> <span m="4211240">and--</span> <span m="4212330">I guess</span> <span m="4212540">I</span> <span m="4212570">keep</span> <span m="4212800">saying</span> <span m="4213160">they</span> <span m="4213720">keep</span> <span m="4214150">measuring</span> <span m="4214560">the</span> <span m="4215030">time</span> <span m="4215780">for</span> <span m="4215910">this</span> <span m="4216130">guy.</span> <span m="4216800">But</span> <span m="4217530">the</span> <span m="4217790">particular,</span> <span m="4220010">well,</span> <span m="4221965">there's</span> <span m="4222220">two</span> <span m="4222420">parts</span> <span m="4222675">of the</span> <span m="4222930">attack,</span> <span m="4223170">you</span> <span m="4223220">have</span> <span m="4223505">to</span> <span m="4223790">bootstrap</span> <span m="4224210">it a little</span> <span m="4224480">bit</span> <span m="4224630">to guess</span> <span m="4224890">the</span> <span m="4224980">first</span> <span m="4225280">couple</span> <span m="4225520">of</span> <span m="4225680">bits.</span> <span m="4226390">And</span> <span m="4226510">then</span> <span m="4226660">once</span> <span m="4226830">you</span> <span m="4226900">have</span> <span m="4227040">the</span> <span m="4227130">first</span> <span m="4227370">couple of</span> <span m="4227770">bits,</span> <span m="4228060">you</span> <span m="4228355">can</span> <span m="4228650">I</span> <span m="4228670">guess</span> <span m="4228850">the</span> <span m="4228940">next</span> <span m="4229390">bit.</span> <span m="4229600">So</span> <span m="4230010">let</span> <span m="4230230">me</span> <span m="4230640">not</span> <span m="4230970">say</span> <span m="4231160">exactly</span> <span m="4231550">how</span> <span m="4231710">they</span> <span m="4231810">guess</span> <span m="4232050">the</span> <span m="4232130">first</span> <span m="4232500">couple</span> <span m="4232790">of</span> <span m="4232990">bits</span> <span m="4234540">because</span> <span m="4235000">it's actually</span> <span m="4235080">much more</span> <span m="4235190">interesting</span> <span m="4235510">to</span> <span m="4235760">see how</span> <span m="4236010">they guess</span> <span m="4236270">the</span> <span m="4236340">next</span> <span m="4236690">bit.</span> <span m="4236955">And</span> <span m="4237220">then we'll</span> <span m="4237530">come</span> <span m="4237710">back</span> <span m="4238090">if we</span> <span m="4238180">have</span> <span m="4238330">time</span> <span m="4238570">to</span> <span m="4238670">look</span> <span m="4238870">at</span> <span m="4238950">how</span> <span m="4239140">they</span> <span m="4239280">guess</span> <span m="4239750">the</span> <span m="4239820">first</span> <span m="4240020">couple</span> <span m="4240230">of</span> <span m="4240300">bits</span> <span m="4240500">[? at this ?]</span> <span m="4240630">in the paper.</span> </p>
<p><span m="4241970">But basically,</span> <span m="4242670">suppose</span> <span m="4243070">you have a</span> <span m="4243280">guess</span> <span m="4243670">g</span> <span m="4244720">about</span> <span m="4245600">what</span> <span m="4245820">the</span> <span m="4245900">bits</span> <span m="4246270">are</span> <span m="4246540">of</span> <span m="4246760">this</span> <span m="4246950">value</span> <span m="4247450">q.</span> <span m="4248216">So</span> <span m="4248600">you</span> <span m="4248790">know</span> <span m="4249070">that</span> <span m="4249310">q</span> <span m="4250320">has</span> <span m="4250570">some</span> <span m="4251180">bits,</span> <span m="4252350">g0,</span> <span m="4253310">g1,</span> <span m="4254620">g2,</span> <span m="4255360">et</span> <span m="4255790">cetera.</span> <span m="4256820">And</span> <span m="4259130">actually,</span> <span m="4259930">I</span> <span m="4260070">guess</span> <span m="4260360">these</span> <span m="4260600">are</span> <span m="4260710">not</span> <span m="4261000">even</span> <span m="4261310">gs,</span> <span m="4261720">these are</span> <span m="4261940">real</span> <span m="4262180">q</span> <span m="4262455">bits,</span> <span m="4262730">so</span> <span m="4262880">let</span> <span m="4263030">me</span> <span m="4263520">write</span> <span m="4263690">it as</span> <span m="4264160">that.</span> <span m="4264990">So you</span> <span m="4265110">know</span> <span m="4265730">tat</span> <span m="4266790">q bit</span> <span m="4267190">0</span> <span m="4268440">q bit</span> <span m="4268750">1,</span> <span m="4269500">q bit</span> <span m="4269905">2,</span> <span m="4270310">these</span> <span m="4270715">are</span> <span m="4271120">the</span> <span m="4271260">highest</span> <span m="4271580">bits</span> <span m="4271840">of</span> <span m="4272180">q.</span> <span m="4272690">And</span> <span m="4272955">then</span> <span m="4273220">you're</span> <span m="4273440">trying to</span> <span m="4273500">guess</span> <span m="4273880">lower</span> <span m="4274260">and lower</span> <span m="4274610">bits.</span> <span m="4275455">So</span> <span m="4275710">suppose</span> <span m="4275830">you</span> <span m="4276200">know</span> <span m="4276300">the value</span> <span m="4276620">of</span> <span m="4276940">q</span> <span m="4277570">up</span> <span m="4277870">to</span> <span m="4278260">bit</span> <span m="4278970">j.</span> <span m="4280275">And</span> <span m="4280710">from</span> <span m="4280870">that</span> <span m="4281050">point</span> <span m="4281230">on,</span> <span m="4281370">your</span> <span m="4281570">guess</span> <span m="4281850">is actually</span> <span m="4282230">all</span> <span m="4282480">0.</span> <span m="4282750">You</span> <span m="4282850">have</span> <span m="4283020">no</span> <span m="4283100">idea</span> <span m="4283360">what</span> <span m="4283840">the other</span> <span m="4283990">bits</span> <span m="4284350">are.</span> </p>
<p><span m="4286280">So</span> <span m="4286970">these</span> <span m="4287180">guys</span> <span m="4287470">are</span> <span m="4287580">going</span> <span m="4287740">to</span> <span m="4287930">try</span> <span m="4288330">to</span> <span m="4289910">get</span> <span m="4290980">this</span> <span m="4291540">guess</span> <span m="4291900">g</span> <span m="4293480">into</span> <span m="4293620">this</span> <span m="4294160">place</span> <span m="4294470">in</span> <span m="4294560">the</span> <span m="4294650">pipeline.</span> <span m="4295760">Because</span> <span m="4296060">this</span> <span m="4296240">is</span> <span m="4296390">where</span> <span m="4296940">there are</span> <span m="4297240">two</span> <span m="4297440">tiny</span> <span m="4297850">effects:</span> <span m="4298280">this</span> <span m="4298430">choice</span> <span m="4298650">of</span> <span m="4298750">Karatsuba</span> <span m="4299140">versus</span> <span m="4299630">normal</span> <span m="4299940">multiplication.</span> <span m="4301010">And</span> <span m="4301180">this</span> <span m="4301660">choice of,</span> <span m="4302390">or</span> <span m="4302560">this</span> <span m="4302910">a</span> <span m="4303660">different</span> <span m="4303970">number</span> <span m="4304230">of</span> <span m="4304470">extra</span> <span m="4304750">reductions</span> <span m="4305030">depending</span> <span m="4305420">on</span> <span m="4305550">the</span> <span m="4305610">value</span> <span m="4306470">c0</span> <span m="4307090">prime.</span> <span m="4308436">Sp</span> <span m="4308870">they're</span> <span m="4309030">going</span> <span m="4309180">to</span> <span m="4309400">actually try</span> <span m="4309540">to</span> <span m="4309620">get</span> <span m="4309980">two</span> <span m="4310280">different</span> <span m="4310740">guess</span> <span m="4311020">values</span> <span m="4311480">into</span> <span m="4311690">that</span> <span m="4312010">place in the</span> <span m="4312310">pipeline.</span> <span m="4313330">One</span> <span m="4313670">that</span> <span m="4313850">looks</span> <span m="4314050">like</span> <span m="4314310">this,</span> <span m="4315790">and</span> <span m="4316290">one</span> <span m="4317130">that</span> <span m="4317385">they</span> <span m="4317640">call</span> <span m="4318120">g</span> <span m="4318565">high,</span> <span m="4319500">which</span> <span m="4319810">is</span> <span m="4319900">all</span> <span m="4320130">the</span> <span m="4320220">same</span> <span m="4320920">high</span> <span m="4321230">bits,</span> <span m="4322780">q2</span> <span m="4324190">qj.</span> <span m="4325110">And</span> <span m="4325510">for</span> <span m="4325600">the</span> <span m="4325720">next</span> <span m="4326000">bit,</span> <span m="4326250">which</span> <span m="4326350">they</span> <span m="4326410">don't</span> <span m="4326700">know,</span> <span m="4327440">[? you ?]</span> <span m="4327840">guess</span> <span m="4328240">g</span> <span m="4328470">is going</span> <span m="4328580">to</span> <span m="4328620">have</span> <span m="4328830">0,</span> <span m="4329750">g high</span> <span m="4330130">is</span> <span m="4330230">going to</span> <span m="4330410">have</span> <span m="4330470">a bit</span> <span m="4330780">1</span> <span m="4331010">here</span> <span m="4331970">and</span> <span m="4332260">all</span> <span m="4332490">zeros</span> <span m="4332540">later</span> <span m="4333150">on.</span> </p>
<p><span m="4334906">So</span> <span m="4335360">how does</span> <span m="4335560">it</span> <span m="4335720">help</span> <span m="4335970">these</span> <span m="4336200">guys</span> <span m="4336510">figure</span> <span m="4336770">out</span> <span m="4336940">what's</span> <span m="4337120">going</span> <span m="4337370">on?</span> <span m="4339040">So</span> <span m="4339150">there are</span> <span m="4339580">really</span> <span m="4339810">two</span> <span m="4340390">ways</span> <span m="4341140">you can</span> <span m="4341200">think</span> <span m="4341400">of</span> <span m="4341500">it.</span> <span m="4342120">Suppose</span> <span m="4342730">that</span> <span m="4343070">we</span> <span m="4343970">get</span> <span m="4344190">this</span> <span m="4344390">guess</span> <span m="4344815">g</span> <span m="4345480">to</span> <span m="4345670">be</span> <span m="4346200">the</span> <span m="4346290">value</span> <span m="4346630">of</span> <span m="4346750">c0</span> <span m="4347560">prime.</span> <span m="4348930">We</span> <span m="4349210">can</span> <span m="4349310">think</span> <span m="4349580">of</span> <span m="4350020">g</span> <span m="4351075">and</span> <span m="4351570">g</span> <span m="4351890">high</span> <span m="4352210">being</span> <span m="4352500">the</span> <span m="4352770">c0</span> <span m="4353130">prime</span> <span m="4353480">value</span> <span m="4354350">on</span> <span m="4354530">that</span> <span m="4354700">left</span> <span m="4354960">board</span> <span m="4355390">over there.</span> <span m="4356540">It's</span> <span m="4356650">actually</span> <span m="4356830">fairly</span> <span m="4357100">straightforward</span> <span m="4357700">to</span> <span m="4357790">do</span> <span m="4357880">this</span> <span m="4358330">because</span> <span m="4358900">c0</span> <span m="4359460">prime</span> <span m="4360510">is</span> <span m="4361660">pretty</span> <span m="4361740">deterministically</span> <span m="4362460">computed</span> <span m="4362950">from</span> <span m="4363500">the</span> <span m="4363660">input</span> <span m="4363950">ciphertext</span> <span m="4364215">c0.</span> <span m="4364480">You</span> <span m="4364920">just</span> <span m="4365150">multiply</span> <span m="4365650">it by</span> <span m="4365800">R.</span> <span m="4366200">So,</span> <span m="4366600">in order</span> <span m="4367030">for them</span> <span m="4367200">to</span> <span m="4367270">get</span> <span m="4367480">some</span> <span m="4367640">value</span> <span m="4367930">to</span> <span m="4368220">here,</span> <span m="4369240">as a</span> <span m="4369300">guess,</span> <span m="4370600">they</span> <span m="4370740">just</span> <span m="4370960">need</span> <span m="4371210">to</span> <span m="4371930">take</span> <span m="4372380">their</span> <span m="4372800">guess</span> <span m="4373370">and</span> <span m="4373590">first</span> <span m="4373850">divide it</span> <span m="4374310">by</span> <span m="4374490">R,</span> <span m="4375060">so</span> <span m="4375330">divide it</span> <span m="4375780">by</span> <span m="4375900">2</span> <span m="4376200">to the</span> <span m="4376460">512</span> <span m="4376960">mod</span> <span m="4377340">something.</span> <span m="4378340">And</span> <span m="4378530">then,</span> <span m="4379330">they're going</span> <span m="4379490">to inject</span> <span m="4379910">it</span> <span m="4380330">back.</span> <span m="4381610">And</span> <span m="4381750">the</span> <span m="4381830">server's</span> <span m="4382190">going</span> <span m="4382320">to</span> <span m="4382370">multiply</span> <span m="4382850">it by</span> <span m="4383060">R,</span> <span m="4384260">and</span> <span m="4384520">then</span> <span m="4385233">off</span> <span m="4385686">you go.</span> <span m="4386490">Make</span> <span m="4386963">sense?</span> <span m="4387910">All</span> <span m="4387970">right.</span> </p>
<p><span m="4389490">So</span> <span m="4390340">suppose</span> <span m="4390800">that</span> <span m="4390850">we</span> <span m="4391155">manage</span> <span m="4391460">to</span> <span m="4391750">get</span> <span m="4392010">our</span> <span m="4392510">particular</span> <span m="4392990">chosen</span> <span m="4393640">integer</span> <span m="4393730">value</span> <span m="4394015">into</span> <span m="4394300">that</span> <span m="4394550">c0</span> <span m="4394650">you're</span> <span m="4395140">prime</span> <span m="4395450">spot.</span> <span m="4396650">So</span> <span m="4396760">what's</span> <span m="4396890">going</span> <span m="4397030">to</span> <span m="4397110">be</span> <span m="4397280">the</span> <span m="4397470">time</span> <span m="4398150">to</span> <span m="4399080">compute</span> <span m="4399930">c0</span> <span m="4400150">prime</span> <span m="4400490">to</span> <span m="4400810">the</span> <span m="4400920">d</span> <span m="4401230">mod q?</span> <span m="4402522">So</span> <span m="4402880">there are</span> <span m="4403140">two</span> <span m="4403310">possible</span> <span m="4405236">options</span> <span m="4405620">here</span> <span m="4406290">where</span> <span m="4406780">q</span> <span m="4406940">falls</span> <span m="4407270">in this</span> <span m="4407490">picture.</span> <span m="4408180">So</span> <span m="4408290">it</span> <span m="4408420">might</span> <span m="4408690">be</span> <span m="4409220">that</span> <span m="4410230">q</span> <span m="4411020">is</span> <span m="4411880">between</span> <span m="4412240">these</span> <span m="4412440">two</span> <span m="4412560">values.</span> <span m="4413920">Because</span> <span m="4414340">the</span> <span m="4415600">next</span> <span m="4416260">bit of</span> <span m="4416360">q</span> <span m="4416590">is</span> <span m="4416800">0.</span> <span m="4417630">So</span> <span m="4417810">this</span> <span m="4418030">value</span> <span m="4418390">is</span> <span m="4418452">going</span> <span m="4418514">to</span> <span m="4418576">be</span> <span m="4418638">less</span> <span m="4418700">than</span> <span m="4419010">q,</span> <span m="4419170">but</span> <span m="4419330">this</span> <span m="4419500">guy's</span> <span m="4419770">going</span> <span m="4419860">to</span> <span m="4419920">be</span> <span m="4420010">greater</span> <span m="4420350">than</span> <span m="4420690">q.</span> <span m="4421670">So</span> <span m="4422100">this</span> <span m="4422330">happens if</span> <span m="4422700">the</span> <span m="4422850">next</span> <span m="4423190">bit</span> <span m="4423660">of</span> <span m="4423780">q0</span> <span m="4424680">or</span> <span m="4424890">it</span> <span m="4424970">might</span> <span m="4425200">be</span> <span m="4425310">that</span> <span m="4425690">q</span> <span m="4426070">lies</span> <span m="4426990">above</span> <span m="4427355">both</span> <span m="4427720">of</span> <span m="4427760">these</span> <span m="4427970">values</span> <span m="4428340">if</span> <span m="4428520">the</span> <span m="4428570">next</span> <span m="4428820">bit</span> <span m="4428940">of</span> <span m="4429060">q</span> <span m="4429370">is 1.</span> <span m="4431880">So</span> <span m="4432010">now</span> <span m="4432220">we</span> <span m="4432500">can</span> <span m="4432660">tell,</span> <span m="4432955">OK,</span> <span m="4433430">what's</span> <span m="4433780">going</span> <span m="4433860">to</span> <span m="4433930">be</span> <span m="4434730">the</span> <span m="4434920">timing</span> <span m="4435480">of</span> <span m="4436200">decrypting</span> <span m="4436480">these</span> <span m="4436760">two</span> <span m="4437000">values,</span> <span m="4438280">if</span> <span m="4438580">q</span> <span m="4438810">lies</span> <span m="4439090">in between</span> <span m="4439410">them,</span> <span m="4440110">or</span> <span m="4440470">if q</span> <span m="4440720">lies</span> <span m="4441750">above</span> <span m="4441930">both</span> <span m="4442350">of</span> <span m="4442768">them.</span> </p>
<p><span m="4444440">Let's</span> <span m="4444680">look</span> <span m="4444830">at</span> <span m="4444990">the</span> <span m="4445090">situation</span> <span m="4445470">where</span> <span m="4445600">q</span> <span m="4445890">lies</span> <span m="4446320">above</span> <span m="4446660">both</span> <span m="4447000">of them.</span> <span m="4448140">Well</span> <span m="4448330">in that</span> <span m="4448560">case,</span> <span m="4450990">actually</span> <span m="4451230">everything</span> <span m="4451760">is</span> <span m="4452630">pretty</span> <span m="4452730">much</span> <span m="4452960">the same.</span> <span m="4453340">Right?</span> <span m="4453660">Because</span> <span m="4453970">both of</span> <span m="4454180">these</span> <span m="4454400">values</span> <span m="4454820">are</span> <span m="4454970">smaller</span> <span m="4455400">than</span> <span m="4455700">q,</span> <span m="4456330">then</span> <span m="4456610">the value</span> <span m="4456890">of these</span> <span m="4457260">things</span> <span m="4457500">mod</span> <span m="4457560">q</span> <span m="4458080">is</span> <span m="4458180">going</span> <span m="4458220">to be</span> <span m="4458340">roughly</span> <span m="4458670">the</span> <span m="4458760">same.</span> <span m="4459390">They're going to be</span> <span m="4459685">a little</span> <span m="4459980">bit</span> <span m="4460200">different</span> <span m="4461080">because</span> <span m="4461535">this</span> <span m="4461990">extra</span> <span m="4462320">bit,</span> <span m="4462890">but</span> <span m="4463220">more or</span> <span m="4463560">less</span> <span m="4463890">they're</span> <span m="4464540">the</span> <span m="4464650">same</span> <span m="4464940">magnitude.</span> </p>
<p><span m="4466420">And</span> <span m="4467810">the</span> <span m="4467950">number of</span> <span m="4468380">extractor</span> <span m="4468490">reductions</span> <span m="4468910">is also</span> <span m="4469350">probably</span> <span m="4469590">not</span> <span m="4469740">going</span> <span m="4469840">to</span> <span m="4469910">be</span> <span m="4470260">hugely</span> <span m="4470730">different</span> <span m="4471070">because it's</span> <span m="4471380">proportional</span> <span m="4472230">to</span> <span m="4472370">the</span> <span m="4472765">value of</span> <span m="4473160">this guy</span> <span m="4473410">mod</span> <span m="4473680">q.</span> <span m="4474780">And</span> <span m="4475130">for</span> <span m="4475260">both</span> <span m="4475550">these</span> <span m="4475740">guys,</span> <span m="4475980">they're</span> <span m="4476100">both a</span> <span m="4476350">little</span> <span m="4476590">bit</span> <span m="4477150">smaller</span> <span m="4477690">than</span> <span m="4478000">q,</span> <span m="4478270">so</span> <span m="4478540">they're all</span> <span m="4479020">about</span> <span m="4479300">the</span> <span m="4479470">same.</span> <span m="4480130">Neither</span> <span m="4480750">of</span> <span m="4480840">them</span> <span m="4480990">is</span> <span m="4481080">going</span> <span m="4481200">to</span> <span m="4481360">exceed</span> <span m="4481790">q</span> <span m="4482080">and</span> <span m="4482200">all of</span> <span m="4482660">a sudden</span> <span m="4483080">have</span> <span m="4483550">[? many or fewer ?]</span> <span m="4483815">extra</span> <span m="4484160">reductions.</span> </p>
<p><span m="4486080">So</span> <span m="4486460">if</span> <span m="4486680">q</span> <span m="4487040">is</span> <span m="4487800">greater</span> <span m="4488240">than</span> <span m="4488400">both</span> <span m="4488630">of</span> <span m="4488700">these</span> <span m="4488880">guesses</span> <span m="4489290">then</span> <span m="4490190">Karatsuba</span> <span m="4490390">versus</span> <span m="4490850">normal</span> <span m="4490950">is</span> <span m="4491310">going</span> <span m="4491430">to stay</span> <span m="4491760">the same.</span> <span m="4492670">The</span> <span m="4492850">server is</span> <span m="4493295">going to do</span> <span m="4493740">the same</span> <span m="4494010">thing basically</span> <span m="4494280">for</span> <span m="4494550">both</span> <span m="4494620">g</span> <span m="4495005">and</span> <span m="4495390">g high</span> <span m="4495710">in terms</span> <span m="4495970">of</span> <span m="4496230">Karatsuba</span> <span m="4496310">versus</span> <span m="4496420">normal.</span> <span m="4496825">And</span> <span m="4497230">the server's</span> <span m="4497620">going to</span> <span m="4498010">do</span> <span m="4498395">about</span> <span m="4498780">the</span> <span m="4498990">same</span> <span m="4499100">number of</span> <span m="4499190">extra</span> <span m="4499580">reductions</span> <span m="4499630">for</span> <span m="4500000">both</span> <span m="4500230">these</span> <span m="4500420">guys</span> <span m="4500830">as</span> <span m="4500930">well.</span> <span m="4501715">So</span> <span m="4502060">If</span> <span m="4502240">you</span> <span m="4502360">see</span> <span m="4502610">that the</span> <span m="4502820">server's</span> <span m="4503160">taking</span> <span m="4503350">the</span> <span m="4503420">same</span> <span m="4503620">amount</span> <span m="4503780">of</span> <span m="4503880">time</span> <span m="4504080">to</span> <span m="4504150">respond</span> <span m="4504510">to</span> <span m="4504580">these</span> <span m="4504890">guesses,</span> <span m="4505890">then you</span> <span m="4506050">should</span> <span m="4506210">probably</span> <span m="4506960">guess</span> <span m="4507250">that,</span> <span m="4507530">oh,</span> <span m="4507810">q</span> <span m="4508010">probably</span> <span m="4508270">has</span> <span m="4508450">the</span> <span m="4508720">bit 1</span> <span m="4509000">here.</span> </p>
<p><span m="4510580">On</span> <span m="4510700">the</span> <span m="4510750">other</span> <span m="4510940">hand,</span> <span m="4511500">if</span> <span m="4511620">q</span> <span m="4511790">lies</span> <span m="4512040">in</span> <span m="4512160">the</span> <span m="4512240">middle,</span> <span m="4512840">then</span> <span m="4513100">there are</span> <span m="4513450">two</span> <span m="4513580">possible</span> <span m="4513950">things</span> <span m="4514170">that</span> <span m="4514310">could</span> <span m="4514670">trigger</span> <span m="4515160">a</span> <span m="4515320">change</span> <span m="4515660">in</span> <span m="4515780">the</span> <span m="4516045">timing.</span> <span m="4517370">One</span> <span m="4517520">possibility</span> <span m="4518090">is</span> <span m="4518280">that</span> <span m="4518710">because</span> <span m="4519160">g</span> <span m="4519250">high</span> <span m="4519680">is</span> <span m="4520110">just</span> <span m="4520440">a</span> <span m="4520490">little</span> <span m="4520790">bit</span> <span m="4521010">larger</span> <span m="4521390">than</span> <span m="4521640">q,</span> <span m="4522930">then</span> <span m="4523150">the</span> <span m="4523230">number</span> <span m="4523620">of extra</span> <span m="4523720">reductions</span> <span m="4524170">is</span> <span m="4524580">going  to</span> <span m="4525020">be proportional</span> <span m="4525180">to</span> <span m="4525310">this</span> <span m="4525440">guy</span> <span m="4525570">mod q,</span> <span m="4525840">which</span> <span m="4526050">is</span> <span m="4526200">very</span> <span m="4526440">small</span> <span m="4527530">because</span> <span m="4527790">c0</span> <span m="4528470">prime</span> <span m="4529530">is</span> <span m="4529830">q</span> <span m="4530440">plus</span> <span m="4530780">just</span> <span m="4531040">a</span> <span m="4531120">little</span> <span m="4531450">bit</span> <span m="4532030">in</span> <span m="4532310">these</span> <span m="4532840">extra</span> <span m="4533260">bits.</span> <span m="4534300">So</span> <span m="4534420">the</span> <span m="4534540">number of</span> <span m="4534710">extra</span> <span m="4534920">reductions</span> <span m="4535290">is going</span> <span m="4535380">to</span> <span m="4535840">[? flaunt it ?].</span> <span m="4536650">And</span> <span m="4536810">all of a sudden,</span> <span m="4537185">it will</span> <span m="4537560">be faster.</span> </p>
<p><span m="4539620">Another</span> <span m="4539860">possible</span> <span m="4540200">thing</span> <span m="4540520">that can happen</span> <span m="4540880">is</span> <span m="4541060">that</span> <span m="4541430">maybe</span> <span m="4541780">the server</span> <span m="4541910">will decide,</span> <span m="4542240">oh,</span> <span m="4542623">now</span> <span m="4543006">it's time to do</span> <span m="4543390">normal</span> <span m="4543670">multiplication</span> <span m="4544310">instead</span> <span m="4544390">of</span> <span m="4544480">Karatsuba.</span> <span m="4545690">Maybe</span> <span m="4548128">for</span> <span m="4548560">this</span> <span m="4548840">value,</span> <span m="4549730">all</span> <span m="4549940">these,</span> <span m="4550630">c</span> <span m="4551070">to the</span> <span m="4551490">0</span> <span m="4551910">prime</span> <span m="4552580">was</span> <span m="4553050">the</span> <span m="4553140">same</span> <span m="4553350">number</span> <span m="4553680">of</span> <span m="4553780">bits</span> <span m="4554040">as</span> <span m="4554416">q</span> <span m="4555170">if</span> <span m="4555920">it</span> <span m="4556040">turns</span> <span m="4556290">out</span> <span m="4556490">that</span> <span m="4556640">g</span> <span m="4556770">high</span> <span m="4557230">is</span> <span m="4557970">above</span> <span m="4558070">q,</span> <span m="4558890">then</span> <span m="4559560">g</span> <span m="4559780">high</span> <span m="4560180">mod</span> <span m="4560516">q</span> <span m="4561190">is</span> <span m="4561370">potentially</span> <span m="4561690">going</span> <span m="4561780">to</span> <span m="4561820">have</span> <span m="4562070">fewer</span> <span m="4562400">bits.</span> <span m="4562700">And if</span> <span m="4562900">this</span> <span m="4563100">crosses</span> <span m="4563700">the</span> <span m="4563780">[INAUDIBLE]</span> <span m="4563900">boundary,</span> <span m="4564930">then</span> <span m="4565140">the</span> <span m="4565230">server's</span> <span m="4565730">going to do</span> <span m="4566080">normal</span> <span m="4566430">multiplication all</span> <span m="4566715">of a sudden.</span> <span m="4568270">So</span> <span m="4568380">that's</span> <span m="4568490">going</span> <span m="4568640">to</span> <span m="4568700">be</span> <span m="4569230">in the</span> <span m="4569560">other</span> <span m="4569890">direction.</span> <span m="4570590">So</span> <span m="4570750">if</span> <span m="4570930">you</span> <span m="4571330">cross</span> <span m="4571630">over,</span> <span m="4571930">then</span> <span m="4572490">normal</span> <span m="4572780">multiplication</span> <span m="4573090">kicks</span> <span m="4573400">in,</span> <span m="4574260">and</span> <span m="4574780">things</span> <span m="4575020">get</span> <span m="4575130">a</span> <span m="4575180">lot</span> <span m="4575520">slower</span> <span m="4575960">because</span> <span m="4576270">normal</span> <span m="4576580">multiplication</span> <span m="4576885">is</span> <span m="4577190">quadratic</span> <span m="4577660">instead</span> <span m="4577920">of</span> <span m="4579204">nicer,</span> <span m="4579681">faster</span> <span m="4580158">Karatsuba.</span> <span m="4580635">Question.</span> </p>
<p><span m="4581112">AUDIENCE:</span> <span m="4581589">[INAUDIBLE]</span> </p>
<p><span m="4584930">PROFESSOR: Yeah,</span> <span m="4585225">because</span> <span m="4585520">the number of</span> <span m="4585840">extra</span> <span m="4585940">reductions is</span> <span m="4586360">proportional</span> <span m="4586970">to</span> <span m="4588090">from</span> <span m="4588450">above</span> <span m="4588880">there</span> <span m="4589140">to</span> <span m="4589740">c0</span> <span m="4590060">prime</span> <span m="4590400">mod</span> <span m="4590740">q.</span> <span m="4591520">So</span> <span m="4591650">if</span> <span m="4591850">c0</span> <span m="4592420">prime,</span> <span m="4593240">which</span> <span m="4593300">is</span> <span m="4593410">this</span> <span m="4593520">value,</span> <span m="4594300">is</span> <span m="4594600">just</span> <span m="4594940">a</span> <span m="4595020">little</span> <span m="4595370">over</span> <span m="4595600">q.</span> <span m="4596880">Then,</span> <span m="4597330">this</span> <span m="4597450">is</span> <span m="4597770">tiny,</span> <span m="4598530">as</span> <span m="4598650">opposed</span> <span m="4598960">to</span> <span m="4599030">this</span> <span m="4599240">guy</span> <span m="4599580">who's</span> <span m="4599870">basically</span> <span m="4600350">the</span> <span m="4600460">same</span> <span m="4600660">as</span> <span m="4600910">q,</span> <span m="4601380">or</span> <span m="4601590">all</span> <span m="4602030">the</span> <span m="4602230">high</span> <span m="4602570">bits</span> <span m="4602730">are the same</span> <span m="4603070">as q,</span> <span m="4603495">and</span> <span m="4603920">then it's</span> <span m="4603970">big.</span> <span m="4604820">So</span> <span m="4605080">then</span> <span m="4605420">it'll</span> <span m="4605860">be</span> <span m="4606150">the difference</span> <span m="4606510">that you</span> <span m="4606914">can</span> <span m="4607318">try to</span> <span m="4607722">measure.</span> <span m="4608530">So</span> <span m="4608820">this is one</span> <span m="4609070">interesting thing,</span> <span m="4609470">actually</span> <span m="4609730">a</span> <span m="4610000">couple interesting</span> <span m="4610270">things,</span> <span m="4610970">these</span> <span m="4611120">effects</span> <span m="4611480">actually</span> <span m="4611790">work</span> <span m="4611970">in</span> <span m="4612070">different</span> <span m="4612340">directions,</span> <span m="4612750">right.</span> <span m="4612930">So</span> <span m="4613340">if</span> <span m="4613520">you</span> <span m="4613600">hit</span> <span m="4613850">a 32</span> <span m="4614280">bit</span> <span m="4614360">boundary</span> <span m="4615240">and</span> <span m="4615500">Karatsuba</span> <span m="4615870">versus</span> <span m="4616270">normal</span> <span m="4616610">switches,</span> <span m="4617070">then</span> <span m="4617390">all of</span> <span m="4617620">a</span> <span m="4617870">sudden</span> <span m="4618170">it</span> <span m="4618270">takes</span> <span m="4618510">much</span> <span m="4618760">longer</span> <span m="4619170">to decrypt</span> <span m="4619380">this message.</span> </p>
<p><span m="4620930">On</span> <span m="4621050">the</span> <span m="4621100">other</span> <span m="4621270">hand,</span> <span m="4621960">if</span> <span m="4623340">it's</span> <span m="4623380">not</span> <span m="4623870">a 32 bit</span> <span m="4624010">boundary,</span> <span m="4624460">maybe</span> <span m="4624780">this effect</span> <span m="4625100">will</span> <span m="4626190">tell</span> <span m="4626730">you</span> <span m="4626770">what's</span> <span m="4627000">going</span> <span m="4627230">on.</span> <span m="4627490">So</span> <span m="4627750">you</span> <span m="4628150">actually have</span> <span m="4628300">to</span> <span m="4628420">watch</span> <span m="4628700">for</span> <span m="4628860">different</span> <span m="4629140">effects.</span> <span m="4629590">If</span> <span m="4629800">you're</span> <span m="4630360">not</span> <span m="4630830">guessing</span> <span m="4631170">a</span> <span m="4631505">bit</span> <span m="4632130">that's</span> <span m="4632210">a</span> <span m="4632260">multiple</span> <span m="4632660">of</span> <span m="4632930">32</span> <span m="4633040">bits,</span> <span m="4633400">then</span> <span m="4633670">you</span> <span m="4634050">should probably</span> <span m="4634406">expect</span> <span m="4635120">the</span> <span m="4635220">time</span> <span m="4635410">to</span> <span m="4635890">drop</span> <span m="4636390">because</span> <span m="4636500">of</span> <span m="4636880">extra</span> <span m="4637255">reductions.</span> <span m="4638125">On the other</span> <span m="4638620">hand, if</span> <span m="4639090">you're</span> <span m="4639355">trying</span> <span m="4639620">to guess</span> <span m="4639980">a</span> <span m="4640440">bit that's</span> <span m="4640480">a multiple</span> <span m="4640820">of</span> <span m="4640910">32,</span> <span m="4641780">then</span> <span m="4642570">maybe</span> <span m="4642720">you</span> <span m="4642770">should</span> <span m="4642960">be</span> <span m="4643420">expecting</span> <span m="4643930">for</span> <span m="4644100">it to</span> <span m="4644200">jump</span> <span m="4644500">a lot</span> <span m="4645100">or</span> <span m="4645260">maybe</span> <span m="4645470">drop</span> <span m="4645860">if it's</span> <span m="4646060">[INAUDIBLE]</span> <span m="4646340">normal.</span> </p>
<p><span m="4647910">So</span> <span m="4648160">I</span> <span m="4648280">guess</span> <span m="4648440">what</span> <span m="4648540">these</span> <span m="4648700">guys</span> <span m="4649180">look</span> <span m="4649400">at</span> <span m="4649550">in the</span> <span m="4649620">paper,</span> <span m="4649890">this</span> <span m="4650100">actually</span> <span m="4650360">doesn't</span> <span m="4650600">really</span> <span m="4650780">matter</span> <span m="4651450">whether</span> <span m="4651800">there's</span> <span m="4652160">a jump</span> <span m="4652490">up</span> <span m="4652790">or a</span> <span m="4653020">jump</span> <span m="4653290">down</span> <span m="4653660">in time.</span> <span m="4654380">You should</span> <span m="4654490">just</span> <span m="4654750">expect</span> <span m="4655600">if</span> <span m="4656030">q</span> <span m="4656370">is,</span> <span m="4657030">if the</span> <span m="4657315">next</span> <span m="4657600">bit</span> <span m="4657670">of</span> <span m="4657820">q</span> <span m="4657990">is 1,</span> <span m="4658570">you</span> <span m="4658870">should</span> <span m="4659280">expect</span> <span m="4659600">these</span> <span m="4659810">things</span> <span m="4659950">to take</span> <span m="4660310">almost</span> <span m="4660670">the</span> <span m="4660780">same amount of</span> <span m="4661020">time.</span> <span m="4661740">And</span> <span m="4661860">if the</span> <span m="4662010">next</span> <span m="4662340">bit</span> <span m="4662570">of q</span> <span m="4662910">is</span> <span m="4663170">0,</span> <span m="4663880">then</span> <span m="4664570">you</span> <span m="4664660">should</span> <span m="4664790">expect</span> <span m="4665090">these</span> <span m="4665210">guys</span> <span m="4665470">to have</span> <span m="4665680">a</span> <span m="4665730">noticeable</span> <span m="4666220">difference</span> <span m="4666940">even</span> <span m="4667300">if it's</span> <span m="4667780">big or small,</span> <span m="4668260">even if it's</span> <span m="4669110">positive</span> <span m="4669530">or</span> <span m="4669650">negative.</span> </p>
<p><span m="4671740">So</span> <span m="4671830">actually,</span> <span m="4672400">they</span> <span m="4672670">measure</span> <span m="4673080">this.</span> <span m="4673450">And it turns</span> <span m="4673740">out to</span> <span m="4673810">actually</span> <span m="4674460">work</span> <span m="4674760">pretty</span> <span m="4674940">well.</span> <span m="4675280">They have</span> <span m="4675730">to do</span> <span m="4676180">actually</span> <span m="4676360">two</span> <span m="4676510">interesting</span> <span m="4677360">tricks</span> <span m="4677790">to</span> <span m="4677900">make</span> <span m="4678120">this</span> <span m="4678320">work</span> <span m="4678580">out.</span> <span m="4678820">If</span> <span m="4679040">you</span> <span m="4679230">remember</span> <span m="4679820">the</span> <span m="4680250">timing</span> <span m="4680550">difference</span> <span m="4680910">was</span> <span m="4681300">tiny,</span> <span m="4681890">it's</span> <span m="4682120">an order</span> <span m="4682395">of</span> <span m="4682670">1</span> <span m="4683010">to</span> <span m="4683350">2</span> <span m="4683810">microseconds.</span> <span m="4685110">So</span> <span m="4685450">it's</span> <span m="4685580">going to be</span> <span m="4685790">hard</span> <span m="4686050">to</span> <span m="4686130">measure</span> <span m="4686420">this</span> <span m="4686700">over</span> <span m="4687080">a</span> <span m="4687310">network,</span> <span m="4687690">over</span> <span m="4687910">an</span> <span m="4688280">ethernet</span> <span m="4688650">switch</span> <span m="4688940">for</span> <span m="4689010">example.</span> </p>
<p><span m="4690060">What</span> <span m="4690200">they do</span> <span m="4690410">is</span> <span m="4690720">they actually</span> <span m="4691720">do</span> <span m="4691950">two</span> <span m="4692140">kinds</span> <span m="4692450">of</span> <span m="4692620">measurements,</span> <span m="4693460">two</span> <span m="4693630">kinds</span> <span m="4693870">of</span> <span m="4694010">averaging.</span> <span m="4695310">So</span> <span m="4695760">for</span> <span m="4696010">each</span> <span m="4696420">guess</span> <span m="4696685">that they</span> <span m="4696950">send,</span> <span m="4697450">they actually</span> <span m="4697720">send</span> <span m="4697980">it</span> <span m="4698130">several</span> <span m="4698480">times.</span> <span m="4698870">In</span> <span m="4698930">the</span> <span m="4699100">paper,</span> <span m="4699330">they</span> <span m="4699470">said</span> <span m="4699680">they</span> <span m="4700090">send</span> <span m="4700370">it</span> <span m="4700710">like</span> <span m="4700860">7</span> <span m="4701245">times or</span> <span m="4701630">something.</span> <span m="4702380">So</span> <span m="4702780">what</span> <span m="4702960">kind</span> <span m="4703140">of</span> <span m="4703450">noise</span> <span m="4703790">do you</span> <span m="4704080">think</span> <span m="4704430">this</span> <span m="4704610">helps</span> <span m="4704910">them</span> <span m="4705600">with</span> <span m="4705920">[? if they ?]</span> <span m="4706170">just</span> <span m="4706360">resend</span> <span m="4706670">the same</span> <span m="4706980">guess</span> <span m="4707210">over</span> <span m="4707410">and</span> <span m="4707470">over?</span> <span m="4709440">Yeah.</span> </p>
<p><span m="4710400">AUDIENCE:</span> <span m="4710880">What's up with the</span> <span m="4711360">[INAUDIBLE]?</span> </p>
<p><span m="4713280">PROFESSOR: Yeah,</span> <span m="4713730">so if</span> <span m="4713880">the</span> <span m="4713950">network</span> <span m="4714340">keeps</span> <span m="4714780">adding</span> <span m="4715250">different</span> <span m="4715510">things,</span> <span m="4715780">you</span> <span m="4715910">just</span> <span m="4716150">try</span> <span m="4716250">the</span> <span m="4716370">same thing</span> <span m="4716730">many</span> <span m="4717050">times.</span> <span m="4717750">The</span> <span m="4718045">thing in the</span> <span m="4718340">server</span> <span m="4718680">should</span> <span m="4718930">be</span> <span m="4719060">taking</span> <span m="4719535">exactly</span> <span m="4719800">the</span> <span m="4719850">same</span> <span m="4719990">amount of</span> <span m="4720210">time</span> <span m="4720390">every</span> <span m="4720630">time</span> <span m="4721100">and</span> <span m="4721480">just</span> <span m="4721660">average</span> <span m="4721860">out</span> <span m="4722196">the network</span> <span m="4722532">noise.</span> <span m="4722870">In</span> <span m="4723240">the paper,</span> <span m="4723360">they</span> <span m="4723590">say</span> <span m="4723845">they take the</span> <span m="4724100">median</span> <span m="4724430">value--</span> <span m="4725280">I</span> <span m="4725380">actually don't</span> <span m="4725540">understand</span> <span m="4725920">why</span> <span m="4726060">they</span> <span m="4726230">take the</span> <span m="4726630">median,</span> <span m="4727030">I think they should</span> <span m="4727430">be taking</span> <span m="4727760">the min of</span> <span m="4727920">the</span> <span m="4728020">real</span> <span m="4728200">thing</span> <span m="4728510">that's going</span> <span m="4728720">on--</span> <span m="4729460">but</span> <span m="4729590">anyway,</span> <span m="4729960">this</span> <span m="4730160">was</span> <span m="4730620">the</span> <span m="4730800">average</span> <span m="4731140">of the</span> <span m="4731570">network.</span> </p>
<p><span m="4732000">But</span> <span m="4732430">then</span> <span m="4732860">they</span> <span m="4733140">do this</span> <span m="4733490">other</span> <span m="4733760">weird</span> <span m="4734220">thing,</span> <span m="4734630">which</span> <span m="4734700">is</span> <span m="4734850">that</span> <span m="4736530">when</span> <span m="4736760">they're</span> <span m="4736970">sending</span> <span m="4737170">a</span> <span m="4737470">guess,</span> <span m="4737850">they</span> <span m="4737940">don't</span> <span m="4738190">just</span> <span m="4738350">send</span> <span m="4738570">the</span> <span m="4738770">same</span> <span m="4738850">guess</span> <span m="4739240">7</span> <span m="4739586">times,</span> <span m="4740280">they</span> <span m="4740670">actually</span> <span m="4741070">send</span> <span m="4741320">a</span> <span m="4741490">neighborhood</span> <span m="4742020">of</span> <span m="4742170">guesses.</span> <span m="4742730">And</span> <span m="4743300">each</span> <span m="4743880">value</span> <span m="4744220">in</span> <span m="4744300">the</span> <span m="4744470">neighborhood</span> <span m="4744920">gets sent</span> <span m="4745110">7</span> <span m="4745395">times</span> <span m="4745680">itself.</span> <span m="4746250">So they</span> <span m="4746690">actually</span> <span m="4746990">send</span> <span m="4747830">g</span> <span m="4749120">7</span> <span m="4749540">times.</span> <span m="4749960">Then</span> <span m="4750330">they</span> <span m="4750430">send</span> <span m="4750800">g</span> <span m="4751310">plus</span> <span m="4751550">1</span> <span m="4752410">also</span> <span m="4752700">7</span> <span m="4753200">times.</span> <span m="4753700">Then</span> <span m="4754020">they send</span> <span m="4754420">g</span> <span m="4754710">plus</span> <span m="4755065">2</span> <span m="4755420">also</span> <span m="4755905">7</span> <span m="4756390">times,</span> <span m="4756875">et cetera,</span> <span m="4757360">up</span> <span m="4757580">to</span> <span m="4757670">g</span> <span m="4757980">plus</span> <span m="4758140">400</span> <span m="4758430">in the</span> <span m="4758720">paper.</span> <span m="4760660">Why</span> <span m="4761000">do</span> <span m="4761130">they</span> <span m="4761240">do</span> <span m="4761370">this</span> <span m="4762140">kind</span> <span m="4762480">of</span> <span m="4763130">averaging</span> <span m="4763640">as</span> <span m="4763750">well</span> <span m="4764050">over</span> <span m="4764240">different</span> <span m="4764620">g</span> <span m="4764840">value</span> <span m="4766270">instead</span> <span m="4766710">of</span> <span m="4766890">just</span> <span m="4767090">sending</span> <span m="4768240">g</span> <span m="4769120">7 times</span> <span m="4769560">400</span> <span m="4770021">times.</span> <span m="4772326">Because it seems</span> <span m="4772790">more straightforward.</span> <span m="4773590">Yeah?</span> </p>
<p><span m="4774060">AUDIENCE:</span> <span m="4774530">[INAUDIBLE]</span> </p>
<p><span m="4778290">PROFESSOR: Yeah,</span> <span m="4778635">that's</span> <span m="4778980">actually</span> <span m="4779240">what's going</span> <span m="4779520">on.</span> <span m="4780380">We're</span> <span m="4780500">actually</span> <span m="4780770">trying</span> <span m="4781100">to</span> <span m="4781480">measure</span> <span m="4782050">exactly</span> <span m="4782420">how</span> <span m="4782725">long</span> <span m="4783440">this</span> <span m="4783850">piece</span> <span m="4784060">of</span> <span m="4784300">computation</span> <span m="4784750">will</span> <span m="4784900">take.</span> <span m="4785310">But</span> <span m="4785660">then there's</span> <span m="4785720">lots</span> <span m="4786030">of</span> <span m="4786130">other</span> <span m="4786380">stuff.</span> <span m="4786650">For</span> <span m="4786750">example,</span> <span m="4787060">this</span> <span m="4787510">other</span> <span m="4787650">pipeline</span> <span m="4787970">that's at</span> <span m="4788050">the</span> <span m="4788160">bottom</span> <span m="4788470">is</span> <span m="4788600">doing</span> <span m="4788710">all</span> <span m="4789020">the</span> <span m="4789210">stuff</span> <span m="4789500">mod p.</span> <span m="4790340">I mean it's</span> <span m="4790630">also</span> <span m="4790885">going</span> <span m="4791140">to</span> <span m="4791260">take</span> <span m="4791330">different</span> <span m="4791630">amount</span> <span m="4791850">of</span> <span m="4791950">time</span> <span m="4792630">depending</span> <span m="4793050">on</span> <span m="4793130">what</span> <span m="4793280">exactly</span> <span m="4793630">the</span> <span m="4793920">input</span> <span m="4794215">is.</span> </p>
<p><span m="4794870">So</span> <span m="4795080">the</span> <span m="4795210">cool</span> <span m="4795430">thing</span> <span m="4795680">is</span> <span m="4795850">that</span> <span m="4796690">if</span> <span m="4796900">you</span> <span m="4797290">perturb</span> <span m="4797600">the</span> <span m="4797790">value</span> <span m="4798220">of</span> <span m="4798300">all</span> <span m="4798730">your</span> <span m="4798970">guess</span> <span m="4799370">g</span> <span m="4800030">by</span> <span m="4800220">adding</span> <span m="4800640">1,</span> <span m="4800910">2,</span> <span m="4801110">3,</span> <span m="4801340">whatever,</span> <span m="4801800">it's just</span> <span m="4802215">[INAUDIBLE]</span> <span m="4802630">the</span> <span m="4802700">little</span> <span m="4803000">bits.</span> <span m="4803370">So</span> <span m="4803740">the</span> <span m="4803790">timing</span> <span m="4804100">attack</span> <span m="4804270">we</span> <span m="4804470">just</span> <span m="4804650">looked</span> <span m="4804810">at</span> <span m="4804950">just</span> <span m="4805130">now,</span> <span m="4805690">isn't</span> <span m="4806000">going to</span> <span m="4806310">change</span> <span m="4806690">because</span> <span m="4807020">that</span> <span m="4807230">depended</span> <span m="4807570">on</span> <span m="4807680">this</span> <span m="4808160">middle</span> <span m="4808660">bit</span> <span m="4808920">flipping.</span> </p>
<p><span m="4810400">But</span> <span m="4811405">everything</span> <span m="4811830">that's</span> <span m="4812080">happening</span> <span m="4812440">on</span> <span m="4812510">the</span> <span m="4812580">bottom</span> <span m="4813070">side of</span> <span m="4813160">the</span> <span m="4813270">pipeline</span> <span m="4813700">mod</span> <span m="4814020">p</span> <span m="4814900">is</span> <span m="4814980">going to be</span> <span m="4815240">totally</span> <span m="4815550">randomized</span> <span m="4816110">by</span> <span m="4816250">this</span> <span m="4816460">because</span> <span m="4816950">when</span> <span m="4817080">they</span> <span m="4817160">do it</span> <span m="4817510">mod p</span> <span m="4817770">then</span> <span m="4818260">adding</span> <span m="4818570">an</span> <span m="4819040">extra</span> <span m="4819220">bit</span> <span m="4819570">could</span> <span m="4820740">shift</span> <span m="4821040">things</span> <span m="4821270">around</span> <span m="4821600">quite</span> <span m="4821770">a</span> <span m="4821810">bit</span> <span m="4822020">mod</span> <span m="4822330">p.</span> <span m="4822610">Then</span> <span m="4823180">you're</span> <span m="4823320">going</span> <span m="4823700">to,</span> <span m="4824840">it will</span> <span m="4825280">average</span> <span m="4825690">out</span> <span m="4825920">other</span> <span m="4826170">kinds</span> <span m="4826560">of</span> <span m="4826730">computational</span> <span m="4827520">noise</span> <span m="4828000">that's</span> <span m="4828450">deterministic for</span> <span m="4828860">a</span> <span m="4829250">particular</span> <span m="4829470">value</span> <span m="4830140">but it's</span> <span m="4830470">not</span> <span m="4830760">related</span> <span m="4831690">to</span> <span m="4832610">this</span> <span m="4832720">part of</span> <span m="4833165">the computation</span> <span m="4833610">we're</span> <span m="4833730">trying</span> <span m="4833960">to</span> <span m="4834020">go</span> <span m="4834230">after.</span> <span m="4834690">Make</span> <span m="4835179">sense?</span> </p>
<p><span m="4835668">AUDIENCE: How</span> <span m="4836157">do they do</span> <span m="4836646">that</span> <span m="4837135">when they</span> <span m="4837624">try to</span> <span m="4838113">guess the lower bits?</span> </p>
<p><span m="4838602">PROFESSOR:</span> <span m="4839091">So</span> <span m="4839580">actually</span> <span m="4840069">they use</span> <span m="4840558">some</span> <span m="4841050">other mathematical</span> <span m="4841380">trick</span> <span m="4841650">to</span> <span m="4841920">only</span> <span m="4842020">actually</span> <span m="4842260">bother</span> <span m="4842660">guessing</span> <span m="4842980">the</span> <span m="4843120">top</span> <span m="4843360">half of</span> <span m="4843655">the bits</span> <span m="4843950">of</span> <span m="4844310">q.</span> <span m="4845180">It</span> <span m="4845280">turns</span> <span m="4845500">out if</span> <span m="4845810">you know</span> <span m="4846080">the top</span> <span m="4846430">half of the</span> <span m="4846830">bits of q</span> <span m="4847160">there's some</span> <span m="4847440">math</span> <span m="4847700">you</span> <span m="4847780">can</span> <span m="4848000">rely</span> <span m="4848300">on</span> <span m="4848520">to</span> <span m="4849080">factor</span> <span m="4849720">the</span> <span m="4849780">numbers,</span> <span m="4850970">and</span> <span m="4851050">then you're</span> <span m="4851390">in good shape.</span> <span m="4851730">So</span> <span m="4851890">you</span> <span m="4852030">can</span> <span m="4852290">always</span> <span m="4852480">[INAUDIBLE]</span> <span m="4852500">little</span> <span m="4852860">bit.</span> <span m="4853790">Basically not worry about it.</span> <span m="4855706">Make sense?</span> <span m="4856189">Yeah,</span> <span m="4856672">question.</span> </p>
<p><span m="4857155">AUDIENCE:</span> <span m="4857638">[INAUDIBLE]</span> </p>
<p><span m="4861510">PROFESSOR: Well,</span> <span m="4861900">you're</span> <span m="4862050">going</span> <span m="4862160">to</span> <span m="4862450">construct</span> <span m="4863230">this</span> <span m="4863570">value</span> <span m="4864670">c0--</span> <span m="4865180">well</span> <span m="4865600">you</span> <span m="4865710">want</span> <span m="4865890">the</span> <span m="4866030">c0</span> <span m="4866500">prime--</span> <span m="4867100">you're</span> <span m="4867390">going to</span> <span m="4867600">construct</span> <span m="4867840">a value</span> <span m="4868250">c</span> <span m="4869250">by</span> <span m="4869450">basically</span> <span m="4869810">taking</span> <span m="4870130">your</span> <span m="4870310">c0</span> <span m="4870930">prime</span> <span m="4871810">and</span> <span m="4872000">multiplying</span> <span m="4872660">it</span> <span m="4872830">times</span> <span m="4873200">R</span> <span m="4873460">inverse</span> <span m="4874310">mod</span> <span m="4874710">n.</span> <span m="4877860">And</span> <span m="4878520">then</span> <span m="4878770">when</span> <span m="4878870">the</span> <span m="4878970">server</span> <span m="4879220">takes</span> <span m="4879460">this</span> <span m="4879660">value,</span> <span m="4880430">it's going to</span> <span m="4880865">push</span> <span m="4881300">it</span> <span m="4881400">through</span> <span m="4881630">here.</span> <span m="4882000">So</span> <span m="4882130">it's going to</span> <span m="4882370">compute</span> <span m="4882620">c0.</span> <span m="4883680">It's</span> <span m="4883820">going</span> <span m="4883950">to</span> <span m="4884030">be</span> <span m="4884230">c</span> <span m="4885070">mod</span> <span m="4885410">q,</span> <span m="4885600">so that</span> <span m="4885910">value</span> <span m="4886160">is going to</span> <span m="4886500">be c0</span> <span m="4887000">prime</span> <span m="4887360">R</span> <span m="4887570">inverse</span> <span m="4887900">mod</span> <span m="4888130">q.</span> </p>
<p><span m="4889210">Then</span> <span m="4889390">you</span> <span m="4889710">multiply</span> <span m="4890190">it by</span> <span m="4890420">R,</span> <span m="4890640">so you get</span> <span m="4891070">rid of the</span> <span m="4891250">R</span> <span m="4891500">inverse.</span> <span m="4892550">And</span> <span m="4892670">then</span> <span m="4892780">you</span> <span m="4892870">end</span> <span m="4893040">up</span> <span m="4893240">with</span> <span m="4893430">a</span> <span m="4893480">guess</span> <span m="4893850">exactly</span> <span m="4894290">in this</span> <span m="4894470">position.</span> <span m="4895800">So</span> <span m="4896020">the cool</span> <span m="4896290">thing is</span> <span m="4896720">basically</span> <span m="4896970">all</span> <span m="4897440">manipulations</span> <span m="4897820">leading</span> <span m="4898200">up</span> <span m="4898450">to</span> <span m="4898710">here</span> <span m="4899030">are</span> <span m="4899200">just</span> <span m="4899420">multiplying</span> <span m="4899890">by</span> <span m="4900000">this</span> <span m="4900200">R.</span> <span m="4900570">And you know</span> <span m="4900940">what</span> <span m="4901310">R</span> <span m="4901550">is</span> <span m="4901670">going</span> <span m="4901900">be,</span> <span m="4902040">it's going to</span> <span m="4902190">be 2</span> <span m="4902490">to the</span> <span m="4902850">512.</span> <span m="4903360">I'm</span> <span m="4903490">going</span> <span m="4903610">to</span> <span m="4903650">be</span> <span m="4903770">really</span> <span m="4904130">straightforward.</span> <span m="4906894">Make</span> <span m="4907390">sense?</span> <span m="4907886">Another question?</span> </p>
<p><span m="4908382">AUDIENCE:</span> <span m="4908878">Could we just</span> <span m="4909374">cancel</span> <span m="4909870">out</span> <span m="4910720">timing</span> <span m="4910920">[INAUDIBLE]?</span> </p>
<p><span m="4916115">PROFESSOR: Well,</span> <span m="4916380">if you</span> <span m="4916440">do p,</span> <span m="4916705">you'd</span> <span m="4916970">be in</span> <span m="4917210">business.</span> <span m="4919930">Yeah,</span> <span m="4920388">so that's</span> <span m="4920850">the thing.</span> <span m="4921220">Yeah,</span> <span m="4921590">you</span> <span m="4921650">don't</span> <span m="4921890">know what</span> <span m="4922280">p is,</span> <span m="4922735">but you</span> <span m="4923190">just want to</span> <span m="4923645">randomize</span> <span m="4924100">it</span> <span m="4924555">out.</span> <span m="4926375">Any</span> <span m="4926830">questions?</span> <span m="4927440">All right.</span> <span m="4927805">[INAUDIBLE]</span> <span m="4929160">but thanks</span> <span m="4929623">for sticking</span> <span m="4930086">around.</span> <span m="4930549">So we'll</span> <span m="4931012">start talking about</span> <span m="4931475">other</span> <span m="4931940">kinds</span> <span m="4932320">of</span> <span m="4932700">problems</span> <span m="4933300">next</span> <span m="4933600">week.</span> </p>
</div>
        <div id="vid_related" itemprop="description" class="tabContent hide">
<h2 class="subhead">Free Downloads</h2>
<h3 class="subsubhead">Video</h3>
<ul>
<li>iTunes U (<a href="https://itunes.apple.com/us/itunes-u/id1017908130">MP4 - 182MB</a>)</li>
<li>Internet Archive (<a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec16_300k.mp4">MP4 - 182MB</a>)</li>
</ul>
<br>
<h3 class="subsubhead">Caption</h3>
<ul>
<li>English-US (<a href="../../../contents/video-lectures/lecture-16-side-channel-attacks/3v5Von-oNUg.srt">SRT</a>)</li>
</ul>
</div>
    
   </div>  




      					 
        <div class="" id="parent-fieldname-bottom_html_area">
            
            
        </div>
    
               </main><!--Course_inner_media tag close -->
           		</div>
<!--Course_wrapper tag close -->
            </div>
<!--left tag close -->
            <aside id="right">
                <!--Begin Right Portion -->
                    <div>
    



</div>

                	<div>
    



</div>


        <div class="" id="parent-fieldname-rsi_top_html_area">
            
            
        </div>
    

<!-- RSI google ad space-->



<div id="google_ads">    
    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <script type="text/javascript">var googletag = googletag || {}; googletag.cmd = googletag.cmd || [];</script>
    <script type="text/javascript">
googletag.cmd.push(function() {googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_A_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_A_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_B_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_B_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_C_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_C_DL').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
 googletag.enableServices();
});</script>
    <script language="javascript" type="text/javascript">
googletag.cmd.push(function() {googletag.pubads().set("TYPE","HOUSE");googletag.pubads().set("DEPARTMENT","6");googletag.pubads().set("CRS_BEG2","85");googletag.pubads().set("CRS_END","8");googletag.pubads().set("SESSION","F");googletag.pubads().set("YEAR","14");})
</script>
    
    <div id="VIDEO_INDIVIDUAL_SLOT_A_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_A_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_B_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_B_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_C_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_C_DL'); });</script>
    </div>
</div>

<!-- End RSI ads--> 


<div>
    



</div>

            </aside><!--Right div close -->
            <div class="clear"></div>
        </div>
<!--grid tag close -->
      </div>
		
		<footer id="bottom">
			<div id="grid">
				
<div id="portletwrapper-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572" class="portletWrapper kssattr-portlethash-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572">
<div class="portletStaticText portlet-static-site-footer"><div id="footer">
<nav aria-label="Footer">     <nav id="foot-c1" class="grid_2 alpha" aria-labelledby="f-find-courses">       <span class="footer" id="f-find-courses" aria-hidden="true">Find Courses</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Find by Topic</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-number/">Find by Course Number</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-department/">Find by Department</a></li>
    <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights</a></li>
    <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
    <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    <li><a href="https://ocw.mit.edu/courses/translated-courses/">Translated Courses</a></li>
</ul>
</nav>
<div id="foot-c2" class="grid_2"><nav aria-labelledby="f-for-educators">         <span id="f-for-educators" class="footer" aria-hidden="true">For Educators</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
    <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal </a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
    <li><a href="https://openlearning.mit.edu/campus/digital-innovations/" aria-label="External Link: Residential Digital Innovations">Residential Digital Innovations </a></li>
    <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
</ul>
</nav></div>
<nav class="grid_2" id="foot-c3" aria-labelledby="f-donate">       <span id="f-donate" class="footer" aria-hidden="true">Give Now</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
    <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
    <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
    <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
    <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
</ul>
</nav>
<div class="grid_2" id="foot-c4">
<nav aria-labelledby="f-about">         <span id="f-about" class="footer" aria-hidden="true">About</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/about/">About OpenCourseWare</a></li>
    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
    <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
    <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
</ul>
</nav><!--about-->       <nav aria-labelledby="f-tools">         <span id="f-tools" class="footer" aria-hidden="true">Tools</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/help/">Help &amp; FAQs</a></li>
    <li><a href="https://ocw.mit.edu/about/contactus">Contact Us</a></li>
    <li><a href="https://accessibility.mit.edu/" target="_blank">Accessibility</a></li>
    <li><a href="https://ocw.mit.edu/help/site-map/">Site Map</a></li>
    <li><a href="../../../common/terms/index.htm">Privacy &amp; Terms of Use</a></li>
    <li><a href="https://ocw.mit.edu/help/rss/">RSS Feeds</a></li>
</ul>
</nav><!--tools-->
</div>
</nav> <aside style="min-height: 289px;" aria-labelledby="f-our-corporate-supporters" class="grid_4 omega" id="foot-c5">           <span aria-hidden="true" class="footer" id="f-our-corporate-supporters">Our Corporate Supporters</span>           <!-- HOME_CORP_LOGO_1 -->
<div id="div-gpt-ad-1388181177156-0" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-0'); });
            </script></div>
<!-- HOME_CORP_LOGO_2 -->
<div id="div-gpt-ad-1388181177156-1" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-1'); });
            </script></div>
<!-- HOME_CORP_LOGO_3 -->
<div id="div-gpt-ad-1388181177156-2" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-2'); });
            </script></div>
<!-- HOME_CORP_LOGO_4 -->
<div id="div-gpt-ad-1388181177156-3" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-3'); });
            </script></div>
<!-- HOME_CORP_LOGO_5 -->
<div id="div-gpt-ad-1388181177156-4" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-4'); });
              </script></div>
<!-- HOME_CORP_LOGO_6 -->
<div id="div-gpt-ad-1388181177156-5" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-5'); });
              </script></div>
</aside>
<div class="grid_12 alpha omega" itemprop="publisher" itemscope="" itemtype="http://schema.org/CollegeOrUniversity">
<h4 class="footer" style="border-top: thin solid #d5c9ba; padding-top: 10px; margin-bottom: 10px;">About <span itemprop="name">MIT OpenCourseWare</span>
</h4>
<p style="color: #999; font-size: 1em; line-height: 1.5em; margin-top: 10px;" itemprop="description">MIT OpenCourseWare is an online publication of materials from over 2,500 MIT courses, freely sharing knowledge with learners and educators around the world. <a href="https://ocw.mit.edu/about/">Learn more »</a></p>
</div>
<div id="foot-copy" class="grid_12 alpha omega" style="border-top: none;">
<a href="http://web.mit.edu"><img src="../../../common/images/logo_mit.png" alt="Massachusetts Institute of Technology logo and name." style="width: 195; height: 44;"></a><a href="https://openlearning.mit.edu/"><img src="https://ocw.mit.edu/images/mitol_logo.png" alt="MIT Open Learning logo and name." style="width: 265; height: 50; vertical-align: top; padding-left:30px;"></a><a href="https://www.oeglobal.org/"><img src="https://ocw.mit.edu/images/oeg_logo.gif" alt="Open Education Consortium logo." style="width: 219px; height: 59px; vertical-align: top; padding-left:20px;"></a><a rel="license" itemprop="useRightsUrl" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="../../../common/images/cc_by-nc-sa.png" alt="Creative Commons logo with terms BY-NC-SA." style="width: 126px; height: 44px; margin-right: 0; padding-left: 20px;"></a>
<p class="copyright">© 2001–2018<br>
Massachusetts Institute of Technology</p>
<p style="font-size: 0.9em; margin-bottom: 15px;">Your use of the MIT OpenCourseWare site and materials is subject to our <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license">Creative Commons License</a> and other <a href="../../../common/terms/index.htm" rel="cc:morePermissions">terms of use</a>.</p>
</div>
</div></div>

</div>





                
			</div> <!-- bottom grid end -->
		</footer><!-- footer bottom end -->


   </body>
 </html>
