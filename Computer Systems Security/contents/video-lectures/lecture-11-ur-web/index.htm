<!DOCTYPE html><html lang="en">
      
      
        
    
    
    
    

      
      
      <head>
        <meta charset="utf-8">
        <meta name="format-detection" content="telephone=no">  
        
        <title>Lecture 11: Ur/Web | Lecture Videos | Computer Systems Security | Electrical Engineering and Computer Science | MIT OpenCourseWare</title>
    <!-- Begin Automatic Metadata Insertion -->
    <meta content="6-858-computer-systems-security-fall-2014" name="WT.cg_n">
    <meta content="Lecture 11: Ur/Web" name="WT.cg_s">
    <meta content="In this lecture, Professor Chlipala discusses Ur/Web, the programming language he created for modern web applications." name="Description">
    <meta content="Zeldovich, Nickolai" name="Author">
    <meta content="6.858,Ur/Web,encapsulation,simple concurrency,functional programming,web programming,Computer Design and Engineering,Software Design and Engineering" name="keywords">
    <meta content="6.858 Computer Systems Security | Lecture 11: Ur/Web" name="Search_Display">
    <meta content="Computer Design and Engineering" itemprop="about">
    <meta content="Software Design and Engineering" itemprop="about">
    <!-- End Automatic Metadata Insertion -->

	<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/grid.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/base.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/menu.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.bubblepopup.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/search.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses_new.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.jscrollpane.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/media_tabs.css">
	<link href="../../../common/xml/ocwcc.rdf" type="application/rdf+xml" rel="metadata">
	<link rel="canonical" href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-11-ur-web/">
	<link rel="apple-touch-icon" href="../../../common/images/apple-touch-icon.png">
	
	
      
	
	<script type="text/javascript" src="../../../common/scripts/jquery.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-media-utils-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.bubblepopup.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery-ui.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.jscrollpane.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/expandy.js"></script>
	<script type="text/javascript" src="../../../common/scripts/bubble-popup-offline.js"></script>
	
	
	
    <script type="text/javascript">
      $(document).ready(function() {
        $("#tabs").tabs();
        IpadScroller();
      });
    </script>
    
    
    
    
    
    
      
       
		 

        
        
        

        
        
        
        
        
        
        
        
        
      </head>
    <body itemscope itemtype="http://schema.org/WebPage">
        
	

        <header id="top">
			<div id="grid">
				
				
					
<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572">
<div class="portletStaticText portlet-static-site-header">
<!--googleoff: index-->
<div class="grid_6 alpha" id="banner"><a href="https://ocw.mit.edu/"><img src="../../../common/images/ocw_mast.png" class="logo" alt="MIT OpenCourseWare, Massachusetts Institute of Technology"></a></div>
<div class="grid_6 omega" id="subscribe">
<aside class="module" aria-label="Connect with OCW">
<table class="social">
    <tbody>
        <tr>
            <td class="socialbutton"><a aria-label="Subscribe to the OCW Newsletter" href="https://ocw.mit.edu/subscribe/index.htm?utm_source=header"><img src="../../../common/images/trans.gif" alt="An icon depicting an envelope.">Subscribe to the OCW Newsletter</a></td>
            <td>
<a aria-label="Facebook" href="https://facebook.com/mitocw"><img src="../../../common/images/icon_fb.png" alt="Click to visit our Facebook page."></a>  <a aria-label="Instagram" href="https://www.instagram.com/mitocw/"><img src="https://ocw.mit.edu/images/icon_ig.png" alt="Click to visit our Instagram page."></a> <a aria-label="Twitter" href="https://twitter.com/mitocw"><img src="https://ocw.mit.edu/images/icon_twitter.png" alt="Click to visit our Twitter feed."></a><a aria-label="YouTube" href="https://www.youtube.com/mitocw" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_yt.png" alt="Click to visit our YouTube page."></a><span style="font-size: 12.208px;">   </span><a aria-label="Open Matters blog on WordPress" href="https://www.ocw-openmatters.org/" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_wp.png" alt="Click to visit our blog on WordPress."></a>
</td>
        </tr>
    </tbody>
</table>
</aside><nav aria-label="Help Links" class="helplinks">     <a aria-label="OCW Site Help" href="https://ocw.mit.edu/help">Help</a><span aria-hidden="true">|</span>     <a href="../../../common/about/contactus.htm">Contact Us</a>   </nav>
</div>
<div class="clear"> </div>
<!--googleon: index-->
</div>

</div>

<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75">
<div class="portletStaticText portlet-static-mega-menu"><div><nav id="mega" class="grid_8 alpha" aria-label="Site">
<ul id="menu" role="presentation">
    <li id="menu_home">
<a href="https://ocw.mit.edu/" aria-label="Homepage"><img src="../../../common/images/top-nav_home.png" class="home_icon" alt="Click for site home page."></a><!-- Begin Home Item -->
</li>
    <!-- End Home Item -->
    <li id="drop_1" aria-label="Find Courses">
<a href="#" aria-hidden="true">FIND COURSES</a><!-- Begin 5 columns Item -->
    <div class="dropdown_5columns-a mega-courses">
    <div class="col_1a">
    <div class="row_1a">
<nav aria-labelledby="mm-find-courses-by">     <span id="mm-find-courses-by" class="nav" aria-hidden="true">Find courses by:</span>
    <ul class="find_by" role="presentation">
        <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Topic</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-number/">MIT Course Number</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-department/">Department</a></li>
    </ul>
    </nav>     <nav aria-labelledby="mm-collections">     <span id="mm-collections" class="nav" aria-hidden="true">Collections</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Lectures</a></li>
        <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
        <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
        <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    </ul>
    </nav>     <nav class="col_1b" aria-labelledby="mm-translated-courses">     <span id="mm-translated-courses" class="nav" aria-hidden="true" style="line-height: 1.3;">Cross-Disciplinary Topic Lists</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/energy-courses">Energy</a></li>
        <li><a href="https://ocw.mit.edu/courses/entrepreneurship">Entrepreneurship</a></li>
        <li><a href="https://ocw.mit.edu/courses/environment-courses">Environment</a></li>
        <li><a href="https://ocw.mit.edu/courses/intro-programming">Introductory Programming</a></li>
        <li><a href="https://ocw.mit.edu/courses/life-sciences">Life Sciences</a></li>
        <li><a href="https://ocw.mit.edu/courses/transportation-courses">Transportation</a></li>
    </ul>
    </nav>
</div>
    <div class="row_1b"><nav aria-labelledby="mm-cross-disciplinary-topic-lists">     <span id="mm-cross-disciplinary-topic-lists" class="nav" aria-hidden="true">Translated Courses</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/translated-courses/traditional-chinese" aria-label="Traditional Chinese">繁體字 / Traditional Chinese</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/turkish" aria-label="Turkish">Türkçe / Turkish</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/korean" aria-label="Korean">(비디오)한국 / Korean</a></li>
    </ul>
    </nav></div>
    </div>
    </div>
    </li>
    <li id="drop_2">
<a href="#" aria-label="For Educators">For Educators</a>
    <div class="dropdown_1column-a" style="width: 270px;"><nav aria-labelledby="mm-find-courses-by">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/chalk-radio-podcast">Chalk Radio Podcast</a></li>
        <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
        <li><a href="https://openlearning.mit.edu/campus/digital-innovations/">Residential Digital Innovations </a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_3">
<a href="#" aria-hidden="true">Give Now</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="Donate">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
        <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
        <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
        <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
        <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_4">
<a href="#" aria-hidden="true">About</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="About">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/about/">About MIT OpenCourseWare</a></li>
        <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
        <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
        <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
        <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
        <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
    </ul>
    </nav></div>
    </li>
</ul>
</nav></div></div>

</div>





<!--googleoff: index-->
<script>
  (function() {
	var cx = '012626166551961672889:owjdpuboktq';
	var gcse = document.createElement('script');
	gcse.type = 'text/javascript';
	gcse.async = true;
	gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(gcse, s);
  })();
  window.onload = function(){
	document.getElementById('gsc-i-id1').placeholder = 'Search';	
  };

$(document).ready(function(){

$('.advanceSearch a').keydown(function(event){showSearchTips($(this),event);})
$('#searchTipsModal').keydown(function(event){showSearchTips($(this),event);})

function showSearchTips(obj,evt) {
// if pressed enter key
	if ( evt.which == 13 || evt.which == 32) {
		showModal();
		ga('send', 'pageview', "AdvanceSearch");
		$(".advanceSearch a").attr('aria-expanded', 'true');
		$('.searchTipsModal').focus();
		evt.preventDefault();
		}
	if ( evt.which == 27 ) {
		hideModal();
		$(".advanceSearch a").attr('aria-expanded', 'false');
		var modal = document.getElementById('searchTipsModal');
		modal.style.display = "none";
		$(".advanceSearch a").focus();
		evt.preventDefault();
		}
}

});
function showModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "block";
	ga('send', 'pageview', "AdvanceSearch");
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", true);
	window.setTimeout(function () {
    document.getElementById('searchTipsModal').focus(); }, 0);
}

function hideModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "none";
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", false);
}
</script>
<div id="search" role="search" class="grid_4 omega">
    	<table class="search">
				<tbody>
					<tr>
						<td><div class="searchboxheader"><searchbox-only resultsurl="/search/ocwsearch.htm"></searchbox-only></div></td>
						<td>
							<div class="advanceSearch">
								<a id="searchTipsBtn" onclick="showModal();" href="#" role="button" aria-label="search tips" aria-expanded="false" aria-describedby="searchtips">Search Tips</a>

								<!-- The Modal -->
								<div id="searchTipsModal" class="modal" tabindex="-1">
								  <!-- Modal content -->
									<div class="modal-content">
										<div class="modal-body">
											<button class="close" onclick="hideModal();" aria-label="close">X</button>
											<span>
												<b>Exclude words from your search</b>
												<br>Put - in front of a word you want to leave out. For example, jaguar speed -car
												<br><br>
												<b>Search for an exact match</b>
												<br>Put a word or phrase inside quotes. For example, "tallest building".
												<br><br>
												<b>Search for wildcards or unknown words</b>
												<br>Put a * in your word or phrase where you want to leave a placeholder. For example, "largest * in the world".
												<br><br>
												<b>Search within a range of numbers</b>
												<br>Put .. between two numbers. For example, camera $50..$100.
												<br><br>
												<b>Combine searches</b>
												<br>Put "OR" between each search query. For example,  marathon OR race.
												<br><br>
											</span>
										</div>
								  </div>
								</div>
							</div>
						</td>
					</tr>
				</tbody>
		</table>
</div>
<div class="clear"></div>
<!--googleon: index-->
<!-- *end header* -->

				
				
			</div>
<!-- top grid end -->
		</header><!-- top end -->
			
		<div id="center_media">
      	<div id="grid">
      		<div id="left">
        		<nav id="breadcrumb_media" aria-label="Breadcrumb">
                	<p>

    <a href="https://ocw.mit.edu/">Home</a>
    
        »
        
    
    
        
            <a href="https://ocw.mit.edu/courses">Courses</a>
            
                »
                
            
            
         
    
    
        
            <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science">Electrical Engineering and Computer Science</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/index.htm">Computer Systems Security</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/video-lectures/index.htm">Lecture Videos</a>
            
                »
                
            
            
         
    
    
        
            
            
            Lecture 11: Ur/Web
         
    
</p>

            	</nav>
            	<div class="clear"></div>
        		<div id="media_title">
        		<h1 class="title" itemprop="name" property="dct:title">
        <span class="" id="parent-fieldname-title">
            Lecture 11: Ur/Web
        </span>
    </h1>
        		</div>
           		<div class="clear"></div>
           		<div id="course_wrapper_media">
           			<nav id="course_nav" aria-label="Course">
           				<script language="javascript" type="text/javascript">
function toggleMenu(objID) {
  if (!document.getElementById) return;
  var ob = document.getElementById(objID);
  ob.className = (ob.className == 'selected')?'': 'selected';
}
function toggleClass(id)
{
  var divtoggleClass= document.getElementById(id);
  divtoggleClass.className = (divtoggleClass.className == 'mO')?'mC': 'mO';
  return false;
}
function changeAlt(id)
{
  id.alt = (id.alt == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
  id.title = (id.title == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
}
</script>
<!--Left Nav Starts -->


	<ul>			  
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/index.htm">
		                  Course Home  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/syllabus/index.htm">
		                  Syllabus  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/calendar/index.htm">
		                  Calendar  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/readings/index.htm">
		                  Readings  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/lecture-notes/index.htm">
		                  Lecture Notes  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="selected">
			   			<a href="../../../contents/video-lectures/index.htm">
		                  Lecture Videos  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/labs/index.htm">
		                  Labs  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/exams/index.htm">
		                  Exams  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/final-project/index.htm">
		                  Final Project  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/related-resources/index.htm">
		                  Related Resources  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    
		    
         	
	<!--second tal block close-->  
	
</ul>


<!--Left Nav Ends -->





           			</nav>
           			<main id="course_inner_media" aria-labelledby="media_title">
      					 
        <div class="" id="parent-fieldname-text">
            
            
        </div>
    
      					     
    
    



<script type="text/javascript">var caption_embed_1 ={'English - US': '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-11-ur-web/XMEFdofERLI.srt'}</script>     
     <div id="media-embed">
         <div class="attention_message" id="embed_1">
<p>Flash and JavaScript are required for this feature.</p>
<p>Download the video from <a href="https://itunes.apple.com/us/itunes-u/id1017908130">iTunes U</a> or the <a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec11_300k.mp4">Internet Archive</a>.</p>
</div>
     </div>
    
     <script type="text/javascript">ocw_embed_chapter_media('embed_1', 'https://www.youtube.com/v/XMEFdofERLI', 'youtube', '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-11-ur-web', 'https://img.youtube.com/vi/XMEFdofERLI/0.jpg',0,0, 'https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-11-ur-web/XMEFdofERLI.srt')</script>
	 
	 
	 		
	 		<div id="transcript1"></div>
				 <script type="text/javascript">createThreePlayParams(2, 662954, "embed_1", 0, 0)</script>
			 
	

     <div id="media_resource_next_prev_nav" style="margin-top: 1em;">
        <p>
        
            <a href="../../../contents/video-lectures/lecture-10-symbolic-execution/index.htm">
                <img src="../../../common/images/btn_previous_resource.png" style="margin: 0 30px 0 50px;" alt="Previous track" title="Previous track"></a>
     	
     	
        
            <a href="../../../contents/video-lectures/lecture-12-network-security/index.htm"> 
                <img src="../../../common/images/btn_next_resource.png" alt="Next track" title="Next track"></a>
       
       </p>
     </div>
 


<script type="text/javascript">
		window.onload=function(){
		init();
		
		}
		var tabLinks = new Array();
		var contentDivs = new Array();
		function init() {
		  // Grab the tab links and content divs from the page
		  var tabListItems = document.getElementById('tabs').childNodes;
		  for ( var i = 0; i < tabListItems.length; i++ ) {
			if ( tabListItems[i].nodeName == "LI" ) {
			  var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
			  var id = getHash( tabLink.getAttribute('href') );
			  tabLinks[id] = tabLink;
			  contentDivs[id] = document.getElementById( id );
			}
		  }
		  // Assign onclick events to the tab links, and
		  // highlight the first tab
		  var i = 0;
		  for ( var id in tabLinks ) {
			tabLinks[id].onclick = showTab;
			tabLinks[id].onfocus = function() { this.blur() };
			if ( i == 0 ) tabLinks[id].className = 'selected';
			i++;
		  }
		  // Hide all content divs except the first
		  var i = 0;
		  for ( var id in contentDivs ) {
			if ( i != 0 ) contentDivs[id].className = 'tabContent hide';
			i++;
		  }
		}
		function showTab() {
		  var selectedId = getHash( this.getAttribute('href') );
		  // Highlight the selected tab, and dim all others.
		  // Also show the selected content div, and hide all others.
		  for ( var id in contentDivs ) {
			if ( id == selectedId ) {
			  tabLinks[id].className = 'selected';
			  contentDivs[id].className = 'tabContent';
			} else {
			  tabLinks[id].className = '';
			  contentDivs[id].className = 'tabContent hide';
			}
		  }
		  // Stop the browser following the link
		  return false;
		}
		function getFirstChildWithTagName( element, tagName ) {
		  for ( var i = 0; i < element.childNodes.length; i++ ) {
			if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
		  }
		}
		function getHash( url ) {
		  var hashPos = url.lastIndexOf ( '#' );
		  return url.substring( hashPos + 1 );
		}
 </script>	
 

  <div id="media_tabs">
     
        <ul id="tabs">
            <li class="first">
                <a href="#vid_about" class="selected">About this Video</a>
            </li>
            <li class="">
                <a href="#vid_index" class="">Playlist</a>
            </li>
            <li class="">
                <a href="#vid_playlist" class="">Transcript</a>
            </li>
            <li class="">
                <a href="#vid_related" class="">Download this Video</a>
            </li>
        </ul>
   
        <div id="vid_about" itemprop="description" class="tabContent">
<p><strong>Description:</strong> In this lecture, Professor Chlipala discusses Ur/Web, the programming language he created for modern web applications.</p>  <p><strong>Instructor:</strong> Nickolai Zeldovich and Adam Chlipala</p>
</div>
        <div id="vid_index" itemprop="description" class="tabContent hide">
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-1-introduction-threat-models/index.htm">
<img src="https://img.youtube.com/vi/GqmQg-cszw4/default.jpg" title="Lecture 1: Introduction, Threat Models" alt="Lecture 1: Introduction, Threat Models">
<p>Lecture 1: Introduction, Th...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-2-control-hijacking-attacks/index.htm">
<img src="https://img.youtube.com/vi/r4KjHEgg9Wg/default.jpg" title="Lecture 2: Control Hijacking Attacks" alt="Lecture 2: Control Hijacking Attacks">
<p>Lecture 2: Control Hijackin...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-3-buffer-overflow-exploits-and-defenses/index.htm">
<img src="https://img.youtube.com/vi/xSQxaie_h1o/default.jpg" title="Lecture 3: Buffer Overflow Exploits and Defenses" alt="Lecture 3: Buffer Overflow Exploits and Defenses">
<p>Lecture 3: Buffer Overflow ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-4-privilege-separation/index.htm">
<img src="https://img.youtube.com/vi/dNl22h1kW1k/default.jpg" title="Lecture 4: Privilege Separation" alt="Lecture 4: Privilege Separation">
<p>Lecture 4: Privilege Separa...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-6-capabilities/index.htm">
<img src="https://img.youtube.com/vi/TQhmua7Z2cY/default.jpg" title="Lecture 6: Capabilities" alt="Lecture 6: Capabilities">
<p>Lecture 6: Capabilities</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-7-sandboxing-native-code/index.htm">
<img src="https://img.youtube.com/vi/I0Psvvky-44/default.jpg" title="Lecture 7: Sandboxing Native Code	" alt="Lecture 7: Sandboxing Native Code	">
<p>Lecture 7: Sandboxing Nativ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-8-web-security-model/index.htm">
<img src="https://img.youtube.com/vi/eRJ_r8WF1Y0/default.jpg" title="Lecture 8: Web Security Model" alt="Lecture 8: Web Security Model">
<p>Lecture 8: Web Security Model</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-9-securing-web-applications/index.htm">
<img src="https://img.youtube.com/vi/WlmKwIe9z1Q/default.jpg" title="Lecture 9: Securing Web Applications" alt="Lecture 9: Securing Web Applications">
<p>Lecture 9: Securing Web App...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-10-symbolic-execution/index.htm">
<img src="https://img.youtube.com/vi/yRVZPvHYHzw/default.jpg" title="Lecture 10: Symbolic Execution" alt="Lecture 10: Symbolic Execution">
<p>Lecture 10: Symbolic Execution</p></a>
</div>
<div class="related-media-thumbnail-nolink">
<div class="now-playing-resource">Now Playing</div>
<img src="https://img.youtube.com/vi/XMEFdofERLI/default.jpg" title="Lecture 11: Ur/Web" alt="Lecture 11: Ur/Web">
<p>Lecture 11: Ur/Web</p>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-12-network-security/index.htm">
<img src="https://img.youtube.com/vi/BZTWXl9QNK8/default.jpg" title="Lecture 12: Network Security" alt="Lecture 12: Network Security">
<p>Lecture 12: Network Security</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-13-network-protocols/index.htm">
<img src="https://img.youtube.com/vi/QOtA76ga_fY/default.jpg" title="Lecture 13: Network Protocols" alt="Lecture 13: Network Protocols">
<p>Lecture 13: Network Protocols</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-14-ssl-and-https/index.htm">
<img src="https://img.youtube.com/vi/q1OF_0ICt9A/default.jpg" title="Lecture 14: SSL and HTTPS" alt="Lecture 14: SSL and HTTPS">
<p>Lecture 14: SSL and HTTPS</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-15-medical-software/index.htm">
<img src="https://img.youtube.com/vi/bA3xCpYLA34/default.jpg" title="Lecture 15: Medical Software" alt="Lecture 15: Medical Software">
<p>Lecture 15: Medical Software</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-16-side-channel-attacks/index.htm">
<img src="https://img.youtube.com/vi/3v5Von-oNUg/default.jpg" title="Lecture 16: Side-Channel Attacks" alt="Lecture 16: Side-Channel Attacks">
<p>Lecture 16: Side-Channel At...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-17-user-authentication/index.htm">
<img src="https://img.youtube.com/vi/MT7X17ZRo1U/default.jpg" title="Lecture 17: User Authentication" alt="Lecture 17: User Authentication">
<p>Lecture 17: User Authentica...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-18-private-browsing/index.htm">
<img src="https://img.youtube.com/vi/YTWXAFJf8bw/default.jpg" title="Lecture 18: Private Browsing" alt="Lecture 18: Private Browsing">
<p>Lecture 18: Private Browsing</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-19-anonymous-communication/index.htm">
<img src="https://img.youtube.com/vi/OgGTJIgNewE/default.jpg" title="Lecture 19: Anonymous Communication" alt="Lecture 19: Anonymous Communication">
<p>Lecture 19: Anonymous Commu...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-20-mobile-phone-security/index.htm">
<img src="https://img.youtube.com/vi/uT7BXusDgDM/default.jpg" title="Lecture 20: Mobile Phone Security" alt="Lecture 20: Mobile Phone Security">
<p>Lecture 20: Mobile Phone Se...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-21-data-tracking/index.htm">
<img src="https://img.youtube.com/vi/WG5UbMrUiLU/default.jpg" title="Lecture 21: Data Tracking" alt="Lecture 21: Data Tracking">
<p>Lecture 21: Data Tracking</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-22-guest-lecture-by-mit-is-t/index.htm">
<img src="https://img.youtube.com/vi/2PO8h1pVW50/default.jpg" title="Lecture 22: Guest Lecture by MIT IS&amp;T" alt="Lecture 22: Guest Lecture by MIT IS&amp;T">
<p>Lecture 22: Guest Lecture b...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-23-security-economics/index.htm">
<img src="https://img.youtube.com/vi/8PdnOZI7H5E/default.jpg" title="Lecture 23: Security Economics" alt="Lecture 23: Security Economics">
<p>Lecture 23: Security Economics</p></a>
</div>
</div>
        <div id="vid_playlist" itemprop="description" class="tabContent hide">
<ul><li><a class="transcript-link" title="Open in a new window." alt="Open in a new window." style="text-decoration: none; font-size: 1.0em;" target="_blank" text-decoration: none font-size: href="../../../contents/video-lectures/lecture-11-ur-web/XMEFdofERLI.pdf"> Download English-US transcript (PDF)</a></li></ul>
<p><span m="90">The</span> <span m="170">following</span> <span m="610">content</span> <span m="1120">is</span> <span m="1230">provided</span> <span m="1670">under</span> <span m="1940">a</span> <span m="1980">Creative</span> <span m="2430">Commons</span> <span m="2830">license.</span> <span m="3820">Your</span> <span m="3920">support</span> <span m="4420">will</span> <span m="4560">help</span> <span m="4820">MIT</span> <span m="5310">OpenCourseWare</span> <span m="6060">continue</span> <span m="6540">to</span> <span m="6680">offer</span> <span m="7000">high</span> <span m="7210">quality</span> <span m="7720">educational</span> <span m="8370">resources</span> <span m="8940">for</span> <span m="9080">free.</span> <span m="10150">To</span> <span m="10250">make</span> <span m="10350">a</span> <span m="10400">donation</span> <span m="11090">or</span> <span m="11340">to</span> <span m="11450">view</span> <span m="11660">additional</span> <span m="12070">materials</span> <span m="12700">from</span> <span m="12860">hundreds</span> <span m="13190">of</span> <span m="13300">MIT</span> <span m="13680">courses,</span> <span m="15000">visit</span> <span m="15160">MIT</span> <span m="15690">OpenCourseWare</span> <span m="16600">at</span> <span m="16830">ocw.mit.edu.</span> </p>
<p><span m="26790">PROFESSOR: All</span> <span m="27290">right,</span> <span m="27660">guys,</span> <span m="28320">let's get</span> <span m="28610">started.</span> <span m="28930">So today,</span> <span m="29250">we're</span> <span m="29660">going</span> <span m="30025">to</span> <span m="30390">talk</span> <span m="30690">about</span> <span m="31080">a</span> <span m="31110">very</span> <span m="31350">different</span> <span m="31780">and</span> <span m="32231">principled</span> <span m="32682">approach</span> <span m="33133">to</span> <span m="33674">building</span> <span m="33764">secure</span> <span m="33854">web</span> <span m="33944">applications.</span> <span m="34035">And</span> <span m="34486">it's</span> <span m="34937">going</span> <span m="35390">to be</span> <span m="35440">about a</span> <span m="35730">system</span> <span m="35930">called</span> <span m="36270">Ur/Web.</span> <span m="36670">And</span> <span m="37106">right</span> <span m="37154">now,</span> <span m="37202">our</span> <span m="37251">guest</span> <span m="37396">lecturer</span> <span m="37978">is the</span> <span m="38414">author of the</span> <span m="38850">system,</span> <span m="39260">Adam</span> <span m="39380">Chlipala,</span> <span m="39530">who's</span> <span m="39950">a</span> <span m="40370">professor</span> <span m="40790">at MIT,</span> <span m="41210">is going to</span> <span m="41630">tell</span> <span m="41747">you</span> <span m="41982">more</span> <span m="42100">about</span> <span m="42485">the</span> <span m="42870">system</span> <span m="43367">he built.</span> </p>
<p><span m="44361">ADAM CHLIPALA: All</span> <span m="45000">right,</span> <span m="45380">so</span> <span m="46700">I</span> <span m="47090">want</span> <span m="47280">to</span> <span m="47330">get</span> <span m="47650">to</span> <span m="48210">a</span> <span m="48410">demo</span> <span m="48830">as</span> <span m="48920">soon</span> <span m="49100">as</span> <span m="49200">possible.</span> <span m="49770">But</span> <span m="50160">before</span> <span m="50450">that,</span> <span m="50670">I</span> <span m="51030">just</span> <span m="51240">want</span> <span m="51370">to</span> <span m="51420">spend</span> <span m="51630">some</span> <span m="51770">slides</span> <span m="52290">setting</span> <span m="52710">up</span> <span m="52920">part</span> <span m="53130">of</span> <span m="53180">the</span> <span m="53260">context</span> <span m="53800">about</span> <span m="54030">this</span> <span m="54130">system.</span> <span m="54890">And</span> <span m="55290">you've</span> <span m="55400">probably</span> <span m="56150">gotten</span> <span m="56460">some of</span> <span m="56540">that</span> <span m="56710">context</span> <span m="57150">already</span> <span m="57500">from</span> <span m="57700">the</span> <span m="58580">draft</span> <span m="58970">paper</span> <span m="59340">that</span> <span m="59560">was</span> <span m="59830">the</span> <span m="60360">reading</span> <span m="60730">for</span> <span m="60810">this</span> <span m="61050">class.</span> <span m="63740">So</span> <span m="64300">what</span> <span m="64450">is</span> <span m="64560">Ur/Web?</span> <span m="65410">It's</span> <span m="65510">always</span> <span m="65750">good</span> <span m="65890">to</span> <span m="65950">start</span> <span m="66200">out</span> <span m="66450">by</span> <span m="66770">explaining</span> <span m="67240">what</span> <span m="67360">the</span> <span m="67430">name</span> <span m="67700">of</span> <span m="67800">something</span> <span m="68110">means.</span> </p>
<p><span m="68885">So</span> <span m="69180">Ur/Web,</span> <span m="69440">first</span> <span m="69720">it's</span> <span m="70940">a</span> <span m="71760">programming</span> <span m="72200">language</span> <span m="72600">for</span> <span m="72730">building</span> <span m="73160">web</span> <span m="73340">applications.</span> <span m="74030">That's</span> <span m="74160">what</span> <span m="74310">the</span> <span m="74390">Web</span> <span m="74600">part</span> <span m="74820">of</span> <span m="74870">the</span> <span m="74950">name</span> <span m="75190">means.</span> <span m="76045">And</span> <span m="76500">it's</span> <span m="76720">sort of</span> <span m="77000">a</span> <span m="77050">full</span> <span m="77300">stack</span> <span m="77710">system.</span> <span m="78050">It</span> <span m="78150">does</span> <span m="78420">everything</span> <span m="78710">you</span> <span m="78790">need</span> <span m="78970">to</span> <span m="79470">do</span> <span m="79730">to</span> <span m="79860">build</span> <span m="80160">web</span> <span m="80350">applications.</span> <span m="82640">And</span> <span m="82870">Ur</span> <span m="83260">is</span> <span m="83500">a</span> <span m="84390">new</span> <span m="84570">general</span> <span m="84930">purpose</span> <span m="85760">functional</span> <span m="86130">programming</span> <span m="86560">language</span> <span m="87500">that</span> <span m="87770">is</span> <span m="87880">used</span> <span m="88250">to</span> <span m="88460">implement</span> <span m="88950">these</span> <span m="89510">web</span> <span m="89750">specific</span> <span m="90720">features.</span> </p>
<p><span m="93820">And</span> <span m="94680">the</span> <span m="94800">whole</span> <span m="95020">point</span> <span m="95290">of</span> <span m="95420">Ur/Web</span> <span m="95880">is</span> <span m="96050">that</span> <span m="96200">instead</span> <span m="96430">of</span> <span m="96550">having</span> <span m="96820">a</span> <span m="96860">general</span> <span m="97160">purpose</span> <span m="97450">programming</span> <span m="97860">language</span> <span m="98340">and then</span> <span m="98440">having</span> <span m="98710">a</span> <span m="98780">library</span> <span m="99210">or</span> <span m="99640">a</span> <span m="99920">traditional</span> <span m="100330">framework</span> <span m="100840">for</span> <span m="100970">building</span> <span m="101240">web</span> <span m="101450">applications,</span> <span m="102370">it's</span> <span m="102540">all</span> <span m="102680">integrated</span> <span m="103130">into</span> <span m="103340">a</span> <span m="103660">customized</span> <span m="104200">programming</span> <span m="104590">language</span> <span m="105030">in</span> <span m="105200">Ur/Web.</span> <span m="105730">And</span> <span m="105920">it's</span> <span m="106300">a</span> <span m="107100">language</span> <span m="107500">that</span> <span m="107840">involves</span> <span m="108260">compilation,</span> <span m="109070">not</span> <span m="109690">interpretation</span> <span m="110360">at</span> <span m="110440">run</span> <span m="110630">time.</span> <span m="111100">And</span> <span m="111280">the</span> <span m="111350">compiler</span> <span m="111910">in</span> <span m="112010">some</span> <span m="112210">sense</span> <span m="112500">understands</span> <span m="113400">what</span> <span m="113660">a</span> <span m="113720">web</span> <span m="113890">application</span> <span m="114175">is</span> <span m="114460">supposed</span> <span m="114870">to</span> <span m="114950">do.</span> <span m="115490">And</span> <span m="115720">it</span> <span m="115810">will</span> <span m="115960">point</span> <span m="116220">out</span> <span m="116550">mistakes that</span> <span m="116950">you're</span> <span m="117150">making</span> <span m="117880">that</span> <span m="118210">a</span> <span m="118450">conventional</span> <span m="119040">compiler,</span> <span m="119620">for</span> <span m="119780">say</span> <span m="120010">Java,</span> <span m="120700">would</span> <span m="120870">not</span> <span m="121070">be</span> <span m="121200">able</span> <span m="121360">to</span> <span m="121910">realize</span> <span m="122280">where</span> <span m="122400">mistakes.</span> </p>
<p><span m="124170">So</span> <span m="125090">there</span> <span m="125310">are</span> <span m="125360">really</span> <span m="125590">three</span> <span m="125860">main</span> <span m="126090">principles</span> <span m="126620">that</span> <span m="127790">I</span> <span m="128039">was</span> <span m="128520">trying</span> <span m="128949">to</span> <span m="129509">follow</span> <span m="129910">in</span> <span m="129990">designing</span> <span m="130380">this</span> <span m="130560">language.</span> <span m="131590">The</span> <span m="131750">middle</span> <span m="131950">one</span> <span m="132140">is</span> <span m="132230">most</span> <span m="132460">relevant</span> <span m="132880">in</span> <span m="132970">this</span> <span m="133110">context.</span> <span m="133850">But</span> <span m="134650">they</span> <span m="135070">are</span> <span m="135240">programmer</span> <span m="135600">productivity,</span> <span m="136260">security,</span> <span m="136970">and</span> <span m="137210">performance.</span> <span m="137860">And</span> <span m="137950">the</span> <span m="138020">last</span> <span m="138320">part,</span> <span m="138580">especially</span> <span m="139100">on</span> <span m="139250">the</span> <span m="139320">server</span> <span m="139660">side,</span> <span m="140740">because</span> <span m="142080">that</span> <span m="142300">seemed</span> <span m="142500">more</span> <span m="142700">important</span> <span m="143090">for</span> <span m="143200">scaling</span> <span m="143600">reasons.</span> <span m="144350">In</span> <span m="144470">many</span> <span m="144680">cases,</span> <span m="145840">the</span> <span m="146130">users</span> <span m="146440">of</span> <span m="146560">your</span> <span m="146650">application</span> <span m="147200">won't</span> <span m="147410">notice</span> <span m="148110">small</span> <span m="149300">performance</span> <span m="149810">issues</span> <span m="150140">on</span> <span m="150200">the</span> <span m="150270">client</span> <span m="150600">side.</span> <span m="150900">But</span> <span m="151010">a</span> <span m="151060">small issue</span> <span m="151510">on</span> <span m="151640">the</span> <span m="151720">server</span> <span m="152000">side</span> <span m="152270">could</span> <span m="152420">force</span> <span m="152650">you</span> <span m="152720">to</span> <span m="152780">buy</span> <span m="153310">many</span> <span m="153520">more</span> <span m="153720">servers</span> <span m="154110">than</span> <span m="154220">you</span> <span m="154300">would</span> <span m="154410">have</span> <span m="154590">otherwise.</span> </p>
<p><span m="157950">And</span> <span m="158660">at</span> <span m="158800">this</span> <span m="158950">point,</span> <span m="159790">there</span> <span m="159900">are</span> <span m="160090">some</span> <span m="160350">users</span> <span m="160960">of</span> <span m="161120">Ur/Web--</span> <span m="161820">not</span> <span m="162010">nearly</span> <span m="162280">as</span> <span m="162380">much</span> <span m="162680">as</span> <span m="162810">pretty</span> <span m="162980">much</span> <span m="163200">any</span> <span m="163450">other</span> <span m="163950">language</span> <span m="164380">you</span> <span m="164490">probably</span> <span m="164790">think</span> <span m="165030">of.</span> <span m="165490">But</span> <span m="165730">there's</span> <span m="165920">at</span> <span m="165980">least</span> <span m="166210">this</span> <span m="166380">one</span> <span m="166730">commercial</span> <span m="167600">web</span> <span m="167810">application,</span> <span m="168730">which</span> <span m="169030">is</span> <span m="169330">an</span> <span m="169660">RSS</span> <span m="170260">feed</span> <span m="170480">reader</span> <span m="171270">that</span> <span m="171710">supports</span> <span m="172170">such</span> <span m="172450">exotic</span> <span m="172950">features</span> <span m="173420">as</span> <span m="173570">displaying</span> <span m="173980">comments.</span> <span m="175170">And</span> <span m="175840">there's</span> <span m="176020">the</span> <span m="176100">URL</span> <span m="176990">chosen</span> <span m="177400">by</span> <span m="177560">a</span> <span m="177640">non-native</span> <span m="178200">English</span> <span m="178490">speaker</span> <span m="178860">who</span> <span m="179060">regrets</span> <span m="179460">it</span> <span m="179570">now.</span> <span m="180210">It's</span> <span m="180500">called</span> <span m="180800">BazQux</span> <span m="181150">Reader,</span> <span m="181500">as</span> <span m="181610">a</span> <span m="181780">combination</span> <span m="182310">of</span> <span m="182410">common</span> <span m="182810">medicine</span> <span m="183200">tactic</span> <span m="183600">variables</span> <span m="184140">from</span> <span m="184830">the</span> <span m="184920">hacker</span> <span m="185690">community.</span> </p>
<p><span m="186840">And</span> <span m="187450">there</span> <span m="187710">are</span> <span m="188350">a</span> <span m="188430">few</span> <span m="188620">thousand</span> <span m="189310">paying</span> <span m="189620">users.</span> <span m="190040">And it</span> <span m="190180">looks</span> <span m="190350">like</span> <span m="190540">that--</span> <span m="190980">much</span> <span m="191180">nicer</span> <span m="191490">than</span> <span m="191640">anything</span> <span m="192060">I</span> <span m="192190">know</span> <span m="192350">how</span> <span m="192500">to</span> <span m="192880">make</span> <span m="193380">with</span> <span m="193800">CSS.</span> <span m="195010">But</span> <span m="195470">here's</span> <span m="195720">a</span> <span m="196000">proof</span> <span m="196280">that it</span> <span m="196480">can</span> <span m="196580">be</span> <span m="196670">done</span> <span m="197000">using</span> <span m="197260">Ur/Web.</span> <span m="200640">Feel</span> <span m="200770">free</span> <span m="201160">to</span> <span m="201370">jump</span> <span m="201620">in</span> <span m="201730">with</span> <span m="201830">questions</span> <span m="202270">at</span> <span m="202340">any</span> <span m="202480">point,</span> <span m="203120">though</span> <span m="203460">I</span> <span m="203520">probably</span> <span m="203750">haven't</span> <span m="203960">gotten</span> <span m="204200">to</span> <span m="204250">the</span> <span m="204350">point</span> <span m="204610">yet</span> <span m="204870">that</span> <span m="205050">provokes</span> <span m="205420">many</span> <span m="205600">questions.</span> </p>
<p><span m="207400">So</span> <span m="207780">the</span> <span m="207830">basic</span> <span m="208150">sales</span> <span m="208430">pitch</span> <span m="208910">for</span> <span m="209215">Ur/Web</span> <span m="209520">is</span> <span m="209900">that</span> <span m="210050">it has</span> <span m="210220">a</span> <span m="210260">very</span> <span m="210450">high</span> <span m="210740">level</span> <span m="211010">programming</span> <span m="211430">model,</span> <span m="211740">which</span> <span m="211880">is</span> <span m="211990">very</span> <span m="212180">different</span> <span m="212530">from,</span> <span m="212760">say,</span> <span m="212840">Django,</span> <span m="213300">which</span> <span m="213470">I</span> <span m="213510">know</span> <span m="213650">you</span> <span m="213950">spent</span> <span m="214250">some</span> <span m="214390">time</span> <span m="214960">reading</span> <span m="215170">about</span> <span m="215410">or</span> <span m="215520">talking</span> <span m="215810">about</span> <span m="216470">in</span> <span m="217060">class.</span> <span m="218020">And</span> <span m="219190">it</span> <span m="219300">has</span> <span m="219460">a</span> <span m="219730">good</span> <span m="219950">security</span> <span m="220370">story.</span> <span m="221480">Some</span> <span m="221820">features</span> <span m="222210">you</span> <span m="222340">want for</span> <span m="222590">security are</span> <span m="223050">really</span> <span m="223390">integrated</span> <span m="223870">into</span> <span m="224010">the</span> <span m="224110">system</span> <span m="224580">so</span> <span m="224730">that</span> <span m="225000">you</span> <span m="225250">would</span> <span m="225500">really</span> <span m="225710">have</span> <span m="225860">to</span> <span m="225960">work</span> <span m="226210">hard</span> <span m="226520">to</span> <span m="226680">avoid</span> <span m="227530">inheriting</span> <span m="228340">these</span> <span m="228480">security</span> <span m="228880">benefits.</span> <span m="229360">And I'll</span> <span m="229520">say</span> <span m="229910">more</span> <span m="230140">about</span> <span m="230340">the</span> <span m="230410">detail</span> <span m="230800">shortly.</span> <span m="231780">And</span> <span m="232160">also,</span> <span m="232390">the</span> <span m="232480">server</span> <span m="232760">side</span> <span m="232960">performance</span> <span m="233410">is</span> <span m="233540">unusually</span> <span m="234070">good,</span> <span m="234500">even</span> <span m="235070">among</span> <span m="235400">the</span> <span m="235700">popular</span> <span m="236730">tools</span> <span m="237020">for</span> <span m="237130">building</span> <span m="237420">web</span> <span m="237590">applications</span> <span m="238230">that</span> <span m="238350">you're</span> <span m="238560">more</span> <span m="238790">likely</span> <span m="239150">to</span> <span m="239250">have</span> <span m="239350">heard</span> <span m="239570">of</span> <span m="239680">before.</span> </p>
<p><span m="241490">And</span> <span m="242620">the</span> <span m="244020">caveat</span> <span m="244690">is</span> <span m="244910">that</span> <span m="245780">we</span> <span m="245830">probably</span> <span m="246180">need</span> <span m="246520">to</span> <span m="247640">have</span> <span m="247930">internalized</span> <span m="248690">the</span> <span m="248750">big</span> <span m="248950">ideas</span> <span m="249290">of</span> <span m="249410">functional</span> <span m="249770">programming</span> <span m="250390">languages</span> <span m="250800">like</span> <span m="251030">Haskell</span> <span m="251580">before</span> <span m="252710">a</span> <span m="252820">programmer's</span> <span m="253320">ready</span> <span m="253570">to</span> <span m="253650">start</span> <span m="253890">using</span> <span m="254150">Ur/Web.</span> <span m="254550">And</span> <span m="254880">looking</span> <span m="255170">at</span> <span m="255320">the</span> <span m="255760">questions</span> <span m="256209">and</span> <span m="256329">answers</span> <span m="256880">for</span> <span m="257310">this</span> <span m="257779">class,</span> <span m="259110">maybe</span> <span m="260670">a</span> <span m="260749">fifth</span> <span m="260829">of you</span> <span m="260910">were</span> <span m="261589">complaining</span> <span m="262060">about</span> <span m="262500">the</span> <span m="263570">functional</span> <span m="263940">programming</span> <span m="264410">parts</span> <span m="264690">of</span> <span m="264760">the</span> <span m="265060">paper</span> <span m="265380">being</span> <span m="265550">hard</span> <span m="265740">to</span> <span m="265800">follow.</span> </p>
<p><span m="266700">I</span> <span m="266790">apologize.</span> <span m="269420">There</span> <span m="269520">are</span> <span m="269550">just</span> <span m="269730">so</span> <span m="269860">many</span> <span m="270000">good</span> <span m="270180">ideas</span> <span m="270540">in</span> <span m="270590">the</span> <span m="270670">world</span> <span m="270870">of</span> <span m="270940">functional</span> <span m="271310">programming</span> <span m="271800">that</span> <span m="271930">it's</span> <span m="272050">hard</span> <span m="272230">not</span> <span m="272390">to</span> <span m="272450">start</span> <span m="272750">from</span> <span m="272850">that</span> <span m="273030">point</span> <span m="273340">and</span> <span m="273470">add</span> <span m="273630">more</span> <span m="273850">cool</span> <span m="274040">stuff</span> <span m="274300">on</span> <span m="274400">top</span> <span m="274600">of</span> <span m="274640">that.</span> <span m="275070">And</span> <span m="275730">I</span> <span m="275880">will</span> <span m="276040">try</span> <span m="276240">to</span> <span m="276300">avoid</span> <span m="277430">any</span> <span m="277610">requirement</span> <span m="278110">to</span> <span m="278200">know</span> <span m="278350">that</span> <span m="279160">material</span> <span m="279650">to</span> <span m="279890">follow</span> <span m="280470">what</span> <span m="280800">I'll</span> <span m="280900">be</span> <span m="280990">doing</span> <span m="281770">in</span> <span m="281890">class</span> <span m="282300">today.</span> </p>
<p><span m="285240">So</span> <span m="285970">the</span> <span m="286320">programming</span> <span m="286710">model</span> <span m="287420">is</span> <span m="287650">really</span> <span m="287880">closely</span> <span m="288240">connected</span> <span m="288580">to</span> <span m="288660">static</span> <span m="289040">typing.</span> <span m="289910">And</span> <span m="290190">that's</span> <span m="290730">not</span> <span m="291080">just</span> <span m="291250">static</span> <span m="291530">typing</span> <span m="291850">like</span> <span m="292060">in,</span> <span m="292150">say,</span> <span m="292340">Java,</span> <span m="292640">which</span> <span m="292910">has</span> <span m="293040">a</span> <span m="293120">relatively</span> <span m="293590">inexpressive</span> <span m="294170">clunky</span> <span m="294490">type</span> <span m="294730">system,</span> <span m="295130">but</span> <span m="295570">static</span> <span m="295890">typing</span> <span m="296190">like</span> <span m="296380">in</span> <span m="296440">Haskell</span> <span m="296715">or</span> <span m="296990">OCaml.</span> <span m="298460">And</span> <span m="299130">these</span> <span m="299330">types</span> <span m="299630">are</span> <span m="299740">one</span> <span m="299900">of</span> <span m="299950">the</span> <span m="300030">ways</span> <span m="300260">that</span> <span m="300330">the</span> <span m="300400">compiler</span> <span m="301120">understands</span> <span m="301530">what</span> <span m="301630">you're</span> <span m="301740">doing</span> <span m="302380">and</span> <span m="302530">catches</span> <span m="302900">mistakes in</span> <span m="303310">your</span> <span m="303470">program.</span> </p>
<p><span m="305190">And</span> <span m="305400">it</span> <span m="305490">turns</span> <span m="305730">out</span> <span m="305900">that</span> <span m="306270">the</span> <span m="306810">core</span> <span m="307250">Ur</span> <span m="307500">language</span> <span m="308020">that</span> <span m="308140">Ur/Web</span> <span m="308340">is</span> <span m="308430">built</span> <span m="308710">on</span> <span m="308830">top</span> <span m="309180">of has</span> <span m="309320">a</span> <span m="309360">very</span> <span m="309580">expressive</span> <span m="310120">static</span> <span m="310460">type</span> <span m="310690">system.</span> <span m="311090">So</span> <span m="311260">many</span> <span m="311570">of</span> <span m="311670">the</span> <span m="311750">things</span> <span m="312020">that</span> <span m="312110">Ur/Web</span> <span m="312460">does</span> <span m="312700">are</span> <span m="312800">actually</span> <span m="313150">just</span> <span m="313350">exposed as</span> <span m="313840">libraries</span> <span m="314710">with</span> <span m="314850">no</span> <span m="314980">special</span> <span m="315400">compiler</span> <span m="315890">support.</span> <span m="316630">For</span> <span m="316830">instance,</span> <span m="317190">we'll</span> <span m="317390">teach</span> <span m="318080">the</span> <span m="318940">compiler</span> <span m="319760">how</span> <span m="319910">to</span> <span m="320000">type</span> <span m="320260">check</span> <span m="320520">SQL</span> <span m="321060">queries</span> <span m="321560">without</span> <span m="321880">actually</span> <span m="322620">building</span> <span m="323210">the</span> <span m="323300">typing</span> <span m="323640">rules</span> <span m="323860">of</span> <span m="323940">SQL</span> <span m="324430">into</span> <span m="324580">the</span> <span m="324670">compiler.</span> <span m="325420">They</span> <span m="325530">can</span> <span m="325650">be</span> <span m="325770">encoded</span> <span m="326700">as</span> <span m="326890">a</span> <span m="326950">library</span> <span m="327630">and</span> <span m="327840">use</span> <span m="328030">a</span> <span m="328100">standard</span> <span m="328530">type</span> <span m="328760">checker</span> <span m="329310">to</span> <span m="329870">make</span> <span m="330080">sure</span> <span m="330190">your</span> <span m="330330">SQL</span> <span m="330790">queries</span> <span m="331190">are</span> <span m="332350">following</span> <span m="332680">the</span> <span m="332770">rules</span> <span m="333000">of</span> <span m="333070">SQL.</span> </p>
<p><span m="336950">Most</span> <span m="337270">relevant</span> <span m="337600">in</span> <span m="337660">this</span> <span m="337810">context,</span> <span m="338440">the</span> <span m="338540">security</span> <span m="338950">story</span> <span m="340010">at</span> <span m="340140">a</span> <span m="340180">high</span> <span m="340340">level--</span> <span m="342610">most</span> <span m="342950">of</span> <span m="343080">the</span> <span m="343180">most</span> <span m="343490">common</span> <span m="343840">security</span> <span m="344200">vulnerabilities</span> <span m="345230">are</span> <span m="345690">impossible</span> <span m="346380">by</span> <span m="346530">construction</span> <span m="347300">in</span> <span m="347690">Ur/Web.</span> <span m="348690">You</span> <span m="348840">will</span> <span m="348980">have</span> <span m="349190">to</span> <span m="349340">explicitly</span> <span m="350020">enable</span> <span m="350890">scary</span> <span m="351400">looking</span> <span m="351730">flag</span> <span m="352150">names</span> <span m="352920">to</span> <span m="353080">be</span> <span m="353200">allowed</span> <span m="353580">to</span> <span m="353690">do</span> <span m="354020">most</span> <span m="354400">of</span> <span m="354570">the</span> <span m="355220">most</span> <span m="355520">awful</span> <span m="355820">things</span> <span m="356070">you</span> <span m="356170">can</span> <span m="356290">do</span> <span m="356550">in</span> <span m="356630">a</span> <span m="356690">web</span> <span m="356860">application,</span> <span m="357550">like</span> <span m="357750">no</span> <span m="358930">cross</span> <span m="359250">site</span> <span m="359470">scripting</span> <span m="359820">vulnerabilities</span> <span m="360910">unless</span> <span m="361320">you</span> <span m="362090">really</span> <span m="362420">invoke</span> <span m="362780">some</span> <span m="363150">black</span> <span m="363470">magic,</span> <span m="363930">say,</span> <span m="364160">by</span> <span m="364340">using</span> <span m="364610">the</span> <span m="364690">foreign</span> <span m="364980">function</span> <span m="365290">interface.</span> <span m="368020">And</span> <span m="368220">there</span> <span m="368340">are</span> <span m="368370">a</span> <span m="368470">few</span> <span m="368590">other</span> <span m="370050">security-specific</span> <span m="370710">features</span> <span m="371130">that</span> <span m="371610">I'll</span> <span m="371750">highlight</span> <span m="372290">later.</span> </p>
<p><span m="374100">And</span> <span m="374480">the</span> <span m="374560">performance</span> <span m="375000">is</span> <span m="375110">also</span> <span m="375610">very</span> <span m="375820">good.</span> <span m="376540">The</span> <span m="377200">compiler</span> <span m="377790">is,</span> <span m="379290">first</span> <span m="379620">of</span> <span m="379660">all,</span> <span m="380100">a</span> <span m="380740">domain</span> <span m="381040">specific</span> <span m="381450">compiler</span> <span m="381790">for a</span> <span m="382180">web</span> <span m="382370">application.</span> <span m="382970">So</span> <span m="383150">it</span> <span m="383210">understands</span> <span m="384180">what</span> <span m="384480">the</span> <span m="384630">web</span> <span m="384780">application</span> <span m="385260">is</span> <span m="385380">doing</span> <span m="385680">and</span> <span m="385770">is</span> <span m="385890">able</span> <span m="386080">to</span> <span m="386160">optimize</span> <span m="386650">some</span> <span m="386850">things</span> <span m="387210">that</span> <span m="387605">a</span> <span m="387860">more</span> <span m="388070">general</span> <span m="388390">compiler</span> <span m="388800">wouldn't</span> <span m="389040">catch.</span> <span m="389770">And</span> <span m="389950">usually</span> <span m="390350">the</span> <span m="391340">code</span> <span m="391600">that</span> <span m="391670">comes</span> <span m="391880">out</span> <span m="391990">of</span> <span m="392040">this</span> <span m="392160">compiler</span> <span m="392770">that</span> <span m="392850">runs</span> <span m="393030">on</span> <span m="393090">the</span> <span m="393170">server</span> <span m="393570">is</span> <span m="393920">native</span> <span m="394260">code,</span> <span m="394580">which</span> <span m="394770">is</span> <span m="394920">very,</span> <span m="395710">very</span> <span m="396100">competitive</span> <span m="396680">with</span> <span m="397130">what</span> <span m="397390">you</span> <span m="397490">might</span> <span m="397730">bother</span> <span m="398060">to</span> <span m="398190">write</span> <span m="398570">by</span> <span m="398710">hand</span> <span m="399140">in</span> <span m="399280">C.</span> </p>
<p><span m="401450">And</span> <span m="402360">the</span> <span m="402680">performance</span> <span m="403300">costs</span> <span m="403730">that</span> <span m="404100">there</span> <span m="404570">are</span> <span m="404750">compared</span> <span m="405060">to</span> <span m="405110">other</span> <span m="405340">approaches</span> <span m="405770">tend</span> <span m="405990">to</span> <span m="406030">have</span> <span m="406210">to</span> <span m="406320">do</span> <span m="406430">with</span> <span m="406540">the</span> <span m="406610">concurrency</span> <span m="407160">model,</span> <span m="407480">which</span> <span m="407630">makes</span> <span m="407900">the</span> <span m="408000">programmer's</span> <span m="408450">life</span> <span m="408690">easier</span> <span m="409340">at</span> <span m="409510">some</span> <span m="409760">cost</span> <span m="410250">in</span> <span m="410780">performance.</span> <span m="411380">And</span> <span m="411520">I'll</span> <span m="411780">say</span> <span m="411800">a</span> <span m="411820">little</span> <span m="412020">bit</span> <span m="412150">more</span> <span m="412330">about</span> <span m="412540">that</span> <span m="412760">in</span> <span m="412830">a</span> <span m="412870">moment.</span> </p>
<p><span m="415920">Here's</span> <span m="416040">a</span> <span m="416360">quick</span> <span m="416590">plug</span> <span m="416930">for</span> <span m="417260">this</span> <span m="418470">web</span> <span m="418720">framework</span> <span m="419170">benchmarking</span> <span m="419960">initiative</span> <span m="420930">that</span> <span m="421130">is</span> <span m="421290">run</span> <span m="421460">by</span> <span m="421530">a</span> <span m="421600">third</span> <span m="421890">party.</span> <span m="423380">This</span> <span m="423570">is</span> <span m="423710">a</span> <span m="424120">screenshot</span> <span m="424640">of</span> <span m="424800">the</span> <span m="425010">results</span> <span m="425410">of</span> <span m="425470">the</span> <span m="425510">most</span> <span m="425750">recent</span> <span m="426020">round</span> <span m="427460">where</span> <span m="427970">a</span> <span m="428010">number</span> <span m="428280">of</span> <span m="428370">different</span> <span m="428750">web</span> <span m="428960">programming</span> <span m="429350">tasks</span> <span m="429830">were</span> <span m="430090">completed</span> <span m="430480">in</span> <span m="430860">many</span> <span m="431090">different</span> <span m="431360">frameworks,</span> <span m="431870">and</span> <span m="431990">they</span> <span m="432060">were</span> <span m="432200">compared</span> <span m="432650">pretty</span> <span m="432800">much</span> <span m="434210">exclusively</span> <span m="434760">on</span> <span m="434870">performance</span> <span m="435460">so</span> <span m="435610">far.</span> <span m="436470">And</span> <span m="436810">here you</span> <span m="437010">can</span> <span m="437130">see</span> <span m="437530">Ur/Web</span> <span m="438300">sitting</span> <span m="438780">at</span> <span m="439120">fourth</span> <span m="439450">out</span> <span m="439780">of</span> <span m="440320">about</span> <span m="440810">60</span> <span m="441230">frameworks</span> <span m="442180">on</span> <span m="442370">this</span> <span m="442550">benchmark.</span> <span m="443400">And</span> <span m="443880">there's</span> <span m="444070">been</span> <span m="444260">some</span> <span m="444400">improvements</span> <span m="444890">to</span> <span m="444930">the</span> <span m="445050">Ur/Web</span> <span m="445350">compiler</span> <span m="446200">since</span> <span m="446690">this</span> <span m="447480">screenshot</span> <span m="447930">was</span> <span m="448050">taken.</span> <span m="448470">And</span> <span m="448600">I</span> <span m="448730">expect</span> <span m="449220">in the</span> <span m="449290">next</span> <span m="449620">round</span> <span m="449830">it'll</span> <span m="449960">move</span> <span m="450140">up</span> <span m="450280">a</span> <span m="450320">little</span> <span m="450500">bit</span> <span m="450620">higher.</span> </p>
<p><span m="452740">But</span> <span m="452930">basically,</span> <span m="453700">already</span> <span m="454570">this</span> <span m="454760">is</span> <span m="454800">a</span> <span m="454860">simple</span> <span m="455170">example</span> <span m="455590">using</span> <span m="455880">SQL</span> <span m="456320">to</span> <span m="456400">generate</span> <span m="456760">HTML</span> <span m="457230">pages.</span> <span m="457630">You</span> <span m="457940">get</span> <span m="458080">about</span> <span m="458810">100,000</span> <span m="460060">requests</span> <span m="460430">per</span> <span m="460550">second</span> <span m="460970">from</span> <span m="461170">the</span> <span m="461970">Ur/Web</span> <span m="462190">server,</span> <span m="462640">which</span> <span m="462720">is</span> <span m="462930">going</span> <span m="463100">to</span> <span m="463160">be</span> <span m="463520">just</span> <span m="463780">plenty</span> <span m="464090">for</span> <span m="464590">most</span> <span m="464850">applications.</span> <span m="465920">So</span> <span m="466360">sort</span> <span m="466540">of</span> <span m="466990">maybe</span> <span m="467120">the</span> <span m="467860">important</span> <span m="468220">takeaway</span> <span m="468550">message</span> <span m="468940">from</span> <span m="469070">this</span> <span m="469230">slide</span> <span m="469820">in</span> <span m="470260">this</span> <span m="470470">class</span> <span m="470900">is</span> <span m="471170">that</span> <span m="471850">you</span> <span m="471990">can</span> <span m="472300">adopt</span> <span m="472680">a</span> <span m="472700">high</span> <span m="472860">level</span> <span m="473110">model</span> <span m="473520">that</span> <span m="473710">makes</span> <span m="473910">security</span> <span m="474390">easier</span> <span m="474640">to</span> <span m="474770">achieve</span> <span m="475160">without</span> <span m="476440">just</span> <span m="477000">giving</span> <span m="477270">up</span> <span m="477400">all</span> <span m="477520">the</span> <span m="477590">performance</span> <span m="478430">that</span> <span m="478820">you</span> <span m="479010">would</span> <span m="479170">expect</span> <span m="479580">to</span> <span m="479660">get</span> <span m="480160">from</span> <span m="480700">more</span> <span m="480980">mainstream</span> <span m="481530">techniques.</span> </p>
<p><span m="484840">All</span> <span m="484950">right,</span> <span m="485140">so</span> <span m="485450">let</span> <span m="485630">me</span> <span m="485820">start</span> <span m="486110">out</span> <span m="486370">by</span> <span m="486760">giving</span> <span m="487010">my</span> <span m="487250">cartoon</span> <span m="487760">impression</span> <span m="488370">of</span> <span m="488530">the</span> <span m="488620">way</span> <span m="488860">web</span> <span m="489090">programmers</span> <span m="489540">think</span> <span m="489810">about</span> <span m="490380">writing</span> <span m="490640">web</span> <span m="490820">applications</span> <span m="491500">in</span> <span m="491750">mainstream</span> <span m="492180">frameworks</span> <span m="492610">today.</span> <span m="492885">And</span> <span m="493160">then</span> <span m="493340">I'll</span> <span m="493490">show</span> <span m="493730">the</span> <span m="494230">different</span> <span m="494570">perspective</span> <span m="495250">that</span> <span m="495630">Ur/Web</span> <span m="495980">provides,</span> <span m="496690">where</span> <span m="497040">some</span> <span m="497240">of</span> <span m="497290">the</span> <span m="497390">things</span> <span m="497670">that</span> <span m="497810">can</span> <span m="497890">go</span> <span m="498060">wrong</span> <span m="498510">at</span> <span m="498600">this</span> <span m="498800">level</span> <span m="499370">given</span> <span m="499670">the</span> <span m="499770">abstractions</span> <span m="500430">that</span> <span m="500520">are</span> <span m="500650">exposed</span> <span m="501645">can</span> <span m="502020">no</span> <span m="502210">longer</span> <span m="502520">go</span> <span m="502690">wrong</span> <span m="503070">by</span> <span m="503210">construction.</span> </p>
<p><span m="504230">So</span> <span m="504510">the</span> <span m="504580">basic</span> <span m="504910">cartoon</span> <span m="505220">picture is</span> <span m="505650">there's</span> <span m="505740">a</span> <span m="505820">web</span> <span m="505990">server</span> <span m="506330">out</span> <span m="506470">there.</span> <span m="506740">And it's</span> <span m="506860">sort</span> <span m="507020">of</span> <span m="507100">in</span> <span m="507210">charge</span> <span m="507980">of</span> <span m="508430">the</span> <span m="508510">whole</span> <span m="508800">process</span> <span m="509410">of</span> <span m="509560">your</span> <span m="509690">application.</span> <span m="510720">And</span> <span m="511380">there's</span> <span m="511530">a</span> <span m="511600">whole</span> <span m="511780">fleet</span> <span m="512059">of</span> <span m="512130">browsers</span> <span m="512690">out</span> <span m="512880">there</span> <span m="513049">that</span> <span m="513200">are</span> <span m="513250">going</span> <span m="513409">to</span> <span m="513480">interact</span> <span m="513929">with</span> <span m="514020">that</span> <span m="514210">server.</span> <span m="515260">It'll</span> <span m="515429">have</span> <span m="515600">some</span> <span m="515840">state</span> <span m="516530">that</span> <span m="516850">winds</span> <span m="517179">up</span> <span m="517440">effectively</span> <span m="518010">shared</span> <span m="518350">across</span> <span m="518650">all</span> <span m="518760">these</span> <span m="518919">browsers</span> <span m="519470">through</span> <span m="519640">their</span> <span m="519809">contact</span> <span m="520350">with</span> <span m="520480">the</span> <span m="520559">server.</span> </p>
<p><span m="522179">So</span> <span m="522490">the</span> <span m="522620">usual</span> <span m="522900">picture is</span> <span m="523320">that</span> <span m="523429">the</span> <span m="523480">browser</span> <span m="524210">starts</span> <span m="524560">interacting</span> <span m="525060">with</span> <span m="525180">the</span> <span m="525250">web</span> <span m="525420">server</span> <span m="526060">by</span> <span m="526270">sending</span> <span m="526790">it</span> <span m="527560">an</span> <span m="528000">HTTP</span> <span m="528600">request</span> <span m="528870">that</span> <span m="529140">includes</span> <span m="529520">some</span> <span m="529720">URLs</span> <span m="530260">embedded</span> <span m="530650">in</span> <span m="530800">it.</span> <span m="531320">And</span> <span m="531400">then</span> <span m="531530">the</span> <span m="531610">web</span> <span m="531810">server</span> <span m="532750">throws</span> <span m="533020">back,</span> <span m="533380">again,</span> <span m="533690">the</span> <span m="533880">HTTP</span> <span m="534660">and</span> <span m="534730">HTML</span> <span m="535300">page.</span> <span m="535660">And</span> <span m="535750">there</span> <span m="535890">are</span> <span m="535940">some</span> <span m="536100">URLs</span> <span m="536550">embedded</span> <span m="536970">in that,</span> <span m="537305">which</span> <span m="537640">can be</span> <span m="537710">used</span> <span m="538170">to</span> <span m="538280">decide</span> <span m="538680">which</span> <span m="538850">request</span> <span m="539340">to</span> <span m="539400">make</span> <span m="539620">the</span> <span m="539700">web</span> <span m="539860">server</span> <span m="540310">in the</span> <span m="540530">future.</span> </p>
<p><span m="542760">This</span> <span m="542910">web</span> <span m="543090">server</span> <span m="543370">might</span> <span m="543550">also</span> <span m="543800">be</span> <span m="543940">talking</span> <span m="544350">to</span> <span m="544470">a</span> <span m="544540">database</span> <span m="545020">that</span> <span m="545120">provides</span> <span m="545570">a</span> <span m="545670">persistent</span> <span m="546820">store</span> <span m="547250">that</span> <span m="547450">is</span> <span m="547590">shared</span> <span m="547920">across</span> <span m="548230">all</span> <span m="548360">the</span> <span m="548450">users</span> <span m="548810">of</span> <span m="548900">the</span> <span m="549000">application.</span> <span m="550170">One</span> <span m="550650">popular</span> <span m="551750">protocol</span> <span m="552030">to</span> <span m="552310">speak</span> <span m="552650">between</span> <span m="553000">the</span> <span m="553080">web</span> <span m="553240">server and the</span> <span m="553630">database</span> <span m="554115">is</span> <span m="554600">SQL.</span> <span m="555870">That's</span> <span m="556080">what</span> <span m="556210">I'll</span> <span m="556340">be</span> <span m="556500">focusing</span> <span m="556920">on</span> <span m="557600">talking</span> <span m="557890">about</span> <span m="558090">Ur/Web.</span> </p>
<p><span m="560070">And</span> <span m="560190">also,</span> <span m="560920">with</span> <span m="562840">modern</span> <span m="563160">web</span> <span m="563350">applications,</span> <span m="564390">it's</span> <span m="565270">not</span> <span m="565500">just</span> <span m="565740">the</span> <span m="565860">one</span> <span m="566140">page</span> <span m="566710">at</span> <span m="566830">a</span> <span m="566900">time</span> <span m="567220">model</span> <span m="567570">where</span> <span m="567730">whenever</span> <span m="568070">anything</span> <span m="568350">has</span> <span m="568550">to</span> <span m="568660">change</span> <span m="569070">on</span> <span m="569180">the</span> <span m="569250">page</span> <span m="569610">you</span> <span m="569710">make</span> <span m="569890">a</span> <span m="569950">new</span> <span m="570150">request</span> <span m="570550">to the</span> <span m="570660">server</span> <span m="571010">and</span> <span m="571090">then</span> <span m="571220">replace</span> <span m="571730">the</span> <span m="571810">whole</span> <span m="572010">page</span> <span m="572290">of the</span> <span m="572460">unit.</span> <span m="572830">There's</span> <span m="573090">this</span> <span m="573470">Ajax</span> <span m="573930">style</span> <span m="574310">where</span> <span m="574420">the</span> <span m="574530">browser</span> <span m="575450">within</span> <span m="575690">a</span> <span m="575740">single</span> <span m="576050">page</span> <span m="576330">view</span> <span m="576510">will</span> <span m="576660">sometimes</span> <span m="577090">make</span> <span m="577380">extra</span> <span m="577670">HTTP</span> <span m="578300">requests</span> <span m="578860">to</span> <span m="578930">the</span> <span m="579030">web</span> <span m="579190">server</span> <span m="579960">and</span> <span m="580110">receive</span> <span m="580420">responses</span> <span m="580990">that</span> <span m="581100">are</span> <span m="581170">processed</span> <span m="581650">programmatically</span> <span m="582390">in</span> <span m="583180">a</span> <span m="583270">customized</span> <span m="583770">way.</span> <span m="583970">And</span> <span m="584060">this</span> <span m="584490">often</span> <span m="584830">uses</span> <span m="585120">representations</span> <span m="585870">like</span> <span m="586050">XML</span> <span m="586580">and</span> <span m="586700">JSON</span> <span m="587430">and</span> <span m="587570">other</span> <span m="588190">simple</span> <span m="588790">wire</span> <span m="589070">formats</span> <span m="589590">for</span> <span m="589740">exchanging</span> <span m="590480">data</span> <span m="590750">between</span> <span m="591420">the</span> <span m="591540">client</span> <span m="591980">and</span> <span m="592080">the</span> <span m="592180">server.</span> </p>
<p><span m="594400">And</span> <span m="594420">then</span> <span m="594500">when</span> <span m="594670">the</span> <span m="594980">browser</span> <span m="595350">gets</span> <span m="595540">back</span> <span m="595780">that</span> <span m="596240">response,</span> <span m="597080">there's</span> <span m="597260">some</span> <span m="597400">JavaScript</span> <span m="597910">code</span> <span m="598200">running</span> <span m="598480">there,</span> <span m="598960">which</span> <span m="599150">implements</span> <span m="599530">arbitrary</span> <span m="600010">logic</span> <span m="600420">for</span> <span m="600560">controlling</span> <span m="601440">the</span> <span m="601820">UI</span> <span m="602520">that</span> <span m="602660">we're</span> <span m="602780">displaying</span> <span m="603210">to the</span> <span m="603390">user.</span> <span m="604270">And</span> <span m="604330">the</span> <span m="604390">way</span> <span m="604480">this</span> <span m="604650">works</span> <span m="605030">is that</span> <span m="605130">this</span> <span m="605270">JavaScript</span> <span m="605770">code</span> <span m="606000">can</span> <span m="606120">read</span> <span m="606470">the</span> <span m="606550">responses</span> <span m="607210">that</span> <span m="607330">the</span> <span m="607420">server</span> <span m="607770">has</span> <span m="607900">given</span> <span m="608200">to</span> <span m="608300">those</span> <span m="608840">different</span> <span m="609210">Ajax</span> <span m="609670">calls.</span> </p>
<p><span m="610050">And</span> <span m="610190">then</span> <span m="610790">it</span> <span m="611020">can</span> <span m="611670">modify</span> <span m="612150">the</span> <span m="612230">page</span> <span m="612570">that's</span> <span m="612790">displayed</span> <span m="613570">basically</span> <span m="614480">by</span> <span m="614600">mutating</span> <span m="615160">a</span> <span m="615210">global</span> <span m="615540">variable</span> <span m="616430">that</span> <span m="616800">stands</span> <span m="617310">for</span> <span m="617870">the</span> <span m="617950">page.</span> <span m="618470">And</span> <span m="618710">any</span> <span m="618930">part</span> <span m="619130">of</span> <span m="619200">the</span> <span m="619260">program</span> <span m="619830">can</span> <span m="620440">have</span> <span m="621170">arbitrary</span> <span m="621710">effects</span> <span m="622150">on</span> <span m="622240">this</span> <span m="622410">global</span> <span m="622670">variable</span> <span m="623110">that</span> <span m="623280">is</span> <span m="623750">the</span> <span m="623860">page.</span> <span m="625130">And</span> <span m="625350">often,</span> <span m="625890">parts</span> <span m="626230">of</span> <span m="626310">the</span> <span m="626390">page</span> <span m="626650">are</span> <span m="626720">looked</span> <span m="626990">up</span> <span m="627230">by</span> <span m="627400">string</span> <span m="627910">IDs</span> <span m="628165">that</span> <span m="628420">are</span> <span m="628690">annotated</span> <span m="629180">on</span> <span m="629400">nodes</span> <span m="629810">of</span> <span m="629970">the</span> <span m="630080">tree</span> <span m="630350">that's</span> <span m="630580">describing</span> <span m="630850">the</span> <span m="631120">document.</span> </p>
<p><span m="634000">And</span> <span m="634090">finally,</span> <span m="634390">one</span> <span m="634610">more</span> <span m="634850">complication--</span> <span m="635820">sometimes</span> <span m="636300">we</span> <span m="636370">want</span> <span m="636690">to</span> <span m="636860">allow</span> <span m="638230">what</span> <span m="638860">feels</span> <span m="639150">like</span> <span m="639370">the</span> <span m="639450">web</span> <span m="639680">server</span> <span m="640110">contacting</span> <span m="640730">the</span> <span m="640800">browser</span> <span m="642930">without</span> <span m="643280">prompting.</span> <span m="643840">So</span> <span m="644350">say</span> <span m="644530">there's</span> <span m="644780">a</span> <span m="644840">new</span> <span m="644990">email</span> <span m="645300">message.</span> <span m="645700">The web</span> <span m="645890">server</span> <span m="646170">wants</span> <span m="646390">to</span> <span m="646490">tell</span> <span m="646710">the</span> <span m="646780">browser,</span> <span m="647350">new</span> <span m="647490">message.</span> <span m="648260">So</span> <span m="648500">there</span> <span m="648800">are</span> <span m="649000">a</span> <span m="649020">variety</span> <span m="649330">of</span> <span m="649380">ways</span> <span m="649560">of</span> <span m="649660">doing</span> <span m="649900">this</span> <span m="650090">involving</span> <span m="650850">acronyms</span> <span m="651380">like</span> <span m="651730">Comet</span> <span m="652170">and</span> <span m="652470">WebSockets</span> <span m="653610">that</span> <span m="654170">really</span> <span m="654380">look</span> <span m="654680">a</span> <span m="654730">lot</span> <span m="654970">like</span> <span m="655200">the</span> <span m="655280">browser</span> <span m="655620">contacting</span> <span m="656110">the</span> <span m="656190">server.</span> <span m="656540">It's</span> <span m="656670">the</span> <span m="656740">same</span> <span m="657000">sort</span> <span m="657200">of</span> <span m="657310">thing</span> <span m="658280">conceptually</span> <span m="659210">in</span> <span m="660000">the</span> <span m="660320">other</span> <span m="660500">direction.</span> </p>
<p><span m="662610">All</span> <span m="662670">right,</span> <span m="662900">so</span> <span m="663680">I</span> <span m="663840">want</span> <span m="663990">to</span> <span m="664510">bring</span> <span m="664780">back</span> <span m="665040">on</span> <span m="665520">the</span> <span m="665600">screen</span> <span m="665940">all</span> <span m="666090">these</span> <span m="666290">protocols</span> <span m="666740">and</span> <span m="666830">languages,</span> <span m="668360">highlight</span> <span m="668840">some</span> <span m="669040">parts</span> <span m="669720">in</span> <span m="669830">yellow</span> <span m="670180">here.</span> <span m="671630">Having</span> <span m="672190">read</span> <span m="672370">the</span> <span m="672450">paper,</span> <span m="672920">does</span> <span m="673260">anyone</span> <span m="673530">have</span> <span m="673660">a</span> <span m="673690">guess</span> <span m="674010">about</span> <span m="674390">what</span> <span m="674550">is</span> <span m="674640">the</span> <span m="674740">commonality</span> <span m="675890">between</span> <span m="676400">all</span> <span m="676580">these</span> <span m="676730">highlighted</span> <span m="677200">parts</span> <span m="677490">here</span> <span m="678180">from</span> <span m="678430">a</span> <span m="678530">security</span> <span m="678970">perspective?</span> <span m="684320">Yes.</span> </p>
<p><span m="684690">STUDENT: They're</span> <span m="685096">all</span> <span m="685502">strings.</span> <span m="686310">So</span> <span m="686710">you can put</span> <span m="687192">whatever you</span> <span m="687674">want in them.</span> </p>
<p><span m="688640">ADAM CHLIPALA: Right,</span> <span m="689020">in</span> <span m="689170">the</span> <span m="689260">mainstream</span> <span m="689850">approaches</span> <span m="690410">to</span> <span m="690540">web</span> <span m="690660">application</span> <span m="691340">programming,</span> <span m="691625">all</span> <span m="691910">of</span> <span m="692180">these</span> <span m="692400">things</span> <span m="692620">are</span> <span m="692720">strings.</span> <span m="693460">And</span> <span m="693720">the</span> <span m="693780">programming</span> <span m="694150">language</span> <span m="694740">doesn't</span> <span m="695090">understand</span> <span m="695600">the</span> <span m="695670">way</span> <span m="695800">you're</span> <span m="695900">using</span> <span m="696270">them</span> <span m="696720">and</span> <span m="696900">can</span> <span m="697140">help</span> <span m="697410">you</span> <span m="697780">avoid</span> <span m="698180">making</span> <span m="698420">mistakes.</span> <span m="699460">So</span> <span m="699630">for</span> <span m="699810">instance,</span> <span m="700600">by</span> <span m="700800">representing</span> <span m="701140">these</span> <span m="701300">things</span> <span m="701520">are</span> <span m="701600">strings,</span> <span m="702380">you</span> <span m="702550">get</span> <span m="702950">code</span> <span m="703150">injection</span> <span m="703540">attacks.</span> <span m="704960">So</span> <span m="705460">as</span> <span m="705550">far</span> <span m="705690">as</span> <span m="705760">I'm</span> <span m="705910">concerned,</span> <span m="706310">code</span> <span m="706500">injection</span> <span m="706900">attacks</span> <span m="707260">are</span> <span m="707310">basically</span> <span m="707710">about</span> <span m="708250">the</span> <span m="708350">consequence</span> <span m="709160">of</span> <span m="709320">including</span> <span m="710040">as</span> <span m="710170">a</span> <span m="710220">primitive</span> <span m="710690">in</span> <span m="710790">your</span> <span m="710910">programming</span> <span m="711280">language</span> <span m="711660">or</span> <span m="711780">your</span> <span m="711890">framework</span> <span m="712750">some</span> <span m="713080">function</span> <span m="713850">that</span> <span m="714000">runs</span> <span m="714620">programs</span> <span m="715410">as</span> <span m="715660">text</span> <span m="716140">in</span> <span m="716620">some</span> <span m="717120">sufficiently</span> <span m="717580">expressive</span> <span m="718070">language.</span> </p>
<p><span m="719090">In</span> <span m="719230">Ur/Web,</span> <span m="719910">there</span> <span m="720100">is</span> <span m="720200">no</span> <span m="720430">built-in</span> <span m="720740">interpreter</span> <span m="721850">at</span> <span m="722000">runtime</span> <span m="722530">for</span> <span m="722690">strings</span> <span m="723150">as</span> <span m="723750">programs.</span> <span m="724640">And</span> <span m="724840">that</span> <span m="725200">makes</span> <span m="725720">a</span> <span m="725760">lot</span> <span m="726140">of</span> <span m="726360">the</span> <span m="726470">most</span> <span m="726740">common</span> <span m="727370">mistakes</span> <span m="727830">in</span> <span m="727890">web</span> <span m="728080">applications</span> <span m="729060">impossible</span> <span m="729790">by</span> <span m="730000">construction.</span> <span m="730920">So</span> <span m="731020">all</span> <span m="731230">these</span> <span m="731440">things</span> <span m="731680">that</span> <span m="731780">are</span> <span m="731820">highlighted</span> <span m="732350">will</span> <span m="732710">either</span> <span m="733010">be</span> <span m="733820">invisible,</span> <span m="734920">or</span> <span m="735090">they'll</span> <span m="735240">be</span> <span m="736250">represented</span> <span m="736950">with</span> <span m="737140">special</span> <span m="737530">types</span> <span m="738220">that</span> <span m="738520">make</span> <span m="738760">clear</span> <span m="739600">what</span> <span m="739830">kind</span> <span m="740040">of</span> <span m="740370">code</span> <span m="740630">you're</span> <span m="740730">dealing</span> <span m="741050">with</span> <span m="741500">and</span> <span m="742790">don't</span> <span m="743380">have</span> <span m="743530">any</span> <span m="743680">sort</span> <span m="743840">of</span> <span m="743990">automatic</span> <span m="744480">coercion</span> <span m="744960">from</span> <span m="745250">string</span> <span m="746010">into</span> <span m="746460">any</span> <span m="746670">of</span> <span m="746780">those</span> <span m="746960">special</span> <span m="747320">types.</span> </p>
<p><span m="751210">All</span> <span m="751290">right,</span> <span m="751500">so</span> <span m="752130">here's</span> <span m="752420">the</span> <span m="752860">alternative</span> <span m="753420">model</span> <span m="753700">that</span> <span m="753800">Ur/Web</span> <span m="754170">exposes,</span> <span m="754740">which</span> <span m="754940">gets</span> <span m="755130">compiled</span> <span m="756170">to</span> <span m="756390">the</span> <span m="756520">traditional</span> <span m="756930">model.</span> <span m="757270">So</span> <span m="757430">it</span> <span m="757740">works</span> <span m="758060">in</span> <span m="758160">all</span> <span m="758300">the</span> <span m="758910">widely</span> <span m="759220">deployed</span> <span m="759780">browsers.</span> <span m="760810">But</span> <span m="761410">the</span> <span m="761490">programmer</span> <span m="761750">can</span> <span m="762010">think</span> <span m="762320">at</span> <span m="762420">this</span> <span m="762580">higher</span> <span m="762790">level</span> <span m="763630">and</span> <span m="764420">avoid</span> <span m="765270">the</span> <span m="765440">potential</span> <span m="765880">for</span> <span m="766010">mistakes</span> <span m="766450">that</span> <span m="766950">were</span> <span m="767060">possible</span> <span m="767540">in</span> <span m="767590">the</span> <span m="767670">previous</span> <span m="768000">picture.</span> <span m="768490">So</span> <span m="768630">we</span> <span m="768720">still</span> <span m="768920">have</span> <span m="769040">the</span> <span m="769110">web</span> <span m="769270">server,</span> <span m="769660">which</span> <span m="769730">is</span> <span m="769820">in</span> <span m="769950">charge.</span> <span m="770500">And we</span> <span m="770640">still</span> <span m="770820">have</span> <span m="771020">this</span> <span m="771220">fleet</span> <span m="771430">of</span> <span m="771510">browsers</span> <span m="771960">that</span> <span m="772040">are</span> <span m="772110">trying</span> <span m="772330">to</span> <span m="772370">use</span> <span m="772600">the</span> <span m="772680">web</span> <span m="772830">server.</span> </p>
<p><span m="773630">But</span> <span m="773730">now,</span> <span m="774090">the</span> <span m="774190">first</span> <span m="774520">important</span> <span m="774870">change</span> <span m="775240">is</span> <span m="775495">that</span> <span m="775750">when</span> <span m="775900">the</span> <span m="775980">browser</span> <span m="776360">wants</span> <span m="776650">to</span> <span m="777050">initiate</span> <span m="777680">use</span> <span m="778000">of</span> <span m="778140">a</span> <span m="778190">web</span> <span m="778370">application,</span> <span m="779290">it</span> <span m="779390">doesn't</span> <span m="779680">just</span> <span m="779920">send</span> <span m="781060">a</span> <span m="781170">string of</span> <span m="781660">HTTP</span> <span m="782300">requests</span> <span m="782710">with</span> <span m="782810">a</span> <span m="782880">URL</span> <span m="783145">in</span> <span m="783410">it.</span> <span m="783980">Effectively,</span> <span m="785270">the</span> <span m="785400">abstraction</span> <span m="785890">is</span> <span m="786000">the</span> <span m="786070">browser</span> <span m="787540">names</span> <span m="787930">a</span> <span m="787990">function</span> <span m="789090">that</span> <span m="790020">should</span> <span m="790120">be</span> <span m="790220">called</span> <span m="790750">where</span> <span m="790900">the</span> <span m="791030">call</span> <span m="791410">runs</span> <span m="791690">on</span> <span m="791830">the</span> <span m="791920">server</span> <span m="792320">instead</span> <span m="792680">of</span> <span m="792780">the</span> <span m="792870">client.</span> </p>
<p><span m="794720">And</span> <span m="794900">then</span> <span m="795080">the</span> <span m="795200">server</span> <span m="795550">responds</span> <span m="796420">with</span> <span m="797140">not</span> <span m="798075">a</span> <span m="798570">string</span> <span m="799030">of</span> <span m="799130">HTTP</span> <span m="800000">protocol</span> <span m="800440">text</span> <span m="800990">but</span> <span m="801670">a</span> <span m="801990">strongly</span> <span m="802490">typed</span> <span m="802990">documentary.</span> <span m="804680">So</span> <span m="804760">instead</span> <span m="805020">of</span> <span m="805080">a</span> <span m="805130">string</span> <span m="805460">of</span> <span m="805530">HTML,</span> <span m="806280">it's</span> <span m="806580">a</span> <span m="806990">tree,</span> <span m="807640">a</span> <span m="808410">first</span> <span m="808630">class</span> <span m="808910">object</span> <span m="809360">in</span> <span m="809420">the</span> <span m="809500">language.</span> <span m="811210">And</span> <span m="812240">that</span> <span m="812530">is</span> <span m="812620">how</span> <span m="813060">the</span> <span m="813180">program</span> <span m="813850">manipulates</span> <span m="814420">it,</span> <span m="814700">not</span> <span m="814960">as</span> <span m="815080">a</span> <span m="815150">string.</span> </p>
<p><span m="817750">And</span> <span m="818160">each</span> <span m="818320">of</span> <span m="818380">these</span> <span m="818550">trees</span> <span m="818920">contains</span> <span m="819310">within</span> <span m="819550">it</span> <span m="819700">links,</span> <span m="820220">which</span> <span m="820400">are</span> <span m="820440">themselves</span> <span m="820950">basically</span> <span m="821360">just</span> <span m="821620">references</span> <span m="822190">to</span> <span m="822260">other</span> <span m="822490">functions</span> <span m="822990">that</span> <span m="823060">you</span> <span m="823150">might</span> <span m="823400">choose</span> <span m="823680">to</span> <span m="823790">call</span> <span m="824080">on</span> <span m="824220">the</span> <span m="824300">server.</span> <span m="825500">So</span> <span m="825700">then</span> <span m="826240">the</span> <span m="826450">browser,</span> <span m="827340">when</span> <span m="827480">the</span> <span m="827550">user</span> <span m="827740">clicks</span> <span m="827990">on</span> <span m="828070">those</span> <span m="828260">links,</span> <span m="828590">picks</span> <span m="828830">out</span> <span m="828980">the</span> <span m="829050">function</span> <span m="829600">and</span> <span m="830010">conceptually</span> <span m="830850">calls</span> <span m="831140">it on</span> <span m="831250">the</span> <span m="831330">server,</span> <span m="831690">just</span> <span m="831910">like</span> <span m="832120">the</span> <span m="832220">original</span> <span m="832540">function</span> <span m="832950">that we</span> <span m="833110">called</span> <span m="833390">to</span> <span m="833520">get</span> <span m="833750">to</span> <span m="833830">this</span> <span m="834010">point.</span> </p>
<p><span m="836840">And</span> <span m="837135">we</span> <span m="837430">have</span> <span m="837870">a</span> <span m="838360">database</span> <span m="838870">interface,</span> <span m="839740">which</span> <span m="840010">is</span> <span m="840140">accessed</span> <span m="840505">by</span> <span m="840870">the</span> <span m="841120">web</span> <span m="841370">server</span> <span m="841850">throwing</span> <span m="842170">queries</span> <span m="842550">at</span> <span m="842650">the</span> <span m="842740">database.</span> <span m="843450">And</span> <span m="843620">these</span> <span m="843790">are</span> <span m="843840">not</span> <span m="844050">just</span> <span m="844410">text</span> <span m="844880">in</span> <span m="845010">the</span> <span m="845200">Ur/Web</span> <span m="845380">model.</span> <span m="845730">They're</span> <span m="846200">strongly</span> <span m="846610">typed</span> <span m="846950">SQL</span> <span m="847460">syntax</span> <span m="847900">trees.</span> <span m="849610">And</span> <span m="849750">then</span> <span m="849890">the</span> <span m="849960">database</span> <span m="850440">will</span> <span m="850590">respond</span> <span m="851060">back</span> <span m="851680">with</span> <span m="852620">not</span> <span m="853470">text,</span> <span m="853930">but</span> <span m="854350">a</span> <span m="854510">list</span> <span m="855110">of</span> <span m="855550">records</span> <span m="856520">of</span> <span m="857600">native</span> <span m="857990">values</span> <span m="858500">in</span> <span m="858630">the</span> <span m="858710">programming</span> <span m="859110">language</span> <span m="859460">that</span> <span m="859630">we're</span> <span m="859740">working</span> <span m="860090">with.</span> </p>
<p><span m="860950">So</span> <span m="861370">we</span> <span m="861550">don't</span> <span m="861690">have</span> <span m="861820">to</span> <span m="861910">worry</span> <span m="862210">about</span> <span m="862650">incorrectly</span> <span m="863500">converting</span> <span m="864220">between</span> <span m="864560">strings</span> <span m="864920">and</span> <span m="865730">native</span> <span m="866270">representations,</span> <span m="867190">or</span> <span m="867920">native</span> <span m="868380">representations</span> <span m="869070">in</span> <span m="869180">any</span> <span m="869370">other</span> <span m="869540">format</span> <span m="869920">that</span> <span m="870400">the</span> <span m="870510">database</span> <span m="870980">might</span> <span m="871650">traditionally</span> <span m="872070">be</span> <span m="872980">presenting</span> <span m="873460">to</span> <span m="873580">us.</span> <span m="876760">And</span> <span m="877400">here's</span> <span m="877640">a</span> <span m="878740">key</span> <span m="879030">element</span> <span m="879520">of</span> <span m="879840">how</span> <span m="880400">the</span> <span m="880510">semantics</span> <span m="880990">of</span> <span m="881230">Ur/Web</span> <span m="881450">makes</span> <span m="881670">it</span> <span m="881760">easier</span> <span m="882070">for</span> <span m="882200">programmers</span> <span m="882700">to</span> <span m="882790">think</span> <span m="882980">about</span> <span m="883330">fewer</span> <span m="883630">scenarios</span> <span m="884200">that</span> <span m="884290">can</span> <span m="884430">actually</span> <span m="884730">happen</span> <span m="885390">when</span> <span m="885660">the</span> <span m="885780">application</span> <span m="886250">is</span> <span m="886340">running.</span> </p>
<p><span m="888340">There's</span> <span m="889040">the</span> <span m="889140">standard</span> <span m="889500">idea</span> <span m="889730">of</span> <span m="889810">transactions</span> <span m="890590">in</span> <span m="890650">the</span> <span m="890740">world</span> <span m="891110">of</span> <span m="891590">relational</span> <span m="892000">databases</span> <span m="892890">where</span> <span m="893150">you</span> <span m="893270">can</span> <span m="893390">run</span> <span m="893580">a</span> <span m="893620">series</span> <span m="893930">of</span> <span m="894030">operations</span> <span m="894630">that</span> <span m="894790">seem</span> <span m="895110">to</span> <span m="895680">run</span> <span m="895960">with</span> <span m="896100">no</span> <span m="896350">interruption</span> <span m="896940">by</span> <span m="897130">other</span> <span m="897390">concurrent</span> <span m="897890">threads.</span> <span m="898500">And</span> <span m="898920">Ur/Web</span> <span m="899230">adopts</span> <span m="899580">that</span> <span m="899760">model</span> <span m="900090">and</span> <span m="900200">builds</span> <span m="900500">it</span> <span m="900570">into</span> <span m="900740">the</span> <span m="900830">semantics</span> <span m="901550">of</span> <span m="901670">the</span> <span m="901750">language.</span> <span m="902790">So</span> <span m="903560">when</span> <span m="904020">a</span> <span m="904090">single</span> <span m="905040">function</span> <span m="905740">is</span> <span m="905930">running</span> <span m="906190">on</span> <span m="906280">the</span> <span m="906360">server</span> <span m="906850">on</span> <span m="907100">behalf</span> <span m="907650">of</span> <span m="907880">a</span> <span m="907940">client,</span> <span m="908820">then</span> <span m="909930">all</span> <span m="910130">of</span> <span m="910240">its</span> <span m="910420">database</span> <span m="910820">accesses</span> <span m="911300">appear</span> <span m="911580">to</span> <span m="911640">happen</span> <span m="911930">as</span> <span m="912020">an</span> <span m="912100">atomic</span> <span m="912560">unit</span> <span m="913000">without</span> <span m="913360">any</span> <span m="913670">interruption</span> <span m="914630">by</span> <span m="915240">any</span> <span m="915450">other</span> <span m="915930">concurrent</span> <span m="916400">requests</span> <span m="916860">to</span> <span m="916940">the</span> <span m="917020">same</span> <span m="917270">server.</span> </p>
<p><span m="918320">And</span> <span m="918880">you</span> <span m="919280">can't</span> <span m="919520">even</span> <span m="919730">avoid</span> <span m="920050">this</span> <span m="920160">behavior</span> <span m="920490">if</span> <span m="920560">you</span> <span m="920660">want</span> <span m="920890">to.</span> <span m="921100">Transactions</span> <span m="921750">are</span> <span m="922420">built</span> <span m="922740">into</span> <span m="922920">the</span> <span m="923000">language.</span> <span m="924410">And</span> <span m="925680">they</span> <span m="925920">really</span> <span m="926660">make</span> <span m="926860">concurrency</span> <span m="927350">a</span> <span m="927410">lot</span> <span m="927620">easier</span> <span m="927840">to</span> <span m="927920">think</span> <span m="928100">about,</span> <span m="929040">and</span> <span m="929490">potentially</span> <span m="929860">help</span> <span m="930050">you</span> <span m="930180">avoid</span> <span m="930540">security</span> <span m="930970">issues</span> <span m="931320">that</span> <span m="931690">only</span> <span m="932010">arise</span> <span m="932370">when</span> <span m="932510">some</span> <span m="932970">rare</span> <span m="933330">interleaving</span> <span m="933830">happens</span> <span m="934440">with</span> <span m="934560">a</span> <span m="934600">particular</span> <span m="935370">combination</span> <span m="935870">of</span> <span m="935960">requests.</span> </p>
<p><span m="938610">And</span> <span m="938700">actually,</span> <span m="939000">I</span> <span m="939040">want</span> <span m="939170">to</span> <span m="939210">get</span> <span m="939410">to</span> <span m="939610">one</span> <span m="939830">of</span> <span m="939900">the</span> <span m="940890">questions</span> <span m="941380">that</span> <span m="941460">someone</span> <span m="941720">submitted</span> <span m="942060">for</span> <span m="942130">this</span> <span m="942270">class</span> <span m="942620">that</span> <span m="942730">I</span> <span m="942790">found</span> <span m="943060">intriguing.</span> <span m="944830">Ur/Web</span> <span m="945270">will</span> <span m="945750">detect</span> <span m="946150">when</span> <span m="946250">a</span> <span m="946310">transaction</span> <span m="947010">fails</span> <span m="947660">because</span> <span m="947940">of</span> <span m="948010">a</span> <span m="948060">concurrency</span> <span m="948710">problem,</span> <span m="949020">like</span> <span m="949170">a</span> <span m="949240">deadlock,</span> <span m="949810">and</span> <span m="950050">automatically</span> <span m="950660">restart</span> <span m="951270">the</span> <span m="951350">transaction.</span> <span m="952420">Someone's</span> <span m="953600">response</span> <span m="954010">to</span> <span m="954510">a</span> <span m="954630">question</span> <span m="955240">said,</span> <span m="956550">this</span> <span m="956880">might</span> <span m="957100">make</span> <span m="957270">it</span> <span m="957350">easier</span> <span m="957850">to</span> <span m="958120">launch</span> <span m="958450">security</span> <span m="958940">attacks</span> <span m="959810">that</span> <span m="960090">depend</span> <span m="960620">on</span> <span m="960840">causing</span> <span m="961340">transactions</span> <span m="961930">to</span> <span m="962020">fail</span> <span m="962400">because</span> <span m="962740">of</span> <span m="963190">concurrency</span> <span m="963800">issues.</span> </p>
<p><span m="965770">I</span> <span m="965840">just</span> <span m="966020">wanted</span> <span m="966180">to</span> <span m="966220">ask</span> <span m="966450">the</span> <span m="966530">class,</span> <span m="966960">what's an</span> <span m="967230">example</span> <span m="968070">of</span> <span m="968230">an</span> <span m="968410">attack</span> <span m="968820">like</span> <span m="968990">that,</span> <span m="969125">if</span> <span m="969260">anyone</span> <span m="969930">happens</span> <span m="970250">to</span> <span m="970330">have</span> <span m="970470">one in</span> <span m="970680">mind?</span> <span m="973270">If</span> <span m="973640">you</span> <span m="973720">have</span> <span m="973810">a</span> <span m="973870">system</span> <span m="974170">that</span> <span m="974290">automatically</span> <span m="974800">restarts</span> <span m="975260">transactions</span> <span m="975590">that</span> <span m="975920">run</span> <span m="976170">into</span> <span m="976320">deadlocks,</span> <span m="977330">how</span> <span m="977460">does</span> <span m="977550">that</span> <span m="977700">cause</span> <span m="978220">a</span> <span m="978300">security</span> <span m="978690">problem,</span> <span m="979060">if</span> <span m="979170">it</span> <span m="979260">does?</span> <span m="981480">This</span> <span m="981640">is</span> <span m="981730">a</span> <span m="981790">question</span> <span m="982190">I</span> <span m="982290">don't</span> <span m="982330">have</span> <span m="982480">an</span> <span m="982580">answer</span> <span m="982830">in mind for,</span> <span m="983150">which</span> <span m="983490">is</span> <span m="983580">why</span> <span m="983740">I'm</span> <span m="983940">asking</span> <span m="984310">it.</span> <span m="994940">It</span> <span m="995330">might</span> <span m="995500">also</span> <span m="995720">have</span> <span m="995870">only</span> <span m="996080">a non-obvious</span> <span m="996680">answer</span> <span m="996960">that</span> <span m="997190">no</span> <span m="997350">one</span> <span m="997490">would</span> <span m="997720">come</span> <span m="997890">up</span> <span m="997990">with</span> <span m="998120">on</span> <span m="998190">the</span> <span m="998250">spot</span> <span m="998510">like</span> <span m="998700">this,</span> <span m="998990">which</span> <span m="999070">is</span> <span m="999160">fine,</span> <span m="999380">too.</span> <span m="1004858">Yeah.</span> </p>
<p><span m="1005356">STUDENT: Can</span> <span m="1005854">you maybe</span> <span m="1006352">do</span> <span m="1006518">some</span> <span m="1006684">sort</span> <span m="1006850">of denial of</span> <span m="1007348">service?</span> <span m="1007846">If it's going to</span> <span m="1008344">restart</span> <span m="1008842">a</span> <span m="1009340">transaction</span> <span m="1009838">that you're</span> <span m="1010336">sending, and you</span> <span m="1010834">know it</span> <span m="1011332">will fail,</span> <span m="1011830">can you</span> <span m="1012328">just</span> <span m="1012494">keep</span> <span m="1012660">restarting</span> <span m="1012826">that</span> <span m="1013324">and</span> <span m="1013822">try again?</span> </p>
<p><span m="1016840">ADAM CHLIPALA: OK,</span> <span m="1017750">so--</span> </p>
<p><span m="1019335">STUDENT: So</span> <span m="1019760">if you</span> <span m="1020250">could cause</span> <span m="1020749">the system</span> <span m="1021248">to</span> <span m="1021747">do</span> <span m="1022246">some transaction</span> <span m="1022745">you know is</span> <span m="1023244">about to</span> <span m="1023743">fail</span> <span m="1024242">and repeatedly</span> <span m="1024741">fail,</span> <span m="1026030">it</span> <span m="1026514">keeps</span> <span m="1026998">trying</span> <span m="1027240">over and over</span> <span m="1027482">again,</span> <span m="1027966">it would</span> <span m="1028450">never</span> <span m="1028934">[INAUDIBLE].</span> </p>
<p><span m="1029420">ADAM CHLIPALA: Right,</span> <span m="1029859">so</span> <span m="1030010">you'd</span> <span m="1030160">need</span> <span m="1031020">at</span> <span m="1031119">least</span> <span m="1031329">two</span> <span m="1031450">threads</span> <span m="1031730">running</span> <span m="1031940">at</span> <span m="1031990">once</span> <span m="1032369">to</span> <span m="1032530">do</span> <span m="1032780">that.</span> <span m="1033140">But</span> <span m="1033390">potentially</span> <span m="1034650">that</span> <span m="1034819">could</span> <span m="1034940">work.</span> <span m="1037140">So</span> <span m="1037280">you</span> <span m="1037710">could</span> <span m="1037829">launch</span> <span m="1038069">a</span> <span m="1038130">denial</span> <span m="1038440">of</span> <span m="1038530">service</span> <span m="1038839">attack</span> <span m="1039760">taking</span> <span m="1040030">advantage</span> <span m="1040369">of</span> <span m="1040450">the</span> <span m="1040530">fact</span> <span m="1041270">that</span> <span m="1042030">contention</span> <span m="1042670">leads</span> <span m="1043150">to</span> <span m="1044579">request</span> <span m="1045210">handlers</span> <span m="1045589">restarting</span> <span m="1046030">over</span> <span m="1046200">and</span> <span m="1046270">over</span> <span m="1046450">again</span> <span m="1046680">and</span> <span m="1046790">purposely</span> <span m="1047190">cause</span> <span m="1047490">contention</span> <span m="1047960">and</span> <span m="1048099">use</span> <span m="1048220">this</span> <span m="1048339">as</span> <span m="1048470">a</span> <span m="1048530">way</span> <span m="1048640">to</span> <span m="1048780">amplify</span> <span m="1049770">the</span> <span m="1049920">strength</span> <span m="1050290">of</span> <span m="1050410">your</span> <span m="1050540">denial</span> <span m="1050940">of</span> <span m="1051020">service</span> <span m="1051320">attack</span> <span m="1051630">beyond</span> <span m="1051920">what</span> <span m="1052050">you</span> <span m="1052120">can</span> <span m="1052280">get</span> <span m="1053170">with</span> <span m="1053400">a</span> <span m="1053500">traditional</span> <span m="1053930">model.</span> <span m="1056540">All</span> <span m="1056660">right,</span> <span m="1056830">I</span> <span m="1056880">can</span> <span m="1056980">believe</span> <span m="1057210">that.</span> <span m="1057650">Yeah.</span> </p>
<p><span m="1058010">STUDENT: Is</span> <span m="1058508">[INAUDIBLE]</span> <span m="1059006">the only way</span> <span m="1059504">to cause</span> <span m="1060002">the</span> <span m="1060251">transaction</span> <span m="1060500">to fail?</span> </p>
<p><span m="1061500">ADAM CHLIPALA: It</span> <span m="1061620">is.</span> <span m="1062880">Well,</span> <span m="1063770">it's</span> <span m="1063940">the</span> <span m="1064010">only</span> <span m="1064170">way</span> <span m="1064270">to cause</span> <span m="1064630">it to</span> <span m="1064730">fail</span> <span m="1064980">and</span> <span m="1065070">automatically</span> <span m="1065580">restart.</span> <span m="1070660">Yeah.</span> </p>
<p><span m="1072392">STUDENT: Perhaps</span> <span m="1072556">it could</span> <span m="1073050">have</span> <span m="1073420">a</span> <span m="1073815">third</span> <span m="1074210">party,</span> <span m="1074450">which</span> <span m="1074924">would</span> <span m="1075398">conditionally</span> <span m="1075872">fail.</span> <span m="1076346">And</span> <span m="1076820">then you</span> <span m="1077294">could use that</span> <span m="1077768">to monitor</span> <span m="1078242">some</span> <span m="1078716">other</span> <span m="1079190">user's behavior.</span> </p>
<p><span m="1080140">ADAM CHLIPALA: You'd</span> <span m="1080330">also</span> <span m="1080520">need</span> <span m="1080660">a</span> <span m="1080710">way</span> <span m="1080840">to</span> <span m="1080960">observe</span> <span m="1081450">the</span> <span m="1081530">fact</span> <span m="1081860">that</span> <span m="1081940">it</span> <span m="1082030">had</span> <span m="1082320">failed,</span> <span m="1082640">which</span> <span m="1082800">you</span> <span m="1084100">should</span> <span m="1084240">only</span> <span m="1084390">be</span> <span m="1084480">able</span> <span m="1084620">to</span> <span m="1084690">do</span> <span m="1084830">through</span> <span m="1084970">timing.</span> <span m="1085790">But</span> <span m="1085940">that</span> <span m="1086090">could</span> <span m="1086200">still</span> <span m="1086390">be</span> <span m="1086510">an</span> <span m="1086900">issue.</span> <span m="1087320">OK,</span> <span m="1089260">right,</span> <span m="1089780">so</span> <span m="1089950">you</span> <span m="1090110">can</span> <span m="1090200">use</span> <span m="1090380">this</span> <span m="1090540">as</span> <span m="1090630">a</span> <span m="1090710">side</span> <span m="1091000">channel</span> <span m="1091300">to</span> <span m="1091370">see</span> <span m="1091540">what</span> <span m="1091660">other</span> <span m="1091890">threads</span> <span m="1092220">are</span> <span m="1092280">doing,</span> <span m="1092880">because</span> <span m="1093140">their</span> <span m="1093300">actions</span> <span m="1093640">might</span> <span m="1093890">or</span> <span m="1093940">might</span> <span m="1094140">not</span> <span m="1094420">create a</span> <span m="1094840">conflict</span> <span m="1095270">in</span> <span m="1095340">your</span> <span m="1095520">thread.</span> </p>
<p><span m="1099170">OK,</span> <span m="1100770">that</span> <span m="1100950">sounds</span> <span m="1101270">possible</span> <span m="1101740">in</span> <span m="1101780">principle,</span> <span m="1104670">and</span> <span m="1104800">very</span> <span m="1105010">twisty.</span> <span m="1105520">I'm</span> <span m="1105640">not</span> <span m="1105810">sure.</span> <span m="1107090">It's</span> <span m="1107250">hard</span> <span m="1107390">to</span> <span m="1107450">think</span> <span m="1107620">of</span> <span m="1107700">a</span> <span m="1107760">concrete</span> <span m="1108110">attack</span> <span m="1108490">that</span> <span m="1108730">would</span> <span m="1109810">work</span> <span m="1111520">predictably.</span> <span m="1111810">But</span> <span m="1112100">it</span> <span m="1112350">could</span> <span m="1112590">be</span> <span m="1112700">a</span> <span m="1112740">fun</span> <span m="1112940">exercise.</span> <span m="1113510">Yeah.</span> </p>
<p><span m="1113930">STUDENT: So</span> <span m="1114170">do</span> <span m="1114470">the</span> <span m="1114780">transactions</span> <span m="1115518">you</span> <span m="1115946">run--</span> <span m="1117230">for</span> <span m="1117660">each</span> <span m="1118010">request</span> <span m="1118505">that comes</span> <span m="1119000">in,</span> <span m="1119495">you run</span> <span m="1119990">a transaction for</span> <span m="1120485">the</span> <span m="1120980">code you run</span> <span m="1121475">at the</span> <span m="1121970">web server.</span> <span m="1122470">But when</span> <span m="1122710">you</span> <span m="1122820">send that</span> <span m="1123050">code to</span> <span m="1123440">the</span> <span m="1123587">database,</span> <span m="1123735">does</span> <span m="1124030">that</span> <span m="1124650">translate</span> <span m="1125100">into</span> <span m="1125480">a</span> <span m="1125860">database</span> <span m="1126280">transaction</span> <span m="1126570">as well?</span> </p>
<p><span m="1127120">ADAM CHLIPALA: It</span> <span m="1127260">is,</span> <span m="1127470">yeah.</span> <span m="1127830">The</span> <span m="1128410">whole</span> <span m="1128640">execution</span> <span m="1129160">on</span> <span m="1129240">the</span> <span m="1129300">server</span> <span m="1129600">side</span> <span m="1129800">is</span> <span m="1129900">wrapped</span> <span m="1130200">in</span> <span m="1130310">one</span> <span m="1130510">database</span> <span m="1130890">transaction</span> <span m="1132040">if</span> <span m="1132230">the</span> <span m="1132310">application</span> <span m="1132770">uses</span> <span m="1133050">the</span> <span m="1133090">database.</span> <span m="1135030">Yeah.</span> </p>
<p><span m="1135480">STUDENT: So</span> <span m="1135930">if you have a</span> <span m="1136380">transaction</span> <span m="1136830">that's not going to end</span> <span m="1137280">up</span> <span m="1137840">obtaining,</span> <span m="1138327">do you</span> <span m="1138814">think</span> <span m="1139301">[INAUDIBLE]?</span> </p>
<p><span m="1140670">ADAM CHLIPALA: Yeah.</span> </p>
<p><span m="1141260">STUDENT: Are</span> <span m="1141550">you</span> <span m="1141900">telling</span> <span m="1142265">the</span> <span m="1142630">database</span> <span m="1142820">that</span> <span m="1143200">nothing's</span> <span m="1143650">going to</span> <span m="1143890">be updated</span> <span m="1144200">later?</span> <span m="1144980">Because</span> <span m="1145360">presumably,</span> <span m="1145670">the</span> <span m="1146060">database</span> <span m="1146180">doesn't</span> <span m="1146560">know that.</span> </p>
<p><span m="1146975">ADAM CHLIPALA: Yes, so</span> <span m="1147390">the</span> <span m="1147790">compiler</span> <span m="1148250">does</span> <span m="1148340">static</span> <span m="1148660">analysis</span> <span m="1149190">and</span> <span m="1149300">finds</span> <span m="1149640">out</span> <span m="1149830">transactions</span> <span m="1150420">that</span> <span m="1150630">need</span> <span m="1150820">to</span> <span m="1151080">be</span> <span m="1151115">read-only.</span> <span m="1151560">And</span> <span m="1151780">it creates</span> <span m="1152280">the</span> <span m="1152370">transaction</span> <span m="1152740">in</span> <span m="1153110">read-only</span> <span m="1153310">mode,</span> <span m="1154310">which</span> <span m="1154630">in</span> <span m="1154950">some</span> <span m="1155190">database</span> <span m="1155600">systems</span> <span m="1156010">enables</span> <span m="1156640">extra</span> <span m="1157000">optimizations.</span> </p>
<p><span m="1158516">STUDENT: What</span> <span m="1159014">about</span> <span m="1159512">if</span> <span m="1161220">you</span> <span m="1161685">read</span> <span m="1162150">some</span> <span m="1162650">stuff,</span> <span m="1163015">and</span> <span m="1163380">some of</span> <span m="1163520">the</span> <span m="1163835">stuff</span> <span m="1164150">you read</span> <span m="1164646">doesn't affect</span> <span m="1165142">what you're going to</span> <span m="1165638">write,</span> <span m="1166134">but some of the</span> <span m="1166630">other stuff you</span> <span m="1167130">read does?</span> </p>
<p><span m="1167770">ADAM CHLIPALA: I</span> <span m="1168000">see,</span> <span m="1168260">so</span> <span m="1168490">you're</span> <span m="1168640">asking,</span> <span m="1168940">could</span> <span m="1169280">we</span> <span m="1170300">use</span> <span m="1171140">our</span> <span m="1171330">knowledge</span> <span m="1171700">of</span> <span m="1171810">the</span> <span m="1171970">semantics</span> <span m="1172470">of</span> <span m="1172550">the</span> <span m="1172650">application</span> <span m="1173260">to give</span> <span m="1173500">hints to</span> <span m="1173780">the</span> <span m="1173880">database</span> <span m="1174310">system</span> <span m="1175000">saying</span> <span m="1175840">some</span> <span m="1176125">of</span> <span m="1176410">what</span> <span m="1176890">looked</span> <span m="1177080">like</span> <span m="1177310">concurrency</span> <span m="1178440">violations</span> <span m="1179660">are</span> <span m="1179860">actually</span> <span m="1180180">benign,</span> <span m="1180900">and</span> <span m="1181030">we</span> <span m="1181120">don't</span> <span m="1181300">need</span> <span m="1181440">to</span> <span m="1181530">restart</span> <span m="1181930">at that point?</span> <span m="1184130">I</span> <span m="1184150">think</span> <span m="1184280">the</span> <span m="1184350">short</span> <span m="1184570">answer</span> <span m="1184790">is</span> <span m="1184880">no.</span> <span m="1185450">The</span> <span m="1185460">current</span> <span m="1185690">implementation</span> <span m="1186220">doesn't</span> <span m="1186520">do</span> <span m="1186630">that.</span> <span m="1186940">But that</span> <span m="1187070">would</span> <span m="1187140">be</span> <span m="1187260">interesting</span> <span m="1187790">to</span> <span m="1188250">look</span> <span m="1188420">into.</span> <span m="1188670">I</span> <span m="1188720">think</span> <span m="1188870">it</span> <span m="1188930">would</span> <span m="1189030">require</span> <span m="1189450">changes</span> <span m="1189850">to the</span> <span m="1189960">database</span> <span m="1190420">engine,</span> <span m="1190730">not</span> <span m="1190930">just</span> <span m="1191220">the</span> <span m="1191410">interface</span> <span m="1192070">in</span> <span m="1192160">the</span> <span m="1192240">language.</span> </p>
<p><span m="1192660">STUDENT: Usually</span> <span m="1193148">you could split</span> <span m="1193636">it</span> <span m="1194124">into two separate</span> <span m="1194612">transactions,</span> <span m="1195100">maybe,</span> <span m="1195588">or something</span> <span m="1198650">under</span> <span m="1198950">certain</span> <span m="1199220">circumstances.</span> </p>
<p><span m="1200394">ADAM CHLIPALA: Yeah,</span> <span m="1201750">that</span> <span m="1201950">sounds</span> <span m="1203050">hard</span> <span m="1203280">to</span> <span m="1203350">do</span> <span m="1203560">right,</span> <span m="1203700">but</span> <span m="1203840">potentially</span> <span m="1205230">worthwhile</span> <span m="1205840">for--</span> <span m="1206580">I</span> <span m="1206690">don't</span> <span m="1206860">know how to</span> <span m="1207070">estimate</span> <span m="1207450">what</span> <span m="1207630">fraction</span> <span m="1207940">of</span> <span m="1208010">applications</span> <span m="1208560">could</span> <span m="1208670">take</span> <span m="1208820">advantage</span> <span m="1208970">of that,</span> <span m="1209330">but it's</span> <span m="1209690">a</span> <span m="1210050">neat</span> <span m="1210320">idea.</span> <span m="1213910">All</span> <span m="1214040">right,</span> <span m="1214360">so</span> <span m="1215340">transactions</span> <span m="1215830">are</span> <span m="1215890">great.</span> </p>
<p><span m="1219370">We</span> <span m="1219500">also</span> <span m="1219740">have--</span> <span m="1220300">so I was</span> <span m="1220590">just</span> <span m="1220750">telling</span> <span m="1220930">you</span> <span m="1221040">about</span> <span m="1221230">the</span> <span m="1221290">model,</span> <span m="1222190">the</span> <span m="1222310">old</span> <span m="1222560">school</span> <span m="1222820">model</span> <span m="1223210">of</span> <span m="1223340">the</span> <span m="1223410">browser</span> <span m="1223725">requesting</span> <span m="1224040">a</span> <span m="1224490">single</span> <span m="1224770">page</span> <span m="1225080">from</span> <span m="1225130">the</span> <span m="1225210">web</span> <span m="1225350">server.</span> <span m="1225920">We</span> <span m="1226020">can</span> <span m="1226120">also</span> <span m="1226310">have</span> <span m="1226440">this</span> <span m="1226600">Ajax</span> <span m="1227020">style</span> <span m="1227580">stuff</span> <span m="1228240">that</span> <span m="1228420">basically</span> <span m="1228720">looks</span> <span m="1229010">like</span> <span m="1229480">code</span> <span m="1229780">on</span> <span m="1229930">the</span> <span m="1230020">client.</span> <span m="1230590">It's</span> <span m="1230730">calling</span> <span m="1231030">a</span> <span m="1231070">function</span> <span m="1231540">that's</span> <span m="1231710">just</span> <span m="1231890">marked</span> <span m="1232210">to</span> <span m="1232310">run</span> <span m="1232460">on</span> <span m="1232540">the</span> <span m="1232620">server.</span> <span m="1233370">When</span> <span m="1233490">it</span> <span m="1233590">finishes,</span> <span m="1234100">the</span> <span m="1234190">result</span> <span m="1234650">comes</span> <span m="1234850">back</span> <span m="1235360">in</span> <span m="1235520">the</span> <span m="1235590">client</span> <span m="1235850">code.</span> </p>
<p><span m="1237460">And</span> <span m="1237880">the</span> <span m="1237940">result</span> <span m="1238250">is</span> <span m="1238340">just</span> <span m="1238540">a</span> <span m="1238580">native</span> <span m="1238890">value</span> <span m="1239190">in</span> <span m="1239260">the</span> <span m="1239330">programming</span> <span m="1239730">language.</span> <span m="1240110">You</span> <span m="1240190">don't</span> <span m="1240360">have</span> <span m="1240470">to</span> <span m="1240580">worry</span> <span m="1240790">about</span> <span m="1241790">making</span> <span m="1242100">it</span> <span m="1242320">into</span> <span m="1242480">a</span> <span m="1242530">string</span> <span m="1242800">somehow</span> <span m="1243210">and</span> <span m="1243410">translating</span> <span m="1243690">it</span> <span m="1243970">back.</span> <span m="1247580">And</span> <span m="1247660">then</span> <span m="1248150">we</span> <span m="1248270">have</span> <span m="1248350">to</span> <span m="1248450">take</span> <span m="1248630">the</span> <span m="1248700">result</span> <span m="1249110">and</span> <span m="1249250">use</span> <span m="1249420">it</span> <span m="1249530">to</span> <span m="1249620">change</span> <span m="1249920">the</span> <span m="1250010">page</span> <span m="1250320">that the</span> <span m="1250450">user</span> <span m="1250800">sees.</span> <span m="1251120">Otherwise,</span> <span m="1251470">it</span> <span m="1251550">wasn't</span> <span m="1251705">a</span> <span m="1251860">very</span> <span m="1252190">useful</span> <span m="1253070">request</span> <span m="1253430">to</span> <span m="1253490">make.</span> </p>
<p><span m="1254150">So</span> <span m="1254360">the</span> <span m="1254450">model</span> <span m="1254810">in</span> <span m="1255000">Ur/Web</span> <span m="1255410">is</span> <span m="1255710">very</span> <span m="1255900">different</span> <span m="1256250">from</span> <span m="1256420">the</span> <span m="1256480">standard</span> <span m="1257240">document</span> <span m="1257650">object</span> <span m="1257980">model</span> <span m="1258310">that</span> <span m="1258530">browsers</span> <span m="1258910">expose</span> <span m="1259260">directly.</span> <span m="1259840">The</span> <span m="1260240">basic</span> <span m="1260590">idea</span> <span m="1260970">is</span> <span m="1261260">something</span> <span m="1261470">called</span> <span m="1261730">functional</span> <span m="1262080">reactive</span> <span m="1262440">programming,</span> <span m="1262940">which</span> <span m="1263310">I</span> <span m="1263400">won't</span> <span m="1263700">try</span> <span m="1263840">to</span> <span m="1263910">explain in</span> <span m="1264310">too</span> <span m="1264420">much</span> <span m="1264600">detail.</span> <span m="1265060">Because</span> <span m="1265180">I</span> <span m="1265260">know</span> <span m="1266430">it</span> <span m="1266990">requires</span> <span m="1267570">a</span> <span m="1268090">nontrivial</span> <span m="1269770">grokking</span> <span m="1270210">of</span> <span m="1270400">functional</span> <span m="1270710">programming</span> <span m="1271130">first,</span> <span m="1272006">even</span> <span m="1272472">if</span> <span m="1272940">we</span> <span m="1273320">cut off</span> <span m="1273585">that</span> <span m="1273850">reactive</span> <span m="1274270">part.</span> <span m="1274890">But</span> <span m="1275110">the</span> <span m="1275410">basic</span> <span m="1275720">idea</span> <span m="1276080">is</span> <span m="1276190">the</span> <span m="1276300">document</span> <span m="1276730">is</span> <span m="1277280">described</span> <span m="1277670">in</span> <span m="1277770">terms</span> <span m="1278020">of</span> <span m="1278070">a</span> <span m="1278130">set</span> <span m="1278330">of</span> <span m="1278440">mutable</span> <span m="1278800">cells,</span> <span m="1279280">which</span> <span m="1279490">are</span> <span m="1279580">sort</span> <span m="1279780">of</span> <span m="1279860">the</span> <span m="1279950">data</span> <span m="1280430">the</span> <span m="1280560">page</span> <span m="1280780">depends</span> <span m="1281160">on.</span> </p>
<p><span m="1281360">And</span> <span m="1281760">the</span> <span m="1281910">page</span> <span m="1282130">itself</span> <span m="1282450">is</span> <span m="1282550">something</span> <span m="1282830">different,</span> <span m="1283450">described</span> <span m="1283870">as</span> <span m="1283970">a</span> <span m="1284020">function</span> <span m="1284950">that</span> <span m="1285130">takes</span> <span m="1285350">as</span> <span m="1285510">inputs</span> <span m="1285950">the</span> <span m="1286020">values</span> <span m="1286400">of</span> <span m="1286500">those</span> <span m="1286690">cells,</span> <span m="1287030">and</span> <span m="1287110">then</span> <span m="1287230">computes</span> <span m="1287470">a</span> <span m="1287710">page.</span> <span m="1288710">And</span> <span m="1288850">then</span> <span m="1288970">the</span> <span m="1289070">runtime</span> <span m="1289460">system</span> <span m="1289750">of</span> <span m="1289860">the</span> <span m="1289930">language</span> <span m="1290650">watches</span> <span m="1291200">changes</span> <span m="1291670">to</span> <span m="1291790">those</span> <span m="1292130">mutable</span> <span m="1292490">cells.</span> <span m="1292865">And</span> <span m="1293240">when</span> <span m="1293390">they</span> <span m="1293470">do</span> <span m="1293680">change,</span> <span m="1294010">it</span> <span m="1294100">automatically</span> <span m="1294680">computes</span> <span m="1295050">the</span> <span m="1295120">consequences</span> <span m="1296090">for</span> <span m="1296270">the</span> <span m="1296390">displayed</span> <span m="1296800">page</span> <span m="1297550">and</span> <span m="1298690">efficiently</span> <span m="1299200">updates</span> <span m="1299890">just</span> <span m="1300130">the</span> <span m="1300210">parts</span> <span m="1300510">of</span> <span m="1300710">the</span> <span m="1300920">page that have</span> <span m="1301360">changed</span> <span m="1302070">based</span> <span m="1302320">on</span> <span m="1302400">those</span> <span m="1302570">cells.</span> </p>
<p><span m="1307050">All</span> <span m="1307120">right,</span> <span m="1307440">and</span> <span m="1307760">on</span> <span m="1308890">each</span> <span m="1309080">client,</span> <span m="1309470">there</span> <span m="1309570">can</span> <span m="1309700">be</span> <span m="1309820">many</span> <span m="1310080">different</span> <span m="1310400">threads</span> <span m="1310910">running</span> <span m="1311320">at</span> <span m="1311390">once.</span> <span m="1314320">These</span> <span m="1314530">threads</span> <span m="1314810">are</span> <span m="1315540">spawned</span> <span m="1315815">in</span> <span m="1316090">Ur/Web</span> <span m="1316680">code</span> <span m="1316870">and</span> <span m="1317060">themselves</span> <span m="1317530">run</span> <span m="1317960">Ur/Web</span> <span m="1318320">code.</span> <span m="1318780">But</span> <span m="1318920">the</span> <span m="1319090">compiler</span> <span m="1319410">needs</span> <span m="1319580">to</span> <span m="1319710">translate</span> <span m="1320280">them</span> <span m="1320440">into</span> <span m="1320730">JavaScript</span> <span m="1321460">to</span> <span m="1321560">get</span> <span m="1321810">the</span> <span m="1321950">browser</span> <span m="1322290">to</span> <span m="1322390">run</span> <span m="1322590">them.</span> <span m="1323170">So</span> <span m="1323310">that's</span> <span m="1323530">one</span> <span m="1323700">of</span> <span m="1323760">the</span> <span m="1324020">services</span> <span m="1324430">the</span> <span m="1324550">compiler</span> <span m="1324930">provides.</span> <span m="1326840">That's</span> <span m="1326960">one</span> <span m="1327340">important</span> <span m="1327700">point</span> <span m="1327970">about</span> <span m="1328640">the</span> <span m="1328740">threads.</span> </p>
<p><span m="1329610">Another</span> <span m="1329870">key</span> <span m="1330120">point</span> <span m="1330450">is</span> <span m="1330590">that</span> <span m="1330730">the</span> <span m="1330780">client</span> <span m="1331060">side</span> <span m="1331300">threading</span> <span m="1331620">follows</span> <span m="1332360">what's</span> <span m="1332500">call</span> <span m="1332650">the</span> <span m="1332730">cooperative</span> <span m="1333320">multi-threading</span> <span m="1333860">model.</span> <span m="1334580">A</span> <span m="1334720">thread</span> <span m="1334800">doesn't</span> <span m="1335020">have</span> <span m="1335160">to</span> <span m="1335270">worry</span> <span m="1335620">about</span> <span m="1335900">being</span> <span m="1336110">preempted</span> <span m="1336750">by</span> <span m="1336890">another</span> <span m="1337220">thread</span> <span m="1337485">at an</span> <span m="1337750">arbitrary</span> <span m="1338280">point.</span> <span m="1339160">There</span> <span m="1339400">are</span> <span m="1339810">well</span> <span m="1340050">defined</span> <span m="1340430">operations</span> <span m="1341220">that</span> <span m="1341510">signal,</span> <span m="1341910">OK,</span> <span m="1342280">it's</span> <span m="1342450">all</span> <span m="1342600">right</span> <span m="1342740">to</span> <span m="1342830">switch</span> <span m="1343090">to</span> <span m="1343200">another</span> <span m="1343440">thread</span> <span m="1343730">here.</span> <span m="1344190">One</span> <span m="1344470">of them</span> <span m="1344550">is</span> <span m="1344930">making</span> <span m="1345440">a</span> <span m="1345660">remote</span> <span m="1346000">function</span> <span m="1346300">call</span> <span m="1346530">to</span> <span m="1346610">the</span> <span m="1346710">server,</span> <span m="1347090">for</span> <span m="1347420">instance,</span> <span m="1348650">or</span> <span m="1349360">asking</span> <span m="1349700">to</span> <span m="1349760">sleep</span> <span m="1350120">for</span> <span m="1350270">a</span> <span m="1350320">certain</span> <span m="1350550">number</span> <span m="1350790">of</span> <span m="1350850">milliseconds.</span> </p>
<p><span m="1351690">But</span> <span m="1351810">just</span> <span m="1351990">regular</span> <span m="1352350">code</span> <span m="1352670">can't</span> <span m="1352920">be</span> <span m="1353300">interrupted</span> <span m="1353770">arbitrarily.</span> <span m="1354610">So</span> <span m="1354750">that</span> <span m="1354940">means</span> <span m="1355150">the</span> <span m="1355220">programmer</span> <span m="1355495">doesn't</span> <span m="1355770">need</span> <span m="1355980">to</span> <span m="1356050">think</span> <span m="1356280">about</span> <span m="1356480">as</span> <span m="1356560">many</span> <span m="1356790">interleavings,</span> <span m="1357690">and</span> <span m="1357850">it's</span> <span m="1357990">easier</span> <span m="1358360">to</span> <span m="1358510">convince</span> <span m="1358910">yourself</span> <span m="1359780">that,</span> <span m="1360540">say,</span> <span m="1360880">a</span> <span m="1361050">particular</span> <span m="1361410">piece</span> <span m="1361610">of</span> <span m="1361690">code</span> <span m="1361970">avoids</span> <span m="1362740">some</span> <span m="1363210">security</span> <span m="1363590">issue</span> <span m="1363950">or</span> <span m="1364280">other</span> <span m="1364480">bug.</span> <span m="1364915">Because you can</span> <span m="1365350">more</span> <span m="1365610">easily</span> <span m="1365960">enumerate</span> <span m="1366250">all</span> <span m="1366540">the</span> <span m="1366770">possible</span> <span m="1367200">ways</span> <span m="1367700">for the two</span> <span m="1367850">threads to</span> <span m="1368290">interact</span> <span m="1368760">with each other.</span> </p>
<p><span m="1370210">And</span> <span m="1370310">this</span> <span m="1370430">is</span> <span m="1370520">sort</span> <span m="1370670">of</span> <span m="1370730">a</span> <span m="1370780">natural</span> <span m="1371150">model</span> <span m="1371440">to</span> <span m="1371530">use</span> <span m="1371790">given</span> <span m="1372030">the</span> <span m="1372110">way</span> <span m="1372290">JavaScript</span> <span m="1373120">is</span> <span m="1373240">usually</span> <span m="1374610">implemented.</span> <span m="1375890">There</span> <span m="1376340">isn't</span> <span m="1376670">preemption</span> <span m="1377230">in</span> <span m="1377570">JavaScript</span> <span m="1377990">and</span> <span m="1378080">browsers</span> <span m="1378480">already.</span> <span m="1378980">So</span> <span m="1379070">this</span> <span m="1379200">is</span> <span m="1379320">just</span> <span m="1379800">presenting</span> <span m="1380270">a</span> <span m="1380340">threading</span> <span m="1380680">abstraction</span> <span m="1381270">on</span> <span m="1381390">top</span> <span m="1381640">of</span> <span m="1381770">the</span> <span m="1381890">callbacks-based</span> <span m="1382920">model</span> <span m="1383470">that</span> <span m="1383610">JavaScript</span> <span m="1384170">shows</span> <span m="1384470">the</span> <span m="1384560">programmer</span> <span m="1385020">directly.</span> </p>
<p><span m="1389000">And</span> <span m="1389050">the</span> <span m="1389140">last</span> <span m="1389540">piece</span> <span m="1389890">that</span> <span m="1390300">one</span> <span m="1390440">of</span> <span m="1390520">the</span> <span m="1391280">built-in</span> <span m="1391720">abstractions</span> <span m="1392380">that</span> <span m="1392680">Ur/Web</span> <span m="1392980">applications</span> <span m="1393540">use</span> <span m="1394100">is</span> <span m="1394570">channels</span> <span m="1395030">for</span> <span m="1395460">passing</span> <span m="1395900">messages</span> <span m="1396420">between</span> <span m="1397070">different</span> <span m="1397790">machines.</span> <span m="1399060">So</span> <span m="1400100">each</span> <span m="1400330">channel</span> <span m="1400493">has</span> <span m="1400656">a</span> <span m="1400820">type,</span> <span m="1401170">which</span> <span m="1401680">expresses</span> <span m="1402120">what</span> <span m="1402300">kind</span> <span m="1402480">of</span> <span m="1402530">data</span> <span m="1402750">can</span> <span m="1402970">flow</span> <span m="1403210">over</span> <span m="1403500">if.</span> <span m="1403610">You</span> <span m="1403700">don't</span> <span m="1403830">have</span> <span m="1403960">to</span> <span m="1404080">convert</span> <span m="1404440">things</span> <span m="1404740">to</span> <span m="1404920">and</span> <span m="1405040">from</span> <span m="1405300">string</span> <span m="1405575">or</span> <span m="1405850">JSON</span> <span m="1406310">or</span> <span m="1406390">anything</span> <span m="1406680">else</span> <span m="1406890">to</span> <span m="1406980">make</span> <span m="1407130">this</span> <span m="1407260">work.</span> </p>
<p><span m="1408630">And</span> <span m="1409310">channels</span> <span m="1409740">can</span> <span m="1410370">live</span> <span m="1410550">in</span> <span m="1410640">the</span> <span m="1410720">database.</span> <span m="1411550">So</span> <span m="1411840">imagine</span> <span m="1412450">this</span> <span m="1412600">picture</span> <span m="1412750">is</span> <span m="1412900">showing</span> <span m="1413270">us</span> <span m="1413400">there's</span> <span m="1413590">a channel</span> <span m="1413845">that was</span> <span m="1414100">created.</span> <span m="1414370">It</span> <span m="1414640">has</span> <span m="1414730">a</span> <span m="1414840">write</span> <span m="1415110">side</span> <span m="1415360">and a</span> <span m="1415590">read</span> <span m="1415840">side,</span> <span m="1416160">which</span> <span m="1416330">can</span> <span m="1416480">go</span> <span m="1416590">to</span> <span m="1416680">separate</span> <span m="1417000">places.</span> <span m="1418170">The</span> <span m="1418910">write</span> <span m="1419140">end</span> <span m="1419400">is</span> <span m="1419490">sitting</span> <span m="1419730">in</span> <span m="1419800">the</span> <span m="1419880">database.</span> <span m="1420660">And</span> <span m="1420805">the</span> <span m="1420950">read</span> <span m="1421210">end</span> <span m="1421430">somehow</span> <span m="1421740">made</span> <span m="1422010">its</span> <span m="1422140">way</span> <span m="1422360">to</span> <span m="1422460">the</span> <span m="1422540">client</span> <span m="1422970">and</span> <span m="1423110">is</span> <span m="1423210">sitting</span> <span m="1423570">in</span> <span m="1423730">the</span> <span m="1424360">variable</span> <span m="1424780">environment</span> <span m="1425260">of</span> <span m="1425350">a</span> <span m="1425420">thread.</span> </p>
<p><span m="1426010">So</span> <span m="1426170">imagine</span> <span m="1426550">that</span> <span m="1426930">thread</span> <span m="1427240">earlier</span> <span m="1427640">made</span> <span m="1427880">a</span> <span m="1427920">remote</span> <span m="1428260">call</span> <span m="1428500">to</span> <span m="1428570">the</span> <span m="1428670">server,</span> <span m="1429050">which</span> <span m="1429670">created</span> <span m="1430030">the</span> <span m="1430080">channel,</span> <span m="1430610">returned</span> <span m="1431000">it</span> <span m="1431075">to</span> <span m="1431150">the</span> <span m="1431240">client,</span> <span m="1431810">and</span> <span m="1432000">put</span> <span m="1432150">it</span> <span m="1432230">in</span> <span m="1432310">the</span> <span m="1432390">database</span> <span m="1433080">in</span> <span m="1433230">one</span> <span m="1433580">transaction.</span> <span m="1435930">So</span> <span m="1437150">later,</span> <span m="1437450">the</span> <span m="1437560">server</span> <span m="1437830">decides,</span> <span m="1438320">OK,</span> <span m="1438460">I'll</span> <span m="1438600">query</span> <span m="1438950">that</span> <span m="1439470">channel</span> <span m="1439810">out</span> <span m="1439870">of</span> <span m="1439930">the</span> <span m="1440000">database.</span> <span m="1440560">And</span> <span m="1440680">I'll</span> <span m="1441120">dump</span> <span m="1441220">a</span> <span m="1441280">value</span> <span m="1441650">into</span> <span m="1441890">it.</span> <span m="1442080">And it</span> <span m="1442200">just</span> <span m="1442580">sort</span> <span m="1442710">of</span> <span m="1442780">pops</span> <span m="1443080">out</span> <span m="1443250">the</span> <span m="1443340">other</span> <span m="1443530">end</span> <span m="1444400">on</span> <span m="1444570">the</span> <span m="1444650">client.</span> <span m="1445786">And</span> <span m="1446580">everything</span> <span m="1446930">is</span> <span m="1447020">strongly</span> <span m="1447390">tied</span> <span m="1447640">throughout</span> <span m="1447890">this</span> <span m="1448020">process.</span> </p>
<p><span m="1451450">All right,</span> <span m="1451590">I</span> <span m="1451660">think</span> <span m="1451890">this</span> <span m="1452030">is</span> <span m="1452140">the</span> <span m="1452240">last</span> <span m="1452530">step</span> <span m="1452740">of</span> <span m="1452870">my</span> <span m="1453050">animation</span> <span m="1453560">here.</span> <span m="1454380">Any</span> <span m="1454860">questions</span> <span m="1455510">about</span> <span m="1455750">this</span> <span m="1455880">model</span> <span m="1456170">before</span> <span m="1456750">I</span> <span m="1457540">switch</span> <span m="1457880">to</span> <span m="1458000">a</span> <span m="1458070">code</span> <span m="1458440">demo?</span> </p>
<p><span m="1463940">STUDENT: So</span> <span m="1464440">how</span> <span m="1464940">is this</span> <span m="1465440">different</span> <span m="1465940">than</span> <span m="1466440">[INAUDIBLE]?</span> <span m="1467940">Why</span> <span m="1468440">do you need</span> <span m="1468940">a</span> <span m="1469440">message</span> <span m="1469940">passage if you</span> <span m="1470440">already</span> <span m="1470940">have that</span> <span m="1471440">[INAUDIBLE]?</span> </p>
<p><span m="1473940">ADAM CHLIPALA: OK,</span> <span m="1474210">so</span> <span m="1474340">RPC</span> <span m="1474840">interface</span> <span m="1475260">is</span> <span m="1475370">going</span> <span m="1475630">from</span> <span m="1476440">browser</span> <span m="1476860">initiates</span> <span m="1477380">the</span> <span m="1477450">call,</span> <span m="1478130">the</span> <span m="1478230">server</span> <span m="1479170">handles</span> <span m="1479520">it.</span> <span m="1480900">The</span> <span m="1480990">message</span> <span m="1481400">is</span> <span m="1481820">that the</span> <span m="1482100">channels</span> <span m="1482470">are</span> <span m="1482550">intended</span> <span m="1482910">for</span> <span m="1483020">cases</span> <span m="1483360">where</span> <span m="1483440">the</span> <span m="1483550">server</span> <span m="1483940">initiates</span> <span m="1484420">the</span> <span m="1484500">communication.</span> <span m="1485710">For</span> <span m="1486010">instance,</span> <span m="1486520">new</span> <span m="1486690">email</span> <span m="1486980">message--</span> <span m="1487785">that</span> <span m="1488060">would</span> <span m="1488170">be a</span> <span m="1488260">canonical</span> <span m="1488710">example.</span> <span m="1489460">And</span> <span m="1489600">the</span> <span m="1489670">client</span> <span m="1489950">is</span> <span m="1490030">waiting</span> <span m="1490350">to</span> <span m="1490420">hear</span> <span m="1490790">that</span> <span m="1490950">there's</span> <span m="1491090">a</span> <span m="1491130">new</span> <span m="1491290">email</span> <span m="1491560">message.</span> <span m="1491900">But</span> <span m="1492030">it</span> <span m="1492100">can't</span> <span m="1492800">determine</span> <span m="1493170">on</span> <span m="1493330">its</span> <span m="1493480">own</span> <span m="1494050">when</span> <span m="1494120">the</span> <span m="1494200">next</span> <span m="1494470">message</span> <span m="1494820">is</span> <span m="1494920">available.</span> <span m="1495840">Yeah.</span> </p>
<p><span m="1497280">STUDENT: Are</span> <span m="1497760">all the messages</span> <span m="1498240">multiplexed</span> <span m="1498720">through</span> <span m="1499200">one</span> <span m="1499680">connection,</span> <span m="1500160">or is it</span> <span m="1500640">[INAUDIBLE]?</span> </p>
<p><span m="1501600">ADAM CHLIPALA: They are</span> <span m="1501710">multiplexed</span> <span m="1502190">through</span> <span m="1502490">one</span> <span m="1502780">HTTP</span> <span m="1503400">connection.</span> <span m="1504380">I</span> <span m="1504500">know</span> <span m="1504690">there</span> <span m="1504850">are</span> <span m="1504900">these</span> <span m="1505130">newfangled</span> <span m="1505700">things</span> <span m="1506250">today</span> <span m="1506500">called</span> <span m="1506710">web</span> <span m="1506920">sockets</span> <span m="1507400">and</span> <span m="1507480">maybe</span> <span m="1507680">some</span> <span m="1507860">other</span> <span m="1508280">protocols</span> <span m="1508700">like</span> <span m="1508890">that,</span> <span m="1509140">which</span> <span m="1509290">didn't</span> <span m="1509520">exist</span> <span m="1509880">when</span> <span m="1509990">this</span> <span m="1510100">was</span> <span m="1510240">implemented.</span> <span m="1510750">This</span> <span m="1510910">all</span> <span m="1511070">works</span> <span m="1511330">over</span> <span m="1512100">old-school</span> <span m="1512620">HTTP</span> <span m="1513650">with</span> <span m="1513780">one</span> <span m="1514150">connection</span> <span m="1514640">for</span> <span m="1515160">all</span> <span m="1515350">the</span> <span m="1515420">messages</span> <span m="1516310">on</span> <span m="1516520">different</span> <span m="1516790">channels.</span> </p>
<p><span m="1522000">All</span> <span m="1522480">right,</span> <span m="1522710">let's see</span> <span m="1523145">what's next.</span> <span m="1524000">Yeah,</span> <span m="1524420">let</span> <span m="1524540">me</span> <span m="1524810">switch</span> <span m="1525060">to</span> <span m="1525150">a</span> <span m="1525210">demo</span> <span m="1525520">here.</span> <span m="1529740">So</span> <span m="1531360">here's</span> <span m="1531500">a</span> <span m="1531540">Hello</span> <span m="1531790">World</span> <span m="1532190">program</span> <span m="1532840">in</span> <span m="1533120">Ur/Web.</span> <span m="1533510">Probably</span> <span m="1533950">it</span> <span m="1534180">deserves</span> <span m="1534520">more of</span> <span m="1534810">the</span> <span m="1534900">screen</span> <span m="1535150">space</span> <span m="1535510">than</span> <span m="1535670">this</span> <span m="1535980">compilation</span> <span m="1536250">output.</span> <span m="1538180">So</span> <span m="1539830">it</span> <span m="1539970">looks</span> <span m="1540180">pretty</span> <span m="1541090">un-scary</span> <span m="1542040">at</span> <span m="1542220">this</span> <span m="1542370">point,</span> <span m="1542620">I hope.</span> </p>
<p><span m="1544660">The</span> <span m="1545150">unusual</span> <span m="1545580">thing</span> <span m="1545740">here</span> <span m="1545920">maybe</span> <span m="1546250">is</span> <span m="1546460">that</span> <span m="1547390">this</span> <span m="1547530">is</span> <span m="1547600">really</span> <span m="1547800">the</span> <span m="1547880">whole</span> <span m="1548050">program.</span> <span m="1548550">There's</span> <span m="1548720">no</span> <span m="1548870">extra</span> <span m="1549290">routing</span> <span m="1549640">logic</span> <span m="1550130">that</span> <span m="1550980">explains</span> <span m="1551450">how</span> <span m="1551620">to</span> <span m="1551960">map</span> <span m="1552230">a</span> <span m="1552290">URL</span> <span m="1552870">into</span> <span m="1553060">some</span> <span m="1553230">code</span> <span m="1553590">to</span> <span m="1553710">run</span> <span m="1554410">to</span> <span m="1554550">serve</span> <span m="1555040">requests</span> <span m="1555700">to</span> <span m="1555850">that</span> <span m="1556060">URL.</span> <span m="1557010">We</span> <span m="1557170">just</span> <span m="1557400">have</span> <span m="1557640">regular</span> <span m="1557970">functions</span> <span m="1558470">of</span> <span m="1558580">a</span> <span m="1559180">standard</span> <span m="1559650">kind</span> <span m="1559810">of</span> <span m="1559870">programming</span> <span m="1560290">language.</span> <span m="1560840">And</span> <span m="1561080">the</span> <span m="1561150">compiler</span> <span m="1562220">exposes</span> <span m="1563960">all</span> <span m="1564160">the</span> <span m="1564240">functions</span> <span m="1564740">in</span> <span m="1564850">your</span> <span m="1564970">main</span> <span m="1565290">module</span> <span m="1566130">as</span> <span m="1567520">callable</span> <span m="1568020">via</span> <span m="1568200">URLs.</span> </p>
<p><span m="1568740">And</span> <span m="1568840">the</span> <span m="1568890">URL</span> <span m="1569135">is</span> <span m="1569380">just</span> <span m="1569680">formed</span> <span m="1570080">from</span> <span m="1570160">the</span> <span m="1570230">function</span> <span m="1570545">name.</span> <span m="1571220">And</span> <span m="1571470">if</span> <span m="1571690">there's</span> <span m="1571840">some</span> <span m="1572020">nested</span> <span m="1572390">structure</span> <span m="1572790">modules,</span> <span m="1573740">the</span> <span m="1574630">module's</span> <span m="1575750">structure</span> <span m="1576050">is</span> <span m="1576350">also</span> <span m="1576800">replicated</span> <span m="1577480">in</span> <span m="1578040">the</span> <span m="1578560">URL.</span> <span m="1579890">And</span> <span m="1580100">then</span> <span m="1580320">we</span> <span m="1580410">have</span> <span m="1580530">a</span> <span m="1581120">function</span> <span m="1581390">that</span> <span m="1581500">returns</span> <span m="1582230">a</span> <span m="1582470">piece</span> <span m="1583280">of</span> <span m="1584200">XHTML</span> <span m="1584910">syntax.</span> <span m="1586160">The</span> <span m="1586260">compiler</span> <span m="1586590">is</span> <span m="1586920">actually</span> <span m="1587570">using</span> <span m="1587735">a</span> <span m="1587900">special</span> <span m="1588290">parsing</span> <span m="1588590">extension</span> <span m="1589240">for</span> <span m="1589420">processing</span> <span m="1590390">this</span> <span m="1590960">XHTML</span> <span m="1591660">syntax.</span> <span m="1592680">And</span> <span m="1592930">it's</span> <span m="1593080">also</span> <span m="1593580">doing</span> <span m="1593830">some</span> <span m="1593980">basic</span> <span m="1594420">type</span> <span m="1594640">checking</span> <span m="1595370">to</span> <span m="1595490">make</span> <span m="1595680">sure</span> <span m="1595900">that</span> <span m="1596250">different</span> <span m="1596840">XML</span> <span m="1597420">elements</span> <span m="1597860">appear</span> <span m="1598380">inside</span> <span m="1598810">others</span> <span m="1598910">that</span> <span m="1599220">they're</span> <span m="1599390">actually</span> <span m="1599830">authorized</span> <span m="1600460">to</span> <span m="1600520">appear</span> <span m="1600810">inside</span> <span m="1601100">of.</span> </p>
<p><span m="1603140">And</span> <span m="1603610">I</span> <span m="1603630">think</span> <span m="1603830">I</span> <span m="1603850">compiled</span> <span m="1604330">this</span> <span m="1604500">before</span> <span m="1605760">we</span> <span m="1605840">started.</span> <span m="1606340">And</span> <span m="1606620">it</span> <span m="1606710">does</span> <span m="1607170">a</span> <span m="1607450">not</span> <span m="1607640">very</span> <span m="1607910">surprising</span> <span m="1608390">thing</span> <span m="1608610">in</span> <span m="1608670">the</span> <span m="1608730">browser.</span> <span m="1610070">And</span> <span m="1610960">here's</span> <span m="1611240">the</span> <span m="1611880">HTML</span> <span m="1612380">page</span> <span m="1612700">that</span> <span m="1613580">comes</span> <span m="1613790">out.</span> <span m="1616290">So</span> <span m="1616780">among</span> <span m="1617050">other</span> <span m="1617630">properties,</span> <span m="1618350">it</span> <span m="1619040">automatically</span> <span m="1620050">adds</span> <span m="1620450">the</span> <span m="1620580">right</span> <span m="1620810">XHTML</span> <span m="1621520">header.</span> <span m="1621940">And</span> <span m="1622100">it</span> <span m="1622510">declares</span> <span m="1622960">the</span> <span m="1623590">character</span> <span m="1623980">encoding</span> <span m="1624810">for</span> <span m="1625150">this</span> <span m="1625830">document.</span> <span m="1626700">I</span> <span m="1626830">was</span> <span m="1627040">mildly</span> <span m="1627310">horrified</span> <span m="1627990">to</span> <span m="1628220">look</span> <span m="1628390">at</span> <span m="1628470">some</span> <span m="1628610">of</span> <span m="1628710">your</span> <span m="1628860">assigned</span> <span m="1629170">reading</span> <span m="1629420">for</span> <span m="1629510">this</span> <span m="1629680">class</span> <span m="1629990">and</span> <span m="1630110">see</span> <span m="1630240">how</span> <span m="1630320">much</span> <span m="1630540">time</span> <span m="1631170">this</span> <span m="1631740">book</span> <span m="1631950">spends</span> <span m="1632230">talking</span> <span m="1632540">about</span> <span m="1632760">character</span> <span m="1633120">encodings</span> <span m="1633450">and</span> <span m="1634020">what</span> <span m="1634230">happens</span> <span m="1634450">if</span> <span m="1634670">you're</span> <span m="1634810">not</span> <span m="1635140">using</span> <span m="1635460">UTF-8.</span> <span m="1637331">I</span> <span m="1637810">hope</span> <span m="1637980">I</span> <span m="1638050">understood</span> <span m="1638380">that</span> <span m="1638550">correctly.</span> </p>
<p><span m="1638930">This</span> <span m="1639330">forces</span> <span m="1639540">you to use</span> <span m="1640040">UTF-8</span> <span m="1640310">so</span> <span m="1640580">that</span> <span m="1640740">those</span> <span m="1640940">horrible</span> <span m="1641270">things</span> <span m="1641570">aren't</span> <span m="1641710">going</span> <span m="1641890">to</span> <span m="1641930">happen,</span> <span m="1642680">I</span> <span m="1642780">hope.</span> <span m="1643080">But</span> <span m="1643145">if</span> <span m="1643210">anyone</span> <span m="1643460">sees</span> <span m="1643700">a</span> <span m="1643770">way</span> <span m="1643970">to</span> <span m="1644180">replicate</span> <span m="1644680">any</span> <span m="1645740">of</span> <span m="1645820">the</span> <span m="1645920">attacks</span> <span m="1646300">from</span> <span m="1646470">that</span> <span m="1646800">book</span> <span m="1647260"><i>Tangled</i></span> <span m="1647580"><i>Web</i></span> <span m="1647870">in</span> <span m="1648310">Ur/Web,</span> <span m="1648620">or</span> <span m="1648900">has</span> <span m="1649070">a</span> <span m="1649110">hypothesis</span> <span m="1649740">about</span> <span m="1649950">something</span> <span m="1650180">we</span> <span m="1650260">should</span> <span m="1650460">try</span> <span m="1650710">to</span> <span m="1650810">see</span> <span m="1650970">if</span> <span m="1651050">it</span> <span m="1651120">works,</span> <span m="1652060">I'd</span> <span m="1652080">be</span> <span m="1652170">interested</span> <span m="1652600">to</span> <span m="1652640">hear</span> <span m="1652830">that.</span> <span m="1653530">And</span> <span m="1653800">by</span> <span m="1653930">the</span> <span m="1654020">way,</span> <span m="1654220">at</span> <span m="1654320">any</span> <span m="1654370">point</span> <span m="1654580">during</span> <span m="1654780">this</span> <span m="1654910">demo,</span> <span m="1655170">please</span> <span m="1655540">suggest</span> <span m="1658020">experiments</span> <span m="1659310">that</span> <span m="1659550">come</span> <span m="1659740">to</span> <span m="1659810">mind</span> <span m="1660120">about</span> <span m="1660380">things</span> <span m="1660590">we</span> <span m="1660680">should</span> <span m="1660840">try,</span> <span m="1661350">mistakes</span> <span m="1661800">you</span> <span m="1661900">might</span> <span m="1662110">make</span> <span m="1662510">that</span> <span m="1662750">you</span> <span m="1662860">wonder</span> <span m="1663300">whether</span> <span m="1663650">this</span> <span m="1663820">system is</span> <span m="1664290">able</span> <span m="1664490">to</span> <span m="1664550">catch.</span> <span m="1665390">I</span> <span m="1665780">think</span> <span m="1665930">that's</span> <span m="1666180">the</span> <span m="1666610">most</span> <span m="1666880">fun</span> <span m="1667040">kind</span> <span m="1667200">of</span> <span m="1667250">demo.</span> <span m="1667590">Yeah.</span> </p>
<p><span m="1667840">STUDENT: So</span> <span m="1668337">things like</span> <span m="1668834">CRSF</span> <span m="1669331">[INAUDIBLE],</span> <span m="1669828">you said</span> <span m="1670325">that</span> <span m="1670822">[INAUDIBLE].</span> </p>
<p><span m="1675300">ADAM CHLIPALA: So</span> <span m="1677600">cross</span> <span m="1677870">site</span> <span m="1678070">request</span> <span m="1678400">forgery</span> <span m="1678910">I</span> <span m="1679010">wanted</span> <span m="1679350">to</span> <span m="1680020">explain</span> <span m="1680540">a</span> <span m="1680630">little</span> <span m="1680810">later</span> <span m="1681310">explicitly.</span> <span m="1682120">I</span> <span m="1682180">think</span> <span m="1682390">the</span> <span m="1682470">paper</span> <span m="1683260">sort of</span> <span m="1683700">explains</span> <span m="1684190">why</span> <span m="1684380">cross</span> <span m="1684680">site</span> <span m="1684880">scripting</span> <span m="1685240">can't</span> <span m="1685480">work.</span> <span m="1686200">And</span> <span m="1686260">the</span> <span m="1686360">reason</span> <span m="1686700">is</span> <span m="1689040">whenever</span> <span m="1689290">you</span> <span m="1689420">build</span> <span m="1689970">a</span> <span m="1690080">piece</span> <span m="1690330">of</span> <span m="1690410">syntax,</span> <span m="1691640">it's</span> <span m="1692265">an</span> <span m="1692720">object,</span> <span m="1694200">a</span> <span m="1694470">tree</span> <span m="1695260">of</span> <span m="1696510">different</span> <span m="1698230">sub</span> <span m="1698830">parts</span> <span m="1699110">of</span> <span m="1699190">that</span> <span m="1699380">syntax.</span> <span m="1699810">It's</span> <span m="1699970">not</span> <span m="1700140">just</span> <span m="1700330">a</span> <span m="1700380">string.</span> </p>
<p><span m="1701620">And</span> <span m="1701940">you're</span> <span m="1702090">not</span> <span m="1702260">going</span> <span m="1702440">to</span> <span m="1702550">accidentally</span> <span m="1703570">turn</span> <span m="1703830">a</span> <span m="1703880">string</span> <span m="1704570">from</span> <span m="1704730">the</span> <span m="1704820">user</span> <span m="1705250">into</span> <span m="1705540">a</span> <span m="1705610">tree</span> <span m="1706300">with</span> <span m="1706440">structure.</span> <span m="1707200">You</span> <span m="1707360">would</span> <span m="1707480">know</span> <span m="1707700">if</span> <span m="1707770">you</span> <span m="1707840">did</span> <span m="1708010">that.</span> <span m="1708190">Because</span> <span m="1708360">it's</span> <span m="1708780">hard</span> <span m="1709030">to</span> <span m="1709120">write</span> <span m="1709300">an</span> <span m="1709390">interpreter.</span> <span m="1710430">And</span> <span m="1710780">in</span> <span m="1710970">Ur/Web,</span> <span m="1711320">you</span> <span m="1711410">have</span> <span m="1711590">to</span> <span m="1711700">write an</span> <span m="1711890">interpreter.</span> <span m="1712370">It</span> <span m="1712430">doesn't</span> <span m="1712700">automatically</span> <span m="1713280">happen</span> <span m="1713620">for you.</span> <span m="1714490">But</span> <span m="1715360">I'll</span> <span m="1715460">have</span> <span m="1716600">an</span> <span m="1716690">example</span> <span m="1717480">shortly</span> <span m="1717960">that</span> <span m="1718230">might</span> <span m="1718390">also</span> <span m="1718650">address</span> <span m="1718990">that</span> <span m="1719260">concern.</span> </p>
<p><span m="1720440">So</span> <span m="1721370">I</span> <span m="1721530">want</span> <span m="1721555">to</span> <span m="1721580">show</span> <span m="1721760">you</span> <span m="1722510">what</span> <span m="1722850">this</span> <span m="1723080">syntactic</span> <span m="1723600">sugar</span> <span m="1723970">actually</span> <span m="1724690">turns</span> <span m="1724960">into</span> <span m="1725460">in</span> <span m="1725550">the</span> <span m="1725760">compiler.</span> <span m="1726200">So</span> <span m="1726680">this</span> <span m="1726840">might</span> <span m="1727030">look</span> <span m="1727240">like</span> <span m="1727570">we</span> <span m="1727640">could</span> <span m="1727750">just</span> <span m="1727920">add</span> <span m="1728160">some</span> <span m="1728330">double</span> <span m="1728580">quotes</span> <span m="1728950">around</span> <span m="1729310">the</span> <span m="1729540">HTML,</span> <span m="1729740">and</span> <span m="1730200">then</span> <span m="1730320">we're</span> <span m="1730420">back</span> <span m="1730650">in the</span> <span m="1730780">normal</span> <span m="1731120">world.</span> <span m="1731710">We</span> <span m="1731840">might</span> <span m="1732030">wonder,</span> <span m="1732470">why</span> <span m="1732800">is it</span> <span m="1732960">such</span> <span m="1733320">a</span> <span m="1733370">big</span> <span m="1733540">deal</span> <span m="1733760">the</span> <span m="1733940">omit</span> <span m="1734050">the</span> <span m="1734160">double</span> <span m="1734490">quotes</span> <span m="1734790">and put</span> <span m="1735100">XML</span> <span m="1735510">instead?</span> </p>
<p><span m="1736640">So</span> <span m="1738380">we</span> <span m="1738480">can</span> <span m="1738610">actually</span> <span m="1741490">take</span> <span m="1741660">my</span> <span m="1741740">word</span> <span m="1742020">for</span> <span m="1742240">it</span> <span m="1742340">that</span> <span m="1742540">this</span> <span m="1742900">is</span> <span m="1743570">equivalent</span> <span m="1743990">code</span> <span m="1744940">for</span> <span m="1745060">what</span> <span m="1745280">this</span> <span m="1745480">does.</span> <span m="1745820">So</span> <span m="1746180">tag</span> <span m="1746540">is</span> <span m="1746630">a</span> <span m="1746680">built</span> <span m="1747020">in</span> <span m="1747180">function</span> <span m="1747630">that</span> <span m="1747810">builds</span> <span m="1748450">a</span> <span m="1748560">tree</span> <span m="1748910">node</span> <span m="1749320">of</span> <span m="1749450">an</span> <span m="1749530">HTML</span> <span m="1750000">document.</span> <span m="1751260">And</span> <span m="1751360">I'm</span> <span m="1751430">passing</span> <span m="1751760">a</span> <span m="1751820">bunch</span> <span m="1752020">of</span> <span m="1752100">arguments</span> <span m="1752530">that</span> <span m="1752630">are</span> <span m="1753330">expressing</span> <span m="1754080">the</span> <span m="1754250">CSS</span> <span m="1754860">styling</span> <span m="1755230">on</span> <span m="1755370">that</span> <span m="1755560">node.</span> </p>
<p><span m="1757680">This one</span> <span m="1757860">doesn't</span> <span m="1758170">really</span> <span m="1758275">have</span> <span m="1758380">anything</span> <span m="1758630">going</span> <span m="1758890">on,</span> <span m="1759120">so</span> <span m="1759290">it's</span> <span m="1759380">a</span> <span m="1759420">variety</span> <span m="1759790">of</span> <span m="1760820">different</span> <span m="1761060">ways</span> <span m="1761260">of</span> <span m="1761350">saying</span> <span m="1761630">nothing.</span> <span m="1762930">And</span> <span m="1763725">it</span> <span m="1764120">doesn't</span> <span m="1764520">take</span> <span m="1764700">any</span> <span m="1764890">attributes.</span> <span m="1766690">And</span> <span m="1766950">the</span> <span m="1767020">tag</span> <span m="1767510">is</span> <span m="1767830">a</span> <span m="1767880">body</span> <span m="1768200">tag.</span> <span m="1768770">So</span> <span m="1768820">that's</span> <span m="1769060">another</span> <span m="1769900">thing</span> <span m="1770180">in</span> <span m="1770350">the</span> <span m="1770420">standard</span> <span m="1770750">library.</span> <span m="1771340">All</span> <span m="1771580">of</span> <span m="1771620">the</span> <span m="1771660">standard</span> <span m="1772070">tags</span> <span m="1772610">are</span> <span m="1773630">functions</span> <span m="1774060">with</span> <span m="1774130">first</span> <span m="1774400">class</span> <span m="1774680">status</span> <span m="1775110">in</span> <span m="1775240">the</span> <span m="1775310">standard</span> <span m="1775640">library.</span> </p>
<p><span m="1776890">And</span> <span m="1777590">then</span> <span m="1777920">we</span> <span m="1778020">need</span> <span m="1778230">to put</span> <span m="1778320">a</span> <span m="1778355">"Hello</span> <span m="1778740">World"</span> <span m="1779080">text</span> <span m="1779370">inside</span> <span m="1779770">it.</span> <span m="1779870">So</span> <span m="1779970">we</span> <span m="1780080">call</span> <span m="1780350">a</span> <span m="1780400">cdata</span> <span m="1780990">function</span> <span m="1781410">where</span> <span m="1781740">cdata</span> <span m="1781920">is</span> <span m="1782270">the</span> <span m="1783620">XML</span> <span m="1784700">word</span> <span m="1785000">for</span> <span m="1785310">character</span> <span m="1785670">data</span> <span m="1786040">or</span> <span m="1786310">just</span> <span m="1786500">a</span> <span m="1786540">string</span> <span m="1786790">constant.</span> <span m="1787110">And</span> <span m="1787430">we</span> <span m="1787590">can</span> <span m="1787910">put</span> <span m="1788220">exactly</span> <span m="1788590">the</span> <span m="1788700">text</span> <span m="1789060">from below.</span> <span m="1791710">We'll</span> <span m="1792140">comment</span> <span m="1792490">that</span> <span m="1792690">out.</span> </p>
<p><span m="1793460">This</span> <span m="1793630">should</span> <span m="1793830">give</span> <span m="1793990">us</span> <span m="1794120">the</span> <span m="1794190">same</span> <span m="1794490">result</span> <span m="1794765">as</span> <span m="1795040">before.</span> <span m="1796390">Let</span> <span m="1796810">me</span> <span m="1797230">see</span> <span m="1797650">if</span> <span m="1797840">that</span> <span m="1798410">worked.</span> <span m="1798880">OK,</span> <span m="1800510">and</span> <span m="1801010">now</span> <span m="1802290">I'll</span> <span m="1802680">go</span> <span m="1802800">back</span> <span m="1803000">to</span> <span m="1803100">the</span> <span m="1803200">actual</span> <span m="1803480">page.</span> <span m="1805500">Same</span> <span m="1805710">thing as</span> <span m="1805910">before,</span> <span m="1807780">so</span> <span m="1808390">this</span> <span m="1808660">is</span> <span m="1808770">what</span> <span m="1809220">that</span> <span m="1809910">function</span> <span m="1810200">was</span> <span m="1810310">really</span> <span m="1810530">doing</span> <span m="1810800">at the</span> <span m="1810860">begin.</span> <span m="1811550">It's</span> <span m="1811780">not</span> <span m="1812060">just</span> <span m="1812220">building</span> <span m="1812490">a</span> <span m="1812550">string.</span> <span m="1812850">It's</span> <span m="1813000">calling</span> <span m="1813310">a</span> <span m="1813360">series</span> <span m="1813670">of</span> <span m="1813760">operations</span> <span m="1813860">that</span> <span m="1814420">are</span> <span m="1814630">designed</span> <span m="1815085">so</span> <span m="1815540">that</span> <span m="1815830">they</span> <span m="1816110">only</span> <span m="1816480">allow</span> <span m="1816790">you</span> <span m="1817030">to</span> <span m="1817160">build</span> <span m="1817820">valid</span> <span m="1818220">HTML,</span> <span m="1818665">and they</span> <span m="1819110">never</span> <span m="1819580">implicitly</span> <span m="1820300">interpret</span> <span m="1820730">a</span> <span m="1820780">string</span> <span m="1821470">as</span> <span m="1821750">code</span> <span m="1822890">instead</span> <span m="1823230">of</span> <span m="1823390">just</span> <span m="1824260">content that</span> <span m="1824555">sits</span> <span m="1824850">there.</span> <span m="1825240">Yeah?</span> </p>
<p><span m="1826107">STUDENT: [INAUDIBLE]?</span> </p>
<p><span m="1829450">ADAM CHLIPALA: Right,</span> <span m="1829840">you</span> <span m="1830000">are</span> <span m="1831090">anticipating</span> <span m="1831950">the</span> <span m="1832060">next few</span> <span m="1832390">steps.</span> <span m="1832730">Let me</span> <span m="1832910">do</span> <span m="1833020">something</span> <span m="1833470">less</span> <span m="1834460">complicated</span> <span m="1834715">first,</span> <span m="1834970">which</span> <span m="1835325">is</span> <span m="1835680">also</span> <span m="1836180">potentially</span> <span m="1836440">worrisome.</span> <span m="1837556">Let's</span> <span m="1837892">decide</span> <span m="1838230">that</span> <span m="1839820">we're</span> <span m="1839960">really</span> <span m="1840180">happy</span> <span m="1840420">to</span> <span m="1840500">see</span> <span m="1840620">the</span> <span m="1840660">world,</span> <span m="1841050">so</span> <span m="1841180">we</span> <span m="1841290">better</span> <span m="1841680">put</span> <span m="1842020">the</span> <span m="1842360">word</span> <span m="1842455">"hello"</span> <span m="1842550">in bold</span> <span m="1845334">and</span> <span m="1845830">compile</span> <span m="1846010">that again.</span> <span m="1847965">It</span> <span m="1848440">just</span> <span m="1848610">shows</span> <span m="1848870">up</span> <span m="1849060">as</span> <span m="1850430">interpreting</span> <span m="1850830">that</span> <span m="1851030">literally</span> <span m="1851410">as</span> <span m="1851860">text</span> <span m="1852200">instead</span> <span m="1852450">of</span> <span m="1852530">markup.</span> </p>
<p><span m="1853800">So</span> <span m="1854180">this</span> <span m="1857470">presentation</span> <span m="1858020">of</span> <span m="1858100">HTML</span> <span m="1858550">syntax</span> <span m="1859010">as</span> <span m="1859110">a</span> <span m="1859210">function</span> <span m="1859640">that</span> <span m="1859830">builds</span> <span m="1860080">syntax</span> <span m="1861530">doesn't</span> <span m="1862140">have</span> <span m="1862500">any</span> <span m="1862690">of</span> <span m="1862770">the</span> <span m="1862860">usual</span> <span m="1863580">syntactic</span> <span m="1864110">encoding</span> <span m="1864490">conventions</span> <span m="1865000">built</span> <span m="1865220">into</span> <span m="1865450">it.</span> <span m="1865490">It</span> <span m="1865530">interprets</span> <span m="1865980">things</span> <span m="1866210">in</span> <span m="1866270">the</span> <span m="1866350">way</span> <span m="1866480">you</span> <span m="1866660">would want</span> <span m="1866760">it</span> <span m="1867130">to.</span> <span m="1867910">And</span> <span m="1868730">so</span> <span m="1868840">the</span> <span m="1868970">implementation</span> <span m="1869315">of</span> <span m="1869660">cdata</span> <span m="1871320">does</span> <span m="1871630">what's</span> <span m="1872120">usually</span> <span m="1872340">called</span> <span m="1872590">escaping.</span> </p>
<p><span m="1873150">But</span> <span m="1873360">the</span> <span m="1873440">programmer</span> <span m="1873850">doesn't</span> <span m="1874070">need</span> <span m="1874210">to</span> <span m="1874280">know</span> <span m="1874440">there</span> <span m="1874640">is</span> <span m="1874750">any</span> <span m="1874920">such</span> <span m="1875190">thing</span> <span m="1875430">as</span> <span m="1875630">escaping.</span> <span m="1875720">You</span> <span m="1876015">can</span> <span m="1876310">just</span> <span m="1876480">think</span> <span m="1876650">of</span> <span m="1876720">it</span> <span m="1876830">as,</span> <span m="1877010">here's</span> <span m="1877210">a</span> <span m="1877270">set</span> <span m="1877450">of</span> <span m="1877720">convenient</span> <span m="1878050">functions</span> <span m="1878490">for</span> <span m="1878610">building</span> <span m="1878980">a</span> <span m="1879080">tree</span> <span m="1879380">object</span> <span m="1879870">that</span> <span m="1880010">describes</span> <span m="1880305">a</span> <span m="1880600">page.</span> <span m="1880680">Did I</span> <span m="1880945">see a</span> <span m="1881500">question</span> <span m="1881830">over there?</span> </p>
<p><span m="1882774">STUDENT: [INAUDIBLE]?</span> </p>
<p><span m="1885140">ADAM CHLIPALA: You</span> <span m="1885390">want to see the</span> <span m="1885590">HTML</span> <span m="1886060">that</span> <span m="1886530">it generates.</span> <span m="1887000">OK, it's</span> <span m="1887470">going to</span> <span m="1887940">be</span> <span m="1888410">not</span> <span m="1888880">the</span> <span m="1889350">most</span> <span m="1889820">exciting thing.</span> <span m="1892170">I don't know if</span> <span m="1892650">that's</span> <span m="1893190">[INAUDIBLE].</span> <span m="1894360">I</span> <span m="1894420">can</span> <span m="1894540">make</span> <span m="1894660">it</span> <span m="1894720">bigger,</span> <span m="1895180">but</span> <span m="1895255">then</span> <span m="1895330">it</span> <span m="1895405">doesn't</span> <span m="1895480">fit</span> <span m="1895610">on</span> <span m="1895700">one</span> <span m="1895880">line.</span> <span m="1896290">So</span> <span m="1896390">let me know</span> <span m="1896790">if I should make it</span> <span m="1897110">bigger.</span> <span m="1899680">It</span> <span m="1899810">just</span> <span m="1900000">put</span> <span m="1900140">in</span> <span m="1900230">the</span> <span m="1900300">usual</span> <span m="1900660">escapes</span> <span m="1901190">for</span> <span m="1901310">the</span> <span m="1902430">less</span> <span m="1902860">than</span> <span m="1903160">character</span> <span m="1904065">with</span> <span m="1904440">an</span> <span m="1905010">ampersand.</span> </p>
<p><span m="1907660">STUDENT: So</span> <span m="1908090">given that</span> <span m="1908520">you're</span> <span m="1908761">using</span> <span m="1909002">XHTML,</span> <span m="1909484">couldn't</span> <span m="1909966">you just</span> <span m="1910448">use</span> <span m="1910930">the</span> <span m="1911412">cdata</span> <span m="1911894">[INAUDIBLE]</span> <span m="1912376">instead</span> <span m="1912858">of doing</span> <span m="1913340">manual</span> <span m="1913822">[INAUDIBLE]?</span> </p>
<p><span m="1915760">ADAM CHLIPALA: Probably.</span> <span m="1916566">That</span> <span m="1916970">would</span> <span m="1917190">require</span> <span m="1917450">me</span> <span m="1917710">knowing</span> <span m="1917840">more</span> <span m="1918140">about</span> <span m="1918445">XML</span> <span m="1918750">than I</span> <span m="1918860">do.</span> <span m="1924430">All right,</span> <span m="1924930">so</span> <span m="1925490">there</span> <span m="1925755">was</span> <span m="1925887">another</span> <span m="1926020">question</span> <span m="1926440">about</span> <span m="1926820">JavaScript</span> <span m="1927115">URLs,</span> <span m="1927880">which</span> <span m="1928100">is</span> <span m="1928210">a</span> <span m="1928250">good</span> <span m="1928440">one.</span> <span m="1928740">If</span> <span m="1929350">we</span> <span m="1929470">allow</span> <span m="1929800">JavaScript</span> <span m="1930290">URLs,</span> <span m="1930840">then</span> <span m="1930990">we</span> <span m="1931140">have</span> <span m="1931330">a</span> <span m="1931410">back</span> <span m="1931720">door</span> <span m="1932420">for</span> <span m="1934130">automatic</span> <span m="1934660">interpretation</span> <span m="1934990">of</span> <span m="1935320">strings</span> <span m="1935890">as</span> <span m="1936800">programs</span> <span m="1937250">at</span> <span m="1937310">runtime.</span> <span m="1937790">And</span> <span m="1937880">that</span> <span m="1938130">causes</span> <span m="1938580">all</span> <span m="1938760">sorts</span> <span m="1939040">of</span> <span m="1939130">issues.</span> </p>
<p><span m="1939510">So</span> <span m="1940910">let's</span> <span m="1941180">try to avoid</span> <span m="1941340">that.</span> <span m="1941600">I'll</span> <span m="1941860">switch</span> <span m="1942334">back,</span> <span m="1942808">first of</span> <span m="1943282">all,</span> <span m="1943756">to the</span> <span m="1944230">shorter version</span> <span m="1944704">of this.</span> <span m="1946130">And</span> <span m="1946350">then</span> <span m="1949045">inside</span> <span m="1949680">the</span> <span m="1949770">body,</span> <span m="1951050">I'll</span> <span m="1951490">make</span> <span m="1951930">this</span> <span m="1952290">multiple lines.</span> <span m="1952510">And</span> <span m="1953100">let's</span> <span m="1953310">put</span> <span m="1953450">a</span> <span m="1953500">link</span> <span m="1954676">that</span> <span m="1955070">tries</span> <span m="1955380">to</span> <span m="1955470">do</span> <span m="1955630">something</span> <span m="1956740">appropriate.</span> <span m="1966820">We'll</span> <span m="1967105">leave some room</span> <span m="1967390">for</span> <span m="1967670">error</span> <span m="1967950">messages</span> <span m="1968432">here.</span> <span m="1968914">This is working</span> <span m="1969396">correctly.</span> </p>
<p><span m="1974700">Invalid</span> <span m="1974940">URL,</span> <span m="1975560">JavaScript</span> <span m="1976080">something,</span> <span m="1976620">passed</span> <span m="1977030">bless.</span> <span m="1977350">So</span> <span m="1977670">bless</span> <span m="1978070">is</span> <span m="1978230">a</span> <span m="1978280">built</span> <span m="1978550">in</span> <span m="1978680">function</span> <span m="1979140">that is</span> <span m="1979470">the</span> <span m="1979880">gatekeeper</span> <span m="1980365">of</span> <span m="1980850">which</span> <span m="1981340">URLs</span> <span m="1981660">are allowed.</span> <span m="1982420">And</span> <span m="1982960">by</span> <span m="1983080">default,</span> <span m="1983860">no</span> <span m="1983990">URLs</span> <span m="1984380">are allowed.</span> <span m="1985340">So</span> <span m="1985700">certainly</span> <span m="1986210">this</span> <span m="1986350">one</span> <span m="1986470">is</span> <span m="1986560">not</span> <span m="1986740">allowed.</span> <span m="1988320">And</span> <span m="1988630">in</span> <span m="1988720">general,</span> <span m="1989160">it is</span> <span m="1989320">a</span> <span m="1989370">bad</span> <span m="1989660">idea</span> <span m="1990180">to</span> <span m="1990500">write</span> <span m="1990770">your</span> <span m="1991480">URL</span> <span m="1991880">policy</span> <span m="1992430">so</span> <span m="1992620">that</span> <span m="1993170">you</span> <span m="1993300">can</span> <span m="1993460">create</span> <span m="1994070">values</span> <span m="1995300">that</span> <span m="1995690">represent</span> <span m="1996140">JavaScript</span> <span m="1996600">URLs.</span> <span m="1997010">Because</span> <span m="1997345">then</span> <span m="1997680">all</span> <span m="1997860">sorts</span> <span m="1998120">of</span> <span m="1998260">guarantees</span> <span m="1998650">that you</span> <span m="1998990">might like</span> <span m="1999110">are</span> <span m="1999590">invalid.</span> </p>
<p><span m="2000400">To</span> <span m="2000980">make</span> <span m="2001150">it</span> <span m="2001240">a</span> <span m="2001260">little</span> <span m="2001510">clearer</span> <span m="2002340">how</span> <span m="2002480">it</span> <span m="2002630">works,</span> <span m="2002990">let</span> <span m="2003480">me</span> <span m="2004460">factor</span> <span m="2004780">this</span> <span m="2005010">code</span> <span m="2005620">into</span> <span m="2005890">a</span> <span m="2006080">separate</span> <span m="2006540">function</span> <span m="2008350">called</span> <span m="2010015">a</span> <span m="2010500">linker</span> <span m="2011100">that</span> <span m="2011250">takes</span> <span m="2011510">in</span> <span m="2011980">a</span> <span m="2012040">URL.</span> <span m="2012335">So</span> <span m="2012630">URL</span> <span m="2013070">is</span> <span m="2013160">a</span> <span m="2013250">type.</span> <span m="2013550">It's not just</span> <span m="2013890">string.</span> <span m="2014205">It's a</span> <span m="2014520">type</span> <span m="2015340">that</span> <span m="2015700">stands</span> <span m="2016000">for</span> <span m="2016440">a</span> <span m="2016500">URL</span> <span m="2017050">that</span> <span m="2017170">is</span> <span m="2017310">explicitly</span> <span m="2017830">authorized</span> <span m="2018570">by</span> <span m="2018740">your</span> <span m="2018940">application's</span> <span m="2019540">policy.</span> </p>
<p><span m="2021260">And</span> <span m="2021770">so</span> <span m="2022830">we</span> <span m="2023010">can</span> <span m="2025284">[INAUDIBLE]</span> <span m="2026010">XML.</span> <span m="2027140">And</span> <span m="2028660">instead</span> <span m="2029040">of</span> <span m="2029555">a</span> <span m="2029900">constant,</span> <span m="2030440">I'll</span> <span m="2030710">just</span> <span m="2030980">put</span> <span m="2031170">u</span> <span m="2031890">here.</span> <span m="2032160">And so</span> <span m="2032310">I'm</span> <span m="2032470">using</span> <span m="2032780">the</span> <span m="2033070">curly</span> <span m="2033380">braces</span> <span m="2034430">like</span> <span m="2034600">in</span> <span m="2034700">some</span> <span m="2035690">popular</span> <span m="2037070">HTML</span> <span m="2037580">template</span> <span m="2037960">frameworks</span> <span m="2038470">to</span> <span m="2038550">indicate</span> <span m="2039510">inserting</span> <span m="2040050">some</span> <span m="2040220">code</span> <span m="2040700">from</span> <span m="2041040">the host</span> <span m="2041260">language</span> <span m="2041620">inside</span> <span m="2042170">the</span> <span m="2042330">HTML</span> <span m="2042640">that we're</span> <span m="2042950">building.</span> </p>
<p><span m="2043765">And</span> <span m="2044100">this</span> <span m="2044320">is</span> <span m="2044410">all done</span> <span m="2044640">in</span> <span m="2044800">a</span> <span m="2044860">way</span> <span m="2044990">where</span> <span m="2045180">it's</span> <span m="2045590">type</span> <span m="2045700">checked</span> <span m="2046000">statically.</span> <span m="2046500">So</span> <span m="2046880">the</span> <span m="2046970">system will</span> <span m="2047380">check,</span> <span m="2047700">yeah,</span> <span m="2047960">this is</span> <span m="2048080">a</span> <span m="2048210">spot</span> <span m="2048520">where</span> <span m="2048670">a</span> <span m="2049090">URL</span> <span m="2049449">belongs.</span> <span m="2049739">And</span> <span m="2050030">this</span> <span m="2050120">says</span> <span m="2050400">it is a</span> <span m="2050600">URL.</span> <span m="2051090">So</span> <span m="2051250">that's</span> <span m="2051460">fine.</span> </p>
<p><span m="2053020">And</span> <span m="2053250">then</span> <span m="2053580">I</span> <span m="2053750">can</span> <span m="2054170">explicitly</span> <span m="2054820">expose</span> <span m="2055290">the</span> <span m="2055360">call</span> <span m="2055630">to</span> <span m="2055710">bless</span> <span m="2056350">by</span> <span m="2056600">saying,</span> <span m="2058210">let's</span> <span m="2058580">just</span> <span m="2058929">call</span> <span m="2059254">the</span> <span m="2059580">linker</span> <span m="2059730">function</span> <span m="2060210">here</span> <span m="2061107">on</span> <span m="2061594">the result</span> <span m="2062081">of</span> <span m="2062570">blessing that</span> <span m="2062949">URL.</span> <span m="2068679">We should</span> <span m="2068760">get</span> <span m="2069010">basically</span> <span m="2069320">the</span> <span m="2069400">same</span> <span m="2069889">error message as</span> <span m="2070219">before.</span> <span m="2071300">There's</span> <span m="2071699">some</span> <span m="2072800">program</span> <span m="2073110">analysis</span> <span m="2073540">going</span> <span m="2073750">on</span> <span m="2073889">here</span> <span m="2074130">to</span> <span m="2074480">figure</span> <span m="2074840">out--</span> <span m="2075380">I</span> <span m="2075469">guess</span> <span m="2075719">it</span> <span m="2076260">doesn't</span> <span m="2076469">need that.</span> <span m="2076820">Because</span> <span m="2077540">this string</span> <span m="2077630">is</span> <span m="2078050">passed</span> <span m="2078344">directly</span> <span m="2078639">to</span> <span m="2079090">bless.</span> </p>
<p><span m="2079350">And we can</span> <span m="2079650">see--</span> <span m="2080380">I</span> <span m="2080440">couldn't</span> <span m="2080750">wait</span> <span m="2081080">to</span> <span m="2081199">run</span> <span m="2081420">this</span> <span m="2081600">for</span> <span m="2081699">you</span> <span m="2081850">at</span> <span m="2081909">runtime</span> <span m="2082449">and</span> <span m="2082510">discover</span> <span m="2082880">the</span> <span m="2083000">failure.</span> <span m="2083409">But</span> <span m="2083860">I</span> <span m="2083929">can</span> <span m="2084070">tell</span> <span m="2084260">it's</span> <span m="2084510">definitely</span> <span m="2084820">going</span> <span m="2085000">to</span> <span m="2085040">fail.</span> <span m="2085469">So</span> <span m="2085489">I'll</span> <span m="2085639">just</span> <span m="2085850">make</span> <span m="2086020">it</span> <span m="2086270">a</span> <span m="2086420">compiler</span> <span m="2086790">error.</span> <span m="2086925">This</span> <span m="2087060">URL</span> <span m="2087469">is</span> <span m="2087560">not</span> <span m="2087830">going</span> <span m="2088000">to</span> <span m="2088060">be</span> <span m="2088239">accepted</span> <span m="2088750">by</span> <span m="2088929">the</span> <span m="2089670">URL</span> <span m="2090020">policy.</span> </p>
<p><span m="2090800">STUDENT: So</span> <span m="2091291">if you</span> <span m="2091782">didn't</span> <span m="2091945">have</span> <span m="2092109">the</span> <span m="2092273">[INAUDIBLE]?</span> </p>
<p><span m="2094728">ADAM CHLIPALA: If</span> <span m="2095219">I left</span> <span m="2095710">out</span> <span m="2096210">this call</span> <span m="2096510">to</span> <span m="2096594">bless,</span> <span m="2097039">it</span> <span m="2097400">would</span> <span m="2097570">be a</span> <span m="2097680">much</span> <span m="2098500">more</span> <span m="2098660">basic</span> <span m="2099610">compile</span> <span m="2099795">time</span> <span m="2099980">error.</span> <span m="2100560">You</span> <span m="2100650">have</span> <span m="2100800">a</span> <span m="2100850">string and</span> <span m="2101250">need a</span> <span m="2101470">URL.</span> <span m="2101920">They're</span> <span m="2102050">different</span> <span m="2102330">types.</span> <span m="2106738">All right,</span> <span m="2107240">but</span> <span m="2107920">let's</span> <span m="2108110">make</span> <span m="2108270">this</span> <span m="2108430">a</span> <span m="2108480">little</span> <span m="2108610">more</span> <span m="2108820">interesting.</span> <span m="2109370">And</span> <span m="2109440">I'm</span> <span m="2109510">going</span> <span m="2109650">to</span> <span m="2109760">open</span> <span m="2109960">up</span> <span m="2110080">the</span> <span m="2110170">configuration</span> <span m="2110760">file</span> <span m="2111060">for</span> <span m="2111150">this</span> <span m="2112340">demo.</span> </p>
<p><span m="2112900">It's</span> <span m="2113150">pretty</span> <span m="2114350">short,</span> <span m="2114850">as</span> <span m="2115180">these</span> <span m="2115350">things</span> <span m="2115570">go,</span> <span m="2115820">at</span> <span m="2115910">least</span> <span m="2116380">if you</span> <span m="2116510">look</span> <span m="2116680">at</span> <span m="2117220">any</span> <span m="2117480">Java</span> <span m="2118700">web</span> <span m="2118920">application</span> <span m="2119390">framework.</span> <span m="2119760">They have these</span> <span m="2120180">gigantic</span> <span m="2120800">XML</span> <span m="2121220">files</span> <span m="2121610">for</span> <span m="2121690">configuration.</span> <span m="2122080">This</span> <span m="2122470">is</span> <span m="2122580">a</span> <span m="2122630">little</span> <span m="2123370">nicer</span> <span m="2123640">than</span> <span m="2123780">that,</span> <span m="2124920">or</span> <span m="2125380">so</span> <span m="2125700">I</span> <span m="2126080">claim.</span> </p>
<p><span m="2127000">We can</span> <span m="2127260">add</span> <span m="2127470">a</span> <span m="2127570">rule</span> <span m="2127890">that</span> <span m="2128010">says,</span> <span m="2129570">anything</span> <span m="2129990">on</span> <span m="2130210">Wikipedia</span> <span m="2130990">is</span> <span m="2131230">allowed.</span> <span m="2131950">And</span> <span m="2132406">then we can</span> <span m="2132862">put the</span> <span m="2133320">Wikipedia</span> <span m="2133765">URL</span> <span m="2134210">in</span> <span m="2134500">here.</span> <span m="2141517">Now</span> <span m="2142515">we're</span> <span m="2143014">in</span> <span m="2143513">good</span> <span m="2144012">shape.</span> <span m="2146008">What's</span> <span m="2146507">missing?</span> <span m="2153992">Oh,</span> <span m="2154491">I guess</span> <span m="2155000">I</span> <span m="2155300">don't remember</span> <span m="2155600">the</span> <span m="2156040">URL</span> <span m="2156160">scheme</span> <span m="2156550">for</span> <span m="2156630">that.</span> <span m="2156890">But</span> <span m="2157353">we</span> <span m="2157816">got to the</span> <span m="2158279">website. That's</span> <span m="2158742">good enough.</span> </p>
<p><span m="2161983">All right,</span> <span m="2162450">so</span> <span m="2162700">the</span> <span m="2162790">big</span> <span m="2163000">idea</span> <span m="2163210">here</span> <span m="2163540">is</span> <span m="2163840">to</span> <span m="2163940">have</span> <span m="2164100">an</span> <span m="2164250">abstract</span> <span m="2164910">type</span> <span m="2165470">of</span> <span m="2166180">URL,</span> <span m="2166630">just</span> <span m="2166850">like</span> <span m="2166990">you</span> <span m="2167050">could</span> <span m="2167170">have</span> <span m="2167400">an abstract</span> <span m="2167660">type</span> <span m="2168090">of</span> <span m="2168150">hash</span> <span m="2168400">tables</span> <span m="2168860">that</span> <span m="2169480">encodes</span> <span m="2169940">invariants</span> <span m="2170400">about</span> <span m="2170650">how</span> <span m="2170780">the hash</span> <span m="2171090">table</span> <span m="2171400">looks</span> <span m="2171990">and</span> <span m="2172100">prevents</span> <span m="2172480">code</span> <span m="2172730">from</span> <span m="2172860">reaching</span> <span m="2173160">inside</span> <span m="2173510">the</span> <span m="2173630">array</span> <span m="2173850">of the</span> <span m="2173880">hash</span> <span m="2174290">table.</span> <span m="2175030">We</span> <span m="2175130">can</span> <span m="2175300">do</span> <span m="2175410">the</span> <span m="2175500">same</span> <span m="2175740">thing</span> <span m="2175970">for</span> <span m="2176110">URLs.</span> <span m="2177210">And</span> <span m="2177850">the</span> <span m="2177940">system</span> <span m="2178390">enforces</span> <span m="2178850">via</span> <span m="2179010">this</span> <span m="2179200">bless</span> <span m="2179530">function</span> <span m="2180250">that</span> <span m="2180780">every</span> <span m="2181080">value</span> <span m="2181470">of</span> <span m="2181550">this</span> <span m="2181730">type</span> <span m="2182480">has</span> <span m="2182710">passed</span> <span m="2183190">the</span> <span m="2183280">appropriate</span> <span m="2183950">check</span> <span m="2184250">at</span> <span m="2184380">some</span> <span m="2184530">point.</span> </p>
<p><span m="2184835">And</span> <span m="2185140">for</span> <span m="2185310">instance,</span> <span m="2185580">with</span> <span m="2185850">this</span> <span m="2186030">policy,</span> <span m="2186400">we</span> <span m="2186510">know</span> <span m="2186700">there</span> <span m="2186810">will</span> <span m="2186920">never</span> <span m="2187200">be</span> <span m="2187360">a</span> <span m="2187410">JavaScript</span> <span m="2188100">URL.</span> <span m="2188980">And</span> <span m="2189290">it's</span> <span m="2189680">safe</span> <span m="2189970">to</span> <span m="2191300">take</span> <span m="2191520">a</span> <span m="2191640">URL</span> <span m="2191920">value</span> <span m="2192320">and</span> <span m="2192610">use</span> <span m="2192920">it as</span> <span m="2193060">a</span> <span m="2193130">link.</span> <span m="2193780">It</span> <span m="2193860">won't</span> <span m="2194070">break</span> <span m="2194290">the</span> <span m="2194370">basic</span> <span m="2194780">abstractions</span> <span m="2195470">of the</span> <span m="2195750">language.</span> <span m="2196492">Yeah.</span> </p>
<p><span m="2198070">STUDENT: [INAUDIBLE]?</span> </p>
<p></p>
<p><span m="2209100">ADAM CHLIPALA: OK,</span> <span m="2209450">so</span> <span m="2209770">we have</span> <span m="2210080">to</span> <span m="2210470">try</span> <span m="2210860">something</span> <span m="2211640">like</span> <span m="2211820">that.</span> <span m="2212060">And this</span> <span m="2212500">should</span> <span m="2213035">go</span> <span m="2213360">through.</span> <span m="2214310">And</span> <span m="2214460">then</span> <span m="2217100">the</span> <span m="2217550">browser</span> <span m="2217970">knows it's a</span> <span m="2218130">quote.</span> <span m="2218982">And</span> <span m="2219410">we can</span> <span m="2219850">look at the</span> <span m="2220030">source.</span> <span m="2221000">That</span> <span m="2221320">is</span> <span m="2221560">because</span> <span m="2221910">it</span> <span m="2222040">was</span> <span m="2223210">escaped</span> <span m="2223510">in the</span> <span m="2223810">right way.</span> </p>
<p><span m="2225010">STUDENT: But</span> <span m="2225140">can</span> <span m="2225420">you still</span> <span m="2225740">use--</span> <span m="2226030">so</span> <span m="2226320">JavaScript</span> <span m="2226730">allows</span> <span m="2227208">you to</span> <span m="2227686">say,</span> <span m="2228642">[INAUDIBLE],</span> <span m="2229598">and</span> <span m="2230076">then specify</span> <span m="2230554">inline</span> <span m="2231032">JavaScript</span> <span m="2231510">there.</span> <span m="2231988">Is that</span> <span m="2232466">something that</span> <span m="2232944">[INAUDIBLE]?</span> </p>
<p><span m="2234870">ADAM CHLIPALA: Yes</span> <span m="2235000">and</span> <span m="2235270">no.</span> <span m="2236580">So</span> <span m="2236930">we can</span> <span m="2237170">put</span> <span m="2238320">body</span> <span m="2238490">onload.</span> <span m="2238780">And</span> <span m="2239050">instead</span> <span m="2239320">of</span> <span m="2239430">JavaScript,</span> <span m="2239790">you</span> <span m="2240150">put some</span> <span m="2240730">Ur/Web</span> <span m="2241300">code</span> <span m="2241781">that does</span> <span m="2242262">something.</span> <span m="2249490">So</span> <span m="2251140">it would</span> <span m="2251290">be a</span> <span m="2251430">disaster</span> <span m="2251940">to</span> <span m="2252040">interpret</span> <span m="2252490">JavaScript</span> <span m="2252990">code</span> <span m="2253695">in</span> <span m="2254010">string</span> <span m="2254360">form</span> <span m="2254640">as a</span> <span m="2254920">program</span> <span m="2255340">there.</span> </p>
<p><span m="2255650">But</span> <span m="2255830">we</span> <span m="2255900">can</span> <span m="2256040">put</span> <span m="2256250">code of</span> <span m="2256510">the</span> <span m="2256630">same</span> <span m="2256840">programming</span> <span m="2257210">language</span> <span m="2257540">you're</span> <span m="2257590">working</span> <span m="2257880">with</span> <span m="2258030">already</span> <span m="2258920">escaped</span> <span m="2259360">in</span> <span m="2259600">with</span> <span m="2259920">these</span> <span m="2260080">curly</span> <span m="2260490">braces.</span> <span m="2261090">And</span> <span m="2261250">then</span> <span m="2261400">it</span> <span m="2261500">automatically</span> <span m="2261980">gets</span> <span m="2262210">compiled</span> <span m="2262710">to</span> <span m="2262800">JavaScript</span> <span m="2263360">to</span> <span m="2263600">run</span> <span m="2263850">on the</span> <span m="2264346">client.</span> <span m="2272778">All</span> <span m="2273274">right,</span> <span m="2273770">any</span> <span m="2274018">more</span> <span m="2274266">questions?</span> <span m="2274762">Yeah.</span> </p>
<p><span m="2275754">STUDENT: [INAUDIBLE]?</span> </p>
<p></p>
<p><span m="2284499">ADAM CHLIPALA: I</span> <span m="2284998">think</span> <span m="2285497">it's</span> <span m="2287992">everything?</span> <span m="2289490">Is</span> <span m="2289920">it</span> <span m="2291230">embarrassing</span> <span m="2291495">that</span> <span m="2291760">I said</span> <span m="2292120">everything?</span> <span m="2292560">Is there</span> <span m="2292760">something</span> <span m="2292990">that</span> <span m="2293130">shouldn't</span> <span m="2293320">be</span> <span m="2293420">allowed?</span> </p>
<p><span m="2296312">STUDENT: [INAUDIBLE].</span> </p>
<p></p>
<p><span m="2305480">ADAM CHLIPALA: I</span> <span m="2305600">see,</span> <span m="2305810">so</span> <span m="2305950">symbols</span> <span m="2306360">that</span> <span m="2306610">would</span> <span m="2307020">independently</span> <span m="2307340">have</span> <span m="2307840">funny</span> <span m="2308230">things</span> <span m="2308480">happening</span> <span m="2308790">with</span> <span m="2309020">software</span> <span m="2309420">execution</span> <span m="2309960">would</span> <span m="2310340">confuse</span> <span m="2310940">the</span> <span m="2311210">human</span> <span m="2311540">user?</span> </p>
<p><span m="2312816">STUDENT: [INAUDIBLE].</span> </p>
<p><span m="2316600">ADAM CHLIPALA: OK,</span> <span m="2317550">I</span> <span m="2317670">remember</span> <span m="2317930">reading</span> <span m="2318230">some</span> <span m="2318420">of</span> <span m="2318460">that</span> <span m="2318640">stuff.</span> <span m="2319070">And</span> <span m="2320040">maybe</span> <span m="2320250">it</span> <span m="2320390">said</span> <span m="2321080">the</span> <span m="2321170">new</span> <span m="2321350">browser</span> <span m="2321710">versions</span> <span m="2322090">avoid</span> <span m="2322370">those</span> <span m="2322530">problems.</span> <span m="2322990">But</span> <span m="2323280">some</span> <span m="2323630">old ones</span> <span m="2324010">will</span> <span m="2324190">get</span> <span m="2324370">confused.</span> <span m="2325820">It's</span> <span m="2325890">possible</span> <span m="2326480">this</span> <span m="2326610">will</span> <span m="2326750">create</span> <span m="2326960">problems</span> <span m="2327330">in</span> <span m="2327430">the old</span> <span m="2327690">ones</span> <span m="2327960">that</span> <span m="2329540">are</span> <span m="2329920">too</span> <span m="2330110">permissive.</span> <span m="2330690">I'm</span> <span m="2331175">not sure.</span> </p>
<p><span m="2335540">But</span> <span m="2335570">at</span> <span m="2335690">least</span> <span m="2337030">all</span> <span m="2337230">these</span> <span m="2337490">things</span> <span m="2337700">are</span> <span m="2337750">going</span> <span m="2337890">to</span> <span m="2337930">be</span> <span m="2338020">interpreted</span> <span m="2338460">as</span> <span m="2338580">UTF-8</span> <span m="2338960">if</span> <span m="2339290">they</span> <span m="2339360">go</span> <span m="2339550">into the</span> <span m="2339710">document.</span> <span m="2340435">So</span> <span m="2340710">if</span> <span m="2341040">there's</span> <span m="2341160">some</span> <span m="2341410">problem</span> <span m="2341690">with a</span> <span m="2341860">different</span> <span m="2342025">encoding,</span> <span m="2342520">it</span> <span m="2342940">shouldn't</span> <span m="2343360">be applicable</span> <span m="2343520">here.</span> <span m="2346445">Yeah.</span> </p>
<p><span m="2346944">STUDENT: The</span> <span m="2347443">string</span> <span m="2347609">of</span> <span m="2347775">the</span> <span m="2347942">[INAUDIBLE],</span> <span m="2348940">right</span> <span m="2349439">now</span> <span m="2349938">it's</span> <span m="2350437">checking a compile</span> <span m="2350936">time</span> <span m="2351185">that</span> <span m="2351435">that</span> <span m="2351559">string</span> <span m="2351684">is</span> <span m="2351809">on</span> <span m="2351934">allowed</span> <span m="2352433">URL.</span> <span m="2353440">But</span> <span m="2353770">if</span> <span m="2354270">you</span> <span m="2354460">compute a</span> <span m="2354770">string</span> <span m="2355182">at</span> <span m="2355594">runtime,</span> <span m="2356006">does</span> <span m="2356830">bless</span> <span m="2357380">perform</span> <span m="2357610">a check</span> <span m="2358108">at</span> <span m="2358606">runtime</span> <span m="2359104">whether or not the</span> <span m="2359602">string is</span> <span m="2360100">allowed,</span> <span m="2360598">or are</span> <span m="2361096">you not</span> <span m="2361594">allowed</span> <span m="2362092">to--</span> </p>
<p><span m="2362590">ADAM CHLIPALA: So</span> <span m="2363088">let's a</span> <span m="2363586">write</span> <span m="2363835">a</span> <span m="2364084">form</span> <span m="2364582">to test that</span> <span m="2365080">claim.</span> <span m="2371056">So</span> <span m="2371305">we can</span> <span m="2371554">put a form</span> <span m="2372052">in here.</span> <span m="2378028">And</span> <span m="2378526">form wants us</span> <span m="2379024">to enter</span> <span m="2379522">URL</span> <span m="2380020">in a</span> <span m="2380518">text box</span> <span m="2381514">called</span> <span m="2382012">URL.</span> <span m="2385498">Then</span> <span m="2385996">we can have a</span> <span m="2386494">Submit</span> <span m="2386992">button.</span> </p>
<p><span m="2388520">When</span> <span m="2388770">you</span> <span m="2388830">click</span> <span m="2389080">on</span> <span m="2389250">it,</span> <span m="2389670">it</span> <span m="2389740">should</span> <span m="2390140">call</span> <span m="2390700">the</span> <span m="2390910">linker</span> <span m="2391250">function</span> <span m="2392090">with</span> <span m="2392390">a</span> <span m="2392550">record</span> <span m="2392980">of</span> <span m="2393120">one</span> <span m="2393400">value</span> <span m="2394090">for every</span> <span m="2394240">field in the</span> <span m="2394640">form.</span> <span m="2395480">In</span> <span m="2395540">this</span> <span m="2395730">case,</span> <span m="2396070">there's</span> <span m="2396200">just</span> <span m="2396370">one</span> <span m="2396550">field</span> <span m="2396830">called</span> <span m="2397020">URL.</span> <span m="2397990">And</span> <span m="2398240">so</span> <span m="2398640">linker</span> <span m="2398830">will</span> <span m="2399080">get</span> <span m="2399260">passed</span> <span m="2399610">a</span> <span m="2399670">record</span> <span m="2400030">that</span> <span m="2400170">contains</span> <span m="2400710">the</span> <span m="2400790">URL</span> <span m="2401230">as a</span> <span m="2401680">string</span> <span m="2402050">type.</span> <span m="2402430">And then we'll</span> <span m="2402810">explicitly</span> <span m="2403420">try</span> <span m="2403610">to</span> <span m="2403730">bless</span> <span m="2404130">it</span> <span m="2404370">up there</span> <span m="2405250">and</span> <span m="2405340">see</span> <span m="2405550">if</span> <span m="2405660">it</span> <span m="2405710">works.</span> </p>
<p><span m="2416150">This is</span> <span m="2416220">an</span> <span m="2416390">example</span> <span m="2416725">of an</span> <span m="2417060">exciting</span> <span m="2417540">type</span> <span m="2417830">error</span> <span m="2417990">message,</span> <span m="2418480">which</span> <span m="2418570">is</span> <span m="2418990">admittedly</span> <span m="2419370">sub-optimal</span> <span m="2419890">in</span> <span m="2420130">some</span> <span m="2420390">ways.</span> <span m="2427660">Here's</span> <span m="2427830">one of</span> <span m="2427990">those</span> <span m="2428160">things</span> <span m="2428370">that won't</span> <span m="2428670">make</span> <span m="2428890">any</span> <span m="2429040">sense</span> <span m="2429510">if</span> <span m="2429650">you're</span> <span m="2429830">not</span> <span m="2430040">familiar</span> <span m="2430280">with</span> <span m="2430370">Haskell.</span> <span m="2430760">I forgot</span> <span m="2431230">a</span> <span m="2431450">return.</span> <span m="2432670">But</span> <span m="2432970">at</span> <span m="2433340">least</span> <span m="2433620">now it</span> <span m="2433820">looks</span> <span m="2434010">more</span> <span m="2434150">like</span> <span m="2434410">a</span> <span m="2434600">Java</span> <span m="2434860">program.</span> <span m="2439342">Have</span> <span m="2439826">a string--</span> <span m="2441278">let</span> <span m="2441762">me scroll</span> <span m="2442246">to the</span> <span m="2442730">end,</span> <span m="2442870">do one</span> <span m="2442940">of</span> <span m="2443290">these,</span> <span m="2443770">sort</span> <span m="2443890">of</span> <span m="2443990">copying</span> <span m="2444370">the</span> <span m="2444450">full</span> <span m="2444660">type</span> <span m="2445510">of</span> <span m="2445670">all the</span> <span m="2445890">attributes</span> <span m="2446370">that</span> <span m="2446450">this</span> <span m="2446590">tag can</span> <span m="2446940">take.</span> </p>
<p><span m="2447775">And</span> <span m="2448260">I</span> <span m="2448420">also</span> <span m="2448610">forgot</span> <span m="2448980">to</span> <span m="2449030">say,</span> <span m="2449290">this</span> <span m="2449730">is</span> <span m="2449960">now a</span> <span m="2450170">full</span> <span m="2450470">page.</span> <span m="2450790">So</span> <span m="2450970">we</span> <span m="2451250">can't</span> <span m="2451510">use</span> <span m="2451800">an</span> <span m="2451900">a</span> <span m="2452000">tag</span> <span m="2452270">until</span> <span m="2452520">we're</span> <span m="2452660">inside</span> <span m="2452930">a</span> <span m="2452980">body</span> <span m="2453290">tag.</span> <span m="2454880">And</span> <span m="2455200">this</span> <span m="2455360">is</span> <span m="2455500">the</span> <span m="2455790">abstruse</span> <span m="2456340">type</span> <span m="2456530">error message</span> <span m="2456950">for</span> <span m="2457080">that</span> <span m="2457260">property.</span> <span m="2461800">OK,</span> <span m="2462030">so</span> <span m="2462250">now</span> <span m="2462500">let's see what</span> <span m="2462971">happens.</span> <span m="2465330">URL</span> <span m="2465780">is--</span> <span m="2472745">yay.</span> <span m="2483830">There</span> <span m="2484319">we</span> <span m="2484808">go.</span> <span m="2487253">So</span> <span m="2487760">that</span> <span m="2487850">was</span> <span m="2488455">a</span> <span m="2488840">somewhat</span> <span m="2489120">long</span> <span m="2489450">and</span> <span m="2489670">not</span> <span m="2489840">necessarily</span> <span m="2490640">super</span> <span m="2490950">exciting</span> <span m="2491320">answer</span> <span m="2491490">to your</span> <span m="2491690">question.</span> <span m="2492180">Yeah.</span> </p>
<p><span m="2492650">STUDENT: The</span> <span m="2492850">URL</span> <span m="2494191">[INAUDIBLE],</span> <span m="2495093">are</span> <span m="2495544">those</span> <span m="2495995">just for</span> <span m="2496446">[INAUDIBLE],</span> <span m="2496897">or is it more restrictive than</span> <span m="2497348">that?</span> </p>
<p><span m="2498250">ADAM CHLIPALA: It's</span> <span m="2498650">more</span> <span m="2498900">restrictive.</span> <span m="2499380">It's</span> <span m="2499840">currently</span> <span m="2500150">just</span> <span m="2500360">constants</span> <span m="2500630">and</span> <span m="2500900">prefixes.</span> <span m="2502155">But</span> <span m="2502610">you</span> <span m="2502770">can</span> <span m="2502890">also</span> <span m="2503170">have</span> <span m="2503900">disallow</span> <span m="2504120">rules.</span> <span m="2504575">And</span> <span m="2505030">they</span> <span m="2505150">run</span> <span m="2505470">in the</span> <span m="2505610">order</span> <span m="2505950">that you write.</span> </p>
<p><span m="2506450">STUDENT: Oh,</span> <span m="2506944">so</span> <span m="2507438">if you</span> <span m="2507932">stick to</span> <span m="2508426">disallow</span> <span m="2508920">JavaScript</span> <span m="2510402">[INAUDIBLE]</span> <span m="2512378">that</span> <span m="2512872">if you</span> <span m="2513366">put</span> <span m="2513448">a</span> <span m="2513530">line</span> <span m="2513613">break</span> <span m="2513695">in</span> <span m="2513777">the</span> <span m="2513860">middle of the</span> <span m="2514354">word</span> <span m="2514601">"JavaScript,"</span> <span m="2514848">it</span> <span m="2515342">will still</span> <span m="2515836">interpret</span> <span m="2516330">it as--</span> </p>
<p><span m="2517812">ADAM CHLIPALA: That</span> <span m="2518310">would be</span> <span m="2518660">too bad.</span> <span m="2520150">That's</span> <span m="2520640">why it's</span> <span m="2520890">good</span> <span m="2521020">to</span> <span m="2521080">stick</span> <span m="2521270">to</span> <span m="2521420">the white list approach</span> <span m="2521590">instead of the</span> <span m="2522057">black</span> <span m="2522524">list approach.</span> <span m="2522991">So</span> <span m="2523780">you</span> <span m="2523960">probably</span> <span m="2524240">want</span> <span m="2524440">all</span> <span m="2524590">the</span> <span m="2524720">rules</span> <span m="2525020">to</span> <span m="2525520">start</span> <span m="2525900">with</span> <span m="2526720">a</span> <span m="2527120">particular</span> <span m="2527520">protocol,</span> <span m="2527920">like</span> <span m="2528610">HTTP,</span> <span m="2530020">and only</span> <span m="2530390">allow</span> <span m="2530755">things</span> <span m="2531120">that</span> <span m="2531400">fall</span> <span m="2531700">in</span> <span m="2531810">your</span> <span m="2533264">approved set of</span> <span m="2533746">protocols.</span> <span m="2535192">That's what I</span> <span m="2535674">recommend</span> <span m="2536156">it is.</span> <span m="2538084">Yeah.</span> </p>
<p><span m="2538566">STUDENT: For</span> <span m="2539048">many sites,</span> <span m="2539530">you might</span> <span m="2540012">let users share links,</span> <span m="2540494">in which case,</span> <span m="2540976">you need</span> <span m="2541458">to</span> <span m="2541940">allow links to anywhere.</span> </p>
<p><span m="2544370">ADAM CHLIPALA: You</span> <span m="2544490">can</span> <span m="2544750">allow</span> <span m="2545045">links.</span> <span m="2545192">Well,</span> <span m="2545340">do you</span> <span m="2545430">want</span> <span m="2545620">your</span> <span m="2545850">users to</span> <span m="2546140">share</span> <span m="2546360">JavaScript</span> <span m="2546890">links</span> <span m="2547270">or,</span> <span m="2547530">I don't know,</span> <span m="2547930">Flash</span> <span m="2548370">links, or whatever's</span> <span m="2548710">allowed?</span> <span m="2549890">You</span> <span m="2549970">see,</span> <span m="2550170">you</span> <span m="2550580">can</span> <span m="2550780">white</span> <span m="2550980">list</span> <span m="2551160">all</span> <span m="2551380">the</span> <span m="2551490">HTTP,</span> <span m="2553580">HTTPS,</span> <span m="2554180">URLs</span> <span m="2554990">and</span> <span m="2555360">be</span> <span m="2555480">in</span> <span m="2555560">good</span> <span m="2555730">shape</span> <span m="2556430">for</span> <span m="2556830">most</span> <span m="2557105">websites.</span> <span m="2557705">That</span> <span m="2558030">would do</span> <span m="2558350">that.</span> <span m="2559200">And</span> <span m="2560640">the</span> <span m="2560770">guarantees</span> <span m="2561230">are</span> <span m="2561270">a</span> <span m="2561310">little</span> <span m="2561510">weaker</span> <span m="2562630">compared to</span> <span m="2563270">allowing</span> <span m="2563750">only</span> <span m="2563810">particular</span> <span m="2564170">URLs.</span> <span m="2564460">But</span> <span m="2564750">you</span> <span m="2565030">can</span> <span m="2565120">at least</span> <span m="2565440">ensure</span> <span m="2565830">that</span> <span m="2565940">there's</span> <span m="2566245">no</span> <span m="2566550">automatic</span> <span m="2566930">execution</span> <span m="2567408">of</span> <span m="2567647">the</span> <span m="2567886">string</span> <span m="2568364">as a program.</span> </p>
<p><span m="2574590">So</span> <span m="2574800">let</span> <span m="2575140">me</span> <span m="2575450">pull up</span> <span m="2575750">one of</span> <span m="2576050">the</span> <span m="2576480">examples</span> <span m="2577580">from</span> <span m="2577830">the</span> <span m="2578500">paper,</span> <span m="2579180">which</span> <span m="2579664">is</span> <span m="2586440">this</span> <span m="2586924">one,</span> <span m="2587900">an</span> <span m="2588250">example</span> <span m="2589080">of</span> <span m="2589430">a</span> <span m="2589650">simple</span> <span m="2590240">system</span> <span m="2590600">with</span> <span m="2590770">a set of</span> <span m="2590990">chat</span> <span m="2591280">rooms</span> <span m="2591790">represented</span> <span m="2592260">in the</span> <span m="2592460">database.</span> <span m="2593600">And</span> <span m="2594040">the</span> <span m="2594480">user can click</span> <span m="2594920">on a</span> <span m="2595130">link</span> <span m="2595430">to</span> <span m="2595500">go</span> <span m="2595610">to a</span> <span m="2595880">room</span> <span m="2596110">and</span> <span m="2596190">then</span> <span m="2596360">send</span> <span m="2596590">a</span> <span m="2596620">message.</span> <span m="2597360">This</span> <span m="2597490">was</span> <span m="2597610">the</span> <span m="2597710">first of</span> <span m="2598120">several</span> <span m="2598540">variants</span> <span m="2599030">on</span> <span m="2599150">that</span> <span m="2599800">scheme.</span> </p>
<p><span m="2602640">First,</span> <span m="2602985">I'll</span> <span m="2603330">point</span> <span m="2603610">out I'm</span> <span m="2603830">going to</span> <span m="2604240">recompile</span> <span m="2604640">this.</span> <span m="2605040">And</span> <span m="2605270">then</span> <span m="2606170">magically,</span> <span m="2606660">all</span> <span m="2606890">the</span> <span m="2606970">database</span> <span m="2607420">tables</span> <span m="2607770">that</span> <span m="2607930">it</span> <span m="2608010">declares</span> <span m="2608480">are</span> <span m="2608600">going to be</span> <span m="2609080">added</span> <span m="2609240">to</span> <span m="2609400">the</span> <span m="2609560">database.</span> <span m="2610410">And</span> <span m="2610844">we can</span> <span m="2611278">now</span> <span m="2611712">just</span> <span m="2612146">start using the</span> <span m="2612580">application.</span> <span m="2613014">But</span> <span m="2613450">first,</span> <span m="2613860">we</span> <span m="2614130">have to add</span> <span m="2614340">some</span> <span m="2614740">rooms.</span> </p>
<p><span m="2615010">So</span> <span m="2615280">let's</span> <span m="2615520">open our</span> <span m="2616380">[INAUDIBLE]</span> <span m="2617450">interface</span> <span m="2617795">to the</span> <span m="2618140">demo</span> <span m="2618470">database</span> <span m="2619160">and</span> <span m="2619510">insert</span> <span m="2619920">into</span> <span m="2620840">the</span> <span m="2621115">room</span> <span m="2621390">table</span> <span m="2621755">some</span> <span m="2622120">values</span> <span m="2622480">like</span> <span m="2622958">one</span> <span m="2624870">and</span> <span m="2625826">two.</span> <span m="2628216">Hopefully</span> <span m="2628694">these are here</span> <span m="2629172">now.</span> <span m="2631100">OK,</span> <span m="2631560">and we</span> <span m="2632020">go in there,</span> <span m="2632430">and</span> <span m="2632820">we can</span> <span m="2633210">entertain</span> <span m="2633600">ourselves</span> <span m="2633870">all</span> <span m="2634090">day</span> <span m="2634250">long</span> <span m="2635720">sending</span> <span m="2635890">strings</span> <span m="2636320">of</span> <span m="2636430">text.</span> <span m="2637930">Maybe</span> <span m="2638315">a</span> <span m="2638700">little</span> <span m="2638840">more</span> <span m="2639030">interesting,</span> <span m="2643290">you</span> <span m="2643760">can</span> <span m="2644230">try to</span> <span m="2644700">send</span> <span m="2645420">HTML,</span> <span m="2645983">and it</span> <span m="2646356">just</span> <span m="2646730">gets</span> <span m="2647260">handled</span> <span m="2647383">right</span> <span m="2647506">away.</span> <span m="2649634">That's</span> <span m="2650050">the</span> <span m="2650470">basic</span> <span m="2650890">functionality</span> <span m="2651120">there.</span> </p>
<p><span m="2652040">And</span> <span m="2652340">just</span> <span m="2652640">to</span> <span m="2652800">quickly</span> <span m="2653360">go</span> <span m="2653520">over</span> <span m="2653680">some</span> <span m="2653890">of</span> <span m="2654080">how</span> <span m="2654270">this</span> <span m="2654420">works</span> <span m="2654730">again,</span> <span m="2655870">so</span> <span m="2656020">we</span> <span m="2656120">have</span> <span m="2656260">these</span> <span m="2656440">two</span> <span m="2656660">SQL</span> <span m="2657160">table</span> <span m="2657530">that are</span> <span m="2657720">just</span> <span m="2657940">declared</span> <span m="2659070">in</span> <span m="2659230">this</span> <span m="2659400">first</span> <span m="2659670">class</span> <span m="2659920">way</span> <span m="2660120">inside the</span> <span m="2660550">programming</span> <span m="2660960">language.</span> <span m="2661370">And</span> <span m="2661800">we give</span> <span m="2662030">the</span> <span m="2662260">schema</span> <span m="2662565">of each</span> <span m="2662870">table.</span> <span m="2663125">And</span> <span m="2663380">then</span> <span m="2663550">later,</span> <span m="2663850">when we</span> <span m="2664290">try</span> <span m="2664560">to</span> <span m="2664750">access</span> <span m="2665160">those</span> <span m="2665350">tables,</span> <span m="2665720">the</span> <span m="2666065">compiler will</span> <span m="2666410">check</span> <span m="2666680">that</span> <span m="2667090">we're</span> <span m="2667280">accessing</span> <span m="2667830">them</span> <span m="2667990">in</span> <span m="2668050">a</span> <span m="2668110">way</span> <span m="2668260">that's</span> <span m="2668460">consistent</span> <span m="2668795">with the</span> <span m="2669130">schema</span> <span m="2669590">from</span> <span m="2669753">a</span> <span m="2669916">typing</span> <span m="2670080">perspective.</span> </p>
<p><span m="2671550">So</span> <span m="2671650">we have</span> <span m="2671790">a</span> <span m="2671850">table</span> <span m="2672210">of</span> <span m="2672400">rooms</span> <span m="2673210">where</span> <span m="2673380">each</span> <span m="2673560">room</span> <span m="2673970">is</span> <span m="2674420">a</span> <span m="2674440">record</span> <span m="2674800">of</span> <span m="2675630">an</span> <span m="2676360">ID,</span> <span m="2676690">which is</span> <span m="2677020">the</span> <span m="2677280">integer,</span> <span m="2677520">and a</span> <span m="2677790">title,</span> <span m="2678270">which</span> <span m="2678403">is</span> <span m="2678536">the</span> <span m="2678670">string.</span> <span m="2679720">This</span> <span m="2679860">is</span> <span m="2679960">the</span> <span m="2680060">type</span> <span m="2680340">we were</span> <span m="2680480">just</span> <span m="2680890">generating</span> <span m="2681360">records</span> <span m="2681880">in.</span> <span m="2682540">And</span> <span m="2682960">I</span> <span m="2683580">created</span> <span m="2684020">a</span> <span m="2684060">few</span> <span m="2684270">rooms</span> <span m="2684610">at</span> <span m="2684770">the</span> <span m="2685260">SQL</span> <span m="2685690">console.</span> <span m="2687000">And</span> <span m="2687440">we</span> <span m="2687570">also have</span> <span m="2687880">messages</span> <span m="2688990">that</span> <span m="2689570">each</span> <span m="2689780">message</span> <span m="2691580">belongs</span> <span m="2692050">to</span> <span m="2692250">a</span> <span m="2692310">room.</span> <span m="2692730">And it has a</span> <span m="2693230">time</span> <span m="2693650">when it</span> <span m="2693940">was</span> <span m="2694160">posted.</span> <span m="2694990">And</span> <span m="2695220">it</span> <span m="2695310">has</span> <span m="2696220">some</span> <span m="2696400">text,</span> <span m="2696690">which is</span> <span m="2697015">the</span> <span m="2697340">content of the</span> <span m="2697510">message.</span> </p>
<p><span m="2699210">And</span> <span m="2700163">let</span> <span m="2700586">me</span> <span m="2701010">fast</span> <span m="2701290">forward</span> <span m="2701530">to the</span> <span m="2702060">main</span> <span m="2702390">function.</span> <span m="2703520">We</span> <span m="2703830">run</span> <span m="2704040">an</span> <span m="2704280">SQL</span> <span m="2704680">query.</span> <span m="2706092">So</span> <span m="2706470">here's</span> <span m="2706500">an</span> <span m="2706530">example</span> <span m="2706920">of</span> <span m="2707060">SQL</span> <span m="2707460">syntax</span> <span m="2707880">embedded</span> <span m="2708300">inside</span> <span m="2708610">of</span> <span m="2708820">Ur/Web.</span> <span m="2709130">I</span> <span m="2709490">don't</span> <span m="2709670">want</span> <span m="2709850">to</span> <span m="2709910">go</span> <span m="2710080">through</span> <span m="2710280">the</span> <span m="2710460">expansion</span> <span m="2710880">of</span> <span m="2711000">this</span> <span m="2711190">one</span> <span m="2711410">into</span> <span m="2711580">calling</span> <span m="2711880">functions</span> <span m="2712150">from the</span> <span m="2712420">standard</span> <span m="2712780">library.</span> <span m="2713790">Because</span> <span m="2714100">it's</span> <span m="2715410">pretty</span> <span m="2716210">verbose</span> <span m="2716700">if</span> <span m="2716810">I</span> <span m="2716880">do</span> <span m="2717130">that.</span> <span m="2717370">But</span> <span m="2717560">take</span> <span m="2717700">my</span> <span m="2717780">word</span> <span m="2718050">for</span> <span m="2718220">it,</span> <span m="2718335">this</span> <span m="2718450">is</span> <span m="2718620">de-sugared</span> <span m="2718720">into</span> <span m="2719330">calls</span> <span m="2719710">of</span> <span m="2720320">functions</span> <span m="2720660">in</span> <span m="2720740">the</span> <span m="2720830">standard</span> <span m="2721170">library</span> <span m="2721480">that</span> <span m="2721790">represent</span> <span m="2722550">the</span> <span m="2722640">valid</span> <span m="2723040">ways</span> <span m="2723410">of</span> <span m="2723510">constructing</span> <span m="2724250">an</span> <span m="2724390">SQL</span> <span m="2724510">query.</span> </p>
<p><span m="2725720">And</span> <span m="2725970">those</span> <span m="2726140">functions</span> <span m="2726520">have</span> <span m="2726730">types</span> <span m="2727410">that</span> <span m="2727630">cause</span> <span m="2727880">them</span> <span m="2728100">to</span> <span m="2728300">type</span> <span m="2728530">check</span> <span m="2728715">the</span> <span m="2728900">query</span> <span m="2729220">for</span> <span m="2729440">you,</span> <span m="2729580">not</span> <span m="2729810">just</span> <span m="2730090">guarantee</span> <span m="2730620">that</span> <span m="2730790">the</span> <span m="2730870">syntax</span> <span m="2731030">is</span> <span m="2731488">reasonable.</span> <span m="2733320">So</span> <span m="2733770">this</span> <span m="2733890">gets</span> <span m="2734030">de-sugared</span> <span m="2734510">into</span> <span m="2734970">an</span> <span m="2735070">indication</span> <span m="2735540">of</span> <span m="2735650">an SQL</span> <span m="2736150">query.</span> <span m="2736630">And</span> <span m="2736810">then</span> <span m="2737270">the</span> <span m="2737380">code</span> <span m="2737630">here</span> <span m="2737860">is</span> <span m="2737980">basically</span> <span m="2738210">just</span> <span m="2738320">looping</span> <span m="2738780">over</span> <span m="2739490">all</span> <span m="2740120">the</span> <span m="2740570">rows</span> <span m="2740980">that</span> <span m="2741090">come</span> <span m="2741300">out</span> <span m="2741410">of</span> <span m="2741460">that</span> <span m="2741690">query</span> <span m="2741910">and</span> <span m="2742130">generating a</span> <span m="2742620">piece</span> <span m="2742860">of</span> <span m="2743480">HTML</span> <span m="2743590">for</span> <span m="2744170">each</span> <span m="2744300">one.</span> </p>
<p><span m="2744580">In</span> <span m="2744990">particular,</span> <span m="2745330">we're</span> <span m="2745670">going to</span> <span m="2746090">take</span> <span m="2746360">the</span> <span m="2746480">title</span> <span m="2746950">field</span> <span m="2748070">of</span> <span m="2748510">a</span> <span m="2748930">query</span> <span m="2749190">result</span> <span m="2750050">and</span> <span m="2752000">convert</span> <span m="2752315">that into</span> <span m="2752630">HTML</span> <span m="2753005">with</span> <span m="2753940">this</span> <span m="2754450">notation</span> <span m="2754670">that</span> <span m="2754890">involves</span> <span m="2755280">curly</span> <span m="2755670">braces.</span> <span m="2757000">And</span> <span m="2757220">the</span> <span m="2757800">square</span> <span m="2758050">brackets</span> <span m="2758450">are additionally</span> <span m="2759030">saying,</span> <span m="2759310">this</span> <span m="2759480">isn't</span> <span m="2759790">literally</span> <span m="2760290">a</span> <span m="2760310">piece</span> <span m="2760590">of</span> <span m="2760710">HTML</span> <span m="2761440">yet.</span> <span m="2761900">But</span> <span m="2762100">please</span> <span m="2762430">convert</span> <span m="2762860">it</span> <span m="2763010">for</span> <span m="2763200">me</span> <span m="2763380">in the</span> <span m="2763550">standard</span> <span m="2763910">way.</span> <span m="2764455">So we can</span> <span m="2764840">do</span> <span m="2765220">that with</span> <span m="2765670">strings</span> <span m="2765910">and</span> <span m="2766400">integers and</span> <span m="2766490">all</span> <span m="2766580">sorts of</span> <span m="2766875">other</span> <span m="2767170">types.</span> <span m="2767862">Yeah.</span> </p>
<p><span m="2768677">STUDENT: So</span> <span m="2769144">if that</span> <span m="2769611">contained</span> <span m="2770078">malicious</span> <span m="2770545">HTML</span> <span m="2771012">or something,</span> <span m="2771479">would</span> <span m="2771950">that be</span> <span m="2772010">filtered</span> <span m="2772320">out?</span> </p>
<p><span m="2775220">ADAM CHLIPALA: It</span> <span m="2775580">would</span> <span m="2775940">be.</span> <span m="2776410">So</span> <span m="2776660">in the</span> <span m="2776910">usual</span> <span m="2777315">way</span> <span m="2777720">of</span> <span m="2777920">talking</span> <span m="2778160">about</span> <span m="2778340">these</span> <span m="2778540">things,</span> <span m="2779030">escaping</span> <span m="2779750">happens</span> <span m="2780160">in the way</span> <span m="2780340">you'd</span> <span m="2780460">want</span> <span m="2780770">it to.</span> <span m="2781186">In</span> <span m="2781602">Ur/Web,</span> <span m="2782260">you</span> <span m="2782300">can</span> <span m="2782340">just</span> <span m="2782380">think</span> <span m="2782420">of</span> <span m="2782500">this</span> <span m="2782760">as</span> <span m="2783000">building</span> <span m="2783280">a</span> <span m="2783585">tree.</span> <span m="2784640">This</span> <span m="2784800">is</span> <span m="2784880">a</span> <span m="2784950">node that</span> <span m="2785410">stands for</span> <span m="2785880">some text.</span> <span m="2787080">Obviously</span> <span m="2787430">text can't</span> <span m="2787870">do anything.</span> </p>
<p><span m="2788550">STUDENT: So</span> <span m="2788805">if</span> <span m="2789060">that</span> <span m="2789400">title</span> <span m="2789763">was</span> <span m="2790126">User</span> <span m="2790490">Control,</span> <span m="2790951">and</span> <span m="2791412">someone</span> <span m="2791873">made a</span> <span m="2792334">chat room</span> <span m="2792795">with the</span> <span m="2793256">title</span> <span m="2793717">Alert</span> <span m="2794178">something,</span> <span m="2794639">that would not</span> <span m="2795100">be</span> <span m="2795335">JavaScript?</span> </p>
<p><span m="2795570">ADAM CHLIPALA: It</span> <span m="2796000">wouldn't</span> <span m="2796300">automatically</span> <span m="2796480">be</span> <span m="2797220">interpreted as</span> <span m="2797320">JavaScript</span> <span m="2797810">or HTML</span> <span m="2798300">or</span> <span m="2798450">anything</span> <span m="2798840">else.</span> <span m="2799336">It</span> <span m="2799584">would</span> <span m="2799708">just</span> <span m="2799832">be</span> <span m="2800328">text only.</span> <span m="2801320">All right,</span> <span m="2801820">so</span> <span m="2801960">we</span> <span m="2802030">have</span> <span m="2802200">this</span> <span m="2802330">title.</span> <span m="2802595">And</span> <span m="2802860">let's</span> <span m="2803970">wrap</span> <span m="2804410">an a tag</span> <span m="2804630">around</span> <span m="2804910">it.</span> <span m="2805200">And</span> <span m="2805400">instead of</span> <span m="2805670">href,</span> <span m="2806510">the</span> <span m="2806590">usual</span> <span m="2806870">way</span> <span m="2807000">to</span> <span m="2807150">do</span> <span m="2807360">a link</span> <span m="2807510">in</span> <span m="2807570">HTML,</span> <span m="2807900">we</span> <span m="2808150">use</span> <span m="2808410">the</span> <span m="2808660">link</span> <span m="2809020">attribute,</span> <span m="2810130">which</span> <span m="2810480">is</span> <span m="2810567">sort</span> <span m="2810655">of</span> <span m="2810742">a</span> <span m="2810830">pseudo</span> <span m="2811120">attribute in</span> <span m="2811485">Ur/Web,</span> <span m="2812420">which</span> <span m="2814200">takes</span> <span m="2814305">as</span> <span m="2814410">an</span> <span m="2814630">argument</span> <span m="2814900">not</span> <span m="2815170">a</span> <span m="2815380">URL,</span> <span m="2816210">but</span> <span m="2816880">basically</span> <span m="2817570">an</span> <span m="2817990">Ur/Web</span> <span m="2818280">expression.</span> <span m="2818570">And the</span> <span m="2818810">meaning</span> <span m="2819190">is</span> <span m="2819550">when you click on</span> <span m="2820000">this link,</span> <span m="2820290">please</span> <span m="2820480">run</span> <span m="2820680">this</span> <span m="2820850">expression</span> <span m="2821205">to</span> <span m="2821560">generate</span> <span m="2821815">the new</span> <span m="2822070">page that</span> <span m="2822455">should be</span> <span m="2822840">displayed.</span> </p>
<p><span m="2824590">In</span> <span m="2824690">this</span> <span m="2824760">case,</span> <span m="2824970">we're</span> <span m="2825070">calling</span> <span m="2825360">a</span> <span m="2825400">function</span> <span m="2825720">called</span> <span m="2826000">chat,</span> <span m="2826880">which</span> <span m="2827140">is</span> <span m="2827440">defined up</span> <span m="2827550">here.</span> <span m="2830280">And</span> <span m="2830970">here's</span> <span m="2831780">what</span> <span m="2831870">it</span> <span m="2832235">is.</span> <span m="2834990">I won't</span> <span m="2835450">go too</span> <span m="2835710">much</span> <span m="2835930">into the</span> <span m="2836420">details.</span> <span m="2836870">But</span> <span m="2837080">we</span> <span m="2837320">have a</span> <span m="2837590">few</span> <span m="2837810">more</span> <span m="2837900">SQL</span> <span m="2838130">queries</span> <span m="2838220">using</span> <span m="2838470">a</span> <span m="2838860">variety</span> <span m="2839900">of</span> <span m="2840140">standard</span> <span m="2840430">library</span> <span m="2840830">functions</span> <span m="2841280">for</span> <span m="2841570">different</span> <span m="2841800">ways</span> <span m="2842090">of</span> <span m="2842140">using</span> <span m="2842550">queried</span> <span m="2842870">results.</span> </p>
<p><span m="2844000">We</span> <span m="2845250">generate</span> <span m="2845630">this</span> <span m="2845780">HTML</span> <span m="2846208">page.</span> <span m="2846636">And we say,</span> <span m="2847064">you're in the</span> <span m="2847492">chat room.</span> <span m="2847920">Here's the</span> <span m="2848040">title.</span> <span m="2848900">We</span> <span m="2849300">get the same</span> <span m="2849780">kind of escaping</span> <span m="2850150">there.</span> <span m="2850750">And</span> <span m="2851020">there's</span> <span m="2851180">a</span> <span m="2851230">form</span> <span m="2851880">where the</span> <span m="2852220">user</span> <span m="2852400">can</span> <span m="2852680">enter some</span> <span m="2852850">text.</span> <span m="2853320">That's</span> <span m="2853580">the</span> <span m="2854490">form</span> <span m="2854760">that</span> <span m="2855060">I used</span> <span m="2855505">to demonstrate</span> <span m="2855950">this</span> <span m="2856325">a</span> <span m="2856700">few moments</span> <span m="2857030">ago.</span> </p>
<p><span m="2858500">And</span> <span m="2858860">the</span> <span m="2859240">Submit</span> <span m="2859630">button</span> <span m="2859810">of the</span> <span m="2859920">form</span> <span m="2860530">has</span> <span m="2860780">this</span> <span m="2861400">ask</span> <span m="2861900">attribute</span> <span m="2862736">that</span> <span m="2863132">is</span> <span m="2863530">containing</span> <span m="2863790">say,</span> <span m="2864250">which</span> <span m="2864692">is</span> <span m="2864765">the</span> <span m="2864839">name</span> <span m="2864913">of</span> <span m="2864986">a</span> <span m="2865060">function</span> <span m="2865134">in</span> <span m="2865576">Ur/Web.</span> <span m="2866018">And here it is.</span> <span m="2866902">So</span> <span m="2867344">when we submit</span> <span m="2867790">the form,</span> <span m="2867970">we</span> <span m="2868060">call</span> <span m="2868310">this</span> <span m="2868460">function.</span> <span m="2869060">Run</span> <span m="2869340">some</span> <span m="2869620">more</span> <span m="2870540">SQLs.</span> <span m="2871050">Insert a</span> <span m="2871395">new</span> <span m="2871740">row</span> <span m="2872170">into</span> <span m="2872600">a</span> <span m="2872710">table.</span> </p>
<p><span m="2873470">We</span> <span m="2873620">automatically</span> <span m="2875490">jump</span> <span m="2875740">in</span> <span m="2875940">the</span> <span m="2876170">ID</span> <span m="2876890">of</span> <span m="2877240">the</span> <span m="2877540">chat</span> <span m="2877920">room</span> <span m="2878870">and</span> <span m="2879270">the</span> <span m="2879480">text</span> <span m="2879750">field</span> <span m="2880090">that</span> <span m="2880202">came</span> <span m="2880315">from</span> <span m="2880427">the</span> <span m="2880540">form.</span> <span m="2880940">And these</span> <span m="2881160">are</span> <span m="2881290">automatically</span> <span m="2881950">escaped</span> <span m="2882430">as</span> <span m="2882600">necessary.</span> <span m="2883220">But</span> <span m="2883240">again,</span> <span m="2883710">you</span> <span m="2883808">don't</span> <span m="2883906">have</span> <span m="2884004">to</span> <span m="2884102">think</span> <span m="2884200">about</span> <span m="2884550">escaping</span> <span m="2885095">in</span> <span m="2885490">that</span> <span m="2885700">way</span> <span m="2885990">in</span> <span m="2886430">Ur/Web.</span> <span m="2886870">Because</span> <span m="2886930">this</span> <span m="2886990">is</span> <span m="2887160">just</span> <span m="2887500">syntax</span> <span m="2887920">for</span> <span m="2888020">building</span> <span m="2888330">a</span> <span m="2888390">tree.</span> <span m="2889642">It</span> <span m="2890010">doesn't</span> <span m="2890340">stand</span> <span m="2890680">for</span> <span m="2891020">a</span> <span m="2891770">string.</span> <span m="2892580">So</span> <span m="2893630">there's</span> <span m="2893760">no</span> <span m="2893930">way</span> <span m="2894090">to</span> <span m="2894760">have</span> <span m="2894950">strange</span> <span m="2895380">things</span> <span m="2895590">happen</span> <span m="2896070">with</span> <span m="2896370">parsing</span> <span m="2896645">that you</span> <span m="2896920">don't</span> <span m="2897120">expect</span> <span m="2897600">from</span> <span m="2897790">the</span> <span m="2897920">way</span> <span m="2898270">that</span> <span m="2898570">the</span> <span m="2898980">syntax</span> <span m="2899320">is</span> <span m="2899660">written.</span> <span m="2901100">Yeah.</span> </p>
<p><span m="2902060">STUDENT: [INAUDIBLE]?</span> </p>
<p><span m="2909740">ADAM CHLIPALA: Yes,</span> <span m="2910140">so</span> <span m="2910195">from the</span> <span m="2910250">fact</span> <span m="2910570">that</span> <span m="2910730">there's</span> <span m="2912010">one</span> <span m="2913740">widget,</span> <span m="2914660">one</span> <span m="2914980">GUI</span> <span m="2915070">widget</span> <span m="2915200">in</span> <span m="2915540">this</span> <span m="2915690">form,</span> <span m="2915930">and</span> <span m="2916363">its</span> <span m="2916796">name is</span> <span m="2917230">text,</span> <span m="2917700">and</span> <span m="2917820">that</span> <span m="2918130">one is</span> <span m="2918260">a</span> <span m="2918440">text</span> <span m="2918750">box,</span> <span m="2919400">the</span> <span m="2919777">compiler</span> <span m="2920154">infers</span> <span m="2920531">that</span> <span m="2920720">the</span> <span m="2920910">record</span> <span m="2921390">that</span> <span m="2921510">stands</span> <span m="2921606">for</span> <span m="2921703">the</span> <span m="2921800">form</span> <span m="2922075">result</span> <span m="2922350">should have</span> <span m="2922790">one</span> <span m="2923000">element</span> <span m="2923630">called</span> <span m="2923930">text</span> <span m="2924600">that</span> <span m="2924780">is</span> <span m="2924910">of</span> <span m="2925030">type</span> <span m="2925240">string.</span> <span m="2927870">And</span> <span m="2928070">this</span> <span m="2928150">encoding</span> <span m="2928540">the</span> <span m="2928700">forms,</span> <span m="2930220">the</span> <span m="2930490">typing</span> <span m="2930755">rules for</span> <span m="2931020">it</span> <span m="2931360">are</span> <span m="2931430">not</span> <span m="2931640">built</span> <span m="2931860">into</span> <span m="2931990">the</span> <span m="2932080">language.</span> </p>
<p><span m="2932520">You can</span> <span m="2932670">actually</span> <span m="2934100">with</span> <span m="2934270">the</span> <span m="2934370">type system in</span> <span m="2934690">Ur</span> <span m="2935130">express</span> <span m="2935560">as</span> <span m="2935660">a</span> <span m="2935740">library,</span> <span m="2936720">what</span> <span m="2937580">are</span> <span m="2937700">the</span> <span m="2937830">operations</span> <span m="2938270">for</span> <span m="2938370">building</span> <span m="2938690">forms,</span> <span m="2939410">and</span> <span m="2939520">how</span> <span m="2939660">do</span> <span m="2939750">you</span> <span m="2939860">check</span> <span m="2940240">that</span> <span m="2940420">they're used</span> <span m="2940590">correctly,</span> <span m="2941400">including</span> <span m="2941810">what</span> <span m="2941980">consequences</span> <span m="2942560">they</span> <span m="2942670">have</span> <span m="2942990">of</span> <span m="2943310">the</span> <span m="2943500">types</span> <span m="2943800">of</span> <span m="2943900">the</span> <span m="2944000">functions</span> <span m="2944255">that</span> <span m="2944510">actually</span> <span m="2944998">handle those</span> <span m="2945486">forms?</span> <span m="2953782">[INAUDIBLE].</span> <span m="2959660">Any</span> <span m="2959820">other</span> <span m="2959990">questions</span> <span m="2960610">about</span> <span m="2960860">this</span> <span m="2961010">code</span> <span m="2961330">before</span> <span m="2961720">I</span> <span m="2963199">switch</span> <span m="2963692">to the</span> <span m="2964185">next step</span> <span m="2964678">of</span> <span m="2965171">the</span> <span m="2965664">sequence</span> <span m="2965828">in</span> <span m="2965992">versions</span> <span m="2966157">from the paper,</span> <span m="2966650">which is only</span> <span m="2967143">a</span> <span m="2967636">small change?</span> </p>
<p><span m="2973552">All right,</span> <span m="2974538">then</span> <span m="2975031">here's what</span> <span m="2975524">I'm going to do.</span> <span m="2976510">It's</span> <span m="2977980">basically</span> <span m="2978480">taking</span> <span m="2978770">advantage</span> <span m="2979780">of</span> <span m="2980380">a</span> <span m="2980560">way</span> <span m="2980860">to</span> <span m="2981420">get</span> <span m="2981770">enforced</span> <span m="2982260">encapsulation</span> <span m="2983240">of</span> <span m="2983570">different</span> <span m="2983870">parts</span> <span m="2984160">of</span> <span m="2984240">an</span> <span m="2984320">application</span> <span m="2984870">that</span> <span m="2985010">Ur/Web</span> <span m="2985350">supports,</span> <span m="2985780">which</span> <span m="2985990">is</span> <span m="2986505">at</span> <span m="2986810">least</span> <span m="2987075">only</span> <span m="2987340">rarely</span> <span m="2987890">supported</span> <span m="2988520">elsewhere.</span> <span m="2989590">I'm</span> <span m="2989730">going</span> <span m="2989830">to</span> <span m="2989910">take</span> <span m="2990110">this</span> <span m="2990770">room.</span> <span m="2991640">I'm</span> <span m="2991790">going</span> <span m="2991890">to</span> <span m="2991960">take</span> <span m="2992170">some</span> <span m="2992380">of</span> <span m="2992430">these</span> <span m="2993040">definitions</span> <span m="2993560">here</span> <span m="2993750">and put</span> <span m="2993910">them</span> <span m="2994040">inside</span> <span m="2994400">a</span> <span m="2994440">module</span> <span m="2994920">that</span> <span m="2995030">encapsulates</span> <span m="2995760">some of them</span> <span m="2996070">as</span> <span m="2996230">private.</span> </p>
<p><span m="2996495">In</span> <span m="2996760">particular,</span> <span m="2997590">the</span> <span m="2997680">database</span> <span m="2998090">tables</span> <span m="2998380">are</span> <span m="2998430">going</span> <span m="2998560">to</span> <span m="2998600">be</span> <span m="2998710">private.</span> <span m="3001080">So</span> <span m="3001380">no one</span> <span m="3001810">can</span> <span m="3001930">access</span> <span m="3002260">them</span> <span m="3002610">directly.</span> <span m="3002960">They can</span> <span m="3003030">only</span> <span m="3003210">access</span> <span m="3003610">them</span> <span m="3003740">through</span> <span m="3004270">a</span> <span m="3004340">set</span> <span m="3004510">of</span> <span m="3004630">methods</span> <span m="3005000">that we</span> <span m="3005280">provide.</span> <span m="3005800">So</span> <span m="3006210">one</span> <span m="3006540">method</span> <span m="3007150">runs</span> <span m="3007640">inside</span> <span m="3007990">a</span> <span m="3008070">transaction.</span> <span m="3008390">That's</span> <span m="3008710">what</span> <span m="3008890">this</span> <span m="3009040">type</span> <span m="3009360">says.</span> </p>
<p><span m="3009513">And</span> <span m="3009666">it</span> <span m="3009820">produces</span> <span m="3010130">a</span> <span m="3010220">list</span> <span m="3011550">of</span> <span m="3011950">records</span> <span m="3012003">with</span> <span m="3012056">ID</span> <span m="3012110">and</span> <span m="3012510">title</span> <span m="3012760">fields</span> <span m="3013640">that</span> <span m="3013740">stand</span> <span m="3014080">for</span> <span m="3014680">which</span> <span m="3014870">rooms</span> <span m="3015180">are</span> <span m="3015310">available.</span> <span m="3016180">And</span> <span m="3016590">we'll</span> <span m="3016760">also</span> <span m="3017090">just</span> <span m="3017310">expose</span> <span m="3017625">this</span> <span m="3017940">chat</span> <span m="3018210">operation.</span> <span m="3020556">And one thing I've done here is</span> <span m="3020980">I've</span> <span m="3021370">introduced</span> <span m="3021670">a</span> <span m="3022060">name</span> <span m="3022480">for</span> <span m="3022690">the</span> <span m="3022990">concept</span> <span m="3023430">of</span> <span m="3023540">an</span> <span m="3023640">ID.</span> <span m="3024450">I</span> <span m="3024550">won't</span> <span m="3024770">just</span> <span m="3025090">say that</span> <span m="3025410">an</span> <span m="3025610">ID is</span> <span m="3025740">an</span> <span m="3026000">integer.</span> <span m="3026150">I'll</span> <span m="3026360">say</span> <span m="3026540">it's a</span> <span m="3026680">new</span> <span m="3026850">type.</span> <span m="3028140">And</span> <span m="3028300">the</span> <span m="3028390">only</span> <span m="3028620">way</span> <span m="3028800">the</span> <span m="3028940">outside</span> <span m="3029370">world</span> <span m="3029640">will</span> <span m="3029770">ever</span> <span m="3030040">get</span> <span m="3030320">one</span> <span m="3030930">is</span> <span m="3031090">to</span> <span m="3031230">list</span> <span m="3031540">all</span> <span m="3031680">the</span> <span m="3031780">rooms.</span> <span m="3032520">And</span> <span m="3032660">the only</span> <span m="3033040">way the</span> <span m="3033190">outside</span> <span m="3033600">world</span> <span m="3033870">can</span> <span m="3034000">ever</span> <span m="3034170">use</span> <span m="3034580">one</span> <span m="3034990">is to</span> <span m="3035140">call the</span> <span m="3035230">chat function</span> <span m="3035540">on it.</span> </p>
<p><span m="3037130">So</span> <span m="3037300">just</span> <span m="3037550">like,</span> <span m="3037930">say,</span> <span m="3038080">the</span> <span m="3038230">abstract</span> <span m="3038660">type</span> <span m="3039010">of a hash</span> <span m="3039280">table</span> <span m="3039350">inside</span> <span m="3039390">a</span> <span m="3039690">hash</span> <span m="3039940">table</span> <span m="3040410">class</span> <span m="3041350">where</span> <span m="3041870">the</span> <span m="3041960">details</span> <span m="3042470">of</span> <span m="3042560">what</span> <span m="3042720">is</span> <span m="3042830">an</span> <span m="3042960">ID</span> <span m="3043320">and</span> <span m="3044990">how</span> <span m="3045150">do they</span> <span m="3045560">get</span> <span m="3045740">produced</span> <span m="3046130">internally</span> <span m="3046980">are</span> <span m="3047310">private</span> <span m="3047790">to</span> <span m="3047860">this</span> <span m="3048040">module.</span> <span m="3048750">And</span> <span m="3049050">the</span> <span m="3049410">client</span> <span m="3049780">code</span> <span m="3050030">that</span> <span m="3050240">calls this</span> <span m="3050590">module</span> <span m="3051130">isn't</span> <span m="3051510">going to need</span> <span m="3051700">to use</span> <span m="3051975">them.</span> <span m="3052700">So I'll</span> <span m="3052980">use</span> <span m="3053190">this</span> <span m="3054230">syntax</span> <span m="3054615">to</span> <span m="3055000">put</span> <span m="3056420">everything down</span> <span m="3056860">here</span> <span m="3057510">inside</span> <span m="3057870">the</span> <span m="3057920">module</span> <span m="3058330">so</span> <span m="3058600">it's</span> <span m="3058760">not</span> <span m="3058920">exposed</span> <span m="3059300">to the</span> <span m="3059680">rest</span> <span m="3059960">of the code</span> <span m="3060431">by</span> <span m="3060902">default.</span> </p>
<p><span m="3064199">And</span> <span m="3065141">we</span> <span m="3065620">also</span> <span m="3065760">are</span> <span m="3065846">going</span> <span m="3065933">to</span> <span m="3066020">want</span> <span m="3067120">to</span> <span m="3067330">implement</span> <span m="3067560">this</span> <span m="3067800">rooms</span> <span m="3068040">method.</span> <span m="3068360">We</span> <span m="3068480">already</span> <span m="3068700">happen</span> <span m="3069005">to have chat</span> <span m="3069310">around.</span> <span m="3070180">But</span> <span m="3070615">we</span> <span m="3070760">can</span> <span m="3070905">implement</span> <span m="3071050">rooms</span> <span m="3071395">in a</span> <span m="3071740">simple</span> <span m="3072200">way</span> <span m="3073105">as</span> <span m="3074035">using</span> <span m="3074500">another</span> <span m="3074830">standard</span> <span m="3075130">library</span> <span m="3075480">function</span> <span m="3075890">for</span> <span m="3075960">interpreting</span> <span m="3076320">a</span> <span m="3076430">query</span> <span m="3076820">in a</span> <span m="3077090">useful</span> <span m="3077480">way.</span> </p>
<p><span m="3077840">Let's just</span> <span m="3077980">select</span> <span m="3078360">everything</span> <span m="3078750">from</span> <span m="3079000">the room</span> <span m="3079360">table</span> <span m="3079800">ordering</span> <span m="3080460">by</span> <span m="3080670">title.</span> <span m="3081120">And as</span> <span m="3081290">usual,</span> <span m="3081660">this query</span> <span m="3081965">is</span> <span m="3082270">type checked</span> <span m="3082570">for</span> <span m="3082880">us.</span> <span m="3083280">And</span> <span m="3083761">the</span> <span m="3083921">system</span> <span m="3084081">determines,</span> <span m="3084242">OK,</span> <span m="3084723">this expression</span> <span m="3085204">is going to</span> <span m="3085685">generate</span> <span m="3085765">a</span> <span m="3085845">list</span> <span m="3085925">of</span> <span m="3086005">records</span> <span m="3086085">that</span> <span m="3086647">happens to</span> <span m="3087130">match</span> <span m="3088000">the</span> <span m="3088160">type</span> <span m="3088460">that we</span> <span m="3088540">declared</span> <span m="3088920">in</span> <span m="3089300">the</span> <span m="3089580">signature</span> <span m="3089885">of</span> <span m="3090190">this</span> <span m="3090530">module.</span> <span m="3090870">So</span> <span m="3091010">now</span> <span m="3091290">outside</span> <span m="3091680">this</span> <span m="3091800">module,</span> <span m="3092600">no</span> <span m="3092820">other</span> <span m="3093060">code</span> <span m="3093320">is</span> <span m="3093390">allowed</span> <span m="3093940">to</span> <span m="3094020">mention</span> <span m="3094305">the</span> <span m="3094590">room</span> <span m="3094760">table</span> <span m="3095030">or the</span> <span m="3095300">message</span> <span m="3095771">table.</span> </p>
<p><span m="3096242">So</span> <span m="3096713">we can,</span> <span m="3097184">at</span> <span m="3097301">least</span> <span m="3097419">from</span> <span m="3097537">the</span> <span m="3097655">perspective</span> <span m="3098126">of this application,</span> <span m="3099360">enforce</span> <span m="3099770">whenever</span> <span m="3100010">invariance</span> <span m="3100340">we want on</span> <span m="3100520">them.</span> <span m="3101500">We</span> <span m="3101650">can</span> <span m="3101920">even</span> <span m="3102170">hide</span> <span m="3102610">secrets</span> <span m="3102980">inside</span> <span m="3103300">of</span> <span m="3103390">them</span> <span m="3103685">that</span> <span m="3103980">would be</span> <span m="3104290">a</span> <span m="3104600">security</span> <span m="3105020">problem</span> <span m="3105720">if</span> <span m="3105860">some</span> <span m="3106070">other</span> <span m="3106280">part</span> <span m="3106580">of the</span> <span m="3106850">code</span> <span m="3107120">was</span> <span m="3107260">able</span> <span m="3107470">to</span> <span m="3107530">get</span> <span m="3107740">a hold</span> <span m="3107980">of them.</span> <span m="3108918">Yeah.</span> </p>
<p><span m="3109856">STUDENT: But</span> <span m="3110325">couldn't</span> <span m="3110481">some</span> <span m="3110637">other</span> <span m="3110794">part of the code</span> <span m="3111263">just</span> <span m="3111732">declare</span> <span m="3112201">table</span> <span m="3112435">room</span> <span m="3112670">as well?</span> </p>
<p><span m="3113610">ADAM CHLIPALA: That</span> <span m="3113980">would</span> <span m="3114110">be a</span> <span m="3114280">different</span> <span m="3114590">table.</span> <span m="3115280">We</span> <span m="3115720">could</span> <span m="3115780">do</span> <span m="3115930">that,</span> <span m="3116330">actually.</span> <span m="3117782">It's</span> <span m="3118266">got to be in</span> <span m="3118750">here.</span> <span m="3119620">I</span> <span m="3120110">think this</span> <span m="3120230">should</span> <span m="3120520">have no</span> <span m="3120810">effect</span> <span m="3121240">on the</span> <span m="3121950">behavior.</span> <span m="3124442">I</span> <span m="3124940">think in this case</span> <span m="3125438">we're going to</span> <span m="3125936">get</span> <span m="3126434">something funny</span> <span m="3126932">happening.</span> <span m="3127928">Let's</span> <span m="3128426">put</span> <span m="3128924">this in</span> <span m="3129422">a</span> <span m="3129920">different</span> <span m="3130418">module just</span> <span m="3130930">to</span> <span m="3131260">avoid</span> <span m="3133594">something</span> <span m="3134065">goofy.</span> </p>
<p><span m="3135950">Great, so</span> <span m="3136240">we</span> <span m="3136410">can do</span> <span m="3136540">that.</span> <span m="3137170">And</span> <span m="3137220">we</span> <span m="3137290">can</span> <span m="3137370">do</span> <span m="3137460">whatever</span> <span m="3137680">we</span> <span m="3137730">want</span> <span m="3138100">with this</span> <span m="3138280">table.</span> <span m="3139252">And</span> <span m="3139694">I'll compile this</span> <span m="3140578">in</span> <span m="3141462">maybe about</span> <span m="3141910">30</span> <span m="3142100">seconds</span> <span m="3142355">and</span> <span m="3142610">we'll</span> <span m="3142820">see</span> <span m="3143290">what happens.</span> <span m="3143670">But</span> <span m="3144100">it's</span> <span m="3144290">actually</span> <span m="3144700">a</span> <span m="3144790">different</span> <span m="3145100">table,</span> <span m="3145400">just</span> <span m="3145610">like</span> <span m="3145790">if</span> <span m="3145880">you</span> <span m="3145980">have</span> <span m="3146320">the</span> <span m="3146390">same</span> <span m="3146700">private</span> <span m="3147170">field</span> <span m="3147610">name</span> <span m="3147970">across</span> <span m="3148330">two</span> <span m="3148460">classes</span> <span m="3148790">in</span> <span m="3148890">Java</span> <span m="3149120">they're</span> <span m="3149350">different</span> <span m="3149820">field</span> <span m="3150290">names.</span> <span m="3151282">Yeah.</span> </p>
<p><span m="3152274">STUDENT: [INAUDIBLE]?</span> </p>
<p></p>
<p><span m="3162690">ADAM CHLIPALA: So</span> <span m="3163210">you're</span> <span m="3163480">suggesting</span> <span m="3166760">we</span> <span m="3166940">have,</span> <span m="3167660">inside</span> <span m="3168030">this</span> <span m="3168280">module,</span> <span m="3168340">an</span> <span m="3168400">abstract</span> <span m="3168870">type called</span> <span m="3169270">room,</span> <span m="3170070">which</span> <span m="3170450">contains</span> <span m="3171450">both</span> <span m="3171500">the</span> <span m="3171550">ID</span> <span m="3171830">and the</span> <span m="3171970">title.</span> <span m="3172604">Is</span> <span m="3173098">that</span> <span m="3173592">right?</span> </p>
<p><span m="3175074">STUDENT: [INAUDIBLE]?</span> </p>
<p></p>
<p><span m="3185460">So</span> <span m="3186220">I</span> <span m="3186290">think</span> <span m="3186480">what</span> <span m="3186910">would</span> <span m="3187100">work to do</span> <span m="3187530">instead</span> <span m="3187920">is</span> <span m="3188640">instead of</span> <span m="3188870">type</span> <span m="3189100">ID</span> <span m="3189340">have</span> <span m="3189580">type</span> <span m="3189810">room,</span> <span m="3190790">have</span> <span m="3191110">room</span> <span m="3191430">determine</span> <span m="3191700">a list</span> <span m="3191890">of</span> <span m="3192000">rooms,</span> <span m="3192290">and</span> <span m="3192410">chat</span> <span m="3192820">take a room as</span> <span m="3193090">an input.</span> <span m="3193595">Is</span> <span m="3193950">that</span> <span m="3194380">what</span> <span m="3194520">you</span> <span m="3194590">have</span> <span m="3194780">in mind?</span> <span m="3195010">So</span> <span m="3195750">what</span> <span m="3195990">would happen</span> <span m="3196200">then</span> <span m="3196460">is</span> <span m="3196580">when</span> <span m="3196950">we</span> <span m="3197070">call</span> <span m="3197270">the</span> <span m="3197360">chat</span> <span m="3197630">function,</span> <span m="3197970">it'll</span> <span m="3198140">actually</span> <span m="3198480">be</span> <span m="3198610">called</span> <span m="3198900">via</span> <span m="3199190">a</span> <span m="3199440">URL</span> <span m="3200380">given</span> <span m="3200560">the</span> <span m="3200630">way</span> <span m="3200740">we</span> <span m="3200850">use this</span> <span m="3201180">eventually.</span> </p>
<p><span m="3201720">That</span> <span m="3201950">would</span> <span m="3202160">be</span> <span m="3202610">passing</span> <span m="3203030">the</span> <span m="3203160">ID</span> <span m="3203650">and</span> <span m="3203910">the</span> <span m="3204030">title</span> <span m="3205040">within</span> <span m="3205320">the</span> <span m="3205400">URL</span> <span m="3206180">in</span> <span m="3206880">the</span> <span m="3207300">URL</span> <span m="3207700">representation</span> <span m="3208040">for</span> <span m="3208380">a</span> <span m="3208610">function</span> <span m="3208925">call.</span> <span m="3210700">And</span> <span m="3210920">we</span> <span m="3211030">only</span> <span m="3211180">need</span> <span m="3211390">the</span> <span m="3211560">ID</span> <span m="3211960">to implement</span> <span m="3212386">that function.</span> <span m="3213240">So</span> <span m="3213540">it would be</span> <span m="3213770">a little</span> <span m="3213880">wasteful</span> <span m="3214220">of</span> <span m="3214380">space</span> <span m="3214750">and</span> <span m="3214840">might look</span> <span m="3215060">gross</span> <span m="3215700">to</span> <span m="3215790">the</span> <span m="3215910">user</span> <span m="3216380">to have to</span> <span m="3216600">have</span> <span m="3216730">the</span> <span m="3217120">title</span> <span m="3217450">passed</span> <span m="3217720">along</span> <span m="3218040">as</span> <span m="3218210">an</span> <span m="3218660">extra</span> <span m="3219240">argument</span> <span m="3220170">in</span> <span m="3220810">the</span> <span m="3221060">invocation</span> <span m="3221345">of</span> <span m="3221630">chat</span> <span m="3221905">via</span> <span m="3222180">a URL.</span> <span m="3223136">Does</span> <span m="3223614">that</span> <span m="3224570">make</span> <span m="3224690">sense?</span> </p>
<p><span m="3226690">Or</span> <span m="3226800">maybe</span> <span m="3227120">another</span> <span m="3227390">way</span> <span m="3227530">of</span> <span m="3227610">saying</span> <span m="3227840">it,</span> <span m="3228336">if I have this</span> <span m="3228832">one</span> <span m="3229330">[INAUDIBLE],</span> <span m="3230550">is</span> <span m="3233052">look</span> <span m="3233218">up</span> <span m="3233384">at</span> <span m="3233550">the</span> <span m="3233700">URL</span> <span m="3234120">bar.</span> <span m="3234410">The</span> <span m="3234910">ID</span> <span m="3236290">of</span> <span m="3236660">the</span> <span m="3237000">channel</span> <span m="3237310">we're</span> <span m="3237400">going</span> <span m="3237710">into</span> <span m="3237850">is</span> <span m="3237950">serialized</span> <span m="3238750">automatically</span> <span m="3239095">in the</span> <span m="3239440">URL</span> <span m="3239620">at the end</span> <span m="3240075">here.</span> <span m="3240985">And</span> <span m="3241440">if</span> <span m="3241591">we were</span> <span m="3241743">passing</span> <span m="3241819">a</span> <span m="3241895">record</span> <span m="3242350">that</span> <span m="3242513">contained</span> <span m="3242676">an</span> <span m="3242840">ID</span> <span m="3243155">and</span> <span m="3243470">a</span> <span m="3243810">title,</span> <span m="3244210">the</span> <span m="3244300">title</span> <span m="3244560">would</span> <span m="3244650">be</span> <span m="3244740">serialized,</span> <span m="3245340">too,</span> <span m="3245980">which</span> <span m="3246740">is</span> <span m="3246860">at</span> <span m="3246930">least</span> <span m="3247120">a</span> <span m="3247170">little</span> <span m="3247540">counterintuative.</span> </p>
<p><span m="3253300">OK,</span> <span m="3254260">the</span> <span m="3254740">last thing</span> <span m="3254890">we</span> <span m="3255350">need to do--</span> <span m="3256780">actually,</span> <span m="3257210">it</span> <span m="3257605">might be</span> <span m="3258000">instructive</span> <span m="3258680">to</span> <span m="3260400">make just</span> <span m="3260550">a</span> <span m="3260790">shallow</span> <span m="3261180">change to</span> <span m="3261500">this</span> <span m="3261730">code,</span> <span m="3262820">reference</span> <span m="3263180">the</span> <span m="3263470">room</span> <span m="3263900">module there,</span> <span m="3264920">and</span> <span m="3265090">then</span> <span m="3265280">try</span> <span m="3265840">to</span> <span m="3266050">access</span> <span m="3266680">the</span> <span m="3266780">room</span> <span m="3267000">table</span> <span m="3267270">like</span> <span m="3267470">before.</span> <span m="3268260">This</span> <span m="3268610">shouldn't</span> <span m="3268850">be</span> <span m="3268960">allowed.</span> </p>
<p><span m="3269260">This</span> <span m="3269380">would</span> <span m="3269810">be like</span> <span m="3270040">being</span> <span m="3270200">able</span> <span m="3270340">to</span> <span m="3270900">read</span> <span m="3271110">and</span> <span m="3271190">write</span> <span m="3271430">the</span> <span m="3271650">private</span> <span m="3271925">fields</span> <span m="3272200">of a</span> <span m="3272640">class</span> <span m="3273780">in</span> <span m="3274000">Java.</span> <span m="3274300">And</span> <span m="3274600">indeed,</span> <span m="3274700">we</span> <span m="3275000">get</span> <span m="3275550">a</span> <span m="3275850">pretty</span> <span m="3276290">straightforward</span> <span m="3276810">message</span> <span m="3277230">basically</span> <span m="3277570">saying,</span> <span m="3279650">this</span> <span m="3280110">right</span> <span m="3280260">here</span> <span m="3280720">is an</span> <span m="3280920">unbound</span> <span m="3281360">variable.</span> <span m="3282130">There's</span> <span m="3282570">no table called</span> <span m="3282960">room in scope.</span> </p>
<p><span m="3284280">And</span> <span m="3284745">we</span> <span m="3285210">could</span> <span m="3285270">mention</span> <span m="3285570">this</span> <span m="3285720">extra one</span> <span m="3286060">that we</span> <span m="3286400">created</span> <span m="3286920">just</span> <span m="3287100">for</span> <span m="3287230">fun.</span> <span m="3287700">But</span> <span m="3288200">then</span> <span m="3288260">it</span> <span m="3288730">would</span> <span m="3289220">be</span> <span m="3289310">a</span> <span m="3289470">different</span> <span m="3289800">table.</span> <span m="3290120">It</span> <span m="3290200">wouldn't</span> <span m="3290280">be</span> <span m="3290360">a</span> <span m="3290440">problem</span> <span m="3290710">that we could</span> <span m="3290980">access that.</span> <span m="3293050">So</span> <span m="3293200">instead,</span> <span m="3293890">what</span> <span m="3294160">we</span> <span m="3294280">should</span> <span m="3294470">do</span> <span m="3294930">is</span> <span m="3295500">I'll</span> <span m="3295750">break</span> <span m="3295950">this into</span> <span m="3296300">two</span> <span m="3296460">parts.</span> </p>
<p><span m="3299330">We'll</span> <span m="3299780">start</span> <span m="3300070">out</span> <span m="3300230">by</span> <span m="3300330">just</span> <span m="3300570">calling</span> <span m="3300980">the</span> <span m="3301080">rooms</span> <span m="3301380">method,</span> <span m="3302240">and</span> <span m="3302360">then</span> <span m="3302650">do</span> <span m="3302780">a</span> <span m="3302830">slightly</span> <span m="3303110">different</span> <span m="3303530">thing</span> <span m="3303880">to</span> <span m="3304330">read its</span> <span m="3304630">elements,</span> <span m="3306930">map</span> <span m="3307410">over</span> <span m="3307640">the</span> <span m="3307720">list</span> <span m="3308040">of</span> <span m="3308150">results</span> <span m="3308620">that</span> <span m="3308790">gives--</span> <span m="3311935">what</span> <span m="3312418">did I call</span> <span m="3312901">[INAUDIBLE]?</span> <span m="3321112">Map</span> <span m="3321610">all the</span> <span m="3321910">list</span> <span m="3322120">of</span> <span m="3322210">results</span> <span m="3322610">instead</span> <span m="3322995">of</span> <span m="3324150">the other</span> <span m="3324520">way it was</span> <span m="3324890">working,</span> <span m="3325050">which was</span> <span m="3325533">roughly</span> <span m="3326016">equivalent</span> <span m="3326499">except</span> <span m="3326982">for using</span> <span m="3327465">different data</span> <span m="3327948">types.</span> <span m="3328431">Let's see</span> <span m="3328914">how this</span> <span m="3329397">goes.</span> </p>
<p><span m="3330846">All</span> <span m="3331329">right,</span> <span m="3332778">so</span> <span m="3334856">I'll</span> <span m="3335200">go back</span> <span m="3335563">here.</span> <span m="3336740">And</span> <span m="3337190">we can</span> <span m="3337640">do all</span> <span m="3338090">the</span> <span m="3338540">tremendously</span> <span m="3339860">exciting</span> <span m="3340280">things</span> <span m="3340660">we could do before.</span> <span m="3343380">But</span> <span m="3343760">we have this</span> <span m="3344040">encapsulation.</span> <span m="3344400">And you</span> <span m="3344760">can sort</span> <span m="3344960">of</span> <span m="3345270">think</span> <span m="3345470">of</span> <span m="3345630">this</span> <span m="3345810">room</span> <span m="3346080">structure</span> <span m="3346530">as now</span> <span m="3346870">it's</span> <span m="3347020">a</span> <span m="3347070">library,</span> <span m="3347445">and</span> <span m="3347820">you</span> <span m="3347940">can</span> <span m="3349110">call this from</span> <span m="3349500">all</span> <span m="3349603">sorts</span> <span m="3349706">of</span> <span m="3349810">different</span> <span m="3350270">places</span> <span m="3350680">that</span> <span m="3350800">want</span> <span m="3350960">to</span> <span m="3351000">have</span> <span m="3351190">this</span> <span m="3351320">functionality.</span> </p>
<p><span m="3352050">You</span> <span m="3352150">don't</span> <span m="3352260">have</span> <span m="3352360">to</span> <span m="3352450">worry.</span> <span m="3352790">There's</span> <span m="3353090">different</span> <span m="3353350">places</span> <span m="3353760">that</span> <span m="3353893">are</span> <span m="3354026">going</span> <span m="3354160">to break</span> <span m="3354430">the</span> <span m="3354670">internal</span> <span m="3354885">invariance</span> <span m="3355750">of</span> <span m="3355940">the</span> <span m="3356020">system.</span> <span m="3356540">Maybe</span> <span m="3356870">you</span> <span m="3357120">want</span> <span m="3357490">to</span> <span m="3357580">know</span> <span m="3358060">that once</span> <span m="3358270">a</span> <span m="3358360">message</span> <span m="3358615">is</span> <span m="3358870">added,</span> <span m="3359350">it</span> <span m="3359640">will</span> <span m="3360030">never be</span> <span m="3360140">deleted.</span> <span m="3360440">It's</span> <span m="3360700">always</span> <span m="3360950">there</span> <span m="3361170">in the logs.</span> <span m="3362160">This</span> <span m="3362270">structure</span> <span m="3362680">enforces</span> <span m="3363190">that</span> <span m="3363690">independently</span> <span m="3364060">of</span> <span m="3364430">which</span> <span m="3364680">other</span> <span m="3364910">code</span> <span m="3365270">the</span> <span m="3365731">room module</span> <span m="3366192">might be</span> <span m="3366653">composed with,</span> <span m="3367114">for instance.</span> <span m="3370341">Yeah.</span> </p>
<p><span m="3371245">STUDENT: Say</span> <span m="3371680">you</span> <span m="3372140">change the</span> <span m="3372623">definition of</span> <span m="3373106">room,</span> <span m="3373589">[INAUDIBLE].</span> <span m="3375038">What's</span> <span m="3375521">going to happen</span> <span m="3376004">to the</span> <span m="3376487">database</span> <span m="3376970">table?</span> </p>
<p><span m="3377936">ADAM CHLIPALA: It'll</span> <span m="3378430">be</span> <span m="3378550">a little</span> <span m="3378790">sad.</span> <span m="3379220">We'll</span> <span m="3379566">have</span> <span m="3379912">to</span> <span m="3380260">manually</span> <span m="3381620">run</span> <span m="3382080">an alter</span> <span m="3382540">table</span> <span m="3383000">command if you want</span> <span m="3383460">to save the</span> <span m="3383920">old</span> <span m="3384380">data.</span> <span m="3386680">But</span> <span m="3387520">when</span> <span m="3387670">the</span> <span m="3387770">application</span> <span m="3388240">starts</span> <span m="3388570">up,</span> <span m="3388890">it</span> <span m="3389030">queries</span> <span m="3389580">the</span> <span m="3389680">system</span> <span m="3390390">database</span> <span m="3390820">catalog</span> <span m="3391260">and</span> <span m="3391480">checks</span> <span m="3391770">that</span> <span m="3391875">the</span> <span m="3391980">schema</span> <span m="3392400">still</span> <span m="3392570">matches</span> <span m="3392890">what</span> <span m="3393010">it</span> <span m="3393100">expects.</span> <span m="3393840">So</span> <span m="3393945">you'll</span> <span m="3394050">get</span> <span m="3394180">a</span> <span m="3394240">static</span> <span m="3394560">error</span> <span m="3394980">then.</span> <span m="3395350">And</span> <span m="3395780">that</span> <span m="3396200">will</span> <span m="3396600">hopefully</span> <span m="3397010">give you a</span> <span m="3397180">hint about</span> <span m="3397690">what</span> <span m="3397850">you should change</span> <span m="3398120">in the</span> <span m="3398460">database.</span> </p>
<p><span m="3399265">STUDENT: But</span> <span m="3399730">it wouldn't</span> <span m="3400195">automatically</span> <span m="3400660">drop your</span> <span m="3401125">database</span> <span m="3401590">or something?</span> </p>
<p><span m="3402055">ADAM CHLIPALA: I</span> <span m="3402520">hope not.</span> <span m="3402985">I</span> <span m="3403450">don't</span> <span m="3403640">think</span> <span m="3403850">it should</span> <span m="3403990">do</span> <span m="3404130">that.</span> <span m="3404810">And</span> <span m="3405330">you</span> <span m="3405390">can</span> <span m="3405490">imagine</span> <span m="3405960">tweaking</span> <span m="3406240">the</span> <span m="3406310">compiler</span> <span m="3406850">to</span> <span m="3407490">understand</span> <span m="3407940">the</span> <span m="3408030">evolution</span> <span m="3408290">of a</span> <span m="3408550">database.</span> <span m="3408830">I think</span> <span m="3409110">you have</span> <span m="3409390">to write</span> <span m="3409800">alter</span> <span m="3410090">table</span> <span m="3410390">commands</span> <span m="3410760">to</span> <span m="3410920">run.</span> <span m="3412002">It</span> <span m="3412380">doesn't do</span> <span m="3412560">that</span> <span m="3413023">right now.</span> </p>
<p><span m="3417190">OK,</span> <span m="3418116">so</span> <span m="3418580">now</span> <span m="3418740">let's</span> <span m="3419210">talk</span> <span m="3419470">about</span> <span m="3421270">cross</span> <span m="3421470">site</span> <span m="3422130">request</span> <span m="3422480">forgery</span> <span m="3422800">and</span> <span m="3423120">preventing</span> <span m="3423497">it.</span> <span m="3423874">Actually,</span> <span m="3424251">before</span> <span m="3425040">we</span> <span m="3425560">do</span> <span m="3425700">that,</span> <span m="3425860">let's</span> <span m="3426220">look at the</span> <span m="3426580">code</span> <span m="3426940">on</span> <span m="3427220">this</span> <span m="3427360">page.</span> <span m="3429750">We</span> <span m="3429840">have</span> <span m="3429960">a</span> <span m="3430120">traditional</span> <span m="3430620">looking</span> <span m="3430960">HTML</span> <span m="3431330">form</span> <span m="3431665">that</span> <span m="3432000">gets</span> <span m="3432220">generated</span> <span m="3432670">here.</span> <span m="3433780">And</span> <span m="3434370">there's</span> <span m="3434890">certainly</span> <span m="3435160">no</span> <span m="3435430">cross</span> <span m="3435670">site</span> <span m="3435900">request</span> <span m="3436230">forgery</span> <span m="3436650">protection</span> <span m="3437150">in</span> <span m="3437575">here,</span> <span m="3438850">which</span> <span m="3439280">I think</span> <span m="3439500">is</span> <span m="3439670">good.</span> <span m="3439930">Because</span> <span m="3440190">as</span> <span m="3440530">I</span> <span m="3440870">understand</span> <span m="3441510">cross</span> <span m="3441750">site</span> <span m="3441970">request</span> <span m="3442280">forgery,</span> <span m="3442660">the</span> <span m="3442720">problem</span> <span m="3443130">is</span> <span m="3443290">there's</span> <span m="3443410">some</span> <span m="3443840">implicit</span> <span m="3444310">context</span> <span m="3444580">that</span> <span m="3444930">your</span> <span m="3445020">application</span> <span m="3445580">sends</span> <span m="3445900">on</span> <span m="3446010">every</span> <span m="3446320">request.</span> </p>
<p><span m="3447210">So</span> <span m="3447340">there's</span> <span m="3447480">some</span> <span m="3447650">attacker</span> <span m="3448100">out</span> <span m="3448230">there</span> <span m="3448370">who</span> <span m="3448490">doesn't</span> <span m="3448820">know</span> <span m="3449050">your</span> <span m="3449210">implicit</span> <span m="3449630">context.</span> <span m="3450280">Let's</span> <span m="3450490">say</span> <span m="3450700">your</span> <span m="3450820">password is</span> <span m="3451320">stored</span> <span m="3451750">in</span> <span m="3451916">a</span> <span m="3452083">cookie,</span> <span m="3452250">for a</span> <span m="3452410">really</span> <span m="3452620">simple</span> <span m="3452900">example.</span> <span m="3454020">And</span> <span m="3454340">when</span> <span m="3454510">the</span> <span m="3454620">attacker</span> <span m="3455150">tricks</span> <span m="3455400">you</span> <span m="3455550">into</span> <span m="3455640">following</span> <span m="3455950">a</span> <span m="3456050">link</span> <span m="3456330">to</span> <span m="3456410">the</span> <span m="3456510">application,</span> <span m="3457420">your</span> <span m="3457550">browser</span> <span m="3457920">sends</span> <span m="3458330">the</span> <span m="3458410">implicit</span> <span m="3458780">context</span> <span m="3459240">automatically</span> <span m="3459970">and</span> <span m="3460330">causes</span> <span m="3460670">the</span> <span m="3460790">application</span> <span m="3461320">to</span> <span m="3461450">do</span> <span m="3461620">something</span> <span m="3461945">the attacker</span> <span m="3462270">could not</span> <span m="3462670">have</span> <span m="3463070">done</span> <span m="3463390">directly.</span> </p>
<p><span m="3464580">In</span> <span m="3464680">this</span> <span m="3464860">case,</span> <span m="3465480">there's</span> <span m="3465620">no</span> <span m="3465770">implicit</span> <span m="3466140">context.</span> <span m="3466890">So</span> <span m="3467060">there's</span> <span m="3467240">no</span> <span m="3467700">risk</span> <span m="3467980">of a</span> <span m="3468130">cross</span> <span m="3468460">site</span> <span m="3468820">request</span> <span m="3469350">forgery.</span> <span m="3470570">Does anyone</span> <span m="3470840">want to</span> <span m="3471090">dispute</span> <span m="3471385">that</span> <span m="3471680">characterization</span> <span m="3471940">before I</span> <span m="3472435">go on?</span> <span m="3473425">It</span> <span m="3473920">could be</span> <span m="3474415">educational for me.</span> <span m="3478375">All right, so</span> <span m="3478870">now</span> <span m="3479000">let's</span> <span m="3479230">add some</span> <span m="3479530">implicit</span> <span m="3479920">context.</span> <span m="3480390">And</span> <span m="3480460">the</span> <span m="3480530">system</span> <span m="3480830">is</span> <span m="3480930">automatically</span> <span m="3481560">going</span> <span m="3481730">to</span> <span m="3481820">deploy</span> <span m="3482170">the right</span> <span m="3482360">countermeasures</span> <span m="3483110">based</span> <span m="3483430">on</span> <span m="3483600">program</span> <span m="3483980">analysis</span> <span m="3484620">that</span> <span m="3484850">realizes</span> <span m="3485140">now there's</span> <span m="3485430">implicit</span> <span m="3485891">context.</span> </p>
<p><span m="3488660">In</span> <span m="3488720">particular,</span> <span m="3490580">we</span> <span m="3490720">just</span> <span m="3491030">throw</span> <span m="3491350">in</span> <span m="3492700">a</span> <span m="3493230">cookie</span> <span m="3493726">here.</span> <span m="3500174">As</span> <span m="3501180">another</span> <span m="3501400">example</span> <span m="3501770">of</span> <span m="3501900">module</span> <span m="3502250">capsulation,</span> <span m="3502890">actually,</span> <span m="3503250">I'll</span> <span m="3503590">put in</span> <span m="3503850">a</span> <span m="3504110">whole</span> <span m="3504445">sort</span> <span m="3504780">of user</span> <span m="3505280">authentication</span> <span m="3505723">system</span> <span m="3508830">where</span> <span m="3509150">we</span> <span m="3509470">have</span> <span m="3509845">the</span> <span m="3510220">user</span> <span m="3510530">accounts</span> <span m="3510790">and</span> <span m="3511050">abstract</span> <span m="3511340">types</span> <span m="3511870">of</span> <span m="3511970">IDs</span> <span m="3512310">and</span> <span m="3512430">passwords.</span> <span m="3512705">So</span> <span m="3512980">you</span> <span m="3513130">can't</span> <span m="3513350">just</span> <span m="3514190">build</span> <span m="3514530">the</span> <span m="3514710">value</span> <span m="3515180">of</span> <span m="3515450">either</span> <span m="3515835">of</span> <span m="3516220">these</span> <span m="3516690">types</span> <span m="3517030">directly.</span> <span m="3517295">You'll</span> <span m="3517560">have to go</span> <span m="3518017">through</span> <span m="3518474">some</span> <span m="3518931">kind</span> <span m="3519388">of</span> <span m="3522180">approved</span> <span m="3522600">method</span> <span m="3522960">of</span> <span m="3523030">building</span> <span m="3523420">values of</span> <span m="3523720">these</span> <span m="3524000">types.</span> </p>
<p><span m="3525400">And</span> <span m="3526260">I'm</span> <span m="3526690">actually</span> <span m="3527050">going</span> <span m="3527170">to</span> <span m="3527290">expose</span> <span m="3529070">the</span> <span m="3529290">table</span> <span m="3529600">directly</span> <span m="3530040">in the</span> <span m="3530160">signature.</span> <span m="3531340">And</span> <span m="3531780">I'll</span> <span m="3531980">put</span> <span m="3532100">a</span> <span m="3532240">constraint</span> <span m="3532630">on it,</span> <span m="3532860">too,</span> <span m="3533040">saying</span> <span m="3533350">the ID</span> <span m="3533700">form is</span> <span m="3533980">a</span> <span m="3534080">key for</span> <span m="3534365">it.</span> <span m="3535076">[INAUDIBLE].</span> <span m="3538160">But</span> <span m="3538680">the thing</span> <span m="3538940">is,</span> <span m="3539235">on</span> <span m="3539530">this</span> <span m="3539760">user</span> <span m="3539990">table,</span> <span m="3540390">ID</span> <span m="3540810">and</span> <span m="3540940">password</span> <span m="3541380">are</span> <span m="3541710">abstract</span> <span m="3542040">types.</span> <span m="3542680">So</span> <span m="3542770">the</span> <span m="3542900">code</span> <span m="3543250">can't</span> <span m="3543520">actually</span> <span m="3544940">look</span> <span m="3545120">at</span> <span m="3545180">the</span> <span m="3545250">password.</span> </p>
<p><span m="3546580">And</span> <span m="3548060">it</span> <span m="3548200">can't</span> <span m="3549160">generate</span> <span m="3549540">all</span> <span m="3549760">IDs</span> <span m="3550180">in</span> <span m="3550290">sequence</span> <span m="3551080">and</span> <span m="3551230">try</span> <span m="3551460">them</span> <span m="3551580">against</span> <span m="3551880">this</span> <span m="3552030">table.</span> <span m="3552470">Because</span> <span m="3552860">the type is</span> <span m="3552980">abstract.</span> <span m="3553390">There's</span> <span m="3553800">no</span> <span m="3554020">way to</span> <span m="3554110">make</span> <span m="3554400">an</span> <span m="3554500">ID.</span> <span m="3554970">There's no way</span> <span m="3555400">to make</span> <span m="3555670">a</span> <span m="3555930">password.</span> <span m="3556180">They just</span> <span m="3556440">come out of</span> <span m="3556720">this</span> <span m="3556870">table,</span> <span m="3557310">and they're</span> <span m="3557585">opaque</span> <span m="3557860">tokens.</span> </p>
<p><span m="3562880">But</span> <span m="3563770">we</span> <span m="3563860">might</span> <span m="3564070">want</span> <span m="3564250">to</span> <span m="3564340">allow</span> <span m="3565350">them</span> <span m="3565520">to</span> <span m="3565600">be</span> <span m="3566050">input</span> <span m="3566820">from</span> <span m="3567270">strings.</span> <span m="3567640">You</span> <span m="3567720">might</span> <span m="3567910">want</span> <span m="3568070">to</span> <span m="3568130">allow</span> <span m="3568580">one</span> <span m="3568890">direction</span> <span m="3569280">of</span> <span m="3569380">conversion</span> <span m="3569900">between</span> <span m="3570230">strings</span> <span m="3570555">and these</span> <span m="3570880">types.</span> <span m="3571370">So</span> <span m="3571650">that's</span> <span m="3571880">what</span> <span m="3571970">I'll</span> <span m="3572110">do</span> <span m="3572220">here.</span> <span m="3573720">Basically,</span> <span m="3574250">the</span> <span m="3574340">details</span> <span m="3574650">I</span> <span m="3574960">don't</span> <span m="3575120">want</span> <span m="3575380">to</span> <span m="3575406">try</span> <span m="3575433">to</span> <span m="3575460">explain.</span> <span m="3575745">But</span> <span m="3576030">this</span> <span m="3576150">is</span> <span m="3576310">like</span> <span m="3576490">a</span> <span m="3577590">declaration,</span> <span m="3578550">OK,</span> <span m="3578910">you're</span> <span m="3579130">allowed</span> <span m="3579500">to</span> <span m="3579590">convert</span> <span m="3580010">strings</span> <span m="3580640">into</span> <span m="3581040">IDs.</span> <span m="3581275">For</span> <span m="3581510">those</span> <span m="3581810">who speak</span> <span m="3582110">Haskell,</span> <span m="3582600">this</span> <span m="3582760">is</span> <span m="3582890">a type</span> <span m="3583220">class</span> <span m="3583610">instant.</span> <span m="3584130">For</span> <span m="3584340">those</span> <span m="3584640">who don't,</span> <span m="3585360">it's</span> <span m="3586070">permission</span> <span m="3586530">to</span> <span m="3586630">turn</span> <span m="3586860">strings into</span> <span m="3587290">IDs.</span> </p>
<p><span m="3589290">We're</span> <span m="3589790">going to</span> <span m="3590010">leave</span> <span m="3590190">out</span> <span m="3590420">the other permission.</span> <span m="3591040">We</span> <span m="3591120">don't</span> <span m="3591250">want</span> <span m="3591390">to</span> <span m="3591450">be</span> <span m="3591560">able to</span> <span m="3591730">turn an</span> <span m="3591970">ID</span> <span m="3592240">back</span> <span m="3592680">into</span> <span m="3593400">anything.</span> <span m="3595980">And</span> <span m="3596900">the</span> <span m="3596980">password--</span> <span m="3597800">let's do</span> <span m="3598060">the</span> <span m="3598120">same</span> <span m="3598390">thing.</span> <span m="3598840">We</span> <span m="3598940">want</span> <span m="3599140">to</span> <span m="3599340">be</span> <span m="3599390">able</span> <span m="3599440">to</span> <span m="3599490">read</span> <span m="3599670">a</span> <span m="3599730">password</span> <span m="3599970">from</span> <span m="3600220">the user</span> <span m="3600760">but</span> <span m="3600900">not</span> <span m="3603966">take a password and</span> <span m="3604408">turn</span> <span m="3604496">it</span> <span m="3604584">into</span> <span m="3604673">a</span> <span m="3604761">string</span> <span m="3604850">where</span> <span m="3604956">we</span> <span m="3605063">can</span> <span m="3605170">actually</span> <span m="3605450">tell</span> <span m="3605700">what</span> <span m="3605790">the</span> <span m="3605880">user</span> <span m="3606315">entered.</span> </p>
<p><span m="3606750">So</span> <span m="3606860">other</span> <span m="3607090">parts</span> <span m="3607340">of</span> <span m="3607380">the</span> <span m="3607460">code</span> <span m="3607640">will</span> <span m="3607820">be</span> <span m="3607910">able</span> <span m="3608070">to</span> <span m="3608130">accept</span> <span m="3608480">password</span> <span m="3608900">input</span> <span m="3609460">from</span> <span m="3609630">the</span> <span m="3609750">user,</span> <span m="3610880">convert</span> <span m="3611320">it</span> <span m="3611660">into</span> <span m="3612080">this</span> <span m="3612340">type,</span> <span m="3613500">and</span> <span m="3613910">ship</span> <span m="3614110">it</span> <span m="3614190">off</span> <span m="3614430">to</span> <span m="3614750">the user</span> <span m="3614820">module</span> <span m="3615110">and</span> <span m="3615400">have</span> <span m="3615550">it</span> <span m="3615610">be</span> <span m="3615800">checked.</span> <span m="3616820">But what</span> <span m="3617060">they</span> <span m="3617150">can't</span> <span m="3617490">do</span> <span m="3617840">is</span> <span m="3618070">query</span> <span m="3618430">the</span> <span m="3618770">user</span> <span m="3618860">table</span> <span m="3619170">and</span> <span m="3619230">get</span> <span m="3619490">all</span> <span m="3619650">the</span> <span m="3619740">passwords</span> <span m="3620480">in</span> <span m="3620650">a</span> <span m="3620880">form where</span> <span m="3621246">they can</span> <span m="3621980">actually</span> <span m="3622310">extract</span> <span m="3622750">the text from them.</span> </p>
<p><span m="3625500">Then</span> <span m="3625835">we</span> <span m="3626170">can</span> <span m="3626230">have</span> <span m="3626450">a</span> <span m="3626560">login</span> <span m="3627080">method</span> <span m="3628070">that</span> <span m="3629350">takes</span> <span m="3629710">these</span> <span m="3629900">two</span> <span m="3630060">components</span> <span m="3632438">and</span> <span m="3632934">just</span> <span m="3633430">runs for</span> <span m="3633926">its</span> <span m="3634422">side effects,</span> <span m="3634918">which</span> <span m="3635414">is</span> <span m="3635910">effectively</span> <span m="3636406">what that code says.</span> <span m="3637398">We'll</span> <span m="3638000">also</span> <span m="3638200">need</span> <span m="3638370">a</span> <span m="3638430">way</span> <span m="3638590">to</span> <span m="3638700">tell</span> <span m="3639150">which user</span> <span m="3639540">is logged in.</span> <span m="3640814">That</span> <span m="3641306">is a code</span> <span m="3641798">that runs</span> <span m="3642290">a</span> <span m="3642782">transaction</span> <span m="3643274">that produces</span> <span m="3643766">an</span> <span m="3644258">ID.</span> </p>
<p><span m="3646730">All right,</span> <span m="3647220">so step</span> <span m="3647350">one,</span> <span m="3647580">we can just</span> <span m="3647940">copy</span> <span m="3648300">this</span> <span m="3648782">definition.</span> <span m="3654566">And</span> <span m="3655048">I'll fill in</span> <span m="3655530">what these</span> <span m="3655970">actually</span> <span m="3656340">are.</span> <span m="3656650">It turns</span> <span m="3657135">out--</span> <span m="3657620">surprise, surprise--</span> <span m="3658105">user IDs</span> <span m="3658590">and</span> <span m="3658750">passwords are</span> <span m="3659010">both</span> <span m="3659440">strings.</span> <span m="3659910">But</span> <span m="3660165">outside</span> <span m="3660780">the</span> <span m="3660840">module,</span> <span m="3661170">that</span> <span m="3661320">won't</span> <span m="3661450">be</span> <span m="3662310">exposed.</span> </p>
<p><span m="3663740">And</span> <span m="3664130">now</span> <span m="3664350">we're going to</span> <span m="3664730">create</span> <span m="3665040">a cookie.</span> <span m="3665330">So</span> <span m="3665790">cookies</span> <span m="3666190">are</span> <span m="3666390">another</span> <span m="3666650">thing that's</span> <span m="3666910">built</span> <span m="3667300">into the</span> <span m="3667390">language.</span> <span m="3669410">Effectively,</span> <span m="3669680">they</span> <span m="3670070">act</span> <span m="3670420">like</span> <span m="3670820">mutable</span> <span m="3671290">global</span> <span m="3671610">variables</span> <span m="3672220">that</span> <span m="3672680">have</span> <span m="3672970">one</span> <span m="3673230">copy</span> <span m="3673640">per</span> <span m="3673870">client</span> <span m="3674580">that uses</span> <span m="3674770">your</span> <span m="3675010">application.</span> <span m="3676400">So</span> <span m="3676780">we're</span> <span m="3676880">going</span> <span m="3676990">to</span> <span m="3677070">create</span> <span m="3677290">a</span> <span m="3677340">cookie</span> <span m="3677670">that</span> <span m="3678000">on</span> <span m="3678250">each</span> <span m="3678430">client</span> <span m="3678940">will</span> <span m="3679030">store</span> <span m="3680200">basically</span> <span m="3680700">just</span> <span m="3680720">a</span> <span m="3680980">copy</span> <span m="3681320">of</span> <span m="3681450">the</span> <span m="3681530">same</span> <span m="3682040">two</span> <span m="3682830">fields</span> <span m="3684102">that</span> <span m="3684490">we</span> <span m="3684620">have</span> <span m="3684780">here.</span> </p>
<p><span m="3685453">So</span> <span m="3685836">this</span> <span m="3686220">cookie is</span> <span m="3686390">private</span> <span m="3686930">to</span> <span m="3687010">this</span> <span m="3687170">module.</span> <span m="3687715">Other</span> <span m="3688400">parts</span> <span m="3688630">of</span> <span m="3688710">the</span> <span m="3688810">code</span> <span m="3689190">won't</span> <span m="3689400">be able</span> <span m="3689700">to</span> <span m="3689790">read the</span> <span m="3689930">cookie,</span> <span m="3690470">because</span> <span m="3690630">they</span> <span m="3690750">just</span> <span m="3690880">don't</span> <span m="3691050">have</span> <span m="3691290">this</span> <span m="3691760">private</span> <span m="3692100">field</span> <span m="3692450">and scope.</span> <span m="3693270">So</span> <span m="3693560">no</span> <span m="3693690">one</span> <span m="3693800">else</span> <span m="3693990">will</span> <span m="3694100">be</span> <span m="3694200">able</span> <span m="3694350">to</span> <span m="3694410">see</span> <span m="3694690">directly</span> <span m="3695170">the</span> <span m="3695530">ID</span> <span m="3695950">and</span> <span m="3696370">password</span> <span m="3696650">that</span> <span m="3696930">are</span> <span m="3697090">stored</span> <span m="3697580">for</span> <span m="3697630">this</span> <span m="3697780">user.</span> <span m="3698090">But</span> <span m="3698480">they</span> <span m="3698600">will</span> <span m="3698820">be</span> <span m="3699000">persisted</span> <span m="3699790">across</span> <span m="3700150">different</span> <span m="3700420">page views,</span> <span m="3700870">just</span> <span m="3701080">like</span> <span m="3701240">you would</span> <span m="3701670">expect</span> <span m="3701980">for</span> <span m="3702290">cookies</span> <span m="3702762">usually.</span> </p>
<p><span m="3705594">I'm</span> <span m="3706066">going</span> <span m="3706184">to</span> <span m="3706303">give</span> <span m="3706421">it</span> <span m="3706540">a</span> <span m="3706800">login</span> <span m="3707220">function</span> <span m="3707915">that's</span> <span m="3708170">going to</span> <span m="3708320">run</span> <span m="3708740">some</span> <span m="3710346">incantation</span> <span m="3711480">to</span> <span m="3711600">check</span> <span m="3712190">against</span> <span m="3712445">the</span> <span m="3712780">database</span> <span m="3713460">whether</span> <span m="3713690">this</span> <span m="3713900">is</span> <span m="3714050">really</span> <span m="3715522">a</span> <span m="3716020">correct</span> <span m="3716170">pair</span> <span m="3716640">of</span> <span m="3716990">username</span> <span m="3717436">and</span> <span m="3717882">password.</span> <span m="3718328">It'll just check,</span> <span m="3718774">can</span> <span m="3719220">we</span> <span m="3719670">find</span> <span m="3720100">a</span> <span m="3720160">row in</span> <span m="3720445">the</span> <span m="3720730">database</span> <span m="3722010">that</span> <span m="3722270">has</span> <span m="3722710">this</span> <span m="3722880">user</span> <span m="3723170">ID</span> <span m="3723989">and</span> <span m="3724478">has</span> <span m="3724967">this</span> <span m="3725456">password?</span> </p>
<p><span m="3730350">If</span> <span m="3730510">we find</span> <span m="3730600">one,</span> <span m="3730920">then</span> <span m="3731110">yes,</span> <span m="3731620">good,</span> <span m="3732080">that's</span> <span m="3732436">the</span> <span m="3732792">correct</span> <span m="3733150">value.</span> <span m="3733450">Let's</span> <span m="3733730">just save it</span> <span m="3733970">into the</span> <span m="3734440">cookie.</span> <span m="3735580">We</span> <span m="3735700">use</span> <span m="3735960">a</span> <span m="3736200">method</span> <span m="3736560">that</span> <span m="3737055">modifies</span> <span m="3737380">the</span> <span m="3737770">cookie</span> <span m="3738010">value.</span> <span m="3738390">And</span> <span m="3738480">we</span> <span m="3738570">have</span> <span m="3738913">to</span> <span m="3739256">put some</span> <span m="3739600">things</span> <span m="3739970">in here,</span> <span m="3740180">like</span> <span m="3741250">just</span> <span m="3741650">for simplicity,</span> <span m="3742050">I'll</span> <span m="3742500">say</span> <span m="3742610">this</span> <span m="3742810">cookie</span> <span m="3743010">never</span> <span m="3743260">expires.</span> <span m="3743960">And</span> <span m="3744430">I</span> <span m="3744900">don't</span> <span m="3745070">want</span> <span m="3745260">to</span> <span m="3745630">run</span> <span m="3745890">SSL</span> <span m="3746370">here,</span> <span m="3746660">so I'll</span> <span m="3746950">say</span> <span m="3747220">it</span> <span m="3747490">doesn't</span> <span m="3747710">need to</span> <span m="3747770">be</span> <span m="3747970">secure.</span> </p>
<p><span m="3749180">But</span> <span m="3750246">if you</span> <span m="3750610">really</span> <span m="3750910">care</span> <span m="3751100">about</span> <span m="3751370">security,</span> <span m="3752220">obviously</span> <span m="3752570">you would write</span> <span m="3753037">secure</span> <span m="3753504">equals</span> <span m="3753971">true.</span> <span m="3755840">And</span> <span m="3756240">if</span> <span m="3756680">the</span> <span m="3756790">check</span> <span m="3757040">failed, then</span> <span m="3757380">we</span> <span m="3757640">can--</span> <span m="3757920">I</span> <span m="3758235">don't</span> <span m="3758340">know.</span> <span m="3758445">It</span> <span m="3758550">doesn't</span> <span m="3758750">matter.</span> <span m="3759050">If it</span> <span m="3759270">signals an</span> <span m="3759580">error,</span> <span m="3760620">execution</span> <span m="3761150">stops</span> <span m="3761560">with</span> <span m="3761720">this</span> <span m="3761880">error</span> <span m="3761980">description.</span> </p>
<p><span m="3764720">Finally,</span> <span m="3765960">we</span> <span m="3766080">can</span> <span m="3766490">create</span> <span m="3766870">this</span> <span m="3767000">function</span> <span m="3767520">that</span> <span m="3767840">tells</span> <span m="3768340">who</span> <span m="3768550">the</span> <span m="3768990">user is</span> <span m="3769260">logged in</span> <span m="3769350">as</span> <span m="3769700">by</span> <span m="3769970">getting</span> <span m="3770230">the</span> <span m="3770320">current</span> <span m="3770630">cookie</span> <span m="3770850">value.</span> <span m="3771620">And</span> <span m="3771950">then</span> <span m="3774090">it</span> <span m="3774160">might</span> <span m="3774420">be</span> <span m="3774530">none</span> <span m="3776260">if</span> <span m="3776540">the</span> <span m="3776800">user</span> <span m="3777030">hasn't</span> <span m="3777320">logged</span> <span m="3777600">in</span> <span m="3777880">yet,</span> <span m="3778505">in</span> <span m="3778850">which</span> <span m="3778965">case,</span> <span m="3779080">we</span> <span m="3779195">can</span> <span m="3779310">have a</span> <span m="3779770">different</span> <span m="3779890">error</span> <span m="3780150">message.</span> <span m="3781870">Or</span> <span m="3782320">it</span> <span m="3782400">might</span> <span m="3782610">be</span> <span m="3782740">some</span> <span m="3783180">record</span> <span m="3783515">of</span> <span m="3784330">exactly</span> <span m="3784710">the</span> <span m="3784820">type</span> <span m="3785070">we</span> <span m="3785180">used</span> <span m="3785470">up</span> <span m="3785610">there.</span> <span m="3787018">So</span> <span m="3787087">I'll</span> <span m="3787156">just</span> <span m="3787225">copy</span> <span m="3787294">some</span> <span m="3787363">of</span> <span m="3787432">this</span> <span m="3787502">here.</span> <span m="3794762">Let's</span> <span m="3795246">run</span> <span m="3795730">the same</span> <span m="3796150">check</span> <span m="3796370">there.</span> <span m="3797110">If</span> <span m="3797595">it</span> <span m="3798080">worked,</span> <span m="3798216">then</span> <span m="3798353">we'll</span> <span m="3798490">just</span> <span m="3798740">return</span> <span m="3799730">the</span> <span m="3799840">ID</span> <span m="3800200">part</span> <span m="3800480">of</span> <span m="3800525">the</span> <span m="3800570">record</span> <span m="3801010">that we</span> <span m="3801220">just</span> <span m="3801480">verified</span> <span m="3802100">against</span> <span m="3802440">the database.</span> <span m="3805350">Otherwise,</span> <span m="3806530">[INAUDIBLE].</span> </p>
<p><span m="3814062">So</span> <span m="3814556">let</span> <span m="3815050">me</span> <span m="3815297">just</span> <span m="3815544">type check</span> <span m="3816038">this</span> <span m="3816532">to see if</span> <span m="3817026">this is</span> <span m="3817520">on</span> <span m="3818014">track,</span> <span m="3819496">that</span> <span m="3819990">part--</span> <span m="3822954">Oops,</span> <span m="3823448">capital</span> <span m="3824436">Id.</span> <span m="3833370">All right,</span> <span m="3833600">so</span> <span m="3833950">the</span> <span m="3834770">important</span> <span m="3835150">is</span> <span m="3835560">there's</span> <span m="3835740">all</span> <span m="3835950">those</span> <span m="3836260">implementation</span> <span m="3836850">details.</span> <span m="3837250">But</span> <span m="3837420">from</span> <span m="3837600">outside</span> <span m="3838050">this</span> <span m="3838180">module,</span> <span m="3838520">we</span> <span m="3838630">think</span> <span m="3838820">of</span> <span m="3838893">it</span> <span m="3838966">in</span> <span m="3839040">terms</span> <span m="3839280">of</span> <span m="3839330">the</span> <span m="3839530">interface</span> <span m="3839935">up</span> <span m="3840340">there.</span> <span m="3840990">There</span> <span m="3841420">are</span> <span m="3841530">some</span> <span m="3841760">unknown</span> <span m="3842210">types</span> <span m="3842530">of</span> <span m="3842600">IDs</span> <span m="3843010">and</span> <span m="3843100">passwords.</span> </p>
<p><span m="3843660">This</span> <span m="3843890">table</span> <span m="3844170">of</span> <span m="3844450">users</span> <span m="3845020">expressed</span> <span m="3845420">in</span> <span m="3845480">terms</span> <span m="3845750">of</span> <span m="3845840">them</span> <span m="3846780">were</span> <span m="3846960">allowed</span> <span m="3847090">to</span> <span m="3847220">turn</span> <span m="3847480">strings</span> <span m="3848090">into</span> <span m="3848440">IDs</span> <span m="3848460">and</span> <span m="3848810">passwords,</span> <span m="3849360">but not the</span> <span m="3849620">other</span> <span m="3849790">way</span> <span m="3850240">around.</span> <span m="3851280">And</span> <span m="3851700">we</span> <span m="3851790">have</span> <span m="3851960">these</span> <span m="3852100">two</span> <span m="3852230">methods</span> <span m="3852620">to</span> <span m="3852730">log</span> <span m="3853050">in</span> <span m="3853190">in</span> <span m="3853235">the</span> <span m="3853280">first</span> <span m="3853530">place</span> <span m="3853795">and</span> <span m="3854060">to</span> <span m="3854420">check</span> <span m="3854740">which</span> <span m="3854920">user is</span> <span m="3855280">logged in</span> <span m="3855540">at this</span> <span m="3856016">point.</span> <span m="3858872">Any question</span> <span m="3859348">about this?</span> <span m="3859830">Yeah.</span> </p>
<p><span m="3860255">STUDENT: Do you</span> <span m="3860520">need</span> <span m="3860750">to</span> <span m="3861130">expose</span> <span m="3861390">the</span> <span m="3861650">user</span> <span m="3862126">table?</span> </p>
<p><span m="3865460">ADAM CHLIPALA: Because</span> <span m="3865740">I</span> <span m="3865780">want</span> <span m="3865930">to</span> <span m="3865990">use</span> <span m="3866210">it as</span> <span m="3866330">a</span> <span m="3866380">foreign</span> <span m="3866750">key later.</span> <span m="3867135">That was the</span> <span m="3867520">reason</span> <span m="3868012">I did it.</span> <span m="3868504">It's</span> <span m="3868996">not that great</span> <span m="3869488">of a</span> <span m="3869980">reason.</span> <span m="3874408">All right,</span> <span m="3874910">so</span> <span m="3875080">we're</span> <span m="3875580">almost</span> <span m="3875910">at</span> <span m="3875980">the</span> <span m="3876050">point</span> <span m="3876290">where</span> <span m="3876386">I</span> <span m="3876483">can</span> <span m="3876580">show</span> <span m="3876770">you</span> <span m="3877630">CSRF</span> <span m="3878010">protection in</span> <span m="3878440">action.</span> </p>
<p><span m="3878510">We</span> <span m="3878820">have</span> <span m="3879230">to</span> <span m="3879280">actually</span> <span m="3879490">start</span> <span m="3879800">logging</span> <span m="3880600">in.</span> <span m="3881090">So</span> <span m="3881580">that's</span> <span m="3882070">easy</span> <span m="3882560">enough</span> <span m="3883050">to</span> <span m="3883540">do.</span> <span m="3890400">OK,</span> <span m="3891390">so</span> <span m="3891730">what can we</span> <span m="3892220">do</span> <span m="3892420">here?</span> <span m="3892720">Let's</span> <span m="3893217">just</span> <span m="3893714">add</span> <span m="3893796">another</span> <span m="3893879">part</span> <span m="3893962">of</span> <span m="3894045">this</span> <span m="3894128">page</span> <span m="3895702">that</span> <span m="3896199">says,</span> <span m="3896696">here's</span> <span m="3897193">where you</span> <span m="3897690">log</span> <span m="3898187">in.</span> <span m="3902660">This</span> <span m="3902825">is</span> <span m="3902991">the</span> <span m="3903157">form.</span> </p>
<p><span m="3911109">This is</span> <span m="3911606">where you would</span> <span m="3912103">put</span> <span m="3912202">the</span> <span m="3912301">username</span> <span m="3912401">and</span> <span m="3912500">the</span> <span m="3912600">password.</span> <span m="3922540">And then</span> <span m="3923090">click</span> <span m="3923500">on the</span> <span m="3923910">button.</span> <span m="3924405">It's</span> <span m="3924900">trying</span> <span m="3925065">to</span> <span m="3925230">go</span> <span m="3925395">to</span> <span m="3925890">call</span> <span m="3926015">a</span> <span m="3926140">function</span> <span m="3926430">called</span> <span m="3926675">login,</span> <span m="3926920">which</span> <span m="3927410">we'll</span> <span m="3927900">define</span> <span m="3928390">in a</span> <span m="3928880">moment.</span> <span m="3936230">Let's</span> <span m="3936720">define</span> <span m="3937210">login</span> <span m="3937700">as a</span> <span m="3938190">function</span> <span m="3938680">that</span> <span m="3939170">does</span> <span m="3940150">these</span> <span m="3940640">things.</span> <span m="3943090">It's</span> <span m="3943610">actually</span> <span m="3943890">just</span> <span m="3944080">a</span> <span m="3944140">wrapper</span> <span m="3944700">around</span> <span m="3945180">calling</span> <span m="3947070">the</span> <span m="3947200">login</span> <span m="3947580">function</span> <span m="3947990">from</span> <span m="3948040">that</span> <span m="3948200">module</span> <span m="3948690">where</span> <span m="3949080">we</span> <span m="3949450">take</span> <span m="3949720">each</span> <span m="3950060">of</span> <span m="3950415">the</span> <span m="3950770">components</span> <span m="3951270">and</span> <span m="3951760">convert</span> <span m="3952055">it</span> <span m="3952350">from</span> <span m="3952670">string</span> <span m="3953065">to the</span> <span m="3953460">abstract</span> <span m="3953950">types.</span> </p>
<p><span m="3954440">That's what</span> <span m="3954570">read error</span> <span m="3954980">is</span> <span m="3955140">doing.</span> <span m="3955720">Error</span> <span m="3956180">means</span> <span m="3956220">if</span> <span m="3956260">it</span> <span m="3956300">doesn't</span> <span m="3956570">work,</span> <span m="3956840">just</span> <span m="3957000">abort</span> <span m="3957330">execution</span> <span m="3958090">instead</span> <span m="3958370">of</span> <span m="3958700">signaling</span> <span m="3959190">the</span> <span m="3959310">failure</span> <span m="3959585">with a</span> <span m="3959860">special</span> <span m="3960351">return</span> <span m="3960842">value.</span> <span m="3964279">Here's both</span> <span m="3964770">of those,</span> <span m="3965080">login</span> <span m="3965600">and</span> <span m="3965870">then jump</span> <span m="3966150">to main.</span> <span m="3966925">So now</span> <span m="3967360">we</span> <span m="3967630">should be</span> <span m="3967810">able to log</span> <span m="3968030">in.</span> <span m="3968848">Let's check if</span> <span m="3969316">that's</span> <span m="3969784">true.</span> </p>
<p><span m="3973160">OK,</span> <span m="3973651">so that</span> <span m="3974142">was</span> <span m="3975615">[INAUDIBLE].</span> <span m="3982500">We'll</span> <span m="3982680">probably want</span> <span m="3982840">to</span> <span m="3982910">create an</span> <span m="3983310">account</span> <span m="3983590">to allow</span> <span m="3984085">us</span> <span m="3984580">to log</span> <span m="3985075">in.</span> <span m="3985570">So</span> <span m="3986065">let me</span> <span m="3987055">[INAUDIBLE].</span> <span m="3994655">So now</span> <span m="3995140">I</span> <span m="3995210">should be</span> <span m="3995450">able to</span> <span m="3995620">log in</span> <span m="3995905">as</span> <span m="3996190">a.</span> <span m="3999022">OK,</span> <span m="3999500">and</span> <span m="3999750">take my</span> <span m="3999820">word for it.</span> <span m="4000360">There's</span> <span m="4000590">now a</span> <span m="4001040">cookie</span> <span m="4001400">set</span> <span m="4003750">to</span> <span m="4004000">record</span> <span m="4004490">that</span> <span m="4004620">information.</span> </p>
<p><span m="4005666">And</span> <span m="4006152">then let's go back in the chat</span> <span m="4006640">room</span> <span m="4006735">and</span> <span m="4006830">send</span> <span m="4006925">a</span> <span m="4007020">message.</span> <span m="4007510">We</span> <span m="4007710">didn't</span> <span m="4007870">actually</span> <span m="4008160">add any</span> <span m="4008400">access</span> <span m="4008760">control</span> <span m="4009080">here</span> <span m="4009450">yet.</span> <span m="4010300">So</span> <span m="4010740">there's</span> <span m="4010860">not</span> <span m="4010980">much</span> <span m="4011100">going</span> <span m="4011300">on</span> <span m="4011430">here.</span> <span m="4011880">But</span> <span m="4012130">we</span> <span m="4012680">can</span> <span m="4012920">check to see.</span> </p>
<p><span m="4013970">There's</span> <span m="4014140">a</span> <span m="4014200">cookie.</span> <span m="4014560">But</span> <span m="4014950">the</span> <span m="4015040">system</span> <span m="4015560">has</span> <span m="4015720">determined</span> <span m="4016430">that</span> <span m="4016670">we're</span> <span m="4016750">not</span> <span m="4017070">using</span> <span m="4017400">the</span> <span m="4017500">cookie.</span> <span m="4018970">When</span> <span m="4019300">we</span> <span m="4019630">submit</span> <span m="4019760">this</span> <span m="4019920">form,</span> <span m="4020310">the cookie</span> <span m="4020430">is not</span> <span m="4020800">read.</span> <span m="4021500">So</span> <span m="4021630">there's</span> <span m="4021820">actually</span> <span m="4022150">no need</span> <span m="4022610">to</span> <span m="4022690">add</span> <span m="4022890">any</span> <span m="4023490">CSRF</span> <span m="4023860">protection</span> <span m="4024390">here</span> <span m="4024580">yet.</span> <span m="4024992">So</span> <span m="4025404">now we</span> <span m="4025816">have</span> <span m="4025953">to</span> <span m="4026090">add</span> <span m="4026228">the</span> <span m="4026640">way to</span> <span m="4026830">use</span> <span m="4027080">the</span> <span m="4027280">cookie.</span> <span m="4027670">And then we should see</span> <span m="4027890">the</span> <span m="4028090">protection</span> <span m="4028540">appear.</span> <span m="4029018">Yeah.</span> </p>
<p><span m="4029974">STUDENT: What</span> <span m="4030053">are</span> <span m="4030133">the</span> <span m="4030213">contents</span> <span m="4030292">of</span> <span m="4030372">the</span> <span m="4030452">cookie?</span> </p>
<p><span m="4030930">ADAM CHLIPALA: What</span> <span m="4031410">are the</span> <span m="4031670">contents of the</span> <span m="4031840">cookie?</span> <span m="4032265">The</span> <span m="4032690">contents</span> <span m="4033115">are</span> <span m="4033185">exactly</span> <span m="4033256">what</span> <span m="4033327">you'd</span> <span m="4033398">expect</span> <span m="4033469">from</span> <span m="4033540">the</span> <span m="4034000">code.</span> <span m="4035130">In</span> <span m="4035410">other</span> <span m="4035550">words,</span> <span m="4036040">the</span> <span m="4036060">cookie</span> <span m="4036440">is</span> <span m="4036590">declared</span> <span m="4037840">as</span> <span m="4039430">having</span> <span m="4039700">type</span> <span m="4040380">this</span> <span m="4040540">record,</span> <span m="4040980">an ID,</span> <span m="4041427">and a password.</span> <span m="4042321">So</span> <span m="4042770">that's</span> <span m="4042825">exactly</span> <span m="4042880">what's</span> <span m="4042935">in</span> <span m="4042990">there</span> <span m="4043045">in a</span> <span m="4043320">particular</span> <span m="4043780">serialized</span> <span m="4044050">form.</span> </p>
<p><span m="4049930">So</span> <span m="4050630">now</span> <span m="4050800">let's</span> <span m="4051000">actually</span> <span m="4051230">use the</span> <span m="4051500">cookie.</span> <span m="4052000">And</span> <span m="4052350">we</span> <span m="4052720">should hopefully</span> <span m="4052850">see</span> <span m="4053700">despite</span> <span m="4054080">the fact</span> <span m="4054310">we're going to</span> <span m="4054490">use</span> <span m="4054720">the</span> <span m="4054860">cookie</span> <span m="4056410">indirectly,</span> <span m="4057260">because</span> <span m="4057630">we're</span> <span m="4057770">going</span> <span m="4057870">to</span> <span m="4057910">use</span> <span m="4058120">it</span> <span m="4058210">in</span> <span m="4058310">the</span> <span m="4058420">room</span> <span m="4058660">module,</span> <span m="4059230">which</span> <span m="4059390">doesn't</span> <span m="4059620">even</span> <span m="4059810">have</span> <span m="4060070">the cookie</span> <span m="4060350">in</span> <span m="4060540">scope.</span> <span m="4060820">But</span> <span m="4061100">we'll</span> <span m="4061260">call</span> <span m="4061520">methods</span> <span m="4061830">of</span> <span m="4062140">the</span> <span m="4063140">user</span> <span m="4063240">module,</span> <span m="4064160">which</span> <span m="4064310">indirectly</span> <span m="4064800">are</span> <span m="4064870">using</span> <span m="4065110">the</span> <span m="4065220">cookie.</span> <span m="4065550">And then</span> <span m="4065760">the</span> <span m="4065830">system</span> <span m="4066090">will</span> <span m="4066210">realize</span> <span m="4066630">that</span> <span m="4066770">means</span> <span m="4066970">we</span> <span m="4067070">have</span> <span m="4067270">dependency</span> <span m="4067750">on it.</span> </p>
<p><span m="4068710">So</span> <span m="4069190">let's</span> <span m="4069380">make</span> <span m="4069550">this</span> <span m="4069700">really</span> <span m="4069890">simple</span> <span m="4070760">and</span> <span m="4070980">just</span> <span m="4071170">say</span> <span m="4075671">call</span> <span m="4076150">the</span> <span m="4076550">whoami</span> <span m="4076950">method.</span> <span m="4080430">And</span> <span m="4080970">I'm</span> <span m="4081080">actually</span> <span m="4081410">just</span> <span m="4081476">going</span> <span m="4081543">to</span> <span m="4081610">ignore</span> <span m="4082200">this.</span> <span m="4082520">Or</span> <span m="4082840">we</span> <span m="4083110">can</span> <span m="4083420">do</span> <span m="4083630">this.</span> <span m="4084320">Let's</span> <span m="4084540">decide</span> <span m="4085490">this</span> <span m="4085650">a</span> <span m="4085905">user we</span> <span m="4086160">created</span> <span m="4086430">is</span> <span m="4086700">really</span> <span m="4086930">special.</span> <span m="4087710">And</span> <span m="4090190">only</span> <span m="4090380">this</span> <span m="4090750">user</span> <span m="4091060">is</span> <span m="4091130">allowed</span> <span m="4091440">to</span> <span m="4091510">post</span> <span m="4092439">anything.</span> <span m="4098427">And</span> <span m="4098926">we'll</span> <span m="4099425">fail</span> <span m="4099924">if</span> <span m="4100922">we're not</span> <span m="4101421">a.</span> <span m="4102419">All right,</span> <span m="4102918">let's see</span> <span m="4103417">if this</span> <span m="4103916">works.</span> <span m="4105413">Did</span> <span m="4105912">I forget a slash somewhere?</span> <span m="4106910">Oh,</span> <span m="4107908">yeah.</span> <span m="4115393">[INAUDIBLE].</span> </p>
<p></p>
<p><span m="4128367">Oh, I</span> <span m="4128880">expect</span> <span m="4129340">him</span> <span m="4129560">to</span> <span m="4129620">be</span> <span m="4129790">a</span> <span m="4130074">string.</span> <span m="4131120">But</span> <span m="4132859">it's</span> <span m="4133020">actually</span> <span m="4133370">an</span> <span m="4133460">ID.</span> <span m="4133910">So</span> <span m="4134140">let's</span> <span m="4135020">just</span> <span m="4136630">read</span> <span m="4136979">a</span> <span m="4137773">into an</span> <span m="4138170">ID</span> <span m="4138910">just</span> <span m="4139120">like</span> <span m="4139310">we</span> <span m="4139410">did</span> <span m="4139609">below</span> <span m="4139979">to</span> <span m="4140180">process</span> <span m="4140760">login.</span> <span m="4143670">And</span> <span m="4143890">we</span> <span m="4144000">haven't</span> <span m="4144250">exposed</span> <span m="4144729">that</span> <span m="4144970">the</span> <span m="4145100">ID</span> <span m="4145510">type</span> <span m="4145770">supports</span> <span m="4146310">equality</span> <span m="4147220">testing.</span> <span m="4147729">So</span> <span m="4148080">I'll just</span> <span m="4148430">add</span> <span m="4148543">that</span> <span m="4148656">to</span> <span m="4148770">the</span> <span m="4149442">user</span> <span m="4149855">module.</span> <span m="4150540">And</span> <span m="4150800">then that should</span> <span m="4151189">work.</span> </p>
<p><span m="4153080">ID</span> <span m="4154680">supports</span> <span m="4155210">equality</span> <span m="4155685">testing.</span> <span m="4156160">And we should</span> <span m="4156510">be</span> <span m="4156835">OK.</span> <span m="4158948">So</span> <span m="4159399">now</span> <span m="4159580">we've</span> <span m="4159760">brought</span> <span m="4160119">in the</span> <span m="4160479">interface.</span> <span m="4160920">Now</span> <span m="4161250">we</span> <span m="4161296">can</span> <span m="4161343">do</span> <span m="4161390">more</span> <span m="4161600">things</span> <span m="4161840">with</span> <span m="4161939">the</span> <span m="4162160">ID,</span> <span m="4163152">which could</span> <span m="4163648">trigger some</span> <span m="4164144">security</span> <span m="4164640">issues.</span> <span m="4165136">But</span> <span m="4165632">it</span> <span m="4166128">lets</span> <span m="4166624">us add this</span> <span m="4167120">access</span> <span m="4167616">control check, so let's see how that</span> <span m="4168112">works,</span> <span m="4173072">go</span> <span m="4173568">back to</span> <span m="4174064">the main page</span> <span m="4174560">to</span> <span m="4175056">[INAUDIBLE].</span> </p>
<p><span m="4185472">All right,</span> <span m="4186010">now</span> <span m="4186405">the</span> <span m="4186800">form</span> <span m="4187220">automatically</span> <span m="4187770">has</span> <span m="4188000">a</span> <span m="4188430">hidden</span> <span m="4189200">input name</span> <span m="4189420">sig,</span> <span m="4190370">which</span> <span m="4190550">is</span> <span m="4190689">a</span> <span m="4190939">cryptographic</span> <span m="4191640">signature</span> <span m="4191999">of the</span> <span m="4192359">values</span> <span m="4192990">of</span> <span m="4193279">all</span> <span m="4193544">of the</span> <span m="4193810">cookies.</span> <span m="4194890">And</span> <span m="4196460">it's</span> <span m="4197220">signed</span> <span m="4197490">using</span> <span m="4198000">a</span> <span m="4198110">key</span> <span m="4198560">that's a</span> <span m="4198690">secret</span> <span m="4199300">for</span> <span m="4199390">the</span> <span m="4199490">server.</span> <span m="4200380">And</span> <span m="4200810">when</span> <span m="4200950">the</span> <span m="4201050">form</span> <span m="4201320">is</span> <span m="4201400">submitted,</span> <span m="4202490">the</span> <span m="4203030">application</span> <span m="4204110">knows,</span> <span m="4204890">because</span> <span m="4205190">the</span> <span m="4205600">compiler</span> <span m="4205880">told</span> <span m="4206140">it,</span> <span m="4206360">that</span> <span m="4206500">it</span> <span m="4206620">should</span> <span m="4206750">be</span> <span m="4206910">checking</span> <span m="4207340">signatures</span> <span m="4207980">for</span> <span m="4208285">the</span> <span m="4208590">following</span> <span m="4209130">set</span> <span m="4209340">of</span> <span m="4209440">operations.</span> <span m="4210170">In</span> <span m="4210220">this</span> <span m="4210380">case,</span> <span m="4210640">the</span> <span m="4210750">only</span> <span m="4210960">one</span> <span m="4211150">is</span> <span m="4211390">this</span> <span m="4212060">say</span> <span m="4212370">operation.</span> <span m="4213480">Yeah.</span> </p>
<p><span m="4213960">STUDENT: Does</span> <span m="4214530">the</span> <span m="4214610">signature</span> <span m="4214910">have</span> <span m="4215210">any sort of</span> <span m="4215647">time</span> <span m="4216084">stamp</span> <span m="4216521">as well?</span> </p>
<p><span m="4218270">ADAM CHLIPALA: It</span> <span m="4218430">does not</span> <span m="4218900">have</span> <span m="4219030">a</span> <span m="4219150">time</span> <span m="4219500">stamp.</span> </p>
<p><span m="4219785">STUDENT: Otherwise,</span> <span m="4220070">if</span> <span m="4220390">the</span> <span m="4220650">attacker</span> <span m="4220910">ever</span> <span m="4221399">saw</span> <span m="4221888">this</span> <span m="4222377">live,</span> <span m="4222866">they could</span> <span m="4223355">pretend to be the user.</span> <span m="4225311">It</span> <span m="4225800">never</span> <span m="4226290">expires.</span> </p>
<p><span m="4227010">ADAM CHLIPALA: It</span> <span m="4227510">never</span> <span m="4228010">expires,</span> <span m="4228510">right.</span> <span m="4229140">So that's</span> <span m="4229970">something</span> <span m="4230150">that</span> <span m="4230250">could</span> <span m="4230420">be</span> <span m="4230570">changed</span> <span m="4232270">just</span> <span m="4232470">by</span> <span m="4232900">modifying</span> <span m="4233330">the</span> <span m="4233420">language</span> <span m="4233760">implementation</span> <span m="4234020">without</span> <span m="4234764">modifying</span> <span m="4235248">the</span> <span m="4235732">applications,</span> <span m="4236216">and</span> <span m="4236700">then deployed</span> <span m="4237184">instantly.</span> <span m="4237668">But it's</span> <span m="4238152">not</span> <span m="4238636">there now.</span> <span m="4239120">And</span> <span m="4239216">I</span> <span m="4239313">can</span> <span m="4239410">see</span> <span m="4239507">why</span> <span m="4239604">that</span> <span m="4239765">could</span> <span m="4239926">be</span> <span m="4240088">a</span> <span m="4240572">useful thing</span> <span m="4241056">to add.</span> <span m="4243476">Question,</span> <span m="4244444">yeah.</span> </p>
<p><span m="4244928">STUDENT: You</span> <span m="4245430">could also</span> <span m="4245760">fix that</span> <span m="4246150">by just</span> <span m="4246385">putting</span> <span m="4246620">an</span> <span m="4247090">[INAUDIBLE]</span> <span m="4248030">as</span> <span m="4248500">well.</span> </p>
<p><span m="4249440">ADAM CHLIPALA: That's</span> <span m="4249910">true.</span> <span m="4250780">You're</span> <span m="4250830">right,</span> <span m="4250880">you</span> <span m="4250930">can</span> <span m="4251060">change</span> <span m="4251320">the</span> <span m="4251390">application</span> <span m="4251730">to</span> <span m="4252070">purposely</span> <span m="4252530">modify</span> <span m="4253415">the</span> <span m="4253720">cookie</span> <span m="4253940">data</span> <span m="4254250">frequently</span> <span m="4254590">enough</span> <span m="4254750">that</span> <span m="4255030">the</span> <span m="4255120">signature</span> <span m="4255580">would go out of</span> <span m="4256077">date.</span> <span m="4256574">That's</span> <span m="4257071">also</span> <span m="4257568">true.</span> <span m="4270000">So</span> <span m="4270120">we've</span> <span m="4270270">got</span> <span m="4270660">10</span> <span m="4270790">minutes</span> <span m="4271070">left.</span> <span m="4271860">Any</span> <span m="4272340">requests</span> <span m="4272840">for</span> <span m="4272940">things</span> <span m="4273240">that</span> <span m="4273440">someone</span> <span m="4273920">particularly</span> <span m="4274110">wants</span> <span m="4274340">to</span> <span m="4274440">see</span> <span m="4274670">before class</span> <span m="4275122">is</span> <span m="4275574">over?</span> <span m="4279190">I</span> <span m="4279340">can start</span> <span m="4279730">showing some</span> <span m="4280180">Ajax</span> <span m="4280580">stuff</span> <span m="4281040">by</span> <span m="4281485">default</span> <span m="4281930">if</span> <span m="4282060">no one</span> <span m="4282520">has</span> <span m="4282850">another</span> <span m="4283836">request.</span> <span m="4290245">Yeah.</span> </p>
<p><span m="4291231">STUDENT: Can you</span> <span m="4291724">remap</span> <span m="4292217">the</span> <span m="4292710">URLs?</span> </p>
<p><span m="4295190">ADAM CHLIPALA: You can, yes.</span> <span m="4296854">So</span> <span m="4297660">what</span> <span m="4297830">remapping</span> <span m="4298140">would</span> <span m="4298300">you</span> <span m="4298370">like</span> <span m="4298500">to see?</span> </p>
<p><span m="4299967">STUDENT: Any.</span> <span m="4300211">I</span> <span m="4300456">just want</span> <span m="4300945">to see how it's</span> <span m="4301434">done.</span> </p>
<p><span m="4301923">ADAM CHLIPALA: OK,</span> <span m="4303880">so</span> <span m="4305060">the</span> <span m="4305270">compiler</span> <span m="4305630">is</span> <span m="4305730">assigning--</span> <span m="4306590">as</span> <span m="4306960">we</span> <span m="4307060">can see</span> <span m="4307490">back</span> <span m="4307700">over</span> <span m="4307820">here,</span> <span m="4308210">we</span> <span m="4308560">called</span> <span m="4308780">the</span> <span m="4308850">say</span> <span m="4309100">function.</span> <span m="4309460">And</span> <span m="4309520">basically,</span> <span m="4309890">that</span> <span m="4310090">function</span> <span m="4310390">call is</span> <span m="4310660">serialized</span> <span m="4311260">as</span> <span m="4311400">a</span> <span m="4311540">particular</span> <span m="4311870">URL</span> <span m="4312270">form.</span> <span m="4312590">Maybe</span> <span m="4312770">we</span> <span m="4312860">don't</span> <span m="4313020">like</span> <span m="4313220">that</span> <span m="4313470">form.</span> <span m="4314560">We</span> <span m="4314970">decide</span> <span m="4315390">we're</span> <span m="4315510">going</span> <span m="4315830">to</span> <span m="4316982">rewrite</span> <span m="4317730">URL</span> <span m="4319770">so</span> <span m="4320220">say</span> <span m="4320615">is</span> <span m="4321010">inside</span> <span m="4322210">the</span> <span m="4322630">room</span> <span m="4323470">module,</span> <span m="4325990">inside demo.</span> </p>
<p><span m="4327696">Better</span> <span m="4328149">put</span> <span m="4328602">this up top</span> <span m="4329055">so</span> <span m="4329508">it</span> <span m="4329961">runs</span> <span m="4330414">before</span> <span m="4330870">these</span> <span m="4331040">other</span> <span m="4331310">rewrites--</span> <span m="4332252">rewrite</span> <span m="4332714">url</span> <span m="4333176">Demo/Room/say</span> <span m="4334620">into</span> <span m="4337590">Demo/Room/speak.</span> <span m="4342045">And</span> <span m="4342540">hopefully</span> <span m="4343035">that's what</span> <span m="4344025">I</span> <span m="4344520">want</span> <span m="4345015">it</span> <span m="4345510">to.</span> <span m="4346005">Let's</span> <span m="4346500">see</span> <span m="4346995">what</span> <span m="4347490">happens.</span> <span m="4354915">Yep,</span> <span m="4357420">and you</span> <span m="4357610">can</span> <span m="4357880">have</span> <span m="4358150">wild</span> <span m="4358470">cards</span> <span m="4358800">in those</span> <span m="4359274">rules</span> <span m="4359748">also</span> <span m="4360222">to map one prefix to another</span> <span m="4360696">one.</span> </p>
<p><span m="4364490">And</span> <span m="4364650">the</span> <span m="4364950">compiler</span> <span m="4365205">will</span> <span m="4365460">enforce</span> <span m="4365720">that</span> <span m="4365980">every</span> <span m="4366830">function</span> <span m="4367100">has</span> <span m="4367290">a</span> <span m="4367665">distinct</span> <span m="4368040">URL</span> <span m="4368320">schema.</span> <span m="4369620">So</span> <span m="4369840">if you</span> <span m="4370050">add</span> <span m="4370310">a</span> <span m="4370673">rule that</span> <span m="4371036">causes a</span> <span m="4371400">clash,</span> <span m="4371890">you'll get</span> <span m="4372378">[INAUDIBLE].</span> <span m="4373842">By</span> <span m="4374330">default,</span> <span m="4374818">the automatically</span> <span m="4375306">generated</span> <span m="4375794">URL</span> <span m="4376282">schemes</span> <span m="4376770">are</span> <span m="4377746">[INAUDIBLE].</span> <span m="4378722">You</span> <span m="4379210">can break</span> <span m="4379698">that by</span> <span m="4380186">using this</span> <span m="4380674">feature.</span> <span m="4383602">Any</span> <span m="4384090">other</span> <span m="4384578">requests?</span> <span m="4386530">Yeah.</span> </p>
<p><span m="4387018">STUDENT: So</span> <span m="4387510">you mentioned</span> <span m="4388050">that</span> <span m="4391110">the</span> <span m="4391370">HTML</span> <span m="4392570">[INAUDIBLE]</span> <span m="4393220">is</span> <span m="4393900">not</span> <span m="4394380">compiler</span> <span m="4394800">specific.</span> <span m="4395110">It's</span> <span m="4395420">like</span> <span m="4395745">one is a</span> <span m="4396070">library.</span> <span m="4396335">Are there</span> <span m="4396600">other libraries</span> <span m="4396910">for</span> <span m="4397190">other</span> <span m="4397470">formats</span> <span m="4397944">as</span> <span m="4398418">well?</span> </p>
<p><span m="4400790">ADAM CHLIPALA: There</span> <span m="4401120">are</span> <span m="4401430">other</span> <span m="4401570">libraries</span> <span m="4402760">that</span> <span m="4403110">don't</span> <span m="4403480">do</span> <span m="4404180">type</span> <span m="4404390">checking</span> <span m="4404900">at</span> <span m="4405110">the</span> <span m="4405507">same</span> <span m="4406301">level</span> <span m="4406700">of</span> <span m="4407080">richness.</span> <span m="4407460">But</span> <span m="4407680">for</span> <span m="4407830">instance,</span> <span m="4408180">there's</span> <span m="4408330">a</span> <span m="4408380">library</span> <span m="4408810">for</span> <span m="4410550">serializing</span> <span m="4410910">and</span> <span m="4411270">de-serializing</span> <span m="4412150">JSON.</span> <span m="4412580">And</span> <span m="4413010">most</span> <span m="4413143">of</span> <span m="4413276">the</span> <span m="4413410">automated</span> <span m="4413870">way</span> <span m="4414050">that's</span> <span m="4414440">driven</span> <span m="4414760">by</span> <span m="4415196">type structure.</span> <span m="4416940">So</span> <span m="4417200">you</span> <span m="4417320">can</span> <span m="4417430">do</span> <span m="4417560">things</span> <span m="4417770">like</span> <span m="4417940">that</span> <span m="4418644">that</span> <span m="4419138">aren't</span> <span m="4419632">as</span> <span m="4420126">integrated</span> <span m="4420620">with the compiler.</span> <span m="4427042">Yeah.</span> </p>
<p><span m="4427540">STUDENT: Presumably</span> <span m="4427940">you'd</span> <span m="4428340">still</span> <span m="4428595">want</span> <span m="4428850">to</span> <span m="4429070">write</span> <span m="4429512">JavaScript.</span> <span m="4430396">Is</span> <span m="4430838">there</span> <span m="4431280">any--</span> </p>
<p><span m="4432435">ADAM CHLIPALA: I</span> <span m="4432760">don't.</span> <span m="4433678">You</span> <span m="4434176">do.</span> </p>
<p><span m="4434674">STUDENT: Right,</span> <span m="4435172">no,</span> <span m="4435670">but</span> <span m="4436168">for,</span> <span m="4436666">say,</span> <span m="4437164">I don't</span> <span m="4437662">know,</span> <span m="4438160">you want to</span> <span m="4438658">animate</span> <span m="4438757">things</span> <span m="4438857">on</span> <span m="4438956">the</span> <span m="4439056">page.</span> <span m="4439654">There</span> <span m="4440152">are still</span> <span m="4440650">things</span> <span m="4441148">where--</span> </p>
<p><span m="4441646">ADAM CHLIPALA: Let</span> <span m="4442144">me load the Ajax</span> <span m="4442642">version of this.</span> <span m="4443140">And</span> <span m="4443638">that might answer</span> <span m="4444136">your</span> <span m="4444634">question.</span> <span m="4448120">[INAUDIBLE].</span> </p>
<p></p>
<p><span m="4469036">All right,</span> <span m="4469534">so this version</span> <span m="4470032">has</span> <span m="4470530">client side</span> <span m="4471028">code.</span> <span m="4471526">Let's</span> <span m="4472024">just</span> <span m="4473020">[INAUDIBLE].</span> </p>
<p></p>
<p><span m="4481010">Believe it or</span> <span m="4481110">not,</span> <span m="4481965">this</span> <span m="4482320">time</span> <span m="4482660">the</span> <span m="4482950">add worked</span> <span m="4483290">by an</span> <span m="4483750">Ajax</span> <span m="4484010">call.</span> <span m="4485946">And</span> <span m="4489340">you</span> <span m="4489550">get</span> <span m="4489810">things</span> <span m="4490115">like,</span> <span m="4491020">here's</span> <span m="4491180">a</span> <span m="4491230">button</span> <span m="4491630">tag.</span> <span m="4492350">And</span> <span m="4492620">it has an</span> <span m="4492890">onclick</span> <span m="4493400">attribute</span> <span m="4493620">that</span> <span m="4493970">when</span> <span m="4494210">a</span> <span m="4494305">user</span> <span m="4494400">clicks the</span> <span m="4494720">button,</span> <span m="4495330">all</span> <span m="4495520">this</span> <span m="4495700">code</span> <span m="4496020">here</span> <span m="4496630">runs</span> <span m="4497050">on</span> <span m="4497320">the client</span> <span m="4497670">side.</span> <span m="4498330">But</span> <span m="4498800">it's</span> <span m="4499070">Ur/Web</span> <span m="4499505">code.</span> <span m="4499940">It's not</span> <span m="4500375">JavaScript code.</span> <span m="4500810">The</span> <span m="4501245">compiler</span> <span m="4501680">translates it into</span> <span m="4502210">JavaScript</span> <span m="4502510">for</span> <span m="4502940">you</span> <span m="4503360">and</span> <span m="4503780">guarantees</span> <span m="4504200">that</span> <span m="4504620">it</span> <span m="4505460">maintains</span> <span m="4505990">the</span> <span m="4506080">properties</span> <span m="4506460">that we</span> <span m="4506948">want for the</span> <span m="4507436">abstractions</span> <span m="4507924">in</span> <span m="4508412">our</span> <span m="4508900">list,</span> <span m="4509388">as</span> <span m="4509880">long</span> <span m="4510280">as the</span> <span m="4510650">user</span> <span m="4511120">isn't</span> <span m="4511350">mucking</span> <span m="4511650">around</span> <span m="4511870">with</span> <span m="4512010">it</span> <span m="4512110">manually</span> <span m="4512934">[INAUDIBLE].</span> </p>
<p><span m="4515710">STUDENT: I'm</span> <span m="4515900">more</span> <span m="4516360">thinking that there</span> <span m="4516820">are</span> <span m="4517135">a lot of</span> <span m="4517450">[INAUDIBLE]</span> <span m="4517938">libraries</span> <span m="4518426">out there</span> <span m="4518914">today</span> <span m="4519402">that do</span> <span m="4519890">useful</span> <span m="4520330">things,</span> <span m="4521173">and</span> <span m="4521526">in</span> <span m="4521880">many</span> <span m="4522180">cases complex</span> <span m="4522510">things</span> <span m="4522840">if you</span> <span m="4523312">want to</span> <span m="4523784">recode</span> <span m="4524020">everything</span> <span m="4524256">yourself.</span> <span m="4525672">Is</span> <span m="4526150">there</span> <span m="4526300">any way</span> <span m="4526810">interfacing</span> <span m="4527460">JavaScript</span> <span m="4527850">from</span> <span m="4528247">Ur/Web?</span> </p>
<p><span m="4529041">ADAM CHLIPALA: Yes,</span> <span m="4529670">there's</span> <span m="4529830">a</span> <span m="4529890">foreign</span> <span m="4530250">function</span> <span m="4530380">interface,</span> <span m="4530730">which</span> <span m="4531080">lets</span> <span m="4531400">you</span> <span m="4531850">give</span> <span m="4532060">Ur/Web</span> <span m="4532470">function</span> <span m="4532820">names to</span> <span m="4533170">JavaScript</span> <span m="4533670">function</span> <span m="4534015">names</span> <span m="4534360">and call.</span> <span m="4535192">But</span> <span m="4535610">then</span> <span m="4536280">whenever</span> <span m="4536530">you</span> <span m="4536900">use</span> <span m="4537080">the</span> <span m="4537300">foreign function</span> <span m="4537470">interface,</span> <span m="4538452">you</span> <span m="4538830">don't</span> <span m="4539050">get</span> <span m="4539595">all</span> <span m="4539880">of</span> <span m="4540140">these</span> <span m="4540420">nice</span> <span m="4540650">properties</span> <span m="4541147">like construction</span> <span m="4541644">anymore.</span> <span m="4542141">You have to be</span> <span m="4542638">very</span> <span m="4543135">careful.</span> </p>
<p><span m="4543632">And</span> <span m="4544129">to</span> <span m="4544211">some</span> <span m="4544294">extend,</span> <span m="4544377">you</span> <span m="4544460">have</span> <span m="4544543">to</span> <span m="4544626">understand the implementations</span> <span m="4545123">of some of</span> <span m="4545620">these</span> <span m="4546120">abstractions</span> <span m="4546370">to</span> <span m="4546620">avoid</span> <span m="4547110">disturbing</span> <span m="4547580">them.</span> <span m="4551256">While</span> <span m="4551720">I have</span> <span m="4551970">this</span> <span m="4552310">code</span> <span m="4552680">up</span> <span m="4552800">here,</span> <span m="4554940">let me just</span> <span m="4555010">show</span> <span m="4555270">you.</span> <span m="4556245">We</span> <span m="4556690">still have the</span> <span m="4556760">same</span> <span m="4556990">say</span> <span m="4557270">function as</span> <span m="4557650">before,</span> <span m="4558010">roughly.</span> <span m="4558820">But</span> <span m="4559050">now,</span> <span m="4559690">instead</span> <span m="4559880">of</span> <span m="4560020">calling</span> <span m="4560410">it</span> <span m="4560670">via</span> <span m="4560780">a</span> <span m="4560890">link,</span> <span m="4560940">we</span> <span m="4560990">just</span> <span m="4561150">take</span> <span m="4561350">the</span> <span m="4561420">function</span> <span m="4561740">call,</span> <span m="4562470">which</span> <span m="4562860">is</span> <span m="4562940">populated</span> <span m="4563390">with</span> <span m="4563530">arguments</span> <span m="4563790">that come</span> <span m="4564050">about</span> <span m="4564430">from</span> <span m="4565190">the</span> <span m="4565280">context</span> <span m="4565740">of</span> <span m="4565840">this</span> <span m="4566130">onclick</span> <span m="4566810">handler.</span> </p>
<p><span m="4568640">And</span> <span m="4568720">we</span> <span m="4568890">just wrap</span> <span m="4569140">that</span> <span m="4569310">function</span> <span m="4569580">called</span> <span m="4569940">inside the</span> <span m="4570190">RPC</span> <span m="4570750">syntax.</span> <span m="4571410">And</span> <span m="4571480">that</span> <span m="4571690">means</span> <span m="4572300">this</span> <span m="4572480">is a</span> <span m="4572790">function</span> <span m="4573120">call</span> <span m="4573590">on</span> <span m="4573990">the</span> <span m="4574070">client,</span> <span m="4574680">but</span> <span m="4574945">run</span> <span m="4575210">the</span> <span m="4575560">call</span> <span m="4575780">itself</span> <span m="4576180">on the</span> <span m="4576380">server</span> <span m="4576650">with</span> <span m="4576920">access</span> <span m="4577195">to the</span> <span m="4577470">database</span> <span m="4577745">and</span> <span m="4578020">other</span> <span m="4578380">server</span> <span m="4578990">resources,</span> <span m="4579295">and</span> <span m="4579600">then</span> <span m="4579915">shift</span> <span m="4580490">the</span> <span m="4580560">result</span> <span m="4580860">back</span> <span m="4581080">over</span> <span m="4581260">here.</span> <span m="4582020">And</span> <span m="4582200">it's</span> <span m="4582350">written</span> <span m="4582640">in</span> <span m="4583100">this</span> <span m="4583250">direct</span> <span m="4583590">style</span> <span m="4583920">here</span> <span m="4585040">instead</span> <span m="4585200">of the</span> <span m="4585470">callbacks</span> <span m="4585660">that</span> <span m="4586030">you</span> <span m="4586490">need</span> <span m="4586680">to use</span> <span m="4586890">in</span> <span m="4587245">JavaScript</span> <span m="4587660">usually</span> <span m="4588150">to</span> <span m="4588510">accomplish</span> <span m="4589295">a</span> <span m="4589640">remote</span> <span m="4589990">server</span> <span m="4590270">call</span> <span m="4590765">[INAUDIBLE].</span> <span m="4592250">Yeah.</span> </p>
<p><span m="4592745">STUDENT: [INAUDIBLE]?</span> </p>
<p></p>
<p><span m="4599190">ADAM CHLIPALA: The</span> <span m="4599580">client</span> <span m="4599920">is</span> <span m="4599990">allowed to</span> <span m="4600445">call</span> <span m="4600900">anything</span> <span m="4601290">in</span> <span m="4601380">scope.</span> <span m="4601840">So</span> <span m="4601970">you</span> <span m="4602110">just</span> <span m="4602290">have</span> <span m="4602400">to</span> <span m="4602490">use scope</span> <span m="4602950">the</span> <span m="4603070">way</span> <span m="4603345">we</span> <span m="4603620">usually</span> <span m="4604020">use</span> <span m="4604260">it</span> <span m="4604380">to</span> <span m="4604440">hide</span> <span m="4604870">private</span> <span m="4606000">fields</span> <span m="4606410">and</span> <span m="4606540">so</span> <span m="4606690">forth</span> <span m="4606970">inside</span> <span m="4607460">of</span> <span m="4607958">an</span> <span m="4608456">abstraction.</span> <span m="4617420">I</span> <span m="4617490">mean,</span> <span m="4618010">because</span> <span m="4618370">there's</span> <span m="4618460">a</span> <span m="4618510">call</span> <span m="4618995">here,</span> <span m="4619480">the</span> <span m="4619840">functions</span> <span m="4620180">we're</span> <span m="4620300">allowed</span> <span m="4620570">to</span> <span m="4620630">call</span> <span m="4621190">are</span> <span m="4621300">the</span> <span m="4621370">ones</span> <span m="4621600">whose</span> <span m="4621750">names</span> <span m="4622050">are</span> <span m="4622140">in</span> <span m="4622400">scope.</span> <span m="4624530">This</span> <span m="4624760">name</span> <span m="4624940">happens</span> <span m="4625260">to</span> <span m="4625510">not</span> <span m="4625780">be in</span> <span m="4626050">scope</span> <span m="4626240">here.</span> <span m="4626660">So</span> <span m="4626770">we</span> <span m="4626860">couldn't</span> <span m="4627080">call</span> <span m="4627300">it</span> <span m="4627370">directly</span> <span m="4627700">here.</span> <span m="4628340">But</span> <span m="4628460">because it's in</span> <span m="4628870">scope</span> <span m="4629170">up there,</span> <span m="4629667">we're allowed to</span> <span m="4630164">call</span> <span m="4630661">it.</span> <span m="4636128">Did</span> <span m="4636625">I</span> <span m="4637122">see</span> <span m="4637619">another</span> <span m="4638116">hand?</span> </p>
<p><span m="4643583">Let's</span> <span m="4644080">see,</span> <span m="4644577">is</span> <span m="4645074">there</span> <span m="4645198">anything</span> <span m="4645322">else</span> <span m="4645446">interesting</span> <span m="4645571">about this</span> <span m="4646068">version</span> <span m="4646565">that I wanted to</span> <span m="4647062">mention?</span> <span m="4652070">It</span> <span m="4652190">involves</span> <span m="4652550">an</span> <span m="4653220">implementation</span> <span m="4653700">of a</span> <span m="4654180">GUI</span> <span m="4654280">widget</span> <span m="4654870">using</span> <span m="4655110">this</span> <span m="4655270">functional</span> <span m="4655610">reactive</span> <span m="4655950">style,</span> <span m="4656560">which</span> <span m="4656760">is</span> <span m="4656970">cool</span> <span m="4657320">from</span> <span m="4657660">a</span> <span m="4658000">programming</span> <span m="4658310">modularity</span> <span m="4658830">perspective</span> <span m="4660060">but</span> <span m="4660806">maybe</span> <span m="4661580">less</span> <span m="4661750">interesting</span> <span m="4662220">from</span> <span m="4662410">a</span> <span m="4662460">security</span> <span m="4662810">perspective.</span> <span m="4663790">But</span> <span m="4664230">here's</span> <span m="4664255">an</span> <span m="4664280">example</span> <span m="4664640">of</span> <span m="4664730">calling</span> <span m="4665030">a</span> <span m="4665080">method</span> <span m="4665420">of</span> <span m="4665590">this</span> <span m="4666610">abstraction</span> <span m="4667210">of</span> <span m="4667290">a</span> <span m="4667370">portion</span> <span m="4667680">of</span> <span m="4667760">the</span> <span m="4667850">page</span> <span m="4668290">that</span> <span m="4669140">displays</span> <span m="4669500">a</span> <span m="4669550">list</span> <span m="4669760">of</span> <span m="4669810">lines</span> <span m="4670020">of</span> <span m="4670230">text</span> <span m="4670630">that you can</span> <span m="4671103">add to but</span> <span m="4671576">never delete</span> <span m="4672049">from.</span> </p>
<p><span m="4673470">And</span> <span m="4673725">you can</span> <span m="4673980">actually</span> <span m="4674320">enforce</span> <span m="4674770">that.</span> <span m="4675040">Because</span> <span m="4675300">we</span> <span m="4675390">don't</span> <span m="4675550">have</span> <span m="4675670">the</span> <span m="4675770">dom</span> <span m="4676370">here.</span> <span m="4676950">It's</span> <span m="4677110">not</span> <span m="4677400">that</span> <span m="4677535">any</span> <span m="4677670">part</span> <span m="4677880">of</span> <span m="4677950">the</span> <span m="4678030">code</span> <span m="4678360">can</span> <span m="4678760">reach</span> <span m="4679180">into</span> <span m="4679230">the</span> <span m="4679330">document</span> <span m="4679740">tree</span> <span m="4679945">and</span> <span m="4680150">mutate</span> <span m="4680530">it</span> <span m="4680910">and</span> <span m="4681090">change</span> <span m="4681450">the</span> <span m="4681510">log</span> <span m="4681890">and</span> <span m="4681980">delete</span> <span m="4682270">lines</span> <span m="4682600">that</span> <span m="4682690">were</span> <span m="4682780">previously</span> <span m="4683310">added.</span> </p>
<p><span m="4686380">The</span> <span m="4686470">more</span> <span m="4686640">functional</span> <span m="4686990">style</span> <span m="4687320">here</span> <span m="4687550">means</span> <span m="4687675">you</span> <span m="4687800">can</span> <span m="4688030">actually</span> <span m="4688290">have</span> <span m="4688540">a GUI</span> <span m="4688720">widget</span> <span m="4689210">that</span> <span m="4689570">owns</span> <span m="4689870">a</span> <span m="4689920">part</span> <span m="4690150">of</span> <span m="4690380">the page and</span> <span m="4690550">controls</span> <span m="4691280">exactly</span> <span m="4691680">what's</span> <span m="4691830">shown</span> <span m="4692130">there,</span> <span m="4692510">and bugs</span> <span m="4692860">and</span> <span m="4692910">other</span> <span m="4693170">code</span> <span m="4693710">can't</span> <span m="4694030">interfere</span> <span m="4694920">with</span> <span m="4695230">computing</span> <span m="4695510">what</span> <span m="4695740">shows up</span> <span m="4696211">there.</span> <span m="4701870">This</span> <span m="4702170">is</span> <span m="4702240">probably</span> <span m="4702560">good</span> <span m="4702720">point to stop,</span> <span m="4703070">unless there are</span> <span m="4703340">any last</span> <span m="4703825">questions.</span> </p>
<p><span m="4706735">STUDENT: Channels?</span> </p>
<p><span m="4708190">ADAM CHLIPALA: Channels.</span> <span m="4709650">I</span> <span m="4710000">don't</span> <span m="4710457">think there's enough time</span> <span m="4710914">to</span> <span m="4711371">properly</span> <span m="4711828">demonstrate</span> <span m="4712285">channels.</span> <span m="4713199">But</span> <span m="4713660">there's</span> <span m="4713910">code in the</span> <span m="4714330">paper.</span> <span m="4714610">And</span> <span m="4714710">there</span> <span m="4714810">are</span> <span m="4714830">all</span> <span m="4714960">sorts</span> <span m="4715200">of</span> <span m="4715300">demos</span> <span m="4715565">and</span> <span m="4715830">tutorials</span> <span m="4716085">on the</span> <span m="4716340">website</span> <span m="4716825">for</span> <span m="4717310">this</span> <span m="4717795">project.</span> <span m="4719250">Yeah.</span> </p>
<p><span m="4720220">STUDENT: It's</span> <span m="4720705">really</span> <span m="4721190">hard writing</span> <span m="4721675">correct</span> <span m="4722160">[INAUDIBLE]</span> <span m="4722645">and</span> <span m="4723130">compilers.</span> <span m="4723615">How</span> <span m="4724100">do you</span> <span m="4724585">mitigate</span> <span m="4726040">problems</span> <span m="4726350">that</span> <span m="4726436">might</span> <span m="4726523">be</span> <span m="4726610">present</span> <span m="4726870">from</span> <span m="4727352">the</span> <span m="4728316">abstraction</span> <span m="4729762">layers</span> <span m="4730244">themselves?</span> </p>
<p><span m="4732660">ADAM CHLIPALA: Get</span> <span m="4732840">people</span> <span m="4733090">to</span> <span m="4733160">use</span> <span m="4733420">it and</span> <span m="4733600">report</span> <span m="4733950">bugs.</span> <span m="4734450">That's</span> <span m="4734901">the best</span> <span m="4735352">I have for</span> <span m="4735803">you.</span> <span m="4738060">I</span> <span m="4738100">guess the</span> <span m="4738420">idea</span> <span m="4738690">is</span> <span m="4740970">compilers</span> <span m="4741250">like</span> <span m="4741460">this</span> <span m="4742090">should</span> <span m="4742290">be</span> <span m="4742470">written</span> <span m="4742650">much</span> <span m="4742940">less</span> <span m="4743120">frequently</span> <span m="4743550">than</span> <span m="4743825">new</span> <span m="4743962">applications.</span> <span m="4744810">So</span> <span m="4745360">to</span> <span m="4745700">condense</span> <span m="4746070">all</span> <span m="4746220">the bug</span> <span m="4746480">finding</span> <span m="4746840">in</span> <span m="4746940">this</span> <span m="4747210">one</span> <span m="4747410">place</span> <span m="4747675">is</span> <span m="4747940">still an</span> <span m="4748090">improvement,</span> <span m="4748370">even</span> <span m="4748650">if it's</span> <span m="4749118">not</span> <span m="4749586">done</span> <span m="4750054">in a</span> <span m="4750522">particularly</span> <span m="4750990">principled</span> <span m="4751458">way.</span> <span m="4753800">Yeah.</span> </p>
<p><span m="4754080">STUDENT: Just</span> <span m="4754475">out of</span> <span m="4754870">curiosity,</span> <span m="4755010">how</span> <span m="4755400">are</span> <span m="4755840">[INAUDIBLE]</span> <span m="4756070">files</span> <span m="4756450">handled?</span> </p>
<p><span m="4758440">ADAM CHLIPALA: You</span> <span m="4758770">can</span> <span m="4759460">use</span> <span m="4759660">that</span> <span m="4759940">configuration</span> <span m="4760500">file</span> <span m="4760820">I</span> <span m="4760880">showed</span> <span m="4761300">to</span> <span m="4761555">map</span> <span m="4761810">them</span> <span m="4761960">into</span> <span m="4762290">parts</span> <span m="4762520">of the</span> <span m="4762560">URL</span> <span m="4762960">space.</span> <span m="4764090">Or</span> <span m="4764510">you</span> <span m="4764740">can</span> <span m="4765770">manually</span> <span m="4766570">produce</span> <span m="4767000">values</span> <span m="4767430">in the</span> <span m="4767803">program</span> <span m="4768550">that</span> <span m="4768800">stand</span> <span m="4769110">for</span> <span m="4769200">files</span> <span m="4769630">and</span> <span m="4769750">ask</span> <span m="4769970">to</span> <span m="4770230">return</span> <span m="4770440">those as the result</span> <span m="4770860">of</span> <span m="4771070">the</span> <span m="4771280">page.</span> <span m="4771720">There</span> <span m="4772200">are a</span> <span m="4772610">few different</span> <span m="4773020">approaches.</span> <span m="4775319">Yeah.</span> </p>
<p><span m="4776205">STUDENT: Why</span> <span m="4776648">Ur?</span> </p>
<p><span m="4777540">ADAM CHLIPALA: You're</span> <span m="4777950">asking</span> <span m="4778250">how</span> <span m="4778630">I</span> <span m="4778900">chose</span> <span m="4779110">the</span> <span m="4779200">name?</span> </p>
<p><span m="4779785">STUDENT: Yeah,</span> <span m="4780130">like</span> <span m="4780820">why--</span> </p>
<p><span m="4782210">ADAM CHLIPALA: Oh,</span> <span m="4782350">you're</span> <span m="4782420">asking</span> <span m="4782600">why</span> <span m="4782770">you want to</span> <span m="4782940">use</span> <span m="4783210">this.</span> </p>
<p><span m="4783480">STUDENT: No,</span> <span m="4783958">no,</span> <span m="4784436">the</span> <span m="4784914">name of the</span> <span m="4785392">language,</span> <span m="4785870">just</span> <span m="4786348">out</span> <span m="4786826">of</span> <span m="4787310">curiosity.</span> </p>
<p><span m="4787850">ADAM CHLIPALA: So</span> <span m="4788520">Ur</span> <span m="4789100">language is</span> <span m="4789560">a</span> <span m="4790040">concept</span> <span m="4790460">from</span> <span m="4790750">linguistics</span> <span m="4791320">to</span> <span m="4791430">describe</span> <span m="4791900">the</span> <span m="4792510">language</span> <span m="4792720">that</span> <span m="4792890">is</span> <span m="4793120">the</span> <span m="4794000">ancestor</span> <span m="4795175">of</span> <span m="4795570">the</span> <span m="4795650">modern</span> <span m="4795950">languages.</span> <span m="4796930">And</span> <span m="4797230">the</span> <span m="4797630">idea is</span> <span m="4797850">in</span> <span m="4798150">this</span> <span m="4798450">language,</span> <span m="4798750">you can embed all</span> <span m="4799050">sorts of</span> <span m="4799350">other</span> <span m="4799650">languages inside</span> <span m="4799950">it.</span> <span m="4800250">So it's</span> <span m="4800550">sort of the</span> <span m="4800850">ancestor</span> <span m="4801150">of all</span> <span m="4801450">those.</span> </p>
</div>
        <div id="vid_related" itemprop="description" class="tabContent hide">
<h2 class="subhead">Free Downloads</h2>
<h3 class="subsubhead">Video</h3>
<ul>
<li>iTunes U (<a href="https://itunes.apple.com/us/itunes-u/id1017908130">MP4 - 177MB</a>)</li>
<li>Internet Archive (<a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec11_300k.mp4">MP4 - 177MB</a>)</li>
</ul>
<br>
<h3 class="subsubhead">Caption</h3>
<ul>
<li>English-US (<a href="../../../contents/video-lectures/lecture-11-ur-web/XMEFdofERLI.srt">SRT</a>)</li>
</ul>
</div>
    
   </div>  




      					 
        <div class="" id="parent-fieldname-bottom_html_area">
            
            
        </div>
    
               </main><!--Course_inner_media tag close -->
           		</div>
<!--Course_wrapper tag close -->
            </div>
<!--left tag close -->
            <aside id="right">
                <!--Begin Right Portion -->
                    <div>
    



</div>

                	<div>
    



</div>


        <div class="" id="parent-fieldname-rsi_top_html_area">
            
            
        </div>
    

<!-- RSI google ad space-->



<div id="google_ads">    
    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <script type="text/javascript">var googletag = googletag || {}; googletag.cmd = googletag.cmd || [];</script>
    <script type="text/javascript">
googletag.cmd.push(function() {googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_A_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_A_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_B_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_B_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_C_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_C_DL').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
 googletag.enableServices();
});</script>
    <script language="javascript" type="text/javascript">
googletag.cmd.push(function() {googletag.pubads().set("TYPE","HOUSE");googletag.pubads().set("DEPARTMENT","6");googletag.pubads().set("CRS_BEG2","85");googletag.pubads().set("CRS_END","8");googletag.pubads().set("SESSION","F");googletag.pubads().set("YEAR","14");})
</script>
    
    <div id="VIDEO_INDIVIDUAL_SLOT_A_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_A_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_B_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_B_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_C_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_C_DL'); });</script>
    </div>
</div>

<!-- End RSI ads--> 


<div>
    



</div>

            </aside><!--Right div close -->
            <div class="clear"></div>
        </div>
<!--grid tag close -->
      </div>
		
		<footer id="bottom">
			<div id="grid">
				
<div id="portletwrapper-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572" class="portletWrapper kssattr-portlethash-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572">
<div class="portletStaticText portlet-static-site-footer"><div id="footer">
<nav aria-label="Footer">     <nav id="foot-c1" class="grid_2 alpha" aria-labelledby="f-find-courses">       <span class="footer" id="f-find-courses" aria-hidden="true">Find Courses</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Find by Topic</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-number/">Find by Course Number</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-department/">Find by Department</a></li>
    <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights</a></li>
    <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
    <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    <li><a href="https://ocw.mit.edu/courses/translated-courses/">Translated Courses</a></li>
</ul>
</nav>
<div id="foot-c2" class="grid_2"><nav aria-labelledby="f-for-educators">         <span id="f-for-educators" class="footer" aria-hidden="true">For Educators</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
    <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal </a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
    <li><a href="https://openlearning.mit.edu/campus/digital-innovations/" aria-label="External Link: Residential Digital Innovations">Residential Digital Innovations </a></li>
    <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
</ul>
</nav></div>
<nav class="grid_2" id="foot-c3" aria-labelledby="f-donate">       <span id="f-donate" class="footer" aria-hidden="true">Give Now</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
    <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
    <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
    <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
    <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
</ul>
</nav>
<div class="grid_2" id="foot-c4">
<nav aria-labelledby="f-about">         <span id="f-about" class="footer" aria-hidden="true">About</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/about/">About OpenCourseWare</a></li>
    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
    <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
    <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
</ul>
</nav><!--about-->       <nav aria-labelledby="f-tools">         <span id="f-tools" class="footer" aria-hidden="true">Tools</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/help/">Help &amp; FAQs</a></li>
    <li><a href="https://ocw.mit.edu/about/contactus">Contact Us</a></li>
    <li><a href="https://accessibility.mit.edu/" target="_blank">Accessibility</a></li>
    <li><a href="https://ocw.mit.edu/help/site-map/">Site Map</a></li>
    <li><a href="../../../common/terms/index.htm">Privacy &amp; Terms of Use</a></li>
    <li><a href="https://ocw.mit.edu/help/rss/">RSS Feeds</a></li>
</ul>
</nav><!--tools-->
</div>
</nav> <aside style="min-height: 289px;" aria-labelledby="f-our-corporate-supporters" class="grid_4 omega" id="foot-c5">           <span aria-hidden="true" class="footer" id="f-our-corporate-supporters">Our Corporate Supporters</span>           <!-- HOME_CORP_LOGO_1 -->
<div id="div-gpt-ad-1388181177156-0" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-0'); });
            </script></div>
<!-- HOME_CORP_LOGO_2 -->
<div id="div-gpt-ad-1388181177156-1" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-1'); });
            </script></div>
<!-- HOME_CORP_LOGO_3 -->
<div id="div-gpt-ad-1388181177156-2" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-2'); });
            </script></div>
<!-- HOME_CORP_LOGO_4 -->
<div id="div-gpt-ad-1388181177156-3" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-3'); });
            </script></div>
<!-- HOME_CORP_LOGO_5 -->
<div id="div-gpt-ad-1388181177156-4" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-4'); });
              </script></div>
<!-- HOME_CORP_LOGO_6 -->
<div id="div-gpt-ad-1388181177156-5" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-5'); });
              </script></div>
</aside>
<div class="grid_12 alpha omega" itemprop="publisher" itemscope="" itemtype="http://schema.org/CollegeOrUniversity">
<h4 class="footer" style="border-top: thin solid #d5c9ba; padding-top: 10px; margin-bottom: 10px;">About <span itemprop="name">MIT OpenCourseWare</span>
</h4>
<p style="color: #999; font-size: 1em; line-height: 1.5em; margin-top: 10px;" itemprop="description">MIT OpenCourseWare is an online publication of materials from over 2,500 MIT courses, freely sharing knowledge with learners and educators around the world. <a href="https://ocw.mit.edu/about/">Learn more »</a></p>
</div>
<div id="foot-copy" class="grid_12 alpha omega" style="border-top: none;">
<a href="http://web.mit.edu"><img src="../../../common/images/logo_mit.png" alt="Massachusetts Institute of Technology logo and name." style="width: 195; height: 44;"></a><a href="https://openlearning.mit.edu/"><img src="https://ocw.mit.edu/images/mitol_logo.png" alt="MIT Open Learning logo and name." style="width: 265; height: 50; vertical-align: top; padding-left:30px;"></a><a href="https://www.oeglobal.org/"><img src="https://ocw.mit.edu/images/oeg_logo.gif" alt="Open Education Consortium logo." style="width: 219px; height: 59px; vertical-align: top; padding-left:20px;"></a><a rel="license" itemprop="useRightsUrl" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="../../../common/images/cc_by-nc-sa.png" alt="Creative Commons logo with terms BY-NC-SA." style="width: 126px; height: 44px; margin-right: 0; padding-left: 20px;"></a>
<p class="copyright">© 2001–2018<br>
Massachusetts Institute of Technology</p>
<p style="font-size: 0.9em; margin-bottom: 15px;">Your use of the MIT OpenCourseWare site and materials is subject to our <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license">Creative Commons License</a> and other <a href="../../../common/terms/index.htm" rel="cc:morePermissions">terms of use</a>.</p>
</div>
</div></div>

</div>





                
			</div> <!-- bottom grid end -->
		</footer><!-- footer bottom end -->


   </body>
 </html>
