<!DOCTYPE html><html lang="en">
      
      
        
    
    
    
    

      
      
      <head>
        <meta charset="utf-8">
        <meta name="format-detection" content="telephone=no">  
        
        <title>Lecture 2: Control Hijacking Attacks | Lecture Videos | Computer Systems Security | Electrical Engineering and Computer Science | MIT OpenCourseWare</title>
    <!-- Begin Automatic Metadata Insertion -->
    <meta content="6-858-computer-systems-security-fall-2014" name="WT.cg_n">
    <meta content="Lecture 2: Control Hijacking Attacks" name="WT.cg_s">
    <meta content="In this lecture, Professor Mickens continues the topic of buffer overflows, discussing approaches to such control hijacking attacks." name="Description">
    <meta content="Zeldovich, Nickolai" name="Author">
    <meta content="6.858,buffer overflow,C,assembly language,control hijacking,Computer Design and Engineering,Software Design and Engineering" name="keywords">
    <meta content="6.858 Computer Systems Security | Lecture 2: Control Hijacking Attacks" name="Search_Display">
    <meta content="Computer Design and Engineering" itemprop="about">
    <meta content="Software Design and Engineering" itemprop="about">
    <!-- End Automatic Metadata Insertion -->

	<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/grid.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/base.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/menu.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.bubblepopup.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/search.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses_new.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.jscrollpane.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/media_tabs.css">
	<link href="../../../common/xml/ocwcc.rdf" type="application/rdf+xml" rel="metadata">
	<link rel="canonical" href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-2-control-hijacking-attacks/">
	<link rel="apple-touch-icon" href="../../../common/images/apple-touch-icon.png">
	
	
      
	
	<script type="text/javascript" src="../../../common/scripts/jquery.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-media-utils-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.bubblepopup.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery-ui.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.jscrollpane.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/expandy.js"></script>
	<script type="text/javascript" src="../../../common/scripts/bubble-popup-offline.js"></script>
	
	
	
    <script type="text/javascript">
      $(document).ready(function() {
        $("#tabs").tabs();
        IpadScroller();
      });
    </script>
    
    
    
    
    
    
      
       
		 

        
        
        

        
        
        
        
        
        
        
        
        
      </head>
    <body itemscope itemtype="http://schema.org/WebPage">
        
	

        <header id="top">
			<div id="grid">
				
				
					
<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572">
<div class="portletStaticText portlet-static-site-header">
<!--googleoff: index-->
<div class="grid_6 alpha" id="banner"><a href="https://ocw.mit.edu/"><img src="../../../common/images/ocw_mast.png" class="logo" alt="MIT OpenCourseWare, Massachusetts Institute of Technology"></a></div>
<div class="grid_6 omega" id="subscribe">
<aside class="module" aria-label="Connect with OCW">
<table class="social">
    <tbody>
        <tr>
            <td class="socialbutton"><a aria-label="Subscribe to the OCW Newsletter" href="https://ocw.mit.edu/subscribe/index.htm?utm_source=header"><img src="../../../common/images/trans.gif" alt="An icon depicting an envelope.">Subscribe to the OCW Newsletter</a></td>
            <td>
<a aria-label="Facebook" href="https://facebook.com/mitocw"><img src="../../../common/images/icon_fb.png" alt="Click to visit our Facebook page."></a>  <a aria-label="Instagram" href="https://www.instagram.com/mitocw/"><img src="https://ocw.mit.edu/images/icon_ig.png" alt="Click to visit our Instagram page."></a> <a aria-label="Twitter" href="https://twitter.com/mitocw"><img src="https://ocw.mit.edu/images/icon_twitter.png" alt="Click to visit our Twitter feed."></a><a aria-label="YouTube" href="https://www.youtube.com/mitocw" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_yt.png" alt="Click to visit our YouTube page."></a><span style="font-size: 12.208px;">   </span><a aria-label="Open Matters blog on WordPress" href="https://www.ocw-openmatters.org/" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_wp.png" alt="Click to visit our blog on WordPress."></a>
</td>
        </tr>
    </tbody>
</table>
</aside><nav aria-label="Help Links" class="helplinks">     <a aria-label="OCW Site Help" href="https://ocw.mit.edu/help">Help</a><span aria-hidden="true">|</span>     <a href="../../../common/about/contactus.htm">Contact Us</a>   </nav>
</div>
<div class="clear"> </div>
<!--googleon: index-->
</div>

</div>

<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75">
<div class="portletStaticText portlet-static-mega-menu"><div><nav id="mega" class="grid_8 alpha" aria-label="Site">
<ul id="menu" role="presentation">
    <li id="menu_home">
<a href="https://ocw.mit.edu/" aria-label="Homepage"><img src="../../../common/images/top-nav_home.png" class="home_icon" alt="Click for site home page."></a><!-- Begin Home Item -->
</li>
    <!-- End Home Item -->
    <li id="drop_1" aria-label="Find Courses">
<a href="#" aria-hidden="true">FIND COURSES</a><!-- Begin 5 columns Item -->
    <div class="dropdown_5columns-a mega-courses">
    <div class="col_1a">
    <div class="row_1a">
<nav aria-labelledby="mm-find-courses-by">     <span id="mm-find-courses-by" class="nav" aria-hidden="true">Find courses by:</span>
    <ul class="find_by" role="presentation">
        <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Topic</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-number/">MIT Course Number</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-department/">Department</a></li>
    </ul>
    </nav>     <nav aria-labelledby="mm-collections">     <span id="mm-collections" class="nav" aria-hidden="true">Collections</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Lectures</a></li>
        <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
        <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
        <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    </ul>
    </nav>     <nav class="col_1b" aria-labelledby="mm-translated-courses">     <span id="mm-translated-courses" class="nav" aria-hidden="true" style="line-height: 1.3;">Cross-Disciplinary Topic Lists</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/energy-courses">Energy</a></li>
        <li><a href="https://ocw.mit.edu/courses/entrepreneurship">Entrepreneurship</a></li>
        <li><a href="https://ocw.mit.edu/courses/environment-courses">Environment</a></li>
        <li><a href="https://ocw.mit.edu/courses/intro-programming">Introductory Programming</a></li>
        <li><a href="https://ocw.mit.edu/courses/life-sciences">Life Sciences</a></li>
        <li><a href="https://ocw.mit.edu/courses/transportation-courses">Transportation</a></li>
    </ul>
    </nav>
</div>
    <div class="row_1b"><nav aria-labelledby="mm-cross-disciplinary-topic-lists">     <span id="mm-cross-disciplinary-topic-lists" class="nav" aria-hidden="true">Translated Courses</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/translated-courses/traditional-chinese" aria-label="Traditional Chinese">繁體字 / Traditional Chinese</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/turkish" aria-label="Turkish">Türkçe / Turkish</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/korean" aria-label="Korean">(비디오)한국 / Korean</a></li>
    </ul>
    </nav></div>
    </div>
    </div>
    </li>
    <li id="drop_2">
<a href="#" aria-label="For Educators">For Educators</a>
    <div class="dropdown_1column-a" style="width: 270px;"><nav aria-labelledby="mm-find-courses-by">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/chalk-radio-podcast">Chalk Radio Podcast</a></li>
        <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
        <li><a href="https://openlearning.mit.edu/campus/digital-innovations/">Residential Digital Innovations </a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_3">
<a href="#" aria-hidden="true">Give Now</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="Donate">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
        <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
        <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
        <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
        <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_4">
<a href="#" aria-hidden="true">About</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="About">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/about/">About MIT OpenCourseWare</a></li>
        <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
        <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
        <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
        <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
        <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
    </ul>
    </nav></div>
    </li>
</ul>
</nav></div></div>

</div>





<!--googleoff: index-->
<script>
  (function() {
	var cx = '012626166551961672889:owjdpuboktq';
	var gcse = document.createElement('script');
	gcse.type = 'text/javascript';
	gcse.async = true;
	gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(gcse, s);
  })();
  window.onload = function(){
	document.getElementById('gsc-i-id1').placeholder = 'Search';	
  };

$(document).ready(function(){

$('.advanceSearch a').keydown(function(event){showSearchTips($(this),event);})
$('#searchTipsModal').keydown(function(event){showSearchTips($(this),event);})

function showSearchTips(obj,evt) {
// if pressed enter key
	if ( evt.which == 13 || evt.which == 32) {
		showModal();
		ga('send', 'pageview', "AdvanceSearch");
		$(".advanceSearch a").attr('aria-expanded', 'true');
		$('.searchTipsModal').focus();
		evt.preventDefault();
		}
	if ( evt.which == 27 ) {
		hideModal();
		$(".advanceSearch a").attr('aria-expanded', 'false');
		var modal = document.getElementById('searchTipsModal');
		modal.style.display = "none";
		$(".advanceSearch a").focus();
		evt.preventDefault();
		}
}

});
function showModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "block";
	ga('send', 'pageview', "AdvanceSearch");
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", true);
	window.setTimeout(function () {
    document.getElementById('searchTipsModal').focus(); }, 0);
}

function hideModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "none";
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", false);
}
</script>
<div id="search" role="search" class="grid_4 omega">
    	<table class="search">
				<tbody>
					<tr>
						<td><div class="searchboxheader"><searchbox-only resultsurl="/search/ocwsearch.htm"></searchbox-only></div></td>
						<td>
							<div class="advanceSearch">
								<a id="searchTipsBtn" onclick="showModal();" href="#" role="button" aria-label="search tips" aria-expanded="false" aria-describedby="searchtips">Search Tips</a>

								<!-- The Modal -->
								<div id="searchTipsModal" class="modal" tabindex="-1">
								  <!-- Modal content -->
									<div class="modal-content">
										<div class="modal-body">
											<button class="close" onclick="hideModal();" aria-label="close">X</button>
											<span>
												<b>Exclude words from your search</b>
												<br>Put - in front of a word you want to leave out. For example, jaguar speed -car
												<br><br>
												<b>Search for an exact match</b>
												<br>Put a word or phrase inside quotes. For example, "tallest building".
												<br><br>
												<b>Search for wildcards or unknown words</b>
												<br>Put a * in your word or phrase where you want to leave a placeholder. For example, "largest * in the world".
												<br><br>
												<b>Search within a range of numbers</b>
												<br>Put .. between two numbers. For example, camera $50..$100.
												<br><br>
												<b>Combine searches</b>
												<br>Put "OR" between each search query. For example,  marathon OR race.
												<br><br>
											</span>
										</div>
								  </div>
								</div>
							</div>
						</td>
					</tr>
				</tbody>
		</table>
</div>
<div class="clear"></div>
<!--googleon: index-->
<!-- *end header* -->

				
				
			</div>
<!-- top grid end -->
		</header><!-- top end -->
			
		<div id="center_media">
      	<div id="grid">
      		<div id="left">
        		<nav id="breadcrumb_media" aria-label="Breadcrumb">
                	<p>

    <a href="https://ocw.mit.edu/">Home</a>
    
        »
        
    
    
        
            <a href="https://ocw.mit.edu/courses">Courses</a>
            
                »
                
            
            
         
    
    
        
            <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science">Electrical Engineering and Computer Science</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/index.htm">Computer Systems Security</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/video-lectures/index.htm">Lecture Videos</a>
            
                »
                
            
            
         
    
    
        
            
            
            Lecture 2: Control Hijacking Attacks
         
    
</p>

            	</nav>
            	<div class="clear"></div>
        		<div id="media_title">
        		<h1 class="title" itemprop="name" property="dct:title">
        <span class="" id="parent-fieldname-title">
            Lecture 2: Control Hijacking Attacks
        </span>
    </h1>
        		</div>
           		<div class="clear"></div>
           		<div id="course_wrapper_media">
           			<nav id="course_nav" aria-label="Course">
           				<script language="javascript" type="text/javascript">
function toggleMenu(objID) {
  if (!document.getElementById) return;
  var ob = document.getElementById(objID);
  ob.className = (ob.className == 'selected')?'': 'selected';
}
function toggleClass(id)
{
  var divtoggleClass= document.getElementById(id);
  divtoggleClass.className = (divtoggleClass.className == 'mO')?'mC': 'mO';
  return false;
}
function changeAlt(id)
{
  id.alt = (id.alt == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
  id.title = (id.title == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
}
</script>
<!--Left Nav Starts -->


	<ul>			  
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/index.htm">
		                  Course Home  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/syllabus/index.htm">
		                  Syllabus  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/calendar/index.htm">
		                  Calendar  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/readings/index.htm">
		                  Readings  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/lecture-notes/index.htm">
		                  Lecture Notes  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="selected">
			   			<a href="../../../contents/video-lectures/index.htm">
		                  Lecture Videos  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/labs/index.htm">
		                  Labs  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/exams/index.htm">
		                  Exams  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/final-project/index.htm">
		                  Final Project  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/related-resources/index.htm">
		                  Related Resources  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    
		    
         	
	<!--second tal block close-->  
	
</ul>


<!--Left Nav Ends -->





           			</nav>
           			<main id="course_inner_media" aria-labelledby="media_title">
      					 
        <div class="" id="parent-fieldname-text">
            
            
        </div>
    
      					     
    
    



<script type="text/javascript">var caption_embed_1 ={'English - US': '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-2-control-hijacking-attacks/r4KjHEgg9Wg.srt'}</script>     
     <div id="media-embed">
         <div class="attention_message" id="embed_1">
<p>Flash and JavaScript are required for this feature.</p>
<p>Download the video from <a href="https://itunes.apple.com/us/itunes-u/id1017908130">iTunes U</a> or the <a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec02_300k.mp4">Internet Archive</a>.</p>
</div>
     </div>
    
     <script type="text/javascript">ocw_embed_chapter_media('embed_1', 'https://www.youtube.com/v/r4KjHEgg9Wg', 'youtube', '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-2-control-hijacking-attacks', 'https://img.youtube.com/vi/r4KjHEgg9Wg/0.jpg',0,0, 'https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-2-control-hijacking-attacks/r4KjHEgg9Wg.srt')</script>
	 
	 
	 		
	 		<div id="transcript1"></div>
				 <script type="text/javascript">createThreePlayParams(2, 662946, "embed_1", 0, 0)</script>
			 
	

     <div id="media_resource_next_prev_nav" style="margin-top: 1em;">
        <p>
        
            <a href="../../../contents/video-lectures/lecture-1-introduction-threat-models/index.htm">
                <img src="../../../common/images/btn_previous_resource.png" style="margin: 0 30px 0 50px;" alt="Previous track" title="Previous track"></a>
     	
     	
        
            <a href="../../../contents/video-lectures/lecture-3-buffer-overflow-exploits-and-defenses/index.htm"> 
                <img src="../../../common/images/btn_next_resource.png" alt="Next track" title="Next track"></a>
       
       </p>
     </div>
 


<script type="text/javascript">
		window.onload=function(){
		init();
		
		}
		var tabLinks = new Array();
		var contentDivs = new Array();
		function init() {
		  // Grab the tab links and content divs from the page
		  var tabListItems = document.getElementById('tabs').childNodes;
		  for ( var i = 0; i < tabListItems.length; i++ ) {
			if ( tabListItems[i].nodeName == "LI" ) {
			  var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
			  var id = getHash( tabLink.getAttribute('href') );
			  tabLinks[id] = tabLink;
			  contentDivs[id] = document.getElementById( id );
			}
		  }
		  // Assign onclick events to the tab links, and
		  // highlight the first tab
		  var i = 0;
		  for ( var id in tabLinks ) {
			tabLinks[id].onclick = showTab;
			tabLinks[id].onfocus = function() { this.blur() };
			if ( i == 0 ) tabLinks[id].className = 'selected';
			i++;
		  }
		  // Hide all content divs except the first
		  var i = 0;
		  for ( var id in contentDivs ) {
			if ( i != 0 ) contentDivs[id].className = 'tabContent hide';
			i++;
		  }
		}
		function showTab() {
		  var selectedId = getHash( this.getAttribute('href') );
		  // Highlight the selected tab, and dim all others.
		  // Also show the selected content div, and hide all others.
		  for ( var id in contentDivs ) {
			if ( id == selectedId ) {
			  tabLinks[id].className = 'selected';
			  contentDivs[id].className = 'tabContent';
			} else {
			  tabLinks[id].className = '';
			  contentDivs[id].className = 'tabContent hide';
			}
		  }
		  // Stop the browser following the link
		  return false;
		}
		function getFirstChildWithTagName( element, tagName ) {
		  for ( var i = 0; i < element.childNodes.length; i++ ) {
			if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
		  }
		}
		function getHash( url ) {
		  var hashPos = url.lastIndexOf ( '#' );
		  return url.substring( hashPos + 1 );
		}
 </script>	
 

  <div id="media_tabs">
     
        <ul id="tabs">
            <li class="first">
                <a href="#vid_about" class="selected">About this Video</a>
            </li>
            <li class="">
                <a href="#vid_index" class="">Playlist</a>
            </li>
            <li class="">
                <a href="#vid_playlist" class="">Transcript</a>
            </li>
            <li class="">
                <a href="#vid_related" class="">Download this Video</a>
            </li>
        </ul>
   
        <div id="vid_about" itemprop="description" class="tabContent">
<p><strong>Description:</strong> In this lecture, Professor Mickens continues the topic of buffer overflows, discussing approaches to such control hijacking attacks.</p>
<p><strong>Instructor:</strong> James Mickens</p>
</div>
        <div id="vid_index" itemprop="description" class="tabContent hide">
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-1-introduction-threat-models/index.htm">
<img src="https://img.youtube.com/vi/GqmQg-cszw4/default.jpg" title="Lecture 1: Introduction, Threat Models" alt="Lecture 1: Introduction, Threat Models">
<p>Lecture 1: Introduction, Th...</p></a>
</div>
<div class="related-media-thumbnail-nolink">
<div class="now-playing-resource">Now Playing</div>
<img src="https://img.youtube.com/vi/r4KjHEgg9Wg/default.jpg" title="Lecture 2: Control Hijacking Attacks" alt="Lecture 2: Control Hijacking Attacks">
<p>Lecture 2: Control Hijackin...</p>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-3-buffer-overflow-exploits-and-defenses/index.htm">
<img src="https://img.youtube.com/vi/xSQxaie_h1o/default.jpg" title="Lecture 3: Buffer Overflow Exploits and Defenses" alt="Lecture 3: Buffer Overflow Exploits and Defenses">
<p>Lecture 3: Buffer Overflow ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-4-privilege-separation/index.htm">
<img src="https://img.youtube.com/vi/dNl22h1kW1k/default.jpg" title="Lecture 4: Privilege Separation" alt="Lecture 4: Privilege Separation">
<p>Lecture 4: Privilege Separa...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-6-capabilities/index.htm">
<img src="https://img.youtube.com/vi/TQhmua7Z2cY/default.jpg" title="Lecture 6: Capabilities" alt="Lecture 6: Capabilities">
<p>Lecture 6: Capabilities</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-7-sandboxing-native-code/index.htm">
<img src="https://img.youtube.com/vi/I0Psvvky-44/default.jpg" title="Lecture 7: Sandboxing Native Code	" alt="Lecture 7: Sandboxing Native Code	">
<p>Lecture 7: Sandboxing Nativ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-8-web-security-model/index.htm">
<img src="https://img.youtube.com/vi/eRJ_r8WF1Y0/default.jpg" title="Lecture 8: Web Security Model" alt="Lecture 8: Web Security Model">
<p>Lecture 8: Web Security Model</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-9-securing-web-applications/index.htm">
<img src="https://img.youtube.com/vi/WlmKwIe9z1Q/default.jpg" title="Lecture 9: Securing Web Applications" alt="Lecture 9: Securing Web Applications">
<p>Lecture 9: Securing Web App...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-10-symbolic-execution/index.htm">
<img src="https://img.youtube.com/vi/yRVZPvHYHzw/default.jpg" title="Lecture 10: Symbolic Execution" alt="Lecture 10: Symbolic Execution">
<p>Lecture 10: Symbolic Execution</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-11-ur-web/index.htm">
<img src="https://img.youtube.com/vi/XMEFdofERLI/default.jpg" title="Lecture 11: Ur/Web" alt="Lecture 11: Ur/Web">
<p>Lecture 11: Ur/Web</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-12-network-security/index.htm">
<img src="https://img.youtube.com/vi/BZTWXl9QNK8/default.jpg" title="Lecture 12: Network Security" alt="Lecture 12: Network Security">
<p>Lecture 12: Network Security</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-13-network-protocols/index.htm">
<img src="https://img.youtube.com/vi/QOtA76ga_fY/default.jpg" title="Lecture 13: Network Protocols" alt="Lecture 13: Network Protocols">
<p>Lecture 13: Network Protocols</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-14-ssl-and-https/index.htm">
<img src="https://img.youtube.com/vi/q1OF_0ICt9A/default.jpg" title="Lecture 14: SSL and HTTPS" alt="Lecture 14: SSL and HTTPS">
<p>Lecture 14: SSL and HTTPS</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-15-medical-software/index.htm">
<img src="https://img.youtube.com/vi/bA3xCpYLA34/default.jpg" title="Lecture 15: Medical Software" alt="Lecture 15: Medical Software">
<p>Lecture 15: Medical Software</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-16-side-channel-attacks/index.htm">
<img src="https://img.youtube.com/vi/3v5Von-oNUg/default.jpg" title="Lecture 16: Side-Channel Attacks" alt="Lecture 16: Side-Channel Attacks">
<p>Lecture 16: Side-Channel At...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-17-user-authentication/index.htm">
<img src="https://img.youtube.com/vi/MT7X17ZRo1U/default.jpg" title="Lecture 17: User Authentication" alt="Lecture 17: User Authentication">
<p>Lecture 17: User Authentica...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-18-private-browsing/index.htm">
<img src="https://img.youtube.com/vi/YTWXAFJf8bw/default.jpg" title="Lecture 18: Private Browsing" alt="Lecture 18: Private Browsing">
<p>Lecture 18: Private Browsing</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-19-anonymous-communication/index.htm">
<img src="https://img.youtube.com/vi/OgGTJIgNewE/default.jpg" title="Lecture 19: Anonymous Communication" alt="Lecture 19: Anonymous Communication">
<p>Lecture 19: Anonymous Commu...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-20-mobile-phone-security/index.htm">
<img src="https://img.youtube.com/vi/uT7BXusDgDM/default.jpg" title="Lecture 20: Mobile Phone Security" alt="Lecture 20: Mobile Phone Security">
<p>Lecture 20: Mobile Phone Se...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-21-data-tracking/index.htm">
<img src="https://img.youtube.com/vi/WG5UbMrUiLU/default.jpg" title="Lecture 21: Data Tracking" alt="Lecture 21: Data Tracking">
<p>Lecture 21: Data Tracking</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-22-guest-lecture-by-mit-is-t/index.htm">
<img src="https://img.youtube.com/vi/2PO8h1pVW50/default.jpg" title="Lecture 22: Guest Lecture by MIT IS&amp;T" alt="Lecture 22: Guest Lecture by MIT IS&amp;T">
<p>Lecture 22: Guest Lecture b...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-23-security-economics/index.htm">
<img src="https://img.youtube.com/vi/8PdnOZI7H5E/default.jpg" title="Lecture 23: Security Economics" alt="Lecture 23: Security Economics">
<p>Lecture 23: Security Economics</p></a>
</div>
</div>
        <div id="vid_playlist" itemprop="description" class="tabContent hide">
<ul><li><a class="transcript-link" title="Open in a new window." alt="Open in a new window." style="text-decoration: none; font-size: 1.0em;" target="_blank" text-decoration: none font-size: href="../../../contents/video-lectures/lecture-2-control-hijacking-attacks/r4KjHEgg9Wg.pdf"> Download English-US transcript (PDF)</a></li></ul>
<p><span m="70">The</span> <span m="170">following</span> <span m="610">content</span> <span m="1120">is</span> <span m="1230">provided</span> <span m="1670">under</span> <span m="1940">a</span> <span m="1980">Creative</span> <span m="2430">Commons</span> <span m="2830">license.</span> <span m="3810">Your</span> <span m="3920">support</span> <span m="4420">will</span> <span m="4560">help</span> <span m="4830">MIT</span> <span m="5310">OpenCourseWare</span> <span m="6060">continue</span> <span m="6540">to</span> <span m="6680">offer</span> <span m="7000">high</span> <span m="7210">quality</span> <span m="7720">educational</span> <span m="8370">resources</span> <span m="8940">for</span> <span m="9080">free.</span> <span m="10150">To</span> <span m="10250">make</span> <span m="10350">a</span> <span m="10400">donation,</span> <span m="11090">or</span> <span m="11340">to</span> <span m="11450">view</span> <span m="11660">additional</span> <span m="12070">materials</span> <span m="12700">from</span> <span m="12860">hundreds</span> <span m="13190">of</span> <span m="13300">MIT</span> <span m="13680">courses,</span> <span m="15000">visit</span> <span m="15160">MIT</span> <span m="15690">OpenCourseWare</span> <span m="16600">at</span> <span m="16830">ocw.mit.edu.</span> </p>
<p><span m="26290">PROFESSOR: This</span> <span m="26390">is</span> <span m="26510">very</span> <span m="26860">exciting.</span> <span m="28000">In the</span> <span m="28250">previous</span> <span m="28640">lecture,</span> <span m="29160">we</span> <span m="29410">learned</span> <span m="29830">all</span> <span m="30150">about</span> <span m="30820">buffer</span> <span m="31510">overflow</span> <span m="31910">attacks,</span> <span m="32600">and</span> <span m="32820">today</span> <span m="33140">we're</span> <span m="33320">going</span> <span m="33560">to</span> <span m="33700">continue</span> <span m="34080">to</span> <span m="34120">discuss</span> <span m="35210">some</span> <span m="35420">techniques</span> <span m="35910">to</span> <span m="36170">launch</span> <span m="36460">these</span> <span m="36610">attacks.</span> <span m="37430">So,</span> <span m="37970">the</span> <span m="38050">basic</span> <span m="38440">idea</span> <span m="38910">of</span> <span m="39040">all</span> <span m="39240">these</span> <span m="39430">buffer</span> <span m="39720">overflow</span> <span m="40110">attacks</span> <span m="41210">is</span> <span m="41380">as</span> <span m="41520">follows.</span> <span m="42460">So,</span> <span m="42550">first</span> <span m="42840">of</span> <span m="42940">all,</span> <span m="43100">they</span> <span m="43210">leverage</span> <span m="45310">a</span> <span m="45370">couple</span> <span m="45620">different</span> <span m="45870">facts.</span> </p>
<p><span m="54080">So,</span> <span m="54440">one</span> <span m="54690">thing</span> <span m="54850">that</span> <span m="54980">they</span> <span m="55120">leverage</span> <span m="55680">is</span> <span m="55930">that</span> <span m="56660">system</span> <span m="57100">software</span> <span m="58170">is</span> <span m="58500">often</span> <span m="58760">written</span> <span m="59237">in</span> <span m="59714">C.</span> </p>
<p></p>
<p><span m="67990">And</span> <span m="68474">so</span> <span m="68958">by</span> <span m="69119">system</span> <span m="69280">software,</span> <span m="69442">I</span> <span m="69926">mean</span> <span m="70087">things</span> <span m="70248">like</span> <span m="70410">databases,</span> <span m="70894">compilers,</span> <span m="71378">network servers,</span> <span m="72346">things</span> <span m="72830">like</span> <span m="73314">that.</span> <span m="75250">And</span> <span m="75734">you</span> <span m="75895">can</span> <span m="76056">also</span> <span m="76218">think of</span> <span m="76702">things</span> <span m="76823">like</span> <span m="76944">your</span> <span m="77065">favorite</span> <span m="77186">command</span> <span m="77670">shell.</span> <span m="78680">All</span> <span m="78845">of</span> <span m="79010">those</span> <span m="79175">types</span> <span m="79422">of</span> <span m="79670">things</span> <span m="79917">are</span> <span m="80165">typically</span> <span m="80412">written</span> <span m="80660">in C.</span> <span m="81155">So,</span> <span m="81650">why</span> <span m="82145">are</span> <span m="82392">these</span> <span m="82640">things</span> <span m="82739">typically</span> <span m="82838">written</span> <span m="82937">in</span> <span m="83036">C?</span> <span m="83135">Well,</span> <span m="83630">they're</span> <span m="83877">written</span> <span m="84125">in</span> <span m="84372">C</span> <span m="84620">because</span> <span m="85115">our</span> <span m="85362">community,</span> <span m="85610">of</span> <span m="85857">course,</span> <span m="86105">is</span> <span m="86352">obsessed</span> <span m="86600">with</span> <span m="86847">speed.</span> <span m="88085">And so</span> <span m="88580">C</span> <span m="89075">is</span> <span m="89240">supposed</span> <span m="89405">to</span> <span m="89570">be like</span> <span m="90065">high-level</span> <span m="90560">assembly,</span> <span m="91070">it</span> <span m="91490">takes</span> <span m="91740">us</span> <span m="91820">very</span> <span m="91900">close</span> <span m="91980">to</span> <span m="92060">the</span> <span m="92140">hardware,</span> <span m="93010">and</span> <span m="93130">so as</span> <span m="93270">a result,</span> <span m="94010">all</span> <span m="94350">these</span> <span m="94570">very</span> <span m="95090">mission</span> <span m="95370">critical</span> <span m="95710">systems</span> <span m="96410">are written</span> <span m="96950">in this</span> <span m="97110">very</span> <span m="97380">low</span> <span m="97500">level</span> <span m="97740">language.</span> <span m="98690">Now,</span> <span m="99940">the</span> <span m="100030">problem</span> <span m="100460">with</span> <span m="100710">things</span> <span m="100920">being</span> <span m="101090">written</span> <span m="101340">in</span> <span m="101460">C</span> <span m="102260">is</span> <span m="102460">that</span> <span m="102700">C</span> <span m="103610">actually</span> <span m="104580">exposes</span> <span m="107820">raw</span> <span m="108020">memory</span> <span m="108400">Addresses.</span> </p>
<p></p>
<p><span m="117430">Right?</span> <span m="117860">And</span> <span m="118040">so</span> <span m="118160">not</span> <span m="118420">only</span> <span m="118570">does</span> <span m="118720">it</span> <span m="118800">expose</span> <span m="119420">raw</span> <span m="119590">memory</span> <span m="119980">addresses,</span> <span m="120880">but</span> <span m="121290">it</span> <span m="121440">also</span> <span m="121900">performs</span> <span m="122400">no</span> <span m="122570">bounds</span> <span m="123000">checking</span> <span m="123850">when</span> <span m="124300">programs</span> <span m="124750">manipulate</span> <span m="125380">those</span> <span m="125600">raw</span> <span m="125970">addresses.</span> <span m="126690">Right?</span> <span m="127000">And</span> <span m="127130">so</span> <span m="127310">as</span> <span m="127380">you</span> <span m="127500">can</span> <span m="127610">imagine,</span> <span m="128050">this</span> <span m="128190">is</span> <span m="128300">a</span> <span m="128360">recipe</span> <span m="128720">for</span> <span m="128870">disaster.</span> <span m="129820">OK?</span> <span m="130490">So,</span> <span m="130850">once</span> <span m="131090">again,</span> <span m="131290">why</span> <span m="131530">doesn't</span> <span m="131850">C</span> <span m="132140">check</span> <span m="132460">these</span> <span m="132660">bounds?</span> <span m="133260">Well,</span> <span m="133470">one</span> <span m="133630">reason</span> <span m="133870">is</span> <span m="133950">because</span> <span m="134490">the</span> <span m="134570">hardware</span> <span m="134790">doesn't do</span> <span m="135210">that.</span> <span m="135830">And</span> <span m="136230">people</span> <span m="136510">who</span> <span m="136620">write</span> <span m="137110">in</span> <span m="137280">C</span> <span m="137560">typically</span> <span m="137670">want</span> <span m="138320">the</span> <span m="138410">max</span> <span m="138725">amount of</span> <span m="139040">speed</span> <span m="139360">possible.</span> <span m="140870">The</span> <span m="140980">other</span> <span m="141190">reason</span> <span m="141540">is</span> <span m="141640">that</span> <span m="141780">in</span> <span m="141870">C,</span> <span m="142340">as</span> <span m="142500">we'll</span> <span m="142600">discuss</span> <span m="142990">later,</span> <span m="143510">it</span> <span m="143580">can</span> <span m="143740">actually</span> <span m="144100">be</span> <span m="144220">very</span> <span m="144490">difficult</span> <span m="144980">to</span> <span m="145050">determine</span> <span m="145520">the</span> <span m="145610">semantics</span> <span m="146160">of</span> <span m="146280">what</span> <span m="146450">it</span> <span m="146590">means</span> <span m="146860">to</span> <span m="146940">have</span> <span m="147090">a</span> <span m="147160">pointer</span> <span m="147520">that's</span> <span m="148050">actually</span> <span m="148450">in</span> <span m="148610">bounds.</span> <span m="149270">So,</span> <span m="149460">in</span> <span m="149540">some</span> <span m="149790">cases,</span> <span m="150350">it</span> <span m="150450">would</span> <span m="150520">be</span> <span m="150640">very</span> <span m="150900">difficult</span> <span m="151300">for</span> <span m="151370">the</span> <span m="151480">C runtime</span> <span m="151960">to</span> <span m="152440">automatically</span> <span m="152920">do</span> <span m="153110">that.</span> <span m="153490">Now</span> <span m="153640">we'll</span> <span m="153780">discuss</span> <span m="154200">some</span> <span m="154350">techniques</span> <span m="155420">which</span> <span m="155580">will</span> <span m="155790">actually</span> <span m="156070">try</span> <span m="156300">to</span> <span m="156410">do</span> <span m="156580">that</span> <span m="156790">type</span> <span m="156990">of</span> <span m="157120">automatic</span> <span m="157600">inference.</span> <span m="158020">But</span> <span m="158270">as</span> <span m="158390">we'll</span> <span m="158530">see,</span> <span m="158910">none of</span> <span m="159150">these</span> <span m="159310">techniques</span> <span m="159700">are</span> <span m="159760">fully bulletproof.</span> </p>
<p><span m="162310">And</span> <span m="162500">so</span> <span m="162860">these</span> <span m="163120">attacks</span> <span m="163710">also</span> <span m="164160">leverage</span> <span m="165430">knowledge</span> <span m="168130">of</span> <span m="168380">the</span> <span m="168630">x86</span> <span m="170650">architecture.</span> <span m="177540">And by</span> <span m="177690">knowledge of</span> <span m="177940">that</span> <span m="178110">architecture</span> <span m="178425">I</span> <span m="178740">mean</span> <span m="179095">things</span> <span m="179450">like</span> <span m="179840">what's</span> <span m="180070">the</span> <span m="180150">direction</span> <span m="180540">that</span> <span m="180610">the</span> <span m="180700">stack</span> <span m="181025">grows,</span> <span m="181350">right?</span> <span m="182260">What</span> <span m="182430">are the</span> <span m="182570">calling</span> <span m="183230">conventions</span> <span m="183500">for</span> <span m="183770">functions?</span> <span m="184960">When you invoke</span> <span m="185295">a C</span> <span m="185630">function,</span> <span m="185930">what is</span> <span m="186160">the</span> <span m="186250">stack</span> <span m="186590">going to</span> <span m="187020">look like?</span> <span m="187450">And</span> <span m="187790">when</span> <span m="188090">you</span> <span m="188240">allocate</span> <span m="188505">an object</span> <span m="188770">on</span> <span m="188926">the</span> <span m="189083">heap,</span> <span m="189240">what</span> <span m="189400">are</span> <span m="189420">those</span> <span m="189730">chief</span> <span m="190110">allocation</span> <span m="190375">structures</span> <span m="190640">going to</span> <span m="190990">look like?</span> <span m="192380">And</span> <span m="192540">so</span> <span m="193050">let's</span> <span m="193250">look</span> <span m="193450">at</span> <span m="193550">a</span> <span m="194230">simple</span> <span m="194650">example.</span> <span m="195040">It's</span> <span m="195150">very</span> <span m="195340">similar</span> <span m="195690">to</span> <span m="195780">something</span> <span m="196140">that</span> <span m="196280">you</span> <span m="198850">saw</span> <span m="199620">in</span> <span m="199720">the</span> <span m="199790">last</span> <span m="200070">lecture.</span> <span m="201250">So,</span> <span m="201720">we've</span> <span m="201920">got</span> <span m="202190">you're</span> <span m="203250">standard</span> <span m="203950">read</span> <span m="204260">request</span> <span m="204525">up</span> <span m="204790">here.</span> <span m="208610">And</span> <span m="208860">then you've</span> <span m="209050">got</span> <span m="209440">a</span> <span m="209700">buffer.</span> <span m="210845">That's</span> <span m="211290">here.</span> </p>
<p><span m="214980">And</span> <span m="215150">by</span> <span m="215300">now</span> <span m="215610">you've</span> <span m="215790">probably</span> <span m="216220">trained</span> <span m="216495">your</span> <span m="217150">lizard</span> <span m="217520">brain</span> <span m="217560">instincts--</span> <span m="218270">whenever</span> <span m="218560">you</span> <span m="218670">see</span> <span m="218830">a buffer</span> <span m="219150">you're</span> <span m="219290">probably</span> <span m="219590">filled</span> <span m="219820">with</span> <span m="220050">fear--</span> <span m="220350">that is</span> <span m="220850">the right attitude.</span> <span m="221350">And</span> <span m="221750">so</span> <span m="221890">we've</span> <span m="222010">got</span> <span m="222190">the</span> <span m="222260">buffer</span> <span m="222610">up</span> <span m="222730">here,</span> <span m="223380">and</span> <span m="223530">then</span> <span m="223740">we've</span> <span m="223990">got</span> <span m="224320">the</span> <span m="224390">canonical</span> <span m="224830">int</span> <span m="225270">i.</span> <span m="228000">And</span> <span m="228150">then</span> <span m="228550">we've</span> <span m="228860">got</span> <span m="229590">the</span> <span m="230140">infamous</span> <span m="231130">"gets"</span> <span m="231450">command.</span> <span m="236880">And</span> <span m="236946">then</span> <span m="237013">you've</span> <span m="237080">got</span> <span m="237250">some</span> <span m="237400">other</span> <span m="237580">stuff</span> <span m="237960">here.</span> <span m="238530">Right?</span> </p>
<p><span m="238800">So</span> <span m="238890">as</span> <span m="239000">we</span> <span m="239090">discussed</span> <span m="240030">in</span> <span m="240200">lecture</span> <span m="240870">last</span> <span m="241070">week,</span> <span m="242040">this</span> <span m="242240">is</span> <span m="242350">problematic,</span> <span m="242930">right?</span> <span m="243120">Because</span> <span m="243390">this</span> <span m="243600">gets</span> <span m="243870">operation</span> <span m="244380">here</span> <span m="244640">does</span> <span m="244780">not</span> <span m="244930">actually</span> <span m="245210">check</span> <span m="245430">the</span> <span m="245520">bounds</span> <span m="246170">on</span> <span m="246320">the</span> <span m="246400">buffer.</span> <span m="246990">So,</span> <span m="247280">what</span> <span m="247430">can</span> <span m="247560">happen</span> <span m="248080">is</span> <span m="248280">that</span> <span m="249340">if</span> <span m="249630">the</span> <span m="250190">user</span> <span m="250690">actually</span> <span m="251070">supplies</span> <span m="251680">the</span> <span m="251760">buffer--</span> <span m="252280">and actually</span> <span m="253720">put that</span> <span m="254200">guy up</span> <span m="254970">here,</span> <span m="255270">for</span> <span m="255450">example--</span> <span m="257000">if</span> <span m="257149">that</span> <span m="257350">buffer</span> <span m="257760">comes</span> <span m="258070">in</span> <span m="258649">from</span> <span m="258839">the</span> <span m="258959">user</span> <span m="259660">and</span> <span m="259810">we</span> <span m="259920">use</span> <span m="260149">this</span> <span m="260329">unsafe</span> <span m="260730">function</span> <span m="261089">here,</span> <span m="261579">we</span> <span m="261779">can</span> <span m="261890">actually</span> <span m="262330">overflow</span> <span m="263300">this</span> <span m="263500">buffer.</span> <span m="263910">We</span> <span m="264240">can</span> <span m="264340">actually</span> <span m="265200">rewrite</span> <span m="265640">stuff</span> <span m="265850">that's</span> <span m="266020">on</span> <span m="266120">the</span> <span m="266190">stack.</span> <span m="266800">So,</span> <span m="266960">just</span> <span m="267180">a</span> <span m="267260">reminder</span> <span m="267850">of</span> <span m="267910">what</span> <span m="268070">that</span> <span m="268650">stuff</span> <span m="268970">looks</span> <span m="269160">like--</span> <span m="271630">let's</span> <span m="271880">look</span> <span m="272140">at</span> <span m="272260">a</span> <span m="272730">stack</span> <span m="272826">diagram</span> <span m="272923">here--</span> <span m="276510">so</span> <span m="276960">let's</span> <span m="277240">say</span> <span m="277520">here</span> <span m="277940">we've</span> <span m="278130">got</span> <span m="278400">I.</span> <span m="280290">Let's</span> <span m="280500">say</span> <span m="280800">here</span> <span m="281290">we've</span> <span m="281590">got</span> <span m="283400">a buf</span> </p>
<p><span m="295890">Right?</span> <span m="296180">So,</span> <span m="296250">we've</span> <span m="296410">got</span> <span m="296630">the</span> <span m="297050">first</span> <span m="297300">address</span> <span m="297575">of</span> <span m="297850">buffer here.</span> <span m="298250">We've</span> <span m="298525">got the</span> <span m="298800">last one</span> <span m="299300">up here.</span> <span m="299900">I</span> <span m="299970">apologize</span> <span m="300430">for</span> <span m="300510">my</span> <span m="300640">handwriting,</span> <span m="300980">I'm</span> <span m="301320">used</span> <span m="301403">to</span> <span m="301486">writing</span> <span m="301569">on</span> <span m="301652">the</span> <span m="301735">marker board.</span> <span m="302610">You</span> <span m="302690">should</span> <span m="302840">pray</span> <span m="303050">for</span> <span m="303180">me.</span> <span m="303520">So,</span> <span m="303660">anyways,</span> <span m="304930">then</span> <span m="305360">up</span> <span m="305790">here,</span> <span m="306270">we've</span> <span m="306570">got</span> <span m="310220">the</span> <span m="310340">saved</span> <span m="310890">value</span> <span m="311235">of</span> <span m="314160">the</span> <span m="314250">break</span> <span m="314660">pointer.</span> <span m="318120">We've</span> <span m="318300">got</span> <span m="318620">the</span> <span m="321608">return</span> <span m="322110">address</span> <span m="325286">for</span> <span m="325720">the</span> <span m="325840">function</span> <span m="326220">there.</span> <span m="326770">And</span> <span m="326930">then we've</span> <span m="327110">got</span> <span m="327350">some</span> <span m="327530">other</span> <span m="327790">stuff</span> <span m="328450">from</span> <span m="330816">the</span> <span m="331280">previous</span> <span m="331630">frame.</span> <span m="336220">So,</span> <span m="336360">don't</span> <span m="336530">forget,</span> <span m="337230">we've</span> <span m="337460">got</span> <span m="337790">the</span> <span m="338650">stack</span> <span m="339150">pointer,</span> <span m="341180">which</span> <span m="341410">goes</span> <span m="341610">there.</span> <span m="345150">And</span> <span m="345580">then we've</span> <span m="345810">got</span> <span m="346215">the</span> <span m="348320">new</span> <span m="348530">break</span> <span m="348820">pointer,</span> <span m="351600">which</span> <span m="351890">goes</span> <span m="352110">here.</span> </p>
<p><span m="362960">The</span> <span m="363081">entry</span> <span m="363202">stack</span> <span m="363323">pointer</span> <span m="363930">goes</span> <span m="364190">there,</span> <span m="364780">and then</span> <span m="365010">somewhere</span> <span m="365430">up</span> <span m="365580">here,</span> <span m="366220">we've</span> <span m="366290">got</span> <span m="367290">the</span> <span m="367740">entry</span> <span m="368232">break</span> <span m="368724">point.</span> <span m="374640">Right?</span> <span m="374930">So,</span> <span m="375020">just</span> <span m="375240">as</span> <span m="375390">a</span> <span m="375460">reminder,</span> <span m="375920">the</span> <span m="376000">way</span> <span m="376190">that</span> <span m="376270">the</span> <span m="376360">Stack</span> <span m="376660">Overflow</span> <span m="377070">works</span> <span m="377790">is</span> <span m="378030">that</span> <span m="378990">basically,</span> <span m="380620">it</span> <span m="380770">goes</span> <span m="381020">this</span> <span m="381260">way.</span> <span m="382080">Right?</span> <span m="382530">So,</span> <span m="383170">when</span> <span m="383360">the</span> <span m="383440">gets</span> <span m="383660">operation</span> <span m="384110">is</span> <span m="384240">called,</span> <span m="384670">we</span> <span m="384730">start</span> <span m="385010">writing</span> <span m="385220">bytes</span> <span m="385750">into</span> <span m="386000">buf,</span> <span m="386830">and</span> <span m="386950">eventually</span> <span m="387280">it's</span> <span m="387370">going</span> <span m="387510">to</span> <span m="387570">start</span> <span m="387980">overwriting</span> <span m="388710">these</span> <span m="388960">things</span> <span m="389210">that</span> <span m="389236">are</span> <span m="389263">on</span> <span m="389290">the</span> <span m="389510">stack.</span> <span m="391710">And</span> <span m="391870">so</span> <span m="392110">this</span> <span m="392280">is</span> <span m="392370">basically--</span> <span m="392690">should</span> <span m="393010">all look</span> <span m="393280">pretty</span> <span m="393740">familiar</span> <span m="394090">to</span> <span m="394330">you.</span> <span m="394710">So.</span> <span m="396190">What</span> <span m="396340">does</span> <span m="396460">the</span> <span m="396570">attacker</span> <span m="396970">do to</span> <span m="397140">take</span> <span m="397340">advantage</span> <span m="397680">of</span> <span m="397740">that?</span> <span m="398830">Basically</span> <span m="399140">supplies</span> <span m="399520">that</span> <span m="399710">long</span> <span m="399930">input.</span> <span m="400720">And</span> <span m="400770">so</span> <span m="400870">the</span> <span m="400990">key</span> <span m="401780">idea</span> <span m="402080">here</span> <span m="402360">is</span> <span m="402500">that</span> <span m="402970">this</span> <span m="403370">can be</span> <span m="403790">attacker-supplied.</span> </p>
<p><span m="405452">And</span> <span m="405938">so,</span> <span m="406424">if</span> <span m="406586">this</span> <span m="406748">return</span> <span m="406910">address</span> <span m="407400">is</span> <span m="407542">attacker-supplied,</span> <span m="407970">then</span> <span m="408690">basically</span> <span m="408975">the</span> <span m="409260">attacker</span> <span m="409710">can</span> <span m="410060">determine</span> <span m="410590">where</span> <span m="410750">this</span> <span m="410960">function's</span> <span m="411420">going</span> <span m="411532">to</span> <span m="411645">jump</span> <span m="411757">to</span> <span m="412200">after</span> <span m="412470">[INAUDIBLE]</span> <span m="413000">execution.</span> <span m="413780">So,</span> <span m="414400">what can</span> <span m="414700">the</span> <span m="414810">attacker</span> <span m="415660">do</span> <span m="415990">once</span> <span m="416300">it's</span> <span m="416480">actually</span> <span m="417410">been</span> <span m="417550">able</span> <span m="417860">to</span> <span m="417960">hijack</span> <span m="418280">that</span> <span m="418760">return</span> <span m="419175">address,</span> <span m="419590">and jump</span> <span m="419830">wherever</span> <span m="420140">it wants.</span> <span m="420630">Well,</span> <span m="420810">basically</span> <span m="421870">the attacker</span> <span m="422280">is now</span> <span m="422635">running</span> <span m="422990">code</span> <span m="423570">with</span> <span m="423770">the</span> <span m="423880">privileges</span> <span m="424890">of</span> <span m="425070">the</span> <span m="425160">process</span> <span m="425495">that</span> <span m="425830">it's just</span> <span m="426010">hijacked,</span> <span m="426330">for</span> <span m="426650">example.</span> <span m="427360">So,</span> <span m="427940">if</span> <span m="428360">that</span> <span m="428630">process</span> <span m="429070">was</span> <span m="429526">a</span> <span m="429982">high</span> <span m="430134">priority</span> <span m="430286">process,</span> <span m="430438">let's</span> <span m="430590">say</span> <span m="430742">it</span> <span m="430894">was</span> <span m="431122">running</span> <span m="431350">root,</span> <span m="431810">or admin,</span> <span m="432480">whatever</span> <span m="432760">they</span> <span m="432900">call</span> <span m="433190">the</span> <span m="433390">super-user</span> <span m="433810">of your</span> <span m="434230">favorite</span> <span m="434675">operating system,</span> <span m="435120">then</span> <span m="435565">now,</span> <span m="436010">that program,</span> <span m="436455">which</span> <span m="436900">is</span> <span m="437345">controlled</span> <span m="437790">by the attacker,</span> <span m="438420">can</span> <span m="438530">do</span> <span m="438800">whatever</span> <span m="438990">it</span> <span m="439413">wants</span> <span m="440259">using</span> <span m="440682">the</span> <span m="441530">authority</span> <span m="442370">of</span> <span m="442570">that high-priority</span> <span m="443010">program.</span> </p>
<p><span m="444110">So,</span> <span m="444490">it</span> <span m="444612">can</span> <span m="444735">do</span> <span m="444857">things,</span> <span m="444980">like it</span> <span m="445405">could</span> <span m="445546">maybe</span> <span m="445688">read</span> <span m="445830">files,</span> <span m="446420">it</span> <span m="446795">can</span> <span m="447170">send</span> <span m="447480">spam,</span> <span m="447760">let's say</span> <span m="448135">if</span> <span m="448510">you</span> <span m="448750">corrupted a</span> <span m="448910">mail</span> <span m="449220">server.</span> <span m="449490">It</span> <span m="449760">can</span> <span m="449990">even</span> <span m="450370">do</span> <span m="450600">things</span> <span m="450870">like</span> <span m="451040">actually</span> <span m="451710">defeat</span> <span m="452440">firewalls,</span> <span m="453245">right,</span> <span m="453520">because</span> <span m="453970">the</span> <span m="454080">idea</span> <span m="454320">of</span> <span m="454430">a firewall</span> <span m="455250">is</span> <span m="455360">that there's</span> <span m="455580">going</span> <span m="455635">to</span> <span m="455690">be</span> <span m="455745">this</span> <span m="455800">distinction</span> <span m="456610">between</span> <span m="456980">good</span> <span m="457050">machines</span> <span m="457360">that</span> <span m="457670">are</span> <span m="458100">behind</span> <span m="458211">the</span> <span m="458323">firewall</span> <span m="458435">and</span> <span m="458770">bad</span> <span m="459130">machines</span> <span m="459360">that are</span> <span m="459500">outside</span> <span m="459765">of</span> <span m="460030">the firewall.</span> <span m="460880">So, typically</span> <span m="461290">machines</span> <span m="461710">are</span> <span m="461930">inside</span> <span m="462235">of</span> <span m="462540">the</span> <span m="462620">firewall,</span> <span m="463460">they</span> <span m="463570">have</span> <span m="463730">a</span> <span m="463760">lot</span> <span m="464070">of trust</span> <span m="464550">with each</span> <span m="465045">other.</span> <span m="465540">But if you</span> <span m="465940">can</span> <span m="466040">subvert</span> <span m="466530">a machine</span> <span m="466900">that is</span> <span m="467030">actually</span> <span m="467420">inside</span> <span m="468050">the</span> <span m="468110">firewall,</span> <span m="469030">right,</span> <span m="469350">that's</span> <span m="469610">great.</span> <span m="470080">Because</span> <span m="470250">now you</span> <span m="470590">can just</span> <span m="470850">sort of</span> <span m="471110">skip</span> <span m="471370">past</span> <span m="471930">a</span> <span m="472000">lot</span> <span m="472150">of</span> <span m="472220">those</span> <span m="472470">checks</span> <span m="472880">that those</span> <span m="473370">machines</span> <span m="473625">don't</span> <span m="473880">have</span> <span m="474380">because</span> <span m="474735">they</span> <span m="475090">think that</span> <span m="475450">you're a</span> <span m="475730">trusted individual.</span> </p>
<p><span m="477420">So,</span> <span m="478130">one</span> <span m="478350">thing you</span> <span m="478570">might</span> <span m="478760">be</span> <span m="478860">thinking,</span> <span m="479520">or</span> <span m="479860">I remember</span> <span m="480240">I</span> <span m="480500">was</span> <span m="480640">thinking</span> <span m="480780">this</span> <span m="480913">when</span> <span m="481046">I</span> <span m="481180">was</span> <span m="481296">a</span> <span m="481413">student,</span> <span m="481530">was,</span> <span m="481980">"OK,</span> <span m="482080">fine,</span> <span m="482310">so</span> <span m="482473">I've</span> <span m="482636">showed</span> <span m="482800">you</span> <span m="482960">how</span> <span m="483120">to</span> <span m="483280">do this</span> <span m="484130">buffer</span> <span m="484420">overflow,</span> <span m="484790">but why</span> <span m="485100">didn't</span> <span m="485300">the</span> <span m="485420">OS</span> <span m="485570">stop</span> <span m="485850">this?</span> <span m="487190">Right?</span> <span m="487490">Isn't</span> <span m="487730">the</span> <span m="487880">OS</span> <span m="488240">supposed</span> <span m="488570">to be</span> <span m="488780">that</span> <span m="489090">thing</span> <span m="489510">that's sort of</span> <span m="489930">sitting around</span> <span m="490240">like</span> <span m="490350">Guardians of</span> <span m="490850">the Galaxy</span> <span m="491135">and</span> <span m="491420">defending</span> <span m="491680">all</span> <span m="491940">this</span> <span m="492342">kind of evil</span> <span m="492744">stuff</span> <span m="493146">from happening?"</span> <span m="493950">The thing</span> <span m="494280">to</span> <span m="494590">note</span> <span m="495250">is</span> <span m="495470">that</span> <span m="496010">the</span> <span m="496540">OS</span> <span m="496940">actually</span> <span m="497470">isn't</span> <span m="497800">watching</span> <span m="498055">you</span> <span m="498310">all the</span> <span m="498600">time.</span> <span m="499570">Right?</span> <span m="499910">The</span> <span m="500010">hardware</span> <span m="500340">is</span> <span m="500670">watching all the</span> <span m="501160">time.</span> <span m="502140">It's</span> <span m="502600">the</span> <span m="502700">thing</span> <span m="503030">that's</span> <span m="503270">actually fetching</span> <span m="503570">instructions,</span> <span m="504025">and</span> <span m="504480">decoding them,</span> <span m="504795">and</span> <span m="505110">doing</span> <span m="505470">things like</span> <span m="505640">that.</span> </p>
<p><span m="506180">But</span> <span m="506370">to</span> <span m="506500">a</span> <span m="506640">first</span> <span m="507000">approximation,</span> <span m="508230">what</span> <span m="508610">does</span> <span m="508730">the</span> <span m="508820">OS</span> <span m="509180">do?</span> <span m="509430">It</span> <span m="509700">basically</span> <span m="510120">sets up</span> <span m="510340">some</span> <span m="510590">page table</span> <span m="511170">stuff,</span> <span m="511810">and then</span> <span m="512000">it</span> <span m="512179">basically</span> <span m="512590">lets</span> <span m="512820">you,</span> <span m="513090">the</span> <span m="513210">application,</span> <span m="513789">run,</span> <span m="514129">and</span> <span m="514470">if</span> <span m="514860">you ask</span> <span m="515169">the operating</span> <span m="515620">system</span> <span m="515900">for</span> <span m="516010">services--</span> <span m="516679">so</span> <span m="516809">for</span> <span m="516940">example,</span> <span m="517270">you want to</span> <span m="517309">send a</span> <span m="517730">network</span> <span m="518240">packet,</span> <span m="518840">or</span> <span m="519100">you</span> <span m="519500">want</span> <span m="519780">to</span> <span m="520000">do</span> <span m="520179">some</span> <span m="520360">IPC, or</span> <span m="520809">things</span> <span m="521130">like</span> <span m="521350">that,</span> <span m="521634">then</span> <span m="521919">you'll</span> <span m="522254">invoke a</span> <span m="522590">system</span> <span m="522960">call,</span> <span m="523360">and</span> <span m="523669">you'll</span> <span m="523750">actually</span> <span m="523980">trap into</span> <span m="524920">OS.</span> <span m="525280">But</span> <span m="525480">other than</span> <span m="525910">that,</span> <span m="526260">the operating</span> <span m="526670">system</span> <span m="527020">is</span> <span m="527130">not</span> <span m="528390">looking at</span> <span m="528590">each and every</span> <span m="528890">instruction</span> <span m="529780">that</span> <span m="529930">your</span> <span m="530080">application</span> <span m="530510">is</span> <span m="530940">executing.</span> <span m="532510">So,</span> <span m="533200">in</span> <span m="533330">other</span> <span m="533530">words,</span> <span m="533890">when</span> <span m="533990">this</span> <span m="534420">buffer</span> <span m="534832">overflowed,</span> <span m="536070">it's</span> <span m="536220">not</span> <span m="536430">like</span> <span m="536590">the</span> <span m="536680">operating system</span> <span m="537490">was looking</span> <span m="537630">at</span> <span m="538070">each</span> <span m="538420">of these</span> <span m="538620">memory</span> <span m="538970">axises</span> <span m="539660">for</span> <span m="539850">signs</span> <span m="540000">that</span> <span m="540320">[INAUDIBLE].</span> <span m="540870">Right?</span> <span m="541230">All</span> <span m="541530">of this</span> <span m="541660">address</span> <span m="542050">space</span> <span m="542290">belongs</span> <span m="542550">to</span> <span m="542730">you,</span> <span m="543180">this</span> <span m="543260">[INAUDIBLE]</span> <span m="543340">process</span> <span m="544190">right,</span> <span m="544570">so</span> <span m="544690">you get</span> <span m="545000">to</span> <span m="545080">do</span> <span m="545160">with</span> <span m="545240">it</span> <span m="545320">what you</span> <span m="545520">want to</span> <span m="546010">do</span> <span m="546115">with</span> <span m="546220">it,</span> <span m="546325">right?</span> <span m="546430">Or</span> <span m="546590">at least this</span> <span m="546830">is</span> <span m="547040">the</span> <span m="547120">whole</span> <span m="547320">C</span> <span m="547600">attitude</span> <span m="547970">towards</span> <span m="548130">life,</span> <span m="548460">right?</span> <span m="548910">Life</span> <span m="549050">fast,</span> <span m="549480">die</span> <span m="549630">young.</span> </p>
<p><span m="550080">So.</span> <span m="550600">That's</span> <span m="550840">why</span> <span m="551400">the</span> <span m="551630">operating</span> <span m="551940">system</span> <span m="552250">can't</span> <span m="552710">help you</span> <span m="553170">right there.</span> <span m="554090">So,</span> <span m="554600">later</span> <span m="555140">in</span> <span m="555480">the</span> <span m="555820">lecture,</span> <span m="556540">we will</span> <span m="556710">discuss</span> <span m="557010">some</span> <span m="557310">things</span> <span m="557590">that</span> <span m="557680">the operating system</span> <span m="558410">can</span> <span m="558670">do</span> <span m="559320">with</span> <span m="559450">respect</span> <span m="559780">to</span> <span m="559940">the hardware</span> <span m="561000">so</span> <span m="561140">that</span> <span m="561267">it</span> <span m="561395">can</span> <span m="561523">help</span> <span m="561714">protect</span> <span m="561906">against</span> <span m="562290">these</span> <span m="562515">types</span> <span m="562740">of</span> <span m="562945">attacks.</span> <span m="563560">Once again,</span> <span m="563825">it's</span> <span m="564090">actually</span> <span m="564500">just</span> <span m="564780">the</span> <span m="564860">hardware</span> <span m="565690">that's</span> <span m="566148">interposing</span> <span m="566606">on</span> <span m="566835">every</span> <span m="567064">little</span> <span m="567293">thing</span> <span m="567522">that</span> <span m="567674">you</span> <span m="567827">do.</span> <span m="567980">So,</span> <span m="568050">you can</span> <span m="568120">actually</span> <span m="568450">take</span> <span m="568670">advantage</span> <span m="569130">of</span> <span m="569250">some of that</span> <span m="569440">stuff,</span> <span m="569880">for</span> <span m="569960">example,</span> <span m="570650">using</span> <span m="571020">special types of</span> <span m="571130">[INAUDIBLE]</span> <span m="571430">protections</span> <span m="571730">and</span> <span m="571980">things like that,</span> <span m="572340">that</span> <span m="572830">we'll</span> <span m="572990">discuss</span> <span m="573255">a little bit</span> <span m="573520">later.</span> </p>
<p></p>
<p><span m="575070">That's</span> <span m="575320">basically</span> <span m="575910">an</span> <span m="575990">overview</span> <span m="576860">of</span> <span m="577020">what</span> <span m="577710">the</span> <span m="578070">buffer overflow</span> <span m="578480">looks</span> <span m="578710">like.</span> <span m="579500">So,</span> <span m="579770">how</span> <span m="579930">are</span> <span m="580056">we</span> <span m="580183">gonna</span> <span m="580310">fix</span> <span m="580420">these</span> <span m="580530">things?</span> <span m="581820">So,</span> <span m="582950">one</span> <span m="583240">fix</span> <span m="584200">for</span> <span m="585410">avoiding</span> <span m="585840">buffer</span> <span m="586330">overflow</span> <span m="589010">is</span> <span m="589320">to</span> <span m="589760">simply</span> <span m="590650">avoid</span> <span m="590960">bugs</span> <span m="593380">in</span> <span m="593720">your</span> <span m="593873">C</span> <span m="594026">code.</span> <span m="599620">This</span> <span m="599860">has</span> <span m="600125">the nice</span> <span m="600390">advantage</span> <span m="600810">of being</span> <span m="601350">correct</span> <span m="601660">by</span> <span m="601780">construction,</span> <span m="602360">right.</span> <span m="602580">If</span> <span m="602750">you don't</span> <span m="603130">have</span> <span m="603263">any</span> <span m="603396">bugs</span> <span m="603530">in</span> <span m="603648">your</span> <span m="603766">program,</span> <span m="604240">ipso facto</span> <span m="604668">the</span> <span m="605096">attacker</span> <span m="605310">cannot</span> <span m="605524">take</span> <span m="605738">advantage</span> <span m="605952">of</span> <span m="606380">any</span> <span m="606500">bugs.</span> <span m="606950">That's</span> <span m="607190">on the professor,</span> <span m="607970">I</span> <span m="608160">get paid</span> <span m="608490">to</span> <span m="608526">think</span> <span m="608563">about</span> <span m="608600">something</span> <span m="608722">deeply</span> <span m="608845">like</span> <span m="608967">that.</span> <span m="610240">Now,</span> <span m="610750">this</span> <span m="611070">of</span> <span m="611200">course,</span> <span m="611740">is</span> <span m="612270">easier</span> <span m="612650">said</span> <span m="612910">than</span> <span m="613000">done.</span> <span m="613480">Right?</span> </p>
<p><span m="613680">There's a</span> <span m="613850">couple of</span> <span m="614120">very</span> <span m="614380">straightforward</span> <span m="615100">things that</span> <span m="615340">programmers</span> <span m="615780">can do</span> <span m="616050">to</span> <span m="616320">practice</span> <span m="616940">good security</span> <span m="617300">hygiene.</span> <span m="617980">So,</span> <span m="618110">for</span> <span m="618310">example,</span> <span m="619210">functions</span> <span m="619710">like</span> <span m="620060">this</span> <span m="620290">gets</span> <span m="620550">function,</span> <span m="621170">right?</span> <span m="621420">These</span> <span m="621750">are kind of</span> <span m="622080">like</span> <span m="622240">go-tos,</span> <span m="622700">these</span> <span m="622800">are now known</span> <span m="623290">to be</span> <span m="623410">bad ideas.</span> <span m="624540">Right?</span> <span m="624880">So,</span> <span m="625050">when</span> <span m="625400">you compile</span> <span m="625970">your code,</span> <span m="626750">and</span> <span m="626930">you include</span> <span m="627210">functions like</span> <span m="627490">this--</span> <span m="628380">if</span> <span m="628500">you're using</span> <span m="628620">a</span> <span m="629050">modern</span> <span m="629480">compiler,</span> <span m="629885">GCC,</span> <span m="630290">Visual</span> <span m="630570">Studio,</span> <span m="630690">whatever,</span> <span m="631300">it</span> <span m="631380">will</span> <span m="631530">actually</span> <span m="631830">complain</span> <span m="632320">about</span> <span m="632580">that.</span> <span m="633050">It'll</span> <span m="633250">say,</span> <span m="633520">hey,</span> <span m="633820">you're</span> <span m="634200">one of these</span> <span m="634490">unsafe functions.</span> <span m="635510">Consider</span> <span m="635870">using</span> <span m="636540">[? FGADS ?],</span> <span m="636860">or</span> <span m="637430">using</span> <span m="637526">a</span> <span m="637623">version</span> <span m="637720">of</span> <span m="638010">[INAUDIBLE]</span> <span m="638620">that</span> <span m="638720">actually</span> <span m="639590">can track</span> <span m="640010">the bounds</span> <span m="640430">of things.</span> <span m="641270">So, that's</span> <span m="641740">one</span> <span m="641960">simple thing</span> <span m="642150">that</span> <span m="642430">programmers</span> <span m="642886">can do.</span> </p>
<p><span m="643800">But note</span> <span m="644300">that</span> <span m="644440">a</span> <span m="644510">lot</span> <span m="644750">of</span> <span m="644850">applications</span> <span m="645640">actually</span> <span m="646250">manipulate</span> <span m="646880">buffers</span> <span m="647630">without</span> <span m="647980">necessarily</span> <span m="648470">calling</span> <span m="648800">one of these</span> <span m="649130">functions.</span> <span m="649610">Right?</span> <span m="649790">This</span> <span m="649940">is</span> <span m="650050">very</span> <span m="650330">common</span> <span m="650710">in network</span> <span m="651070">servers,</span> <span m="651590">things</span> <span m="651720">like</span> <span m="651920">that.</span> <span m="652540">They'll</span> <span m="652760">define their</span> <span m="652940">own</span> <span m="653230">custom</span> <span m="653630">parsing</span> <span m="653995">routines,</span> <span m="654360">then make sure</span> <span m="654830">that things</span> <span m="655200">are extracted</span> <span m="655565">from the buffers</span> <span m="655930">in the way</span> <span m="656310">that they</span> <span m="656670">want.</span> <span m="657110">So,</span> <span m="657480">just</span> <span m="657700">restricting</span> <span m="658160">yourself</span> <span m="658600">to</span> <span m="658780">these types of</span> <span m="659130">things</span> <span m="659480">won't</span> <span m="659720">solve</span> <span m="659980">the</span> <span m="660060">problem</span> <span m="660400">completely.</span> <span m="663350">So,</span> <span m="663740">another</span> <span m="664040">thing</span> <span m="664430">that</span> <span m="665190">makes</span> <span m="665420">this</span> <span m="665630">approach</span> <span m="666130">difficult</span> <span m="667340">is</span> <span m="667650">that</span> <span m="667890">it's</span> <span m="668070">not</span> <span m="668400">always</span> <span m="668810">obvious</span> <span m="670050">what</span> <span m="670290">is</span> <span m="670430">a</span> <span m="670725">bug</span> <span m="671020">in a</span> <span m="671290">C program.</span> </p>
<p><span m="672330">So,</span> <span m="672370">if</span> <span m="672440">you've</span> <span m="672580">ever</span> <span m="672760">worked</span> <span m="673010">on a</span> <span m="673190">very</span> <span m="673470">large</span> <span m="673840">scale</span> <span m="674090">system</span> <span m="674440">that's been</span> <span m="674871">written</span> <span m="675302">in C,</span> <span m="675733">you'll know</span> <span m="676164">that it can</span> <span m="676595">be tricky</span> <span m="677030">if you've</span> <span m="677320">got</span> <span m="677520">some</span> <span m="677670">function</span> <span m="678360">definition</span> <span m="679100">that</span> <span m="679280">takes</span> <span m="679580">then</span> <span m="680060">18</span> <span m="680530">void</span> <span m="680810">star</span> <span m="681120">pointers.</span> <span m="682080">I mean,</span> <span m="682230">only</span> <span m="682460">Zeus knows</span> <span m="682900">what</span> <span m="683170">all</span> <span m="683330">those</span> <span m="683530">things</span> <span m="683790">mean,</span> <span m="684205">right?</span> <span m="684620">And</span> <span m="684830">so</span> <span m="685310">it's</span> <span m="685510">much</span> <span m="685860">more</span> <span m="686090">difficult</span> <span m="686430">in a</span> <span m="686770">language</span> <span m="687140">like</span> <span m="687350">C, that has</span> <span m="688470">weak</span> <span m="688690">typing</span> <span m="689270">and</span> <span m="689540">things</span> <span m="689830">like</span> <span m="690010">that,</span> <span m="690260">to actually</span> <span m="690650">understand</span> <span m="690925">as</span> <span m="691200">a</span> <span m="691260">programmer</span> <span m="691680">what</span> <span m="692120">it means</span> <span m="692210">to have a</span> <span m="692450">bug,</span> <span m="692680">and what it</span> <span m="693170">means to not</span> <span m="693440">have</span> <span m="693690">a bug.</span> <span m="694320">OK?</span> </p>
<p><span m="694600">So,</span> <span m="695060">in</span> <span m="695220">general,</span> <span m="695570">one of</span> <span m="695780">the</span> <span m="695900">main</span> <span m="696280">themes</span> <span m="696990">that you'll see</span> <span m="697360">in</span> <span m="697480">this</span> <span m="697660">class</span> <span m="698490">is</span> <span m="698720">that</span> <span m="698950">C</span> <span m="699420">is</span> <span m="699580">probably</span> <span m="699920">the</span> <span m="700260">spawn of</span> <span m="700530">the devil,</span> <span m="701022">right?</span> <span m="702498">And we</span> <span m="702990">use it</span> <span m="703482">because,</span> <span m="703980">once</span> <span m="704290">again,</span> <span m="704710">we</span> <span m="704770">typically</span> <span m="704830">want</span> <span m="704890">to</span> <span m="704950">be</span> <span m="705010">to</span> <span m="705090">be</span> <span m="705340">fast,</span> <span m="706140">right?</span> <span m="706630">But</span> <span m="706780">as</span> <span m="706940">hardware</span> <span m="707350">gets</span> <span m="707580">faster</span> <span m="707945">and</span> <span m="708310">as we</span> <span m="708430">get</span> <span m="708680">more</span> <span m="709350">and better</span> <span m="709770">languages</span> <span m="710230">to write</span> <span m="710800">large-scale</span> <span m="711150">systems</span> <span m="711560">code,</span> <span m="711780">we'll</span> <span m="711920">see</span> <span m="712460">that</span> <span m="712620">maybe</span> <span m="713340">it</span> <span m="713500">doesn't</span> <span m="713760">always</span> <span m="714090">make</span> <span m="714370">sense</span> <span m="714850">to</span> <span m="715020">write</span> <span m="715230">your</span> <span m="715390">stuff</span> <span m="715660">in</span> <span m="715790">C.</span> <span m="716540">Even if you</span> <span m="716930">think it</span> <span m="717130">has</span> <span m="717570">to be fast.</span> <span m="718300">So,</span> <span m="718460">we'll discuss</span> <span m="718780">some of that</span> <span m="719100">later</span> <span m="719660">and</span> <span m="720237">later lectures.</span> </p>
<p><span m="721400">So,</span> <span m="721740">that's</span> <span m="722210">one approach,</span> <span m="722910">avoiding</span> <span m="723100">bugs</span> <span m="723600">in the</span> <span m="724030">first place.</span> <span m="724340">So,</span> <span m="724910">another</span> <span m="725220">approach--</span> <span m="730560">is</span> <span m="730840">to</span> <span m="731740">build</span> <span m="732080">tools</span> <span m="735040">that</span> <span m="735170">allow</span> <span m="736860">programmers</span> <span m="737170">to find</span> <span m="737610">bugs.</span> <span m="746670">And</span> <span m="747040">so</span> <span m="747410">an</span> <span m="747500">example</span> <span m="748050">of</span> <span m="748160">this</span> <span m="748610">is</span> <span m="748740">something</span> <span m="749530">that's</span> <span m="749720">called</span> <span m="749930">static</span> <span m="750320">analysis.</span> <span m="751220">Now</span> <span m="751350">we'll</span> <span m="751500">talk</span> <span m="751730">a</span> <span m="751750">little</span> <span m="751930">bit</span> <span m="752070">more</span> <span m="752260">about</span> <span m="752510">static</span> <span m="752800">analysis</span> <span m="753175">in later</span> <span m="753550">lectures,</span> <span m="754210">but</span> <span m="754340">suffice</span> <span m="754760">it to</span> <span m="754850">say</span> <span m="755280">that</span> <span m="755650">static analysis</span> <span m="756570">is</span> <span m="756760">a</span> <span m="756870">way</span> <span m="757130">of</span> <span m="757260">analyzing</span> <span m="757890">the</span> <span m="758000">source</span> <span m="758400">code</span> <span m="758740">of your</span> <span m="759050">program</span> <span m="759470">before</span> <span m="759870">it even runs</span> <span m="760640">and</span> <span m="760810">looking</span> <span m="761230">for</span> <span m="761380">potential</span> <span m="761740">problems.</span> <span m="762530">So,</span> <span m="762780">imagine</span> <span m="763180">that</span> <span m="763807">you have</span> <span m="764264">a function</span> <span m="764721">like this.</span> <span m="766550">So,</span> <span m="767240">the</span> <span m="767520">[INAUDIBLE]</span> <span m="768015">foo</span> <span m="768510">function,</span> <span m="770342">it takes</span> <span m="770800">in</span> <span m="771716">a</span> <span m="772180">pointer.</span> <span m="776420">Let's</span> <span m="776650">say</span> <span m="776850">it declares</span> <span m="777860">an</span> <span m="778350">integer</span> <span m="778740">offset</span> <span m="779250">value.</span> <span m="782810">It</span> <span m="783290">declares</span> <span m="783860">another</span> <span m="784270">pointer</span> <span m="787940">and</span> <span m="788240">adds</span> <span m="789130">the</span> <span m="789280">offset</span> <span m="790110">to</span> <span m="790260">that</span> <span m="790550">pointer.</span> <span m="791540">Now,</span> <span m="791710">even</span> <span m="791980">just at</span> <span m="792190">this</span> <span m="792370">moment</span> <span m="792635">in the</span> <span m="792900">code,</span> <span m="793620">right,</span> <span m="793810">static</span> <span m="794230">analysis</span> <span m="794790">can</span> <span m="794920">tell</span> <span m="795160">you</span> <span m="795650">that</span> <span m="795850">this</span> <span m="796040">offset</span> <span m="796420">variable</span> <span m="796980">is</span> <span m="797250">un-initialized.</span> <span m="798250">Right?</span> </p>
<p><span m="798610">So,</span> <span m="798780">essentially</span> <span m="799200">you can</span> <span m="799300">do</span> <span m="799550">things</span> <span m="799840">like</span> <span m="800030">saying,</span> <span m="800700">is</span> <span m="800810">there</span> <span m="801040">any</span> <span m="801300">way,</span> <span m="801860">is there</span> <span m="802080">any control</span> <span m="802375">floating</span> <span m="802670">through</span> <span m="802880">this</span> <span m="803220">program</span> <span m="804010">by</span> <span m="804110">which</span> <span m="804600">offset</span> <span m="805790">could</span> <span m="805850">have</span> <span m="806040">been</span> <span m="806150">initialized</span> <span m="807100">before</span> <span m="807480">it was</span> <span m="807620">actually</span> <span m="808050">used</span> <span m="808440">this</span> <span m="808600">in this calculation</span> <span m="809160">here.</span> <span m="809660">Now,</span> <span m="809870">in this</span> <span m="810040">example</span> <span m="810400">it is</span> <span m="810490">very</span> <span m="810680">simple</span> <span m="810980">to</span> <span m="811040">see</span> <span m="811240">the</span> <span m="811350">answer</span> <span m="811830">is no.</span> <span m="812540">Right?</span> <span m="812770">You</span> <span m="812850">can</span> <span m="812960">imagine</span> <span m="813380">that</span> <span m="813600">if there were</span> <span m="813810">more</span> <span m="814000">branches,</span> <span m="814275">or</span> <span m="814670">things</span> <span m="814960">like</span> <span m="815180">this,</span> <span m="815580">it</span> <span m="815662">would</span> <span m="815745">be</span> <span m="815827">more</span> <span m="815910">difficult</span> <span m="816260">to tell.</span> <span m="816630">But</span> <span m="817000">one</span> <span m="817270">thing</span> <span m="817540">that</span> <span m="817750">a</span> <span m="818010">static analysis</span> <span m="818355">tool</span> <span m="818700">can tell you,</span> <span m="819130">and in fact,</span> <span m="819380">one thing</span> <span m="819540">that</span> <span m="820060">[? popular ?]</span> <span m="820460">compilers</span> <span m="820890">will</span> <span m="821090">tell</span> <span m="821280">you,</span> <span m="821480">is</span> <span m="821880">you'll compile</span> <span m="821950">this,</span> <span m="822325">and</span> <span m="822700">it'll</span> <span m="822880">say,</span> <span m="823100">hey</span> <span m="823260">buddy,</span> <span m="823610">this</span> <span m="823960">has not</span> <span m="824310">been</span> <span m="824390">initialized.</span> <span m="825190">Are</span> <span m="825283">you</span> <span m="825376">sure,</span> <span m="825470">is</span> <span m="825533">this</span> <span m="825596">what</span> <span m="825660">you</span> <span m="825730">want</span> <span m="825800">to</span> <span m="825870">do?</span> </p>
<p><span m="826580">So,</span> <span m="827080">that's</span> <span m="827280">one</span> <span m="827470">very</span> <span m="827960">simple example</span> <span m="828380">of static</span> <span m="828640">analysis.</span> <span m="829330">Another</span> <span m="829950">example</span> <span m="830080">of</span> <span m="830220">what you</span> <span m="830480">can</span> <span m="830890">do</span> <span m="831520">is,</span> <span m="831990">let's</span> <span m="832280">say</span> <span m="832500">after</span> <span m="832950">this,</span> <span m="833330">we</span> <span m="833480">have</span> <span m="834230">a</span> <span m="834333">branch</span> <span m="834436">condition</span> <span m="834540">here.</span> <span m="842470">Right?</span> <span m="842760">So,</span> <span m="842830">you</span> <span m="842930">say,</span> <span m="843220">if the</span> <span m="843450">offset</span> <span m="844140">is</span> <span m="844270">greater than</span> <span m="844670">eight,</span> <span m="845580">then</span> <span m="846240">we'll call</span> <span m="846555">some</span> <span m="846870">function</span> <span m="849110">bar,</span> <span m="850950">and</span> <span m="851240">passing</span> <span m="851390">the offset.</span> <span m="852470">Now,</span> <span m="852750">one thing</span> <span m="853090">you can</span> <span m="853150">note</span> <span m="853400">about</span> <span m="853700">this</span> <span m="854090">is</span> <span m="854230">that</span> <span m="854750">this</span> <span m="855080">branch</span> <span m="855440">condition</span> <span m="856020">here</span> <span m="856500">actually</span> <span m="857010">tells</span> <span m="857450">us</span> <span m="857620">something</span> <span m="858120">about</span> <span m="858370">what</span> <span m="858520">the</span> <span m="858620">value</span> <span m="858960">of</span> <span m="859060">offset</span> <span m="859460">is.</span> <span m="860160">Right?</span> <span m="860730">Ignoring</span> <span m="861220">the</span> <span m="861330">fact</span> <span m="861580">that</span> <span m="861710">it</span> <span m="861900">wasn't</span> <span m="861980">initialized ,</span> <span m="862370">we</span> <span m="862720">do</span> <span m="862980">know</span> <span m="863500">that</span> <span m="863680">once</span> <span m="863990">we get</span> <span m="864380">here,</span> <span m="864770">we know</span> <span m="864990">the offset</span> <span m="865330">actually</span> <span m="865425">has</span> <span m="865520">to</span> <span m="865615">be</span> <span m="865710">greater</span> <span m="865836">than</span> <span m="865963">eight.</span> <span m="866870">So,</span> <span m="866960">in</span> <span m="867090">some</span> <span m="867350">cases,</span> <span m="867700">what</span> <span m="867820">we</span> <span m="868140">can do</span> <span m="868430">is</span> <span m="868540">actually</span> <span m="868860">propagate</span> <span m="869950">that</span> <span m="870270">constraint,</span> <span m="871230">that</span> <span m="871470">notion</span> <span m="871840">that</span> <span m="872160">the</span> <span m="872370">offset</span> <span m="872690">must be</span> <span m="873010">greater than</span> <span m="873300">eight,</span> <span m="873830">into</span> <span m="874220">our</span> <span m="874420">analysis</span> <span m="874870">of bar.</span> <span m="875580">Right?</span> <span m="875840">So,</span> <span m="876010">when we</span> <span m="876210">start</span> <span m="876670">statically</span> <span m="876900">analyzing</span> <span m="877410">bar,</span> <span m="877760">we</span> <span m="878110">know</span> <span m="878610">that</span> <span m="878830">offset</span> <span m="879210">can</span> <span m="879590">only</span> <span m="879973">take</span> <span m="880356">certain values.</span> <span m="880740">So,</span> <span m="880880">once again,</span> <span m="881070">this is</span> <span m="881310">a</span> <span m="881380">very</span> <span m="881780">high-level</span> <span m="882080">introduction</span> <span m="882510">to</span> <span m="882760">static analysis,</span> <span m="883125">and</span> <span m="883490">we'll</span> <span m="883710">discuss</span> <span m="884050">it more</span> <span m="884390">in</span> <span m="884550">later</span> <span m="884710">lectures.</span> </p>
<p><span m="885190">But</span> <span m="885290">this</span> <span m="885350">is</span> <span m="885490">a</span> <span m="885550">basic</span> <span m="885980">intuition</span> <span m="886510">of</span> <span m="886600">how</span> <span m="886860">we</span> <span m="886920">might</span> <span m="887120">be</span> <span m="887260">able</span> <span m="887450">to</span> <span m="887560">detect</span> <span m="888150">some types</span> <span m="888920">of bugs</span> <span m="889420">without</span> <span m="889760">even</span> <span m="889980">executing</span> <span m="890270">your code.</span> <span m="891460">So,</span> <span m="891590">does that</span> <span m="891790">all</span> <span m="892060">makes</span> <span m="892300">sense?</span> <span m="895184">So,</span> <span m="895643">another thing</span> <span m="896102">you can</span> <span m="896561">think about</span> <span m="897020">doing too</span> <span m="897560">is</span> <span m="898980">what</span> <span m="899150">they</span> <span m="899250">call</span> <span m="899540">program</span> <span m="900160">fuzzing.</span> <span m="902250">So,</span> <span m="902500">the</span> <span m="902630">idea</span> <span m="902920">behind</span> <span m="903205">program</span> <span m="903890">fuzzing</span> <span m="904380">is</span> <span m="904520">that</span> <span m="904750">essentially</span> <span m="905075">you</span> <span m="905400">take</span> <span m="905770">all</span> <span m="906200">of</span> <span m="906360">the</span> <span m="906520">functions</span> <span m="906680">in your</span> <span m="906830">code,</span> <span m="907660">and then</span> <span m="907870">essentially</span> <span m="908360">throw</span> <span m="909060">random</span> <span m="909490">values</span> <span m="909880">for</span> <span m="910170">input</span> <span m="910630">to those</span> <span m="910900">functions.</span> <span m="912175">And</span> <span m="912470">so</span> <span m="912570">the</span> <span m="912700">idea</span> <span m="913150">is that</span> <span m="913310">you</span> <span m="913410">want</span> <span m="913580">to</span> <span m="913640">have</span> <span m="914220">high</span> <span m="914700">code</span> <span m="915010">coverage</span> <span m="915550">for all of</span> <span m="915855">your</span> <span m="916250">tests.</span> <span m="917450">So,</span> <span m="917650">if</span> <span m="917760">you</span> <span m="917850">go</span> <span m="918090">out</span> <span m="918490">in</span> <span m="918700">the</span> <span m="918800">real</span> <span m="919080">world,</span> <span m="919480">typically</span> <span m="919640">when</span> <span m="920030">you</span> <span m="920365">check in</span> <span m="920476">unit</span> <span m="920588">test,</span> <span m="921160">you can't</span> <span m="921475">just do</span> <span m="921790">things</span> <span m="922350">like,</span> <span m="922600">I tried</span> <span m="922920">values</span> <span m="923390">two,</span> <span m="923620">four,</span> <span m="924053">eight,</span> <span m="924486">and 15,</span> <span m="924920">because</span> <span m="925010">15</span> <span m="925285">is an</span> <span m="925560">odd</span> <span m="925830">number,</span> <span m="926170">so I</span> <span m="926580">probably</span> <span m="926960">tested</span> <span m="927025">all</span> <span m="927090">the</span> <span m="927155">branches</span> <span m="927220">right.</span> </p>
<p><span m="928150">What you</span> <span m="928280">actually</span> <span m="928510">have</span> <span m="928810">to do</span> <span m="929075">is you have</span> <span m="929340">to</span> <span m="929530">look</span> <span m="929710">at</span> <span m="929790">things</span> <span m="930040">like,</span> <span m="930380">like</span> <span m="930670">I</span> <span m="930710">said</span> <span m="930930">how</span> <span m="931140">many</span> <span m="931390">branches</span> <span m="931720">in the</span> <span m="932093">program</span> <span m="932466">overall</span> <span m="932840">were</span> <span m="933300">actually</span> <span m="933510">touched</span> <span m="933942">by</span> <span m="934374">your</span> <span m="934806">test</span> <span m="935238">code,</span> <span m="935670">right?</span> <span m="936540">Because</span> <span m="936660">that's</span> <span m="936766">typically</span> <span m="936873">where</span> <span m="936980">the bugs</span> <span m="937240">hide.</span> <span m="938000">The programmers</span> <span m="938400">don't</span> <span m="938710">think</span> <span m="938930">about the</span> <span m="939260">corner</span> <span m="939570">cases,</span> <span m="939870">and</span> <span m="940170">so</span> <span m="940330">as</span> <span m="940430">a</span> <span m="940500">result,</span> <span m="940890">they</span> <span m="940990">do</span> <span m="941180">have</span> <span m="941340">some</span> <span m="941490">unit</span> <span m="941960">tests</span> <span m="942116">that</span> <span m="942273">pass.</span> <span m="942430">They</span> <span m="942900">even</span> <span m="943017">have</span> <span m="943135">bigger</span> <span m="943252">tests</span> <span m="943370">that</span> <span m="943605">pass.</span> <span m="944310">But</span> <span m="944400">they're</span> <span m="944520">not actually</span> <span m="944900">pinning</span> <span m="945210">all the</span> <span m="945545">corner cases</span> <span m="946220">in the</span> <span m="946560">program.</span> <span m="947170">So, static</span> <span m="947710">analysis</span> <span m="948350">can</span> <span m="948420">actually</span> <span m="948800">help</span> <span m="949150">with this</span> <span m="949400">fuzzing</span> <span m="949750">here.</span> <span m="950200">Once again,</span> <span m="950690">using</span> <span m="950910">things</span> <span m="951270">like this</span> <span m="951692">notion of</span> <span m="952114">constraint.</span> <span m="952960">So,</span> <span m="953100">for</span> <span m="953260">example,</span> <span m="953570">in</span> <span m="953880">this</span> <span m="954110">program</span> <span m="954520">here,</span> <span m="954980">we</span> <span m="955120">have</span> <span m="955350">this</span> <span m="955540">branch</span> <span m="955825">condition</span> <span m="956340">here</span> <span m="957040">that</span> <span m="957250">specified</span> <span m="957580">the</span> <span m="957910">offset</span> <span m="958260">being</span> <span m="958640">greater</span> <span m="959020">than eight.</span> </p>
<p><span m="959400">So,</span> <span m="959580">we can</span> <span m="959900">know</span> <span m="960290">what that</span> <span m="960470">offset</span> <span m="960840">is</span> <span m="961050">statically.</span> <span m="961530">So,</span> <span m="961710">we can</span> <span m="962120">make sure</span> <span m="962475">that if we're</span> <span m="962830">automatically</span> <span m="963440">generating</span> <span m="963860">fuzzed</span> <span m="964230">inputs,</span> <span m="965040">we</span> <span m="965140">can</span> <span m="965340">ensure</span> <span m="965970">that</span> <span m="966310">one</span> <span m="966560">of those</span> <span m="967020">inputs</span> <span m="968230">hopefully</span> <span m="968500">will</span> <span m="968730">ensure</span> <span m="969115">that,</span> <span m="969500">somehow,</span> <span m="969820">offset</span> <span m="970010">is less</span> <span m="970210">than</span> <span m="970350">eight,</span> <span m="970710">one will</span> <span m="971085">ensure that</span> <span m="971460">offset's</span> <span m="971750">equal</span> <span m="972080">to eight,</span> <span m="972490">one</span> <span m="972603">will</span> <span m="972716">ensure</span> <span m="972830">that it's</span> <span m="973150">greater</span> <span m="973233">than</span> <span m="973316">eight.</span> <span m="975290">So,</span> <span m="975430">does</span> <span m="975735">that all</span> <span m="976040">make</span> <span m="976230">sense?</span> <span m="978690">Cool.</span> </p>
<p><span m="979000">So,</span> <span m="979590">that's the basic</span> <span m="979840">idea</span> <span m="980316">behind</span> <span m="980792">the notion</span> <span m="981270">of</span> <span m="981610">building</span> <span m="981780">tools</span> <span m="982280">to help</span> <span m="982740">programmers</span> <span m="982960">find</span> <span m="983500">bugs.</span> <span m="984100">So,</span> <span m="984600">the</span> <span m="984730">nice</span> <span m="985040">thing</span> <span m="985400">is</span> <span m="985640">that</span> <span m="986820">even</span> <span m="987610">partial</span> <span m="988340">analysis</span> <span m="988685">can</span> <span m="989030">be</span> <span m="989484">very,</span> <span m="989938">very</span> <span m="990392">useful,</span> <span m="990619">particularly</span> <span m="990846">when</span> <span m="991073">you're</span> <span m="991300">dealing</span> <span m="991451">with</span> <span m="991602">C.</span> <span m="991754">A</span> <span m="992210">lot</span> <span m="992430">of</span> <span m="992510">these</span> <span m="992650">tools</span> <span m="992990">that we'll</span> <span m="993240">discuss,</span> <span m="993710">to</span> <span m="993980">prevent</span> <span m="994250">against things</span> <span m="994520">like</span> <span m="995020">buffer</span> <span m="995350">overflow</span> <span m="995660">or</span> <span m="995970">initialized</span> <span m="996383">variables,</span> <span m="997210">they</span> <span m="997320">can't</span> <span m="997640">catch</span> <span m="997890">all the</span> <span m="998200">problems.</span> <span m="999090">Right?</span> <span m="999410">But</span> <span m="999540">they</span> <span m="999660">can</span> <span m="999930">actually</span> <span m="1000220">give us</span> <span m="1000430">forward</span> <span m="1001050">progress</span> <span m="1001440">towards</span> <span m="1001830">making</span> <span m="1002040">these</span> <span m="1002540">programs</span> <span m="1002945">more</span> <span m="1003350">secure.</span> <span m="1004065">Now,</span> <span m="1004550">of course,</span> <span m="1005035">the disadvantage</span> <span m="1005520">of these</span> <span m="1005670">things</span> <span m="1006120">is that</span> <span m="1006660">they're</span> <span m="1006830">not</span> <span m="1007230">complete.</span> <span m="1008510">Forward</span> <span m="1008880">progress</span> <span m="1008990">is not</span> <span m="1009200">complete</span> <span m="1009560">progress.</span> <span m="1010280">And</span> <span m="1010500">so</span> <span m="1010980">it's</span> <span m="1011170">still</span> <span m="1011500">a very</span> <span m="1011860">active</span> <span m="1012210">area of</span> <span m="1012676">research</span> <span m="1013142">of how</span> <span m="1013610">you defend</span> <span m="1014450">against</span> <span m="1014810">security</span> <span m="1015320">exploits</span> <span m="1015675">in</span> <span m="1016030">C</span> <span m="1016395">and just in</span> <span m="1016760">programs</span> <span m="1017120">in general.</span> </p>
<p><span m="1020440">So,</span> <span m="1020710">those</span> <span m="1021020">were</span> <span m="1021110">two</span> <span m="1021270">approaches</span> <span m="1021720">to</span> <span m="1021820">deal</span> <span m="1022120">with</span> <span m="1023230">defending</span> <span m="1023649">against</span> <span m="1024400">buffer overflow.</span> <span m="1025210">There's</span> <span m="1025369">actually</span> <span m="1026589">some</span> <span m="1026770">other</span> <span m="1027044">approaches.</span> <span m="1027810">So, a</span> <span m="1028300">third approach</span> <span m="1028790">you</span> <span m="1029252">might</span> <span m="1029714">think</span> <span m="1030176">about</span> <span m="1030638">using</span> <span m="1033410">is the</span> <span m="1033880">use</span> <span m="1034243">[INAUDIBLE].</span> <span m="1041672">And so</span> <span m="1042150">examples of these</span> <span m="1042770">are</span> <span m="1043920">things</span> <span m="1044609">like</span> <span m="1046849">Python,</span> <span m="1050730">Java,</span> <span m="1054950">C#--</span> <span m="1056680">I'm</span> <span m="1056910">not</span> <span m="1057140">going</span> <span m="1057255">to</span> <span m="1057370">put</span> <span m="1057485">up</span> <span m="1057600">Pearl</span> <span m="1058060">there</span> <span m="1058520">because</span> <span m="1058635">people</span> <span m="1058750">who</span> <span m="1058845">use</span> <span m="1058940">Pearl</span> <span m="1059070">are</span> <span m="1059200">bad</span> <span m="1059445">people.</span> </p>
<p><span m="1059690">So</span> <span m="1061400">you can use</span> <span m="1061680">a memory-safe</span> <span m="1062025">language</span> <span m="1062370">like</span> <span m="1062600">that.</span> <span m="1063700">And</span> <span m="1064060">this</span> <span m="1064500">is</span> <span m="1064560">to a</span> <span m="1064640">certain</span> <span m="1064970">extent</span> <span m="1065340">seems</span> <span m="1065930">like</span> <span m="1066220">the most</span> <span m="1066460">obvious</span> <span m="1066755">thing</span> <span m="1066814">that</span> <span m="1066873">you</span> <span m="1066932">could</span> <span m="1066991">do.</span> <span m="1068300">I</span> <span m="1068410">just</span> <span m="1068830">told</span> <span m="1069060">you</span> <span m="1069150">over</span> <span m="1069350">there</span> <span m="1069635">that</span> <span m="1069950">basically</span> <span m="1070680">C</span> <span m="1071060">is</span> <span m="1071170">high-level</span> <span m="1071350">assembly</span> <span m="1071820">code,</span> <span m="1072455">and it</span> <span m="1072940">exposes</span> <span m="1073290">raw</span> <span m="1073640">pointers</span> <span m="1074090">and</span> <span m="1074220">does</span> <span m="1074420">all</span> <span m="1074560">these</span> <span m="1074790">things</span> <span m="1075410">that</span> <span m="1075590">you</span> <span m="1075640">don't</span> <span m="1075890">want it</span> <span m="1076320">to do,</span> <span m="1076690">and it</span> <span m="1076990">doesn't</span> <span m="1077046">do</span> <span m="1077103">things</span> <span m="1077160">you</span> <span m="1077350">do want</span> <span m="1077590">it</span> <span m="1078010">to do,</span> <span m="1078380">like</span> <span m="1078600">[INAUDIBLE].</span> <span m="1079000">So,</span> <span m="1079830">why not</span> <span m="1080210">just</span> <span m="1080255">use</span> <span m="1080300">one</span> <span m="1080345">of</span> <span m="1080390">these</span> <span m="1080435">high</span> <span m="1080480">level</span> <span m="1080750">languages?</span> </p>
<p><span m="1081020">Well,</span> <span m="1081340">there's</span> <span m="1081670">a</span> <span m="1081760">couple</span> <span m="1082050">reasons</span> <span m="1082360">for</span> <span m="1082460">that.</span> <span m="1083340">So,</span> <span m="1084250">first</span> <span m="1084490">of</span> <span m="1084610">all,</span> <span m="1085700">there's</span> <span m="1085790">actually</span> <span m="1086270">a</span> <span m="1086350">lot</span> <span m="1087302">of</span> <span m="1089110">legacy</span> <span m="1089400">code</span> <span m="1089890">that's</span> <span m="1090380">out</span> <span m="1090870">there.</span> <span m="1094800">Right?</span> <span m="1095080">So, it's</span> <span m="1095350">all fine</span> <span m="1095620">and dandy</span> <span m="1095960">if</span> <span m="1096360">you</span> <span m="1096460">want</span> <span m="1096590">go out and</span> <span m="1096910">start</span> <span m="1097310">your</span> <span m="1097330">new</span> <span m="1097510">project</span> <span m="1097970">and</span> <span m="1098040">you</span> <span m="1098110">want</span> <span m="1098180">to</span> <span m="1098250">write</span> <span m="1098730">it in</span> <span m="1099080">one</span> <span m="1099166">of</span> <span m="1099253">these</span> <span m="1099340">really</span> <span m="1099440">safe</span> <span m="1099540">languages.</span> </p>
<p><span m="1100200">But</span> <span m="1100390">what</span> <span m="1100560">if</span> <span m="1100690">you've</span> <span m="1100830">been</span> <span m="1100960">given</span> <span m="1101270">this</span> <span m="1101740">big</span> <span m="1102140">binary</span> <span m="1103640">or</span> <span m="1103870">this big source</span> <span m="1104160">code</span> <span m="1104280">distribution that's been</span> <span m="1104720">written</span> <span m="1105075">in C,</span> <span m="1105880">it's</span> <span m="1105980">been maintained</span> <span m="1106480">for 10,</span> <span m="1106980">15</span> <span m="1107430">years,</span> <span m="1107830">it's been this</span> <span m="1108050">generational</span> <span m="1108650">project,</span> <span m="1108915">I mean</span> <span m="1109400">our</span> <span m="1109550">children's</span> <span m="1109880">children</span> <span m="1110310">will</span> <span m="1110600">be</span> <span m="1110890">working</span> <span m="1111006">on</span> <span m="1111123">it.</span> <span m="1111240">You</span> <span m="1111362">can't</span> <span m="1111485">just</span> <span m="1111607">say,</span> <span m="1111730">I'm</span> <span m="1111920">just going</span> <span m="1112350">to write</span> <span m="1112725">everything in C#</span> <span m="1113100">and</span> <span m="1113557">change</span> <span m="1113709">the</span> <span m="1113861">world.</span> <span m="1114471">Right?</span> <span m="1114930">And</span> <span m="1115400">this</span> <span m="1115700">isn't</span> <span m="1115830">just</span> <span m="1115880">a problem</span> <span m="1116320">in C,</span> <span m="1116635">for example.</span> <span m="1117160">There's</span> <span m="1117380">actually</span> <span m="1117930">systems</span> <span m="1118360">that you use</span> <span m="1119266">that you</span> <span m="1119720">should</span> <span m="1119890">be</span> <span m="1120040">afraid,</span> <span m="1120490">because</span> <span m="1120750">they actually</span> <span m="1121110">use</span> <span m="1121470">Fortran</span> <span m="1122250">and</span> <span m="1122460">COBOL</span> <span m="1122850">code.</span> <span m="1123570">What?</span> <span m="1124170">That's</span> <span m="1124410">stuff from</span> <span m="1124600">the</span> <span m="1124710">Civil</span> <span m="1124990">War.</span> </p>
<p><span m="1126260">So,</span> <span m="1127040">why</span> <span m="1127280">does</span> <span m="1127420">that</span> <span m="1127590">happen?</span> <span m="1128280">Once</span> <span m="1128680">again,</span> <span m="1128890">the</span> <span m="1128990">reason</span> <span m="1129150">why</span> <span m="1129350">it</span> <span m="1129440">happens</span> <span m="1129710">is</span> <span m="1129980">because</span> <span m="1130790">as</span> <span m="1131080">engineers,</span> <span m="1131405">we kind</span> <span m="1131730">of want to</span> <span m="1132130">think,</span> <span m="1132530">oh, we can</span> <span m="1133010">just</span> <span m="1133160">build</span> <span m="1133355">everything</span> <span m="1133550">ourselves,</span> <span m="1134030">it'll be</span> <span m="1134230">awesome,</span> <span m="1134565">it'll be</span> <span m="1134900">just</span> <span m="1135035">the</span> <span m="1135171">way</span> <span m="1135307">that</span> <span m="1135408">I</span> <span m="1135510">want</span> <span m="1135612">it,</span> <span m="1135714">I'll</span> <span m="1135849">call</span> <span m="1135985">my</span> <span m="1136121">variables</span> <span m="1136530">the</span> <span m="1136880">things</span> <span m="1136970">that I want.</span> <span m="1137740">When</span> <span m="1137900">in</span> <span m="1138080">world, that</span> <span m="1138410">doesn't happen.</span> <span m="1139020">Right?</span> <span m="1139400">You show up</span> <span m="1139720">on</span> <span m="1139810">your</span> <span m="1139950">job,</span> <span m="1140230">and</span> <span m="1140510">you</span> <span m="1140710">have</span> <span m="1140980">this</span> <span m="1141310">thing</span> <span m="1141565">that</span> <span m="1141820">exists,</span> <span m="1142195">and</span> <span m="1142570">you</span> <span m="1143010">look</span> <span m="1143330">at</span> <span m="1143430">the</span> <span m="1143680">code</span> <span m="1144120">base,</span> <span m="1144400">and you</span> <span m="1144780">say, well,</span> <span m="1145225">why</span> <span m="1145314">doesn't</span> <span m="1145403">it</span> <span m="1145492">do</span> <span m="1145581">this?</span> <span m="1145670">And</span> <span m="1145790">then</span> <span m="1145910">you</span> <span m="1146030">say,</span> <span m="1146150">listen.</span> <span m="1147280">We'll</span> <span m="1147470">deal</span> <span m="1147640">with</span> <span m="1147770">that</span> <span m="1148210">in V2.</span> </p>
<p><span m="1148942">But for</span> <span m="1149310">now,</span> <span m="1149800">you</span> <span m="1149870">got to</span> <span m="1150020">make things</span> <span m="1150490">work</span> <span m="1150820">because</span> <span m="1150910">the customers</span> <span m="1151330">are</span> <span m="1151572">taking</span> <span m="1151814">away</span> <span m="1151975">their</span> <span m="1152136">money.</span> <span m="1153266">So, there's</span> <span m="1153750">basically</span> <span m="1154234">this</span> <span m="1154718">huge</span> <span m="1155202">issue</span> <span m="1155323">of</span> <span m="1155444">legacy</span> <span m="1155565">code</span> <span m="1155686">here,</span> <span m="1155782">and</span> <span m="1155879">how</span> <span m="1155976">do</span> <span m="1156073">we</span> <span m="1156170">deal</span> <span m="1156331">with</span> <span m="1156492">it?</span> <span m="1157140">And</span> <span m="1157230">as</span> <span m="1157350">you'll</span> <span m="1157460">see</span> <span m="1157770">the</span> <span m="1157870">with the</span> <span m="1158235">baggy bounds</span> <span m="1159780">system,</span> <span m="1160440">One</span> <span m="1160820">of the</span> <span m="1160900">advantages</span> <span m="1161195">of it</span> <span m="1161490">is that</span> <span m="1161860">it</span> <span m="1162010">actually</span> <span m="1162340">inter-operates</span> <span m="1163150">quite</span> <span m="1163440">well</span> <span m="1164010">with</span> <span m="1164220">this</span> <span m="1164430">legacy</span> <span m="1164850">code.</span> <span m="1165690">So, anyway,</span> <span m="1166110">this</span> <span m="1166530">is one</span> <span m="1166690">reason</span> <span m="1166840">why</span> <span m="1167000">you can't</span> <span m="1167330">just necessarily</span> <span m="1168110">make</span> <span m="1168350">all</span> <span m="1168480">these</span> <span m="1168640">buffer overflow</span> <span m="1168950">problems</span> <span m="1169510">go</span> <span m="1169650">away</span> <span m="1169915">by</span> <span m="1170180">using</span> <span m="1170634">one of these</span> <span m="1171088">memory-safe</span> <span m="1171542">languages.</span> </p>
<p><span m="1173360">So,</span> <span m="1173900">another challenges</span> <span m="1174865">is</span> <span m="1175170">that</span> <span m="1176860">what</span> <span m="1177340">if you</span> <span m="1179130">need</span> <span m="1179420">low-level</span> <span m="1179902">access</span> <span m="1181830">to</span> <span m="1182312">hardware?</span> <span m="1189560">This</span> <span m="1189700">might happen</span> <span m="1190120">if you're</span> <span m="1190450">writing</span> <span m="1190560">something</span> <span m="1190670">like</span> <span m="1190780">a device</span> <span m="1191290">driver</span> <span m="1191920">or</span> <span m="1192020">something</span> <span m="1192370">like</span> <span m="1192590">that.</span> <span m="1193060">So,</span> <span m="1193190">in that</span> <span m="1193540">case,</span> <span m="1194690">you</span> <span m="1194840">really</span> <span m="1195250">do need</span> <span m="1196420">that</span> <span m="1196830">the</span> <span m="1196890">benefits</span> <span m="1197380">that</span> <span m="1197480">C</span> <span m="1197800">gives you</span> <span m="1198430">in</span> <span m="1198510">terms</span> <span m="1198690">of</span> <span m="1198740">being</span> <span m="1198970">able</span> <span m="1199410">to look at</span> <span m="1199520">registers</span> <span m="1200385">and</span> <span m="1200680">actually</span> <span m="1201030">understand</span> <span m="1201240">a</span> <span m="1201330">little</span> <span m="1201540">of</span> <span m="1201720">[INAUDIBLE]</span> <span m="1202090">and</span> <span m="1202540">things like that.</span> <span m="1204350">There's</span> <span m="1204500">another</span> <span m="1204800">thing</span> <span m="1205110">too,</span> <span m="1205950">which</span> <span m="1207050">people</span> <span m="1207400">always</span> <span m="1207600">bring up</span> <span m="1207840">and</span> <span m="1208170">which</span> <span m="1208310">I've</span> <span m="1208470">alluded</span> <span m="1208740">to</span> <span m="1209090">before,</span> <span m="1210160">but</span> <span m="1210540">it's</span> <span m="1211210">performance.</span> <span m="1212400">Right?</span> <span m="1212890">So,</span> <span m="1213600">if</span> <span m="1213750">you</span> <span m="1213870">care</span> <span m="1214080">about</span> <span m="1214300">performance,</span> <span m="1214820">typically</span> <span m="1215310">the thing</span> <span m="1215610">that you're</span> <span m="1215740">told</span> <span m="1216060">is</span> <span m="1216270">you've got</span> <span m="1216690">to write</span> <span m="1217140">in C,</span> <span m="1217410">otherwise</span> <span m="1217815">you're</span> <span m="1217884">just</span> <span m="1217953">going</span> <span m="1218022">to</span> <span m="1218091">be</span> <span m="1218160">so</span> <span m="1218450">slow,</span> <span m="1218890">you're</span> <span m="1219030">going</span> <span m="1219170">to</span> <span m="1219310">get</span> <span m="1219480">laughed</span> <span m="1219830">out</span> <span m="1220100">of</span> <span m="1220210">code</span> <span m="1220620">academy</span> <span m="1221050">or whatever.</span> </p>
<p><span m="1221480">Now,</span> <span m="1221970">this</span> <span m="1222220">is</span> <span m="1222740">increasingly</span> <span m="1223115">less</span> <span m="1223490">of</span> <span m="1223970">an</span> <span m="1224450">issue.</span> <span m="1224930">Like</span> <span m="1225040">the</span> <span m="1225390">perf</span> <span m="1225600">stuff.</span> <span m="1226110">Because</span> <span m="1226710">people</span> <span m="1227005">have</span> <span m="1227300">actually</span> <span m="1227570">gotten</span> <span m="1227780">very</span> <span m="1228090">good</span> <span m="1228320">with</span> <span m="1228386">doing</span> <span m="1228452">things</span> <span m="1228518">like</span> <span m="1228850">making</span> <span m="1228930">better</span> <span m="1229500">compilers</span> <span m="1230390">that</span> <span m="1230520">have</span> <span m="1230710">all</span> <span m="1230960">kinds of</span> <span m="1231260">powerful</span> <span m="1231436">optimizations.</span> <span m="1232530">And</span> <span m="1232750">also,</span> <span m="1233280">there</span> <span m="1233440">are</span> <span m="1233480">these</span> <span m="1233700">things</span> <span m="1233950">called</span> <span m="1234180">Gits</span> <span m="1234860">which</span> <span m="1235070">actually</span> <span m="1235710">really</span> <span m="1236010">reduce</span> <span m="1236440">the</span> <span m="1236520">cost</span> <span m="1236860">of</span> <span m="1236950">using these</span> <span m="1237235">memory-safe</span> <span m="1237520">languages.</span> <span m="1238960">So,</span> <span m="1239380">have you</span> <span m="1239700">guys</span> <span m="1240000">heard</span> <span m="1240200">of</span> <span m="1240450">Gits</span> <span m="1240900">before?</span> <span m="1241110">So,</span> <span m="1241270">I'll give you</span> <span m="1241540">a very</span> <span m="1241800">brief</span> <span m="1242150">introduction</span> <span m="1242440">to what</span> <span m="1242740">it is.</span> <span m="1242970">The</span> <span m="1243280">idea</span> <span m="1243630">is</span> <span m="1243740">that,</span> <span m="1244580">think</span> <span m="1244760">about</span> <span m="1245130">a</span> <span m="1245450">language</span> <span m="1245715">like</span> <span m="1245980">Java,</span> <span m="1246740">or</span> <span m="1246850">JavaScript.</span> <span m="1247760">It's</span> <span m="1247920">very</span> <span m="1248210">high</span> <span m="1248370">level,</span> <span m="1248770">it's</span> <span m="1248970">dynamically</span> <span m="1249560">tight,</span> <span m="1250360">right,</span> <span m="1250700">it</span> <span m="1250970">has</span> <span m="1251240">automatic</span> <span m="1252330">heat</span> <span m="1252660">management,</span> <span m="1253090">things</span> <span m="1253320">like</span> <span m="1253520">that.</span> <span m="1254740">So,</span> <span m="1255040">typically,</span> <span m="1256120">when</span> <span m="1256490">these</span> <span m="1256860">languages</span> <span m="1257270">first</span> <span m="1257610">came</span> <span m="1257820">out,</span> <span m="1258270">they</span> <span m="1258370">were</span> <span m="1258685">always</span> <span m="1259000">interpreted.</span> <span m="1259810">Right?</span> <span m="1260280">And by</span> <span m="1260520">interpreted</span> <span m="1260785">I</span> <span m="1261050">mean</span> <span m="1261550">they didn't actually</span> <span m="1262140">execute</span> <span m="1262590">raw</span> <span m="1262940">x86</span> <span m="1263520">instructions.</span> </p>
<p><span m="1264310">Instead,</span> <span m="1265050">these</span> <span m="1265200">languages</span> <span m="1265420">were</span> <span m="1265670">compiled</span> <span m="1266140">down</span> <span m="1266410">to</span> <span m="1266530">some</span> <span m="1266700">type</span> <span m="1266900">of</span> <span m="1267180">intermediate</span> <span m="1267420">form.</span> <span m="1267890">You may have</span> <span m="1268190">heard of</span> <span m="1268490">things</span> <span m="1268820">like</span> <span m="1269810">the</span> <span m="1270120">JVM,</span> <span m="1270680">the</span> <span m="1270760">Java</span> <span m="1270990">Virtual</span> <span m="1271370">Machine</span> <span m="1271680">byte</span> <span m="1271850">code,</span> <span m="1272340">things</span> <span m="1272600">like</span> <span m="1272810">that.</span> <span m="1273390">Right?</span> <span m="1273870">You</span> <span m="1274040">basically</span> <span m="1274170">had a</span> <span m="1274420">program</span> <span m="1274675">that</span> <span m="1274930">sat</span> <span m="1275020">in a loop</span> <span m="1276230">and</span> <span m="1276390">took</span> <span m="1276620">these</span> <span m="1276810">byte</span> <span m="1277120">codes,</span> <span m="1277480">and</span> <span m="1277730">basically</span> <span m="1278450">executed</span> <span m="1279060">the</span> <span m="1279270">high</span> <span m="1279460">level</span> <span m="1280720">instruction</span> <span m="1280995">that was</span> <span m="1281270">encoded</span> <span m="1281530">in</span> <span m="1281645">that</span> <span m="1281760">byte</span> <span m="1281875">code.</span> <span m="1282750">So,</span> <span m="1282890">for</span> <span m="1282970">example,</span> <span m="1283910">some</span> <span m="1284130">of</span> <span m="1284180">the</span> <span m="1284270">JVM</span> <span m="1284615">byte</span> <span m="1284960">codes</span> <span m="1285200">dealt with</span> <span m="1285400">things</span> <span m="1285690">like</span> <span m="1285870">pushing</span> <span m="1286120">and</span> <span m="1286330">popping</span> <span m="1286720">things up</span> <span m="1287015">on the</span> <span m="1287310">stack.</span> <span m="1288070">So, you</span> <span m="1288270">have a program</span> <span m="1288680">that</span> <span m="1288790">would</span> <span m="1288950">go</span> <span m="1289410">through a</span> <span m="1289560">loop,</span> <span m="1291150">operate</span> <span m="1291570">that</span> <span m="1291750">stack,</span> <span m="1292210">and simulate</span> <span m="1292420">those</span> <span m="1292760">operations.</span> <span m="1294440">OK.</span> <span m="1294850">So,</span> <span m="1295540">that</span> <span m="1295740">all</span> <span m="1296090">seemed</span> <span m="1296520">fine and dandy,</span> <span m="1296960">but once again,</span> <span m="1297170">all of the</span> <span m="1297420">speed freaks</span> <span m="1298020">out</span> <span m="1298240">there</span> <span m="1298620">were</span> <span m="1298840">like, what</span> <span m="1298980">about</span> <span m="1299360">the perf?</span> <span m="1299950">This</span> <span m="1300280">too</span> <span m="1300450">slow.</span> <span m="1300870">You've</span> <span m="1301340">got</span> <span m="1301470">sort</span> <span m="1301720">of that</span> <span m="1302200">interpreter</span> <span m="1302490">sitting in that</span> <span m="1302740">loop,</span> <span m="1303010">and</span> <span m="1303790">getting</span> <span m="1304190">in the way</span> <span m="1304430">of our</span> <span m="1304700">bare metal</span> <span m="1304970">performance.</span> </p>
<p><span m="1306090">So,</span> <span m="1306640">what</span> <span m="1306740">people</span> <span m="1307160">started</span> <span m="1307580">to do</span> <span m="1308050">is actually</span> <span m="1308410">take</span> <span m="1308770">these</span> <span m="1309380">high</span> <span m="1309750">level</span> <span m="1310120">interpreter</span> <span m="1310440">languages</span> <span m="1311220">and</span> <span m="1311660">dynamically</span> <span m="1312210">generate</span> <span m="1312710">X86 code</span> <span m="1313400">for</span> <span m="1313800">them</span> <span m="1314070">on</span> <span m="1314260">the</span> <span m="1314430">fly.</span> <span m="1315140">Right?</span> <span m="1315800">So,</span> <span m="1316740">in</span> <span m="1316950">terms</span> <span m="1317180">of</span> <span m="1317270">just</span> <span m="1317540">in</span> <span m="1317810">time</span> <span m="1318160">compilation,</span> <span m="1319100">that</span> <span m="1319230">means</span> <span m="1319420">I</span> <span m="1319490">take</span> <span m="1319810">your</span> <span m="1319900">snippet</span> <span m="1320210">of</span> <span m="1320290">JavaScript,</span> <span m="1320910">I take your</span> <span m="1321380">snippet</span> <span m="1321650">of</span> <span m="1322590">Java</span> <span m="1322980">whatever,</span> <span m="1323570">and I</span> <span m="1323850">actually</span> <span m="1324540">spend</span> <span m="1324770">a</span> <span m="1324880">little</span> <span m="1325110">bit</span> <span m="1325240">of</span> <span m="1325340">time</span> <span m="1325630">upfront</span> <span m="1326270">to</span> <span m="1326500">create</span> <span m="1326930">actual</span> <span m="1327350">raw</span> <span m="1327720">machine</span> <span m="1328290">instructions.</span> <span m="1328650">Raw</span> <span m="1329010">x86</span> <span m="1330110">that</span> <span m="1330240">will</span> <span m="1330390">run</span> <span m="1330580">directly</span> <span m="1331290">on the bare metal.</span> <span m="1332020">So,</span> <span m="1332130">I</span> <span m="1332230">take</span> <span m="1332440">that</span> <span m="1332580">initial</span> <span m="1332880">performance</span> <span m="1333235">hit</span> <span m="1333860">for</span> <span m="1334130">the</span> <span m="1334550">Git</span> <span m="1334890">compilation,</span> <span m="1335300">but then</span> <span m="1335710">after</span> <span m="1336120">that,</span> <span m="1336720">my</span> <span m="1336880">program</span> <span m="1337190">actually</span> <span m="1337570">does</span> <span m="1337926">run</span> <span m="1338640">on the raw</span> <span m="1338880">hard drive.</span> <span m="1339450">Right?</span> <span m="1339970">So,</span> <span m="1340630">things</span> <span m="1340870">like</span> <span m="1341210">the perf</span> <span m="1341540">argument</span> <span m="1342260">are</span> <span m="1342530">not</span> <span m="1342970">necessarily</span> <span m="1343250">as</span> <span m="1343530">compelling</span> <span m="1343900">as</span> <span m="1344270">they used to be,</span> <span m="1344550">because</span> <span m="1344980">of</span> <span m="1345390">stuff like this.</span> </p>
<p><span m="1345800">There's</span> <span m="1345950">also</span> <span m="1346190">some</span> <span m="1346340">crazy</span> <span m="1346700">stuff</span> <span m="1346980">out</span> <span m="1347200">there,</span> <span m="1348030">like</span> <span m="1348250">ASN.js.</span> <span m="1349620">So,</span> <span m="1349940">we</span> <span m="1350030">can</span> <span m="1350150">talk</span> <span m="1350370">more</span> <span m="1350500">about</span> <span m="1350690">this</span> <span m="1350850">offline</span> <span m="1351320">if</span> <span m="1351440">you actually</span> <span m="1351800">are</span> <span m="1351890">a JavaScript</span> <span m="1351990">packer.</span> <span m="1353050">But</span> <span m="1353210">there</span> <span m="1353350">are</span> <span m="1353380">actually</span> <span m="1353690">some</span> <span m="1354100">neat tricks</span> <span m="1354360">that</span> <span m="1354620">you can do,</span> <span m="1355460">like</span> <span m="1355560">compiling</span> <span m="1355885">down</span> <span m="1356470">JavaScript</span> <span m="1357280">to</span> <span m="1357460">very</span> <span m="1357910">restricted</span> <span m="1358400">subset</span> <span m="1358700">of the</span> <span m="1359000">language</span> <span m="1359590">that</span> <span m="1359750">only</span> <span m="1360040">operates</span> <span m="1360860">on</span> <span m="1361240">arrays.</span> <span m="1362280">Right,</span> <span m="1362550">so</span> <span m="1362710">what this</span> <span m="1362910">allows</span> <span m="1362960">you</span> <span m="1363270">to</span> <span m="1363390">do</span> <span m="1363790">is</span> <span m="1363940">actually</span> <span m="1364220">get rid of</span> <span m="1364530">a</span> <span m="1364630">lot</span> <span m="1364860">of</span> <span m="1364940">the dynamic</span> <span m="1365030">typing</span> <span m="1365510">overhead</span> <span m="1365990">in</span> <span m="1366470">standard</span> <span m="1366950">JavaScript,</span> <span m="1367910">and</span> <span m="1368390">you can actually</span> <span m="1368870">get</span> <span m="1369135">JavaScript code now</span> <span m="1369660">to run</span> <span m="1370030">within 2x</span> <span m="1371550">of</span> <span m="1371850">raw</span> <span m="1372360">C</span> <span m="1372560">or</span> <span m="1373040">C++</span> <span m="1373460">performance.</span> <span m="1374220">2x</span> <span m="1374560">might</span> <span m="1374790">sound</span> <span m="1375050">like</span> <span m="1375200">a</span> <span m="1375250">lot,</span> <span m="1376110">but</span> <span m="1376520">it used</span> <span m="1376860">to be</span> <span m="1377470">things</span> <span m="1377730">like</span> <span m="1377960">10x</span> <span m="1378210">or</span> <span m="1378640">20z.</span> <span m="1378990">So, we're</span> <span m="1379160">actually</span> <span m="1379400">making</span> <span m="1379610">a</span> <span m="1379680">lot</span> <span m="1379820">of</span> <span m="1379900">progress</span> <span m="1380340">on</span> <span m="1380430">that</span> <span m="1380650">front.</span> </p>
<p><span m="1384610">And</span> <span m="1384660">so</span> <span m="1385170">the other</span> <span m="1385350">thing to</span> <span m="1385590">keep</span> <span m="1385950">in mind</span> <span m="1386250">with performance, too,</span> <span m="1386380">is that</span> <span m="1386420">a lot</span> <span m="1386790">of</span> <span m="1386850">times,</span> <span m="1387430">you</span> <span m="1387530">don't</span> <span m="1387770">need</span> <span m="1387930">performance</span> <span m="1388370">as</span> <span m="1388450">much</span> <span m="1388820">you might think</span> <span m="1389200">that you do.</span> <span m="1390050">Right?</span> <span m="1390500">So,</span> <span m="1390870">think</span> <span m="1391070">about</span> <span m="1391270">it</span> <span m="1391360">like this.</span> <span m="1392340">Let's say that your</span> <span m="1392440">program</span> <span m="1392890">is</span> <span m="1393010">actually</span> <span m="1393590">IO</span> <span m="1393750">bound.</span> <span m="1395200">So,</span> <span m="1395290">it's</span> <span m="1395440">not</span> <span m="1395760">CPU bound.</span> <span m="1396330">In other words,</span> <span m="1396950">let's</span> <span m="1397280">say that</span> <span m="1397530">your</span> <span m="1397650">program</span> <span m="1398300">spends most</span> <span m="1398610">of</span> <span m="1398710">its</span> <span m="1398810">time</span> <span m="1399350">waiting</span> <span m="1399740">for</span> <span m="1400000">network</span> <span m="1400360">input,</span> <span m="1400720">waiting</span> <span m="1401180">for disk</span> <span m="1401630">input,</span> <span m="1402020">waiting</span> <span m="1402300">for user input,</span> <span m="1403120">things</span> <span m="1403480">like</span> <span m="1403690">that.</span> <span m="1404550">In</span> <span m="1404680">those</span> <span m="1405000">types of cases,</span> <span m="1405425">you</span> <span m="1405850">don't</span> <span m="1406110">actually</span> <span m="1406650">need</span> <span m="1407100">to</span> <span m="1407200">have</span> <span m="1407540">blazing</span> <span m="1408110">fast</span> <span m="1408395">raw</span> <span m="1408680">compute</span> <span m="1409045">speed.</span> <span m="1409740">Right?</span> <span m="1409990">Because</span> <span m="1410270">your</span> <span m="1410380">program</span> <span m="1410775">actually isn't</span> <span m="1411170">spending</span> <span m="1411460">a</span> <span m="1411490">lot</span> <span m="1411640">of</span> <span m="1411730">time</span> <span m="1412110">doing</span> <span m="1412600">that</span> <span m="1412890">kind</span> <span m="1413080">of</span> <span m="1413140">stuff.</span> </p>
<p><span m="1414220">So,</span> <span m="1414330">once again,</span> <span m="1414680">this</span> <span m="1414980">perf argument</span> <span m="1415440">here,</span> <span m="1415840">you've</span> <span m="1416170">got to</span> <span m="1416430">take</span> <span m="1416560">this</span> <span m="1416690">stuff</span> <span m="1416820">with</span> <span m="1416895">a</span> <span m="1416970">grain</span> <span m="1417045">of</span> <span m="1417120">salt.</span> <span m="1417195">And I</span> <span m="1417570">actually</span> <span m="1417910">see</span> <span m="1418060">a</span> <span m="1418110">lot</span> <span m="1418360">students</span> <span m="1418820">who struggle</span> <span m="1419200">with</span> <span m="1419360">this.</span> <span m="1419690">So, for</span> <span m="1419930">example,</span> <span m="1420320">I'll</span> <span m="1421206">ask</span> <span m="1421454">someone</span> <span m="1421702">to</span> <span m="1421867">go</span> <span m="1422032">out</span> <span m="1422198">and</span> <span m="1422446">write</span> <span m="1422694">me</span> <span m="1422818">a</span> <span m="1422942">very</span> <span m="1423066">simple</span> <span m="1423190">program</span> <span m="1423810">to parse</span> <span m="1423910">a</span> <span m="1424050">text</span> <span m="1424380">file.</span> <span m="1424980">So,</span> <span m="1425110">they</span> <span m="1425220">spend</span> <span m="1425470">all</span> <span m="1425690">this</span> <span m="1425860">time</span> <span m="1426340">trying</span> <span m="1426580">to get this</span> <span m="1426670">to work in</span> <span m="1427000">C</span> <span m="1427360">or</span> <span m="1427450">C++</span> <span m="1427890">and</span> <span m="1428330">it's super</span> <span m="1428580">fast</span> <span m="1429000">and</span> <span m="1429230">uses</span> <span m="1429346">the</span> <span m="1429463">templates</span> <span m="1429580">and</span> <span m="1430020">all</span> <span m="1430050">that</span> <span m="1430080">kind</span> <span m="1430110">of</span> <span m="1430140">stuff.</span> <span m="1430570">But</span> <span m="1430670">it's</span> <span m="1430800">like</span> <span m="1430920">a</span> <span m="1430990">one</span> <span m="1431270">line</span> <span m="1431510">solution</span> <span m="1431950">in</span> <span m="1432390">Python.</span> <span m="1433680">And</span> <span m="1433950">it essentially</span> <span m="1434420">runs</span> <span m="1434523">just</span> <span m="1434626">as</span> <span m="1435040">fast.</span> <span m="1435335">And you</span> <span m="1435630">could</span> <span m="1436100">develop it</span> <span m="1436570">much, much</span> <span m="1437040">easier.</span> <span m="1437510">So,</span> <span m="1438580">you just</span> <span m="1438670">have to</span> <span m="1438860">take these perf</span> <span m="1439000">arguments</span> <span m="1439300">with a grain</span> <span m="1439600">of</span> <span m="1439870">salt.</span> </p>
<p><span m="1441760">So,</span> <span m="1442140">anyway,</span> <span m="1442490">we've</span> <span m="1442630">discussed</span> <span m="1444020">the</span> <span m="1444320">three</span> <span m="1444530">ways</span> <span m="1445010">you</span> <span m="1445480">can</span> <span m="1445770">possibly</span> <span m="1446290">avoid</span> <span m="1446520">buffer</span> <span m="1447100">overflow.</span> <span m="1447680">So,</span> <span m="1447940">just avoid</span> <span m="1448200">bugs</span> <span m="1448590">in the</span> <span m="1448890">first place.</span> <span m="1449070">LOL,</span> <span m="1449430">that's difficult</span> <span m="1449800">to do.</span> <span m="1451162">Approach</span> <span m="1451616">two,</span> <span m="1452070">you can</span> <span m="1452180">build</span> <span m="1452540">tools</span> <span m="1452850">to</span> <span m="1453480">help</span> <span m="1453730">you</span> <span m="1454226">discover those bugs.</span> <span m="1455218">Then</span> <span m="1455342">approach</span> <span m="1455466">three</span> <span m="1455590">is,</span> <span m="1455714">in a</span> <span m="1456710">certain</span> <span m="1456970">sense,</span> <span m="1457230">you can push</span> <span m="1457510">those</span> <span m="1457800">tools</span> <span m="1458480">into</span> <span m="1458670">the</span> <span m="1458790">runtime.</span> <span m="1459205">You can</span> <span m="1459620">actually</span> <span m="1460070">hopefully</span> <span m="1460290">rely on</span> <span m="1461220">some</span> <span m="1461450">of</span> <span m="1461560">their language</span> <span m="1462060">runtime</span> <span m="1462220">features</span> <span m="1463280">to</span> <span m="1463440">prevent you</span> <span m="1463875">from</span> <span m="1464310">seeing raw memory</span> <span m="1464775">addresses.</span> <span m="1465240">And you can</span> <span m="1465630">do things</span> <span m="1465820">like</span> <span m="1466250">balance checking,</span> <span m="1466748">and so</span> <span m="1467246">on and so forth.</span> <span m="1469370">Once</span> <span m="1469600">again,</span> <span m="1470520">as</span> <span m="1470960">we</span> <span m="1471190">discussed</span> <span m="1471450">before,</span> <span m="1472320">there's</span> <span m="1472490">a</span> <span m="1472570">lot</span> <span m="1472940">of</span> <span m="1473000">legacy</span> <span m="1473430">C</span> <span m="1473860">and</span> <span m="1474820">C++</span> <span m="1475060">code</span> <span m="1475430">out there.</span> <span m="1475800">So,</span> <span m="1476170">it's</span> <span m="1476330">difficult</span> <span m="1476820">to</span> <span m="1477570">apply</span> <span m="1477930">some of these</span> <span m="1478380">techniques,</span> <span m="1478675">particularly</span> <span m="1479590">number</span> <span m="1479860">two and number three,</span> <span m="1480145">if</span> <span m="1480430">you've got to</span> <span m="1480510">deal with</span> <span m="1480860">that</span> <span m="1481100">legacy</span> <span m="1481300">code.</span> </p>
<p><span m="1483220">So,</span> <span m="1484120">how</span> <span m="1484410">can</span> <span m="1484500">we</span> <span m="1484835">do</span> <span m="1485400">buffer</span> <span m="1485590">overflow</span> <span m="1486040">mitigation</span> <span m="1487000">despite</span> <span m="1487570">all</span> <span m="1487770">these</span> <span m="1487940">challenges?</span> <span m="1489512">Besides</span> <span m="1489948">just,</span> <span m="1490384">you know,</span> <span m="1491260">dropping</span> <span m="1491530">out</span> <span m="1491860">of</span> <span m="1492130">computer</span> <span m="1492370">science</span> <span m="1492710">classes</span> <span m="1493090">and becoming</span> <span m="1493460">a painter,</span> <span m="1493830">or</span> <span m="1493860">something</span> <span m="1494110">like</span> <span m="1494280">that.</span> <span m="1495070">So,</span> <span m="1495900">what</span> <span m="1496210">actually</span> <span m="1496505">is</span> <span m="1496800">going</span> <span m="1497140">on</span> <span m="1497720">in</span> <span m="1497950">a</span> <span m="1497990">buffer</span> <span m="1498390">overflow?</span> <span m="1499260">So,</span> <span m="1500710">in a</span> <span m="1501080">buffer</span> <span m="1501380">overflow</span> <span m="1503381">the attacker</span> <span m="1503858">exploits</span> <span m="1504335">two things.</span> <span m="1511020">So,</span> <span m="1511380">the</span> <span m="1511740">first</span> <span m="1512010">thing</span> <span m="1512590">that</span> <span m="1512960">the</span> <span m="1513700">attack</span> <span m="1513980">is going</span> <span m="1514390">to</span> <span m="1514900">exploit</span> <span m="1515840">is</span> <span m="1517060">gaining</span> <span m="1517370">control</span> <span m="1521092">over</span> <span m="1521584">the</span> <span m="1522076">instruction</span> <span m="1522568">pointer.</span> <span m="1529970">Right?</span> <span m="1530410">And by this,</span> <span m="1531220">I</span> <span m="1531360">mean</span> <span m="1531640">that</span> <span m="1531810">somehow,</span> <span m="1532175">the</span> <span m="1532540">attacker</span> <span m="1533470">figures</span> <span m="1533860">out</span> <span m="1534400">someplace</span> <span m="1534840">in</span> <span m="1535280">the</span> <span m="1535620">code</span> <span m="1536710">that</span> <span m="1536970">it</span> <span m="1537080">can</span> <span m="1537220">make</span> <span m="1537400">the</span> <span m="1537500">program</span> <span m="1537900">jump</span> <span m="1538170">to</span> <span m="1539060">against</span> <span m="1539410">the</span> <span m="1539490">program's</span> <span m="1539980">will.</span> <span m="1540680">Now,</span> <span m="1541100">this</span> <span m="1541520">is</span> <span m="1541940">necessary</span> <span m="1542360">but</span> <span m="1542655">insufficient</span> <span m="1542950">for</span> <span m="1543380">an</span> <span m="1543470">attack</span> <span m="1543880">typically</span> <span m="1544316">to</span> <span m="1544752">happen.</span> <span m="1546500">Because</span> <span m="1546800">the</span> <span m="1546890">other</span> <span m="1547070">thing</span> <span m="1547310">that the attacker</span> <span m="1547680">needs to</span> <span m="1548050">do</span> <span m="1548990">is</span> <span m="1549640">basically</span> <span m="1551080">make</span> <span m="1551320">that</span> <span m="1551610">pointer</span> <span m="1556440">point</span> <span m="1556760">to</span> <span m="1556840">malicious</span> <span m="1557240">code.</span> </p>
<p><span m="1568500">Right?</span> <span m="1568940">So,</span> <span m="1569620">how</span> <span m="1570050">are</span> <span m="1570150">we</span> <span m="1570210">going</span> <span m="1570600">to</span> <span m="1570910">basically</span> <span m="1571470">make</span> <span m="1571810">the</span> <span m="1571960">hijacked</span> <span m="1572530">IP,</span> <span m="1572825">instruction</span> <span m="1573120">pointer,</span> <span m="1573520">point</span> <span m="1574300">to</span> <span m="1574550">something</span> <span m="1574930">that does</span> <span m="1575090">something</span> <span m="1575430">useful</span> <span m="1576040">for</span> <span m="1576380">the</span> <span m="1576720">attacker.</span> <span m="1578230">So,</span> <span m="1578710">what's</span> <span m="1578880">interesting</span> <span m="1579340">is</span> <span m="1579450">that</span> <span m="1579780">in</span> <span m="1579960">many cases,</span> <span m="1580730">it's often</span> <span m="1582020">fairly</span> <span m="1582560">straightforward</span> <span m="1584070">for</span> <span m="1584380">the</span> <span m="1584550">attacker</span> <span m="1585210">to</span> <span m="1585320">put</span> <span m="1585600">some</span> <span m="1585760">interesting</span> <span m="1586220">code</span> <span m="1586705">in</span> <span m="1587190">a memory.</span> <span m="1587390">So we</span> <span m="1587720">looked at</span> <span m="1587870">some of</span> <span m="1587920">those</span> <span m="1588050">shell code</span> <span m="1588550">attacks</span> <span m="1588660">in the</span> <span m="1589010">last</span> <span m="1589330">lecture,</span> <span m="1589610">where</span> <span m="1589890">you</span> <span m="1590330">can</span> <span m="1590640">actually embed</span> <span m="1590980">that</span> <span m="1591130">attack</span> <span m="1591530">code</span> <span m="1591800">in a string.</span> <span m="1592530">As</span> <span m="1592750">we'll</span> <span m="1592890">discuss</span> <span m="1593930">a</span> <span m="1594130">little</span> <span m="1594300">bit</span> <span m="1594400">today</span> <span m="1594820">and more</span> <span m="1595190">in the next</span> <span m="1595590">lecture,</span> <span m="1596130">you</span> <span m="1596280">can</span> <span m="1596430">actually</span> <span m="1596570">take</span> <span m="1596750">advantage</span> <span m="1597140">of</span> <span m="1597330">some of the</span> <span m="1597480">pre-existing</span> <span m="1597840">code</span> <span m="1598700">the</span> <span m="1598820">application</span> <span m="1599330">has</span> <span m="1599700">and</span> <span m="1600070">jump</span> <span m="1600460">to</span> <span m="1600640">in an</span> <span m="1600910">unexpected</span> <span m="1601470">way</span> <span m="1601745">to</span> <span m="1602020">make some</span> <span m="1602365">evil things</span> <span m="1602710">happen.</span> </p>
<p><span m="1603850">So,</span> <span m="1604040">typically,</span> <span m="1605260">figuring</span> <span m="1605700">out</span> <span m="1605930">what</span> <span m="1606490">code</span> <span m="1606940">the attacker</span> <span m="1607300">wants to run,</span> <span m="1608530">maybe that's</span> <span m="1608740">not as</span> <span m="1609030">challenging</span> <span m="1609450">as</span> <span m="1609620">actually</span> <span m="1609910">being</span> <span m="1610270">able</span> <span m="1610570">to force</span> <span m="1611370">the</span> <span m="1611640">program</span> <span m="1612120">to</span> <span m="1612250">jump</span> <span m="1612820">to</span> <span m="1613050">that</span> <span m="1613310">location</span> <span m="1613950">in</span> <span m="1614310">memory.</span> <span m="1616880">And the</span> <span m="1616990">reason</span> <span m="1617200">why</span> <span m="1617300">that's</span> <span m="1617610">tricky</span> <span m="1617980">is</span> <span m="1618150">because,</span> <span m="1619230">basically,</span> <span m="1619770">the</span> <span m="1619940">attacker</span> <span m="1620810">has</span> <span m="1621210">to</span> <span m="1621460">know</span> <span m="1621960">in</span> <span m="1622060">some</span> <span m="1622380">way</span> <span m="1623210">where</span> <span m="1623510">it should</span> <span m="1623845">jump to.</span> <span m="1625050">Right?</span> <span m="1625300">So,</span> <span m="1625510">as</span> <span m="1625760">we'll</span> <span m="1625850">see</span> <span m="1626110">in</span> <span m="1626200">a</span> <span m="1626250">second,</span> <span m="1626830">and as</span> <span m="1626990">you</span> <span m="1627190">actually saw</span> <span m="1627360">in the</span> <span m="1627500">last</span> <span m="1627830">lecture,</span> <span m="1628140">a lot</span> <span m="1628390">of</span> <span m="1628630">these shell</span> <span m="1628970">code</span> <span m="1629310">attacks</span> <span m="1629660">actually take advantage</span> <span m="1630000">of</span> <span m="1630340">these</span> <span m="1630680">hard-coded</span> <span m="1632156">locations</span> <span m="1632654">in</span> <span m="1633152">memory</span> <span m="1633650">where</span> <span m="1634148">the</span> <span m="1634646">instruction</span> <span m="1634814">pointer</span> <span m="1634982">needs</span> <span m="1635150">to get</span> <span m="1635330">sent to.</span> <span m="1636180">So,</span> <span m="1636570">some</span> <span m="1636680">of the</span> <span m="1636870">defenses</span> <span m="1637160">that</span> <span m="1637310">we're</span> <span m="1637590">about to</span> <span m="1637930">look at</span> <span m="1638170">can</span> <span m="1638480">actually</span> <span m="1639000">randomize</span> <span m="1639480">things</span> <span m="1640370">in</span> <span m="1640470">terms</span> <span m="1640690">of</span> <span m="1640780">code</span> <span m="1641290">layout,</span> <span m="1641770">heap</span> <span m="1641960">layout,</span> <span m="1642380">and make</span> <span m="1642550">it</span> <span m="1642790">a</span> <span m="1642880">little</span> <span m="1642970">difficult</span> <span m="1643330">for</span> <span m="1643850">the</span> <span m="1643950">attacker</span> <span m="1644710">to</span> <span m="1644790">figure</span> <span m="1645170">out</span> <span m="1645520">where</span> <span m="1645750">things</span> <span m="1645860">are</span> <span m="1646292">located.</span> </p>
<p><span m="1647590">So,</span> <span m="1648050">let's</span> <span m="1648300">look</span> <span m="1648560">at</span> <span m="1649240">one</span> <span m="1649440">simple</span> <span m="1650285">mitigation</span> <span m="1650670">approach</span> <span m="1651440">first.</span> <span m="1653820">So,</span> <span m="1653990">this is</span> <span m="1654100">the</span> <span m="1654370">idea</span> <span m="1654990">of</span> <span m="1656265">stack</span> <span m="1656870">canaries.</span> <span m="1662920">So,</span> <span m="1663080">the</span> <span m="1663220">basic</span> <span m="1663660">idea</span> <span m="1664010">behind</span> <span m="1664360">stack canaries</span> <span m="1665650">is</span> <span m="1665850">that,</span> <span m="1666640">during</span> <span m="1666970">a buffer</span> <span m="1667320">overflow,</span> <span m="1668400">it's</span> <span m="1668580">actually</span> <span m="1669240">OK</span> <span m="1670430">if we</span> <span m="1670570">allow</span> <span m="1671070">the attacker</span> <span m="1671815">to</span> <span m="1672150">overwrite</span> <span m="1673060">the</span> <span m="1673170">return</span> <span m="1673580">address</span> <span m="1674920">if</span> <span m="1675300">we</span> <span m="1675460">can</span> <span m="1675630">actually</span> <span m="1676080">catch</span> <span m="1676530">that</span> <span m="1677000">overwrite</span> <span m="1677490">before</span> <span m="1677870">we</span> <span m="1678020">actually</span> <span m="1678880">jump</span> <span m="1679260">to</span> <span m="1679330">the</span> <span m="1679480">place</span> <span m="1679840">that</span> <span m="1680050">the attacker</span> <span m="1680330">wants us</span> <span m="1680820">to go.</span> <span m="1682860">So,</span> <span m="1683550">basically,</span> <span m="1684280">here's</span> <span m="1684460">how it works.</span> <span m="1685230">Let's</span> <span m="1685610">return</span> <span m="1686230">to</span> <span m="1687670">Neal</span> <span m="1690510">stack</span> <span m="1690850">diagram.</span> <span m="1691810">Essentially</span> <span m="1692110">we</span> <span m="1692410">have to</span> <span m="1693245">think of it as</span> <span m="1693670">a magic</span> <span m="1694240">value.</span> <span m="1695150">Basically,</span> <span m="1696760">in</span> <span m="1696910">front</span> <span m="1697400">of</span> <span m="1698120">the</span> <span m="1698450">return</span> <span m="1699040">address.</span> <span m="1700060">Such</span> <span m="1700390">that</span> <span m="1700650">any</span> <span m="1700950">overflow</span> <span m="1701600">would have</span> <span m="1702060">to</span> <span m="1702510">hit the canary</span> <span m="1703100">first,</span> <span m="1703860">and then</span> <span m="1704346">hit the</span> <span m="1704832">return address.</span> <span m="1705804">And</span> <span m="1706290">if we can</span> <span m="1706776">check</span> <span m="1706938">that</span> <span m="1707100">canary</span> <span m="1707262">before</span> <span m="1707750">we return</span> <span m="1708080">from</span> <span m="1708190">the</span> <span m="1708300">function,</span> <span m="1708410">then we</span> <span m="1708580">can</span> <span m="1708880">detect</span> <span m="1709150">the</span> <span m="1709420">evil.</span> </p>
<p><span m="1710190">So,</span> <span m="1710790">let's</span> <span m="1711050">say</span> <span m="1711370">that,</span> <span m="1712420">once</span> <span m="1712620">again,</span> <span m="1712810">we've</span> <span m="1713070">got</span> <span m="1713510">the</span> <span m="1714740">buffer</span> <span m="1715150">here.</span> <span m="1724760">Then we're</span> <span m="1724880">going</span> <span m="1724980">to</span> <span m="1725400">put</span> <span m="1725850">the</span> <span m="1726220">canary</span> <span m="1726560">here.</span> <span m="1733960">And then</span> <span m="1734390">this</span> <span m="1734630">will</span> <span m="1734810">be</span> <span m="1735910">the</span> <span m="1736010">save</span> <span m="1736590">value</span> <span m="1738292">of the</span> <span m="1738750">break</span> <span m="1739020">pointer.</span> <span m="1742972">And</span> <span m="1743070">then</span> <span m="1743169">this</span> <span m="1743268">will</span> <span m="1743367">be</span> <span m="1743960">the</span> <span m="1744124">return</span> <span m="1744289">address.</span> <span m="1749900">So,</span> <span m="1750070">once</span> <span m="1750270">again,</span> <span m="1750520">remember</span> <span m="1750700">the</span> <span m="1750790">overflow</span> <span m="1751280">goes</span> <span m="1751400">this</span> <span m="1751670">way.</span> <span m="1752470">So</span> <span m="1752660">the</span> <span m="1752850">idea</span> <span m="1753420">is</span> <span m="1753610">that</span> <span m="1755260">if</span> <span m="1755420">the</span> <span m="1755530">overflow</span> <span m="1756360">wants</span> <span m="1756650">to</span> <span m="1756710">get</span> <span m="1757170">to</span> <span m="1757250">that</span> <span m="1757530">return</span> <span m="1757780">address,</span> <span m="1758300">it</span> <span m="1758540">first</span> <span m="1758870">has</span> <span m="1759020">to</span> <span m="1759120">trample</span> <span m="1759940">on</span> <span m="1760080">this</span> <span m="1760260">canary</span> <span m="1760700">thing here,</span> <span m="1761670">right?</span> <span m="1762770">You have</span> <span m="1763060">a</span> <span m="1763130">question?</span> </p>
<p><span m="1764085">AUDIENCE: Why</span> <span m="1764570">does it</span> <span m="1765055">have to</span> <span m="1765540">touch</span> <span m="1766025">the canary?</span> </p>
<p><span m="1767000">PROFESSOR: Well,</span> <span m="1767230">because--</span> <span m="1768571">assuming</span> <span m="1769018">that the</span> <span m="1769465">attacker</span> <span m="1769912">doesn't</span> <span m="1770530">know</span> <span m="1771010">how to</span> <span m="1771840">jump</span> <span m="1772200">around</span> <span m="1772660">in</span> <span m="1772790">memory</span> <span m="1773340">arbitrarily--</span> <span m="1774400">the way</span> <span m="1774795">that tradionally</span> <span m="1775190">[INAUDIBLE]</span> <span m="1775530">overflow</span> <span m="1776000">attacks</span> <span m="1776360">work</span> <span m="1776940">is</span> <span m="1777190">that</span> <span m="1778232">you</span> <span m="1779090">look</span> <span m="1779210">in</span> <span m="1779540">GB,</span> <span m="1780190">figure out</span> <span m="1780540">where</span> <span m="1780895">all</span> <span m="1781250">this</span> <span m="1781400">stuff is.</span> <span m="1782190">And</span> <span m="1782540">then, you essentially</span> <span m="1783070">have</span> <span m="1783340">this</span> <span m="1784000">string,</span> <span m="1784300">[INAUDIBLE]</span> <span m="1784840">radius</span> <span m="1785250">grows</span> <span m="1785680">this way.</span> </p>
<p><span m="1786810">Now,</span> <span m="1786900">you're</span> <span m="1787210">correct that if</span> <span m="1787640">the attacker</span> <span m="1787945">could</span> <span m="1788250">just</span> <span m="1789050">go here</span> <span m="1789410">directly,</span> <span m="1790680">then all the bets</span> <span m="1791165">are off.</span> <span m="1792135">But in the</span> <span m="1792620">very</span> <span m="1792820">simple</span> <span m="1793450">overflow</span> <span m="1793760">approach,</span> <span m="1794200">everything</span> <span m="1794698">just has to</span> <span m="1795196">grow</span> <span m="1795694">strictly</span> <span m="1796192">that way.</span> </p>
<p><span m="1797690">So</span> <span m="1797850">the</span> <span m="1797940">basic</span> <span m="1798330">idea</span> <span m="1798980">behind the</span> <span m="1799340">canary</span> <span m="1800260">is</span> <span m="1800400">that</span> <span m="1800920">we</span> <span m="1801090">allow</span> <span m="1801460">the</span> <span m="1801750">buffer</span> <span m="1802040">overflow</span> <span m="1802325">exploit</span> <span m="1802610">to take</span> <span m="1803063">place.</span> <span m="1803970">But</span> <span m="1804240">then</span> <span m="1804960">we</span> <span m="1805190">have</span> <span m="1805550">run</span> <span m="1805810">time</span> <span m="1806050">code</span> <span m="1806340">that, at the</span> <span m="1806630">time</span> <span m="1807080">of</span> <span m="1807320">the</span> <span m="1807635">return</span> <span m="1807950">from the</span> <span m="1808190">function,</span> <span m="1808850">is</span> <span m="1808980">going</span> <span m="1809140">to</span> <span m="1809240">check</span> <span m="1809610">this</span> <span m="1809800">canary</span> <span m="1810760">and</span> <span m="1810930">make</span> <span m="1811140">sure</span> <span m="1811350">that it</span> <span m="1811520">has</span> <span m="1811790">the</span> <span m="1811890">right</span> <span m="1812140">value.</span> <span m="1812920">Right?</span> <span m="1813300">So it's</span> <span m="1813540">called the</span> <span m="1813880">canary</span> <span m="1814220">because</span> <span m="1814770">back in the</span> <span m="1815220">days,</span> <span m="1815560">when</span> <span m="1815900">PETA</span> <span m="1816190">wasn't</span> <span m="1816490">around,</span> <span m="1816900">you could use</span> <span m="1817395">birds to  test</span> <span m="1817890">for evil</span> <span m="1818385">things.</span> <span m="1818880">So that's why it's called</span> <span m="1819375">canary.</span> </p>
<p><span m="1820860">AUDIENCE: My question</span> <span m="1821355">is</span> <span m="1821850">if the</span> <span m="1822345">attacker</span> <span m="1823830">is able</span> <span m="1824325">to</span> <span m="1824820">overwrite</span> <span m="1825810">the return</span> <span m="1826305">address,</span> <span m="1828780">and</span> <span m="1829275">modify</span> <span m="1829770">the canary,</span> <span m="1831750">how does he</span> <span m="1832245">check</span> <span m="1832740">that the</span> <span m="1833235">canary</span> <span m="1833730">was not modified,</span> <span m="1834225">but</span> <span m="1834720">was going to be</span> <span m="1835215">performed?</span> <span m="1837690">So the</span> <span m="1838185">attacker</span> <span m="1839490">overwrites</span> <span m="1839750">the</span> <span m="1840210">return address,</span> <span m="1840696">right?</span> <span m="1841670">So</span> <span m="1844138">how is</span> <span m="1844620">the</span> <span m="1845102">check</span> <span m="1845584">that the</span> <span m="1846066">canary</span> <span m="1846548">was modified--</span> </p>
<p><span m="1847520">PROFESSOR: Yeah.</span> <span m="1848110">So</span> <span m="1848300">basically,</span> <span m="1848820">you</span> <span m="1848900">have</span> <span m="1849150">to</span> <span m="1849240">have</span> <span m="1849490">some</span> <span m="1849660">piece</span> <span m="1849910">of</span> <span m="1850030">code</span> <span m="1850640">that</span> <span m="1850790">will</span> <span m="1850910">actually</span> <span m="1852040">check</span> <span m="1852325">this</span> <span m="1852810">before</span> <span m="1853090">the</span> <span m="1853440">return</span> <span m="1853700">takes</span> <span m="1854090">place.</span> <span m="1854960">So</span> <span m="1855210">in other</span> <span m="1855320">words,</span> <span m="1855650">you're</span> <span m="1855750">right.  There has to be</span> <span m="1856190">that</span> <span m="1856420">order</span> <span m="1856710">in there.</span> </p>
<p><span m="1858200">So</span> <span m="1858630">essentially,</span> <span m="1859500">what you</span> <span m="1859860">have</span> <span m="1860230">to do is</span> <span m="1860680">you</span> <span m="1860780">have</span> <span m="1860980">to</span> <span m="1861080">have</span> <span m="1861520">a</span> <span m="1861850">support</span> <span m="1862130">from</span> <span m="1862410">the</span> <span m="1862735">compiler</span> <span m="1863060">here</span> <span m="1863750">that will</span> <span m="1864160">actually</span> <span m="1865750">extend</span> <span m="1866170">the</span> <span m="1866220">calling</span> <span m="1866655">convention,</span> <span m="1867090">if</span> <span m="1867310">you</span> <span m="1867460">will.</span> <span m="1868150">Such</span> <span m="1868470">that</span> <span m="1868740">part</span> <span m="1869090">of</span> <span m="1869350">the</span> <span m="1869870">return</span> <span m="1870240">sequence</span> <span m="1870610">is</span> <span m="1870905">before</span> <span m="1871350">we</span> <span m="1871500">actually</span> <span m="1872150">treat</span> <span m="1872440">this</span> <span m="1872610">value</span> <span m="1872880">as</span> <span m="1873110">valid,</span> <span m="1873700">make sure</span> <span m="1873995">this</span> <span m="1874290">guy</span> <span m="1874565">hasn't been</span> <span m="1874840">trampled.</span> <span m="1876140">Then, and only</span> <span m="1876420">then,</span> <span m="1876640">can we think</span> <span m="1877137">of going  somewhere</span> <span m="1877634">else.</span> </p>
<p><span m="1878628">AUDIENCE: I think I</span> <span m="1879125">might be</span> <span m="1879622">jumping the</span> <span m="1880120">gun here,</span> <span m="1880475">but</span> <span m="1880830">doesn't</span> <span m="1881105">this</span> <span m="1881380">assume</span> <span m="1881716">that the</span> <span m="1882052">attacker</span> <span m="1882390">can't</span> <span m="1882790">find</span> <span m="1883275">out</span> <span m="1883760">or guess</span> <span m="1884150">what the</span> <span m="1884630">canary</span> <span m="1885110">value</span> <span m="1885590">is?</span> </p>
<p><span m="1886070">PROFESSOR: That, in fact, is the</span> <span m="1886550">very next</span> <span m="1887030">thing my lecture</span> <span m="1887510">is.</span> <span m="1887990">If I had prizes,</span> <span m="1888470">you'd get one.</span> <span m="1888950">I don't have any.</span> <span m="1890390">But good for you.</span> <span m="1890870">Gold star.</span> </p>
<p><span m="1891350">That's exactly</span> <span m="1891830">correct.</span> <span m="1892970">So</span> <span m="1893870">one of the</span> <span m="1894120">next</span> <span m="1894260">things I'd</span> <span m="1894610">like to</span> <span m="1894920">say</span> <span m="1895250">is</span> <span m="1895780">what's</span> <span m="1895880">the</span> <span m="1895980">problem</span> <span m="1896290">with this</span> <span m="1896600">scheme?</span> <span m="1897280">What if,</span> <span m="1897683">for example,</span> <span m="1898086">on</span> <span m="1898490">every</span> <span m="1898860">program,</span> <span m="1899910">we</span> <span m="1900140">always</span> <span m="1900600">put</span> <span m="1900770">the</span> <span m="1900830">value</span> <span m="1901300">a?</span> <span m="1901890">Just</span> <span m="1902050">like</span> <span m="1903240">four</span> <span m="1903510">values of</span> <span m="1903960">a.</span> <span m="1904410">So this is like</span> <span m="1904560">a single</span> <span m="1904880">[INAUDIBLE]</span> <span m="1905180">at</span> <span m="1905510">work,</span> <span m="1906000">right?</span> </p>
<p><span m="1906330">Then you'd</span> <span m="1906560">have</span> <span m="1906750">that</span> <span m="1906800">exact</span> <span m="1907330">problem</span> <span m="1907790">that you just</span> <span m="1907970">mentioned.</span> <span m="1908690">Because</span> <span m="1909020">then,</span> <span m="1909540">the</span> <span m="1909640">attacker--</span> <span m="1910270">this</span> <span m="1910742">gets back to</span> <span m="1911214">your question--</span> <span m="1912158">he or she</span> <span m="1912630">knows</span> <span m="1913102">how big</span> <span m="1913574">this is.</span> <span m="1914990">This</span> <span m="1915260">is</span> <span m="1915500">deterministic</span> <span m="1916430">on every</span> <span m="1916740">system.</span> </p>
<p><span m="1917035">So you</span> <span m="1917330">just make sure that your</span> <span m="1917830">buffer</span> <span m="1918060">overflow</span> <span m="1918350">has</span> <span m="1918600">a bunch of</span> <span m="1918680">a's</span> <span m="1919090">here,</span> <span m="1920070">and</span> <span m="1920180">then</span> <span m="1920310">you</span> <span m="1920530">overwrite</span> <span m="1920760">this</span> <span m="1921000">side.</span> <span m="1921440">So you're exactly</span> <span m="1921860">right</span> <span m="1922080">about</span> <span m="1922310">that.</span> <span m="1922850">And</span> <span m="1922950">so</span> <span m="1923250">there's</span> <span m="1923540">basically</span> <span m="1924110">different</span> <span m="1924460">types</span> <span m="1924750">of</span> <span m="1924870">values you could</span> <span m="1925360">put between</span> <span m="1925853">this canary</span> <span m="1926346">to try to prevent</span> <span m="1926839">that.</span> </p>
<p><span m="1928760">One thing</span> <span m="1929020">that you</span> <span m="1929280">can do</span> <span m="1929640">here</span> <span m="1930170">is</span> <span m="1930330">you can</span> <span m="1930690">use--</span> <span m="1935820">this</span> <span m="1936280">is</span> <span m="1936510">sort</span> <span m="1936850">of</span> <span m="1936920">a very</span> <span m="1937300">funny</span> <span m="1938000">type of</span> <span m="1938410">canary,</span> <span m="1938760">but it</span> <span m="1938930">basically</span> <span m="1939310">exploits</span> <span m="1940220">the</span> <span m="1940320">ways</span> <span m="1941020">that</span> <span m="1942300">a</span> <span m="1942390">lot</span> <span m="1942790">of</span> <span m="1943330">C</span> <span m="1943693">progams</span> <span m="1946066">and</span> <span m="1946450">C</span> <span m="1946660">functions</span> <span m="1947700">handle</span> <span m="1948150">special</span> <span m="1948600">characters.</span> <span m="1949310">So</span> <span m="1949530">imagine</span> <span m="1949920">that you</span> <span m="1949990">used</span> <span m="1950410">this</span> <span m="1950650">value for</span> <span m="1951060">the canary.</span> <span m="1952180">So</span> <span m="1952290">the</span> <span m="1952340">binary</span> <span m="1952810">value is</span> <span m="1953160">0,</span> <span m="1953760">which</span> <span m="1953960">is</span> <span m="1954050">like</span> <span m="1954210">the</span> <span m="1954380">null</span> <span m="1954570">byte,</span> <span m="1954990">the null</span> <span m="1955467">character</span> <span m="1955944">in ASCII.</span> <span m="1956900">Carriage</span> <span m="1957460">return</span> <span m="1957920">line</span> <span m="1958310">feed,</span> <span m="1958700">and then the</span> <span m="1959092">negative</span> <span m="1959484">1.</span> </p>
<p><span m="1961000">What's</span> <span m="1961200">funny</span> <span m="1961500">about</span> <span m="1961810">this</span> <span m="1962220">is that</span> <span m="1962340">a</span> <span m="1962420">lot</span> <span m="1962700">of</span> <span m="1962760">the</span> <span m="1963000">functions</span> <span m="1963385">that you</span> <span m="1963770">can</span> <span m="1964180">exploit--</span> <span m="1964780">that</span> <span m="1965233">manipulate</span> <span m="1965686">strings,</span> <span m="1966140">for</span> <span m="1966280">example--</span> <span m="1967090">they</span> <span m="1967200">will</span> <span m="1967410">stop</span> <span m="1967755">when</span> <span m="1968100">they</span> <span m="1968360">encounter</span> <span m="1968620">one of</span> <span m="1969000">these</span> <span m="1969070">words,</span> <span m="1970260">or one of these</span> <span m="1970650">values.</span> <span m="1971610">So you</span> <span m="1971870">can imagine</span> <span m="1972120">that</span> <span m="1972360">you're</span> <span m="1973240">using</span> <span m="1973910">some</span> <span m="1974070">string</span> <span m="1974480">manipulation</span> <span m="1974780">function to</span> <span m="1975120">go up</span> <span m="1975400">this</span> <span m="1975630">way.</span> <span m="1976020">It's</span> <span m="1976150">going</span> <span m="1976500">to hit that</span> <span m="1976760">null</span> <span m="1977050">character.</span> <span m="1977340">Oops--</span> <span m="1977770">it's going to</span> <span m="1977850">stop</span> <span m="1978160">processing.</span> <span m="1979320">Right?</span> </p>
<p><span m="1979810">Or</span> <span m="1979950">maybe</span> <span m="1980240">if you're</span> <span m="1980290">using</span> <span m="1980620">a</span> <span m="1981130">line-oriented</span> <span m="1981850">function--</span> <span m="1983050">carriage</span> <span m="1983270">return,</span> <span m="1983490">line</span> <span m="1983960">feed--</span> <span m="1984080">that's</span> <span m="1984260">often</span> <span m="1984670">used</span> <span m="1984910">as the</span> <span m="1984990">line</span> <span m="1985300">terminator.</span> <span m="1985820">So</span> <span m="1986280">once</span> <span m="1986590">again, you're using</span> <span m="1987055">that dangerous</span> <span m="1987520">function</span> <span m="1988060">that's trying</span> <span m="1988470">to go this</span> <span m="1988880">way.</span> <span m="1989335">It</span> <span m="1989620">hits</span> <span m="1989840">that.</span> <span m="1990300">Oops, it's going</span> <span m="1990575">to quit.</span> </p>
<p><span m="1991870">And the</span> <span m="1992040">negative 1</span> <span m="1992420">is</span> <span m="1992970">another</span> <span m="1993280">similar</span> <span m="1993700">magic</span> <span m="1994120">token.</span> <span m="1994960">So</span> <span m="1995170">that's</span> <span m="1995480">one way you can</span> <span m="1995670">get around</span> <span m="1995965">that.</span> <span m="1996400">One</span> <span m="1996580">second.</span> </p>
<p><span m="1997500">And then</span> <span m="1997640">another</span> <span m="1997830">thing</span> <span m="1998060">you can do</span> <span m="1999050">is</span> <span m="1999335">you</span> <span m="1999620">can</span> <span m="2000600">use</span> <span m="2001140">a</span> <span m="2001460">randomized</span> <span m="2002190">value.</span> <span m="2007140">So</span> <span m="2007560">here,</span> <span m="2007890">you</span> <span m="2008220">just</span> <span m="2008660">[INAUDIBLE]</span> <span m="2009040">from</span> <span m="2009120">this</span> <span m="2009280">whole</span> <span m="2009500">idea</span> <span m="2009880">of trying to</span> <span m="2010220">figure</span> <span m="2010450">out</span> <span m="2010630">what</span> <span m="2010750">exactly</span> <span m="2011280">it is that</span> <span m="2011620">might</span> <span m="2011860">cause</span> <span m="2012160">that</span> <span m="2012370">attack</span> <span m="2012715">to</span> <span m="2013060">terminate.</span> <span m="2013385">And</span> <span m="2013710">you just</span> <span m="2014430">pull</span> <span m="2014700">some</span> <span m="2014890">random</span> <span m="2015180">number</span> <span m="2015700">and</span> <span m="2016020">either</span> <span m="2016320">make</span> <span m="2016620">it</span> <span m="2017020">difficult</span> <span m="2017440">for the</span> <span m="2017530">attacker</span> <span m="2017795">to</span> <span m="2018060">guess what</span> <span m="2018530">that</span> <span m="2018910">is.</span> </p>
<p><span m="2019550">Now,</span> <span m="2019800">of course,</span> <span m="2020260">this</span> <span m="2020490">random</span> <span m="2020780">value--</span> <span m="2021780">its</span> <span m="2021950">strength</span> <span m="2022390">is</span> <span m="2022530">basically</span> <span m="2022950">based</span> <span m="2023310">on</span> <span m="2023440">how</span> <span m="2023630">difficult</span> <span m="2023730">it is</span> <span m="2023990">for the</span> <span m="2024310">attacker</span> <span m="2024690">to guess</span> <span m="2025070">that.</span> <span m="2026150">So</span> <span m="2026965">the</span> <span m="2027290">attacker,</span> <span m="2028000">for</span> <span m="2028080">example,</span> <span m="2028580">can</span> <span m="2028970">understand</span> <span m="2029460">that</span> <span m="2029870">if there's</span> <span m="2030280">only,</span> <span m="2030690">let's say,</span> <span m="2031250">three bits</span> <span m="2031650">of entropy</span> <span m="2032050">in your</span> <span m="2032260">system,</span> <span m="2033085">then</span> <span m="2033340">maybe</span> <span m="2033735">the</span> <span m="2034130">attacker could</span> <span m="2034510">use</span> <span m="2034977">some type of</span> <span m="2035444">forced</span> <span m="2035911">attack,</span> <span m="2036378">so on</span> <span m="2036845">and so</span> <span m="2037312">forth.</span> <span m="2037780">So</span> <span m="2037980">one</span> <span m="2038160">thing to keep in</span> <span m="2038510">mind, in</span> <span m="2038790">general,</span> <span m="2039065">is that</span> <span m="2039340">whenever</span> <span m="2039595">someone</span> <span m="2039850">tells</span> <span m="2040010">you,</span> <span m="2040330">here's</span> <span m="2040550">a</span> <span m="2040680">randomized</span> <span m="2041300">offense</span> <span m="2042090">against</span> <span m="2042630">attack</span> <span m="2043100">foo,</span> <span m="2043950">if</span> <span m="2044090">there are</span> <span m="2044210">not a lot of</span> <span m="2044620">random</span> <span m="2045070">bits</span> <span m="2045240">there,</span> <span m="2045613">that</span> <span m="2045986">attack</span> <span m="2046420">may</span> <span m="2046560">not give</span> <span m="2046810">you</span> <span m="2047230">as</span> <span m="2047410">much</span> <span m="2047670">defense</span> <span m="2047800">as you</span> <span m="2048270">think.</span> <span m="2049749">You had a</span> <span m="2050242">question?</span> </p>
<p><span m="2052707">AUDIENCE: Usually</span> <span m="2053200">what tends</span> <span m="2053693">to happen</span> <span m="2054186">is</span> <span m="2054679">you read</span> <span m="2055172">from  another</span> <span m="2055665">buffer</span> <span m="2056158">and you write</span> <span m="2056651">into that</span> <span m="2057144">buffer</span> <span m="2057637">on the stack.</span> <span m="2058130">So</span> <span m="2058623">in that</span> <span m="2059116">situation,</span> <span m="2059609">it seems</span> <span m="2060102">like</span> <span m="2060595">that</span> <span m="2061088">promiscuous</span> <span m="2061581">canary</span> <span m="2062074">is</span> <span m="2062567">kind of useless.</span> <span m="2063060">Because</span> <span m="2063553">if I read</span> <span m="2064046">from the</span> <span m="2064539">[INAUDIBLE],</span> <span m="2065032">I know what the</span> <span m="2065525">canary is.</span> </p>
<p><span m="2066511">And I have</span> <span m="2067004">this other</span> <span m="2067497">buffer that</span> <span m="2067990">I control.</span> <span m="2068980">And</span> <span m="2069450">I never</span> <span m="2069920">check.</span> <span m="2070414">And in</span> <span m="2070908">that buffer,</span> <span m="2071402">I can put as much</span> <span m="2071896">of it as</span> <span m="2072390">I want.</span> <span m="2072884">I don't want  the</span> <span m="2073378">promiscuous</span> <span m="2073872">canary,</span> <span m="2074366">so I can</span> <span m="2074860">overwrite it</span> <span m="2075354">very</span> <span m="2075848">safely.</span> <span m="2076342">So</span> <span m="2077330">I</span> <span m="2077830">don't see</span> <span m="2078176">how this</span> <span m="2078522">really</span> <span m="2079030">works,</span> <span m="2079489">and</span> <span m="2079744">in</span> <span m="2080000">what</span> <span m="2080449">scenario</span> <span m="2080709">it's--</span> <span m="2081314">you're assuming</span> <span m="2081659">you're reading</span> <span m="2082159">from the</span> <span m="2082469">buffer</span> <span m="2082729">on this</span> <span m="2083239">stack</span> <span m="2083499">and you're going to</span> <span m="2083760">stop--</span> </p>
<p><span m="2084010">PROFESSOR: Well, we're</span> <span m="2084389">assuming--</span> <span m="2085255">we're</span> <span m="2085570">writing</span> <span m="2085850">to the</span> <span m="2086130">buffer.</span> <span m="2087239">So</span> <span m="2087610">basically,</span> <span m="2088260">the</span> <span m="2088510">idea</span> <span m="2088650">is that</span> <span m="2089020">you</span> <span m="2089350">write</span> <span m="2089719">some</span> <span m="2090833">[? two-long ?]</span> <span m="2091226">string</span> <span m="2091960">this</span> <span m="2092210">way.</span> <span m="2092720">And then</span> <span m="2093060">the</span> <span m="2093350">idea</span> <span m="2093790">is that</span> <span m="2094150">if</span> <span m="2094510">you</span> <span m="2094810">can't</span> <span m="2095190">guess</span> <span m="2095449">what</span> <span m="2095630">this</span> <span m="2095840">is,</span> <span m="2096464">then</span> <span m="2096750">you</span> <span m="2097050">can't,</span> <span m="2097910">basically,</span> <span m="2098930">put</span> <span m="2099350">this</span> <span m="2099650">value</span> <span m="2100510">inside</span> <span m="2101150">of</span> <span m="2101660">your</span> <span m="2101850">overflow</span> <span m="2102303">string.</span> </p>
<p><span m="2103209">AUDIENCE: But</span> <span m="2104115">you</span> <span m="2104570">said it's</span> <span m="2105065">deterministic, right?</span> <span m="2105560">0, CR, LF, negative 1.</span> </p>
<p><span m="2106490">PROFESSOR: Oh, yeah.</span> <span m="2107950">Right.</span> <span m="2108820">OK.</span> <span m="2109060">So</span> <span m="2109170">I</span> <span m="2109250">think</span> <span m="2109690">I understand your</span> <span m="2109780">question now.</span> <span m="2110230">Yes.</span> <span m="2110975">If</span> <span m="2111300">you</span> <span m="2111660">use</span> <span m="2112290">this</span> <span m="2112520">system</span> <span m="2112880">here,</span> <span m="2114040">with</span> <span m="2114320">the</span> <span m="2114600">deterministic</span> <span m="2115700">canary,</span> <span m="2116660">and</span> <span m="2117590">you</span> <span m="2118260">essentially</span> <span m="2118960">are</span> <span m="2119200">not</span> <span m="2119600">using one of</span> <span m="2120062">these functions</span> <span m="2120524">from, let's</span> <span m="2120986">say,</span> <span m="2121910">the standard</span> <span m="2122540">library</span> <span m="2123970">that</span> <span m="2124300">would</span> <span m="2124460">be</span> <span m="2124600">fooled</span> <span m="2124970">by</span> <span m="2125130">this,</span> <span m="2125610">then,</span> <span m="2125970">yeah,</span> <span m="2126360">you can defeat</span> <span m="2126700">the system</span> <span m="2127040">that way.</span> </p>
<p><span m="2127380">AUDIENCE: But</span> <span m="2127650">I can</span> <span m="2127850">use</span> <span m="2128610">string</span> <span m="2129646">CPIs</span> <span m="2130618">and the destination</span> <span m="2131104">can be</span> <span m="2131590">buffered.</span> <span m="2132076">And the</span> <span m="2132562">source can</span> <span m="2133048">be</span> <span m="2134506">[INAUDIBLE].</span> <span m="2135964">And that would</span> <span m="2136450">not protect</span> <span m="2136936">me against that.</span> </p>
<p><span m="2140972">PROFESSOR: I'm not sure I</span> <span m="2141468">understand the</span> <span m="2141964">attack,</span> <span m="2142460">so.</span> </p>
<p><span m="2143948">AUDIENCE: So the string</span> <span m="2144444">CPI</span> <span m="2145436">would take home</span> <span m="2145932">the user input</span> <span m="2146428">for my</span> <span m="2146924">data,</span> <span m="2147420">would</span> <span m="2147916">overwrite</span> <span m="2148412">canary--</span> <span m="2149910">oh, and</span> <span m="2150240">you're</span> <span m="2150420">saying--</span> <span m="2150850">hmm,</span> <span m="2151280">actually, I</span> <span m="2151710">understand what</span> <span m="2152140">you're saying.</span> </p>
<p><span m="2152570">PROFESSOR: Right?</span> <span m="2152840">Because</span> <span m="2153070">the</span> <span m="2153150">idea is</span> <span m="2153540">that</span> <span m="2154950">you can</span> <span m="2155370">fill</span> <span m="2155630">this</span> <span m="2155790">buffer</span> <span m="2156120">with</span> <span m="2156410">bytes</span> <span m="2156665">from</span> <span m="2156920">wherever,</span> <span m="2157830">right?</span> <span m="2158240">But the</span> <span m="2158390">idea</span> <span m="2158550">is that</span> <span m="2158790">unless you can</span> <span m="2159260">guess</span> <span m="2159600">this,</span> <span m="2160098">then it</span> <span m="2160596">doesn't  matter.</span> <span m="2162590">But</span> <span m="2162860">you're</span> <span m="2162990">correct.</span> <span m="2163700">In</span> <span m="2163960">general,</span> <span m="2164520">anything</span> <span m="2164830">that</span> <span m="2165030">allows</span> <span m="2165290">you to</span> <span m="2165570">guess</span> <span m="2165850">this</span> <span m="2166490">or</span> <span m="2166670">randomly</span> <span m="2167300">get</span> <span m="2167540">that value</span> <span m="2168250">correct</span> <span m="2168670">will lead</span> <span m="2169137">to the  feed</span> <span m="2169604">of the system.</span> </p>
<p><span m="2171939">AUDIENCE: In terms</span> <span m="2172406">of</span> <span m="2172873">[INAUDIBLE],</span> <span m="2173807">can you</span> <span m="2174274">just take</span> <span m="2174741">something</span> <span m="2175208">like the</span> <span m="2175680">number</span> <span m="2176220">of seconds</span> <span m="2176677">or</span> <span m="2177134">milliseconds</span> <span m="2177591">since the</span> <span m="2178050">epoch</span> <span m="2178500">and</span> <span m="2179450">use</span> <span m="2179820">that</span> <span m="2180160">at the</span> <span m="2181036">[INAUDIBLE]?</span> </p>
<p><span m="2183670">PROFESSOR: Well,</span> <span m="2184100">as it</span> <span m="2184537">turns out,</span> <span m="2184974">a lot of</span> <span m="2185411">times,</span> <span m="2185850">calls</span> <span m="2186140">that</span> <span m="2186430">get</span> <span m="2186660">[INAUDIBLE]</span> <span m="2187554">don't contain</span> <span m="2188001">as much randomness</span> <span m="2188450">as you might</span> <span m="2188890">think.</span> <span m="2190000">Because</span> <span m="2190660">the</span> <span m="2191760">program</span> <span m="2192150">itself</span> <span m="2192415">might</span> <span m="2192680">somehow--</span> <span m="2193121">let's</span> <span m="2193562">say,</span> <span m="2194003">for example,</span> <span m="2195330">have</span> <span m="2195625">a log</span> <span m="2195920">statement</span> <span m="2196260">or</span> <span m="2196480">function</span> <span m="2196570">you could</span> <span m="2197020">call</span> <span m="2197415">to</span> <span m="2197810">get</span> <span m="2197920">the</span> <span m="2198030">time</span> <span m="2198440">that the program</span> <span m="2198860">was</span> <span m="2199000">launched</span> <span m="2199280">or things like</span> <span m="2199725">that.</span> </p>
<p><span m="2200170">But you're right.</span> <span m="2200615">In practice,</span> <span m="2201060">if you</span> <span m="2201505">can use</span> <span m="2201950">something like,</span> <span m="2202395">let's</span> <span m="2202840">say,</span> <span m="2203290">the hardware</span> <span m="2203460">system</span> <span m="2203790">plot,</span> <span m="2204593">which is</span> <span m="2205066">often</span> <span m="2205540">the</span> <span m="2205680">lowest</span> <span m="2206020">level,</span> <span m="2206430">better system</span> <span m="2206904">of</span> <span m="2207378">timing</span> <span m="2207852">of it--</span> <span m="2208326">yes,</span> <span m="2208800">that kind of thing</span> <span m="2209274">might work.</span> </p>
<p><span m="2209750">AUDIENCE: But</span> <span m="2209980">even</span> <span m="2210380">if you</span> <span m="2210590">can</span> <span m="2211030">pull the</span> <span m="2212859">logs,</span> <span m="2213282">it still</span> <span m="2213705">depends</span> <span m="2214130">on</span> <span m="2214470">exactly</span> <span m="2214760">what</span> <span m="2215050">time</span> <span m="2215300">you refuse</span> <span m="2215788">a request.</span> <span m="2216276">And</span> <span m="2216764">so</span> <span m="2217740">if you</span> <span m="2218228">don't have</span> <span m="2218716">control over</span> <span m="2219204">how long</span> <span m="2219692">it takes</span> <span m="2220180">for your</span> <span m="2220668">requests to get</span> <span m="2221156">from your computer</span> <span m="2221644">to the</span> <span m="2222132">server,</span> <span m="2223596">then</span> <span m="2224084">I don't  think</span> <span m="2224572">you can</span> <span m="2225060">deterministically</span> <span m="2226036">guess</span> <span m="2226524">exactly the</span> <span m="2227012">right</span> <span m="2227500">time.</span> </p>
<p><span m="2227988">PROFESSOR: That's right.</span> <span m="2228476">That's right.</span> <span m="2228964">The devil's in</span> <span m="2229452">the details</span> <span m="2229940">with all this</span> <span m="2230428">kind of stuff.</span> </p>
<p><span m="2231892">In other words,</span> <span m="2232380">if there's some</span> <span m="2232870">way</span> <span m="2233290">for you to</span> <span m="2233600">figure</span> <span m="2233980">out,</span> <span m="2234300">for example,</span> <span m="2234763">that type of</span> <span m="2235226">timing</span> <span m="2235690">channel,</span> <span m="2236516">you might</span> <span m="2236930">find</span> <span m="2237170">out</span> <span m="2237440">that the amount</span> <span m="2237906">of entropy--</span> <span m="2238372">the amount</span> <span m="2238840">of</span> <span m="2239060">randomness--</span> <span m="2239460">is</span> <span m="2239640">not,</span> <span m="2239960">let's</span> <span m="2240280">say, the</span> <span m="2240580">full size</span> <span m="2241080">of a</span> <span m="2241280">timestamp,</span> <span m="2241630">but</span> <span m="2241980">maybe</span> <span m="2242290">something that's much</span> <span m="2242620">smaller.</span> <span m="2243650">Because maybe</span> <span m="2244147">the attacker</span> <span m="2244644">can figure out</span> <span m="2245141">the hour</span> <span m="2245638">and the</span> <span m="2246135">minute in which</span> <span m="2246632">you did</span> <span m="2247129">this,</span> <span m="2247626">but</span> <span m="2248123">not the</span> <span m="2248620">second,</span> <span m="2249117">for example.</span> <span m="2250608">We'll take</span> <span m="2251105">one more question,</span> <span m="2251602">then we'll</span> <span m="2252099">move on.</span> </p>
<p><span m="2254584">AUDIENCE: For the record, trying to</span> <span m="2255081">roll your own</span> <span m="2255578">randomness is</span> <span m="2256075">usually</span> <span m="2256572">a bad idea,</span> <span m="2257069">right?</span> </p>
<p><span m="2258063">PROFESSOR: That's correct.</span> </p>
<p><span m="2258560">AUDIENCE: Usually, you should just use whatever's supplied</span> <span m="2259057">by your</span> <span m="2259554">systems.</span> </p>
<p><span m="2260570">PROFESSOR: Oh,</span> <span m="2260730">yes.</span> <span m="2261338">That's very</span> <span m="2261836">true.</span> <span m="2262832">It's</span> <span m="2263330">like inventing</span> <span m="2263828">your own</span> <span m="2264326">cryptosystem,</span> <span m="2264824">which is another</span> <span m="2265322">popular</span> <span m="2265820">thing undergrads</span> <span m="2266318">sometimes want to do.</span> </p>
<p><span m="2267812">We're not the</span> <span m="2268310">NSA,</span> <span m="2268808">we're not mathematicians.</span> <span m="2269306">That typically</span> <span m="2269804">fails.</span> <span m="2270302">So you're exactly</span> <span m="2270800">right about</span> <span m="2271298">that.</span> </p>
<p><span m="2271800">But</span> <span m="2272190">even if</span> <span m="2272450">you use</span> <span m="2272710">system-supplied</span> <span m="2273450">randomness,</span> <span m="2274630">you</span> <span m="2274960">still</span> <span m="2275230">may end</span> <span m="2275500">up</span> <span m="2275952">with fewer bits of</span> <span m="2276404">entropy</span> <span m="2277310">than you</span> <span m="2277730">expect.</span> <span m="2278150">And I'll give</span> <span m="2278340">you an</span> <span m="2278615">example</span> <span m="2278890">of that when</span> <span m="2279348">we talk about</span> <span m="2279806">address phase</span> <span m="2280264">randomization.</span> <span m="2281640">So</span> <span m="2282240">that's</span> <span m="2282470">basically</span> <span m="2282940">how</span> <span m="2283180">the</span> <span m="2283800">stack</span> <span m="2284140">canary</span> <span m="2284885">approach</span> <span m="2285290">works.</span> </p>
<p><span m="2287150">And</span> <span m="2287330">so</span> <span m="2289334">since</span> <span m="2289752">we're</span> <span m="2290170">in a</span> <span m="2290550">security</span> <span m="2290830">class,</span> <span m="2291215">you might be</span> <span m="2291600">wondering,</span> <span m="2292040">so</span> <span m="2292380">what</span> <span m="2292880">kinds</span> <span m="2293380">of</span> <span m="2293880">things</span> <span m="2294370">will</span> <span m="2294600">stack</span> <span m="2294890">canaries</span> <span m="2295357">not</span> <span m="2295824">catch?</span> <span m="2297692">So</span> <span m="2298159">when</span> <span m="2298626">do</span> <span m="2300030">canaries</span> <span m="2300280">fail?</span> </p>
<p><span m="2308310">One</span> <span m="2308646">way</span> <span m="2308982">they can</span> <span m="2309320">fail</span> <span m="2309870">is</span> <span m="2312755">if the</span> <span m="2313218">attacker</span> <span m="2315540">the</span> <span m="2316070">things,</span> <span m="2316550">like</span> <span m="2317370">function</span> <span m="2317710">pointers.</span> <span m="2325430">Because</span> <span m="2325980">if</span> <span m="2326100">function</span> <span m="2326520">pointers</span> <span m="2326960">get</span> <span m="2327370">[INAUDIBLE],</span> <span m="2327780">there's</span> <span m="2328190">nothing</span> <span m="2328510">that</span> <span m="2328990">the canary</span> <span m="2329320">can</span> <span m="2329807">do</span> <span m="2330294">to prevent that type  of</span> <span m="2330781">exploit from taking</span> <span m="2331270">place.</span> <span m="2332120">For</span> <span m="2332250">example,</span> <span m="2332770">let's</span> <span m="2332910">say</span> <span m="2333080">you</span> <span m="2333210">have</span> <span m="2333550">code</span> <span m="2333890">that</span> <span m="2336890">declared a</span> <span m="2337390">pointer.</span> </p>
<p><span m="2340890">It gets</span> <span m="2341200">initialized</span> <span m="2341730">in</span> <span m="2341800">some</span> <span m="2342070">way,</span> <span m="2342360">it doesn't  really</span> <span m="2342852">matter.</span> <span m="2345312">Then</span> <span m="2345804">you have</span> <span m="2346296">a</span> <span m="2347780">buffer</span> <span m="2348180">here.</span> <span m="2351930">Once</span> <span m="2352190">again,</span> <span m="2352515">the</span> <span m="2352840">gets</span> <span m="2353170">function</span> <span m="2353660">rears its</span> <span m="2354110">ugly</span> <span m="2354560">head.</span> </p>
<p><span m="2357710">And then,</span> <span m="2358180">let's</span> <span m="2358520">say,</span> <span m="2358970">down</span> <span m="2359270">here,</span> <span m="2363050">we</span> <span m="2363190">assign</span> <span m="2363670">some</span> <span m="2363900">value</span> <span m="2364660">5</span> <span m="2365090">for the</span> <span m="2365504">pointer.</span> <span m="2367160">Now</span> <span m="2367300">note</span> <span m="2367750">that</span> <span m="2368230">we</span> <span m="2368560">haven't</span> <span m="2368850">actually</span> <span m="2369230">tried</span> <span m="2369820">to</span> <span m="2370560">attack</span> <span m="2371050">the</span> <span m="2371360">return</span> <span m="2371670">address</span> <span m="2372180">of</span> <span m="2372280">the</span> <span m="2372370">function that</span> <span m="2372780">contains</span> <span m="2373100">this</span> <span m="2373420">code.</span> <span m="2374845">When we view</span> <span m="2375320">the</span> <span m="2375340">buffer</span> <span m="2375660">overflow,</span> <span m="2377130">this</span> <span m="2377370">pointer</span> <span m="2377790">address</span> <span m="2378130">up here</span> <span m="2378470">is going to get</span> <span m="2378820">corrupted.</span> </p>
<p><span m="2380710">And so</span> <span m="2380910">what ends</span> <span m="2381060">up</span> <span m="2381170">happening</span> <span m="2381980">is</span> <span m="2382080">that</span> <span m="2382590">if</span> <span m="2383030">the</span> <span m="2383240">attacker</span> <span m="2383730">can corrupt</span> <span m="2384180">that</span> <span m="2384400">pointer,</span> <span m="2385050">then</span> <span m="2385640">the attacker's</span> <span m="2386180">able</span> <span m="2386340">to</span> <span m="2386430">write</span> <span m="2386790">5</span> <span m="2387490">to</span> <span m="2387610">some</span> <span m="2387750">attacker-controlled</span> <span m="2388610">address.</span> <span m="2390930">Does</span> <span m="2391200">everyone</span> <span m="2391450">see</span> <span m="2391760">how the canary</span> <span m="2392230">doesn't help</span> <span m="2392700">here?</span> <span m="2393170">Because we're basically</span> <span m="2393640">not</span> <span m="2394110">attacking</span> <span m="2394580">the</span> <span m="2395050">way</span> <span m="2395400">that the</span> <span m="2395490">function</span> <span m="2395836">returns.</span> </p>
<p><span m="2397650">AUDIENCE: But won't</span> <span m="2397905">the</span> <span m="2398160">pointer</span> <span m="2398835">be</span> <span m="2399210">below</span> <span m="2399690">the</span> <span m="2400558">buffer?</span> </p>
<p><span m="2403840">PROFESSOR: So,</span> <span m="2404420">yeah.</span> </p>
<p><span m="2406160">AUDIENCE: Not</span> <span m="2406660">necessarily--</span> </p>
<p><span m="2407160">PROFESSOR: So you're worried about,</span> <span m="2407660">is it going to be</span> <span m="2408160">here,</span> <span m="2408440">or is it going to be</span> <span m="2408845">here?</span> </p>
<p><span m="2409730">AUDIENCE: I'm</span> <span m="2409880">worried</span> <span m="2410110">about</span> <span m="2410400">when you--</span> <span m="2411768">will you actually</span> <span m="2412224">be able</span> <span m="2412680">to access</span> <span m="2413136">where the</span> <span m="2413592">pointer is</span> <span m="2414048">when you're</span> <span m="2414504">overturning--</span> </p>
<p><span m="2414960">PROFESSOR: Ah,</span> <span m="2415410">yeah.</span> <span m="2415880">So</span> <span m="2415980">you</span> <span m="2416140">can't</span> <span m="2416350">necessarily--</span> <span m="2416830">that's</span> <span m="2417010">a</span> <span m="2417220">good</span> <span m="2417360">question.</span> <span m="2417960">So</span> <span m="2418940">I</span> <span m="2419180">think,</span> <span m="2419540">in</span> <span m="2419810">a lot</span> <span m="2420130">of the previous</span> <span m="2420556">examples,</span> <span m="2420982">you've been</span> <span m="2421408">assuming</span> <span m="2421834">that</span> <span m="2422260">this</span> <span m="2422400">guy</span> <span m="2422640">would be</span> <span m="2422940">here.</span> </p>
<p><span m="2423610">Like, in the</span> <span m="2423760">[INAUDIBLE].</span> <span m="2424690">If the</span> <span m="2425070">stack</span> <span m="2425460">is</span> <span m="2425780">going</span> <span m="2426090">this</span> <span m="2426290">way,</span> <span m="2426640">then the pointer</span> <span m="2427102">would be</span> <span m="2427564">down here.</span> <span m="2428490">But</span> <span m="2428950">the</span> <span m="2429060">order</span> <span m="2429490">of the particular</span> <span m="2429971">variables--</span> <span m="2430452">it depends on a bunch</span> <span m="2430933">of different</span> <span m="2431414">things.</span> <span m="2431895">It depends</span> <span m="2432857">on the way</span> <span m="2433340">that the compiler</span> <span m="2433620">lays stuff</span> <span m="2433920">out.</span> <span m="2434400">It depends on</span> <span m="2435130">the</span> <span m="2435340">column dimension</span> <span m="2436070">of</span> <span m="2436170">the</span> <span m="2436260">hardware,</span> <span m="2436730">so on and</span> <span m="2437135">so forth.</span> <span m="2438350">But</span> <span m="2438500">you're</span> <span m="2438630">right</span> <span m="2438880">that</span> <span m="2439120">if</span> <span m="2439370">the--</span> <span m="2441280">basically,</span> <span m="2441820">if</span> <span m="2442080">the</span> <span m="2442490">buffer</span> <span m="2442910">overflow was going</span> <span m="2443330">this</span> <span m="2443580">way,</span> <span m="2443740">but the</span> <span m="2444190">pointer</span> <span m="2444420">was</span> <span m="2444550">in</span> <span m="2444950">front of</span> <span m="2445230">the</span> <span m="2445310">buffer,</span> <span m="2445780">then it's</span> <span m="2446252">going to work.</span> </p>
<p><span m="2448140">AUDIENCE: Why can't</span> <span m="2448612">you</span> <span m="2449084">associate</span> <span m="2449556">a canary</span> <span m="2450028">with the</span> <span m="2450500">function</span> <span m="2450972">canary,</span> <span m="2451444">just like you did</span> <span m="2451916">with the</span> <span m="2452388">return</span> <span m="2452860">address?</span> </p>
<p><span m="2453810">PROFESSOR: Ah.</span> <span m="2454170">That's an</span> <span m="2454440">interesting</span> <span m="2454940">point.</span> <span m="2455685">You</span> <span m="2455960">could do</span> <span m="2456215">those</span> <span m="2456470">things.</span> <span m="2457274">In fact,</span> <span m="2457676">you could</span> <span m="2458078">try to</span> <span m="2458480">imagine</span> <span m="2458805">a</span> <span m="2459130">compiler</span> <span m="2459860">that,</span> <span m="2460080">whenever</span> <span m="2460260">it</span> <span m="2460720">had</span> <span m="2461220">any pointer</span> <span m="2461690">whatsoever,</span> <span m="2462590">it</span> <span m="2462830">would</span> <span m="2463040">always</span> <span m="2463350">try</span> <span m="2463570">to</span> <span m="2463670">add</span> <span m="2464080">padding</span> <span m="2464550">for various</span> <span m="2464930">things.</span> <span m="2465620">Right?</span> </p>
<p><span m="2465950">As it</span> <span m="2466190">turns</span> <span m="2466500">out,</span> <span m="2467230">it</span> <span m="2467730">seems</span> <span m="2468010">like</span> <span m="2468210">that</span> <span m="2468530">will quickly</span> <span m="2468910">get</span> <span m="2469680">expensive,</span> <span m="2470260">in</span> <span m="2470370">terms</span> <span m="2470770">of</span> <span m="2471440">all</span> <span m="2471710">the</span> <span m="2471840">code that's</span> <span m="2472766">added,</span> <span m="2473262">to have to check</span> <span m="2473758">for all those</span> <span m="2474254">types of things.</span> <span m="2475250">Because</span> <span m="2475530">then</span> <span m="2475700">you</span> <span m="2475800">could</span> <span m="2475910">imagine</span> <span m="2476340">that</span> <span m="2476770">every</span> <span m="2477120">single</span> <span m="2477540">time</span> <span m="2478520">you</span> <span m="2478630">want</span> <span m="2478870">to</span> <span m="2479210">invoke</span> <span m="2479555">any</span> <span m="2479900">pointer,</span> <span m="2480230">or</span> <span m="2480560">recall any</span> <span m="2480990">function,</span> <span m="2481380">you've got to have this</span> <span m="2481730">code</span> <span m="2482350">that's going to</span> <span m="2482818">check whether</span> <span m="2483286">that canary</span> <span m="2483754">is correct.</span> </p>
<p><span m="2484690">But yeah,</span> <span m="2485158">in principle,</span> <span m="2485626">you could do</span> <span m="2486094">something like that.</span> <span m="2489380">So</span> <span m="2489500">does</span> <span m="2489810">this</span> <span m="2489880">make sense?</span> <span m="2490510">So</span> <span m="2490630">we see</span> <span m="2490830">that</span> <span m="2491080">canaries</span> <span m="2491440">don't help</span> <span m="2491730">you</span> <span m="2492020">on this</span> <span m="2492516">equation.</span> </p>
<p><span m="2496490">And</span> <span m="2496690">so</span> <span m="2497350">another</span> <span m="2497760">thing,</span> <span m="2498170">as</span> <span m="2498270">we've</span> <span m="2498400">discussed</span> <span m="2498740">before,</span> <span m="2499160">is that</span> <span m="2499520">if you</span> <span m="2499620">can</span> <span m="2499740">guess the</span> <span m="2500220">randomness,</span> <span m="2505128">then,</span> <span m="2505620">basically,</span> <span m="2506112">the random</span> <span m="2506604">canaries</span> <span m="2507096">don't</span> <span m="2507588">work.</span> <span m="2517440">Producing</span> <span m="2519980">secure</span> <span m="2520370">sources</span> <span m="2520640">of</span> <span m="2520910">randomness</span> <span m="2521560">is</span> <span m="2521710">actually</span> <span m="2522060">a</span> <span m="2522140">topic</span> <span m="2522415">in and</span> <span m="2522690">of</span> <span m="2522800">itself.</span> <span m="2523426">That's</span> <span m="2523772">very,</span> <span m="2524120">very</span> <span m="2524475">complicated,</span> <span m="2524830">so we're</span> <span m="2524880">not going</span> <span m="2525170">to go into great</span> <span m="2525460">depth</span> <span m="2525690">about</span> <span m="2526060">that</span> <span m="2526230">here.</span> <span m="2526710">But</span> <span m="2526920">suffice</span> <span m="2527090">it to</span> <span m="2527160">say,</span> <span m="2527510">if you can</span> <span m="2527840">guess</span> <span m="2528100">the</span> <span m="2528310">randomness,</span> <span m="2528380">everything</span> <span m="2528870">falls apart.</span> </p>
<p><span m="2529420">AUDIENCE: So</span> <span m="2529919">do canaries</span> <span m="2530418">usually have</span> <span m="2530917">less bits</span> <span m="2531416">than the return</span> <span m="2531915">address?</span> <span m="2532414">Because  otherwise,</span> <span m="2532913">couldn't you  just</span> <span m="2533412">memorize</span> <span m="2533911">the return address</span> <span m="2534410">and check</span> <span m="2534909">that</span> <span m="2535408">the address</span> <span m="2535907">changed?</span> </p>
<p><span m="2537910">PROFESSOR: Let's</span> <span m="2538150">see.</span> <span m="2538580">So</span> <span m="2538890">you're</span> <span m="2539050">saying</span> <span m="2539690">if</span> <span m="2540973">the</span> <span m="2541336">canary</span> <span m="2541700">here</span> <span m="2542380">is,</span> <span m="2542720">let's</span> <span m="2543060">say,</span> <span m="2543310">smaller</span> <span m="2543970">than--</span> </p>
<p><span m="2545568">AUDIENCE: I'm saying</span> <span m="2547564">for the canary</span> <span m="2548063">is that you know what</span> <span m="2548562">that value is</span> <span m="2549061">[INAUDIBLE].</span> <span m="2552055">Can't you  also</span> <span m="2553053">memorize the return</span> <span m="2553552">address value</span> <span m="2554051">and check</span> <span m="2554550">if that's</span> <span m="2555049">been changed?</span> </p>
<p><span m="2557550">PROFESSOR: Oh,</span> <span m="2557930">so you're saying</span> <span m="2558170">can't the</span> <span m="2559104">secure</span> <span m="2559571">system--</span> <span m="2560505">can't it</span> <span m="2560972">look</span> <span m="2561439">at the return</span> <span m="2561906">address</span> <span m="2562373">and figure out  if</span> <span m="2562840">that's been</span> <span m="2563275">changed.</span> <span m="2565320">Yeah.</span> <span m="2566270">In other</span> <span m="2566700">words,</span> <span m="2567085">if</span> <span m="2567470">there--</span> <span m="2568140">well,</span> <span m="2569050">yes</span> <span m="2569330">and no.</span> <span m="2570360">Note</span> <span m="2570690">that</span> <span m="2570840">there's</span> <span m="2571030">still</span> <span m="2571330">this</span> <span m="2571635">that's going</span> <span m="2571940">get overwritten</span> <span m="2572430">in the buffer</span> <span m="2572920">overflow attack.</span> <span m="2573900">So this may</span> <span m="2574390">still cause</span> <span m="2574880">problems.</span> </p>
<p><span m="2576350">But</span> <span m="2576580">in</span> <span m="2576690">principle,</span> <span m="2577700">if</span> <span m="2577790">somehow</span> <span m="2579360">these</span> <span m="2579460">things</span> <span m="2579720">were</span> <span m="2579980">invariant</span> <span m="2581070">somehow,</span> <span m="2582110">then</span> <span m="2582370">you could</span> <span m="2582800">do something</span> <span m="2583280">like that.</span> <span m="2584620">But the</span> <span m="2584700">problem</span> <span m="2584975">is</span> <span m="2585250">that,</span> <span m="2585980">in</span> <span m="2586170">many</span> <span m="2586430">cases,</span> <span m="2587640">this</span> <span m="2587920">return--</span> <span m="2588250">the</span> <span m="2588500">bookkeeping</span> <span m="2589120">overhead for</span> <span m="2589520">that</span> <span m="2589750">would be a little bit</span> <span m="2590156">tricky.</span> <span m="2590968">Because</span> <span m="2591374">you can</span> <span m="2591780">imagine</span> <span m="2591970">that</span> <span m="2592390">particular</span> <span m="2592770">function</span> <span m="2593060">may be</span> <span m="2593350">called from</span> <span m="2593760">places,</span> <span m="2594460">and so  on</span> <span m="2594922">and so forth.</span> <span m="2596450">Just in the</span> <span m="2596620">interest</span> <span m="2596910">of</span> <span m="2597000">time,</span> <span m="2597570">we're going</span> <span m="2597640">to</span> <span m="2598015">zoom</span> <span m="2598390">forward</span> <span m="2598820">a little bit.</span> <span m="2599700">But if we have</span> <span m="2600140">time at the</span> <span m="2600570">end, we'll come back</span> <span m="2601018">to some of  these</span> <span m="2601466">questions.</span> </p>
<p><span m="2605308">So those are</span> <span m="2605724">some</span> <span m="2606140">situations</span> <span m="2606485">in</span> <span m="2606830">which</span> <span m="2607536">the</span> <span m="2607890">canary</span> <span m="2608520">can</span> <span m="2608940">fail.</span> <span m="2609330">There's</span> <span m="2609500">some</span> <span m="2609670">other</span> <span m="2609910">places</span> <span m="2610300">in which it can</span> <span m="2610710">fail,</span> <span m="2611040">too.</span> <span m="2612800">For</span> <span m="2612930">example,</span> <span m="2613890">one way</span> <span m="2614240">that  it</span> <span m="2614520">might</span> <span m="2614970">fail</span> <span m="2615220">is</span> <span m="2615440">with</span> <span m="2616440">malloc</span> <span m="2616830">and</span> <span m="2617310">free</span> <span m="2617760">attacks.</span> <span m="2618650">This</span> <span m="2618850">is</span> <span m="2619010">a</span> <span m="2619475">uniquely</span> <span m="2621020">C-style</span> <span m="2621860">attack.</span> <span m="2624446">Let's see</span> <span m="2624930">what</span> <span m="2625090">happens</span> <span m="2625440">here.</span> </p>
<p><span m="2629860">Imagine</span> <span m="2630230">that you</span> <span m="2630600">have</span> <span m="2634350">two</span> <span m="2634790">pointers</span> <span m="2635190">here,</span> <span m="2637880">p and</span> <span m="2638180">q.</span> <span m="2639012">And</span> <span m="2639430">then</span> <span m="2640270">imagine</span> <span m="2642740">that</span> <span m="2642980">we</span> <span m="2643300">issue</span> <span m="2644000">a</span> <span m="2644430">malloc</span> <span m="2644920">for both of</span> <span m="2645375">these.</span> <span m="2648110">We</span> <span m="2648395">give</span> <span m="2648680">p</span> <span m="2649055">1,024</span> <span m="2650060">bytes</span> <span m="2650360">of memory.</span> <span m="2651310">We</span> <span m="2651400">also</span> <span m="2651730">give</span> <span m="2652800">q</span> <span m="2653740">1,024</span> <span m="2654320">bytes</span> <span m="2654700">of memory.</span> <span m="2657880">And</span> <span m="2658100">then,</span> <span m="2658520">let's</span> <span m="2658830">say</span> <span m="2659310">that</span> <span m="2660865">we</span> <span m="2661250">do</span> <span m="2661575">a</span> <span m="2663290">strcpy</span> <span m="2665260">on</span> <span m="2665580">p</span> <span m="2669478">from some</span> <span m="2669962">bug that's</span> <span m="2670446">controlled by the</span> <span m="2670930">attacker.</span> </p>
<p><span m="2671898">So here's</span> <span m="2672382">where the overflow</span> <span m="2672866">happens.</span> <span m="2675300">And</span> <span m="2675450">then</span> <span m="2675870">let's  say</span> <span m="2676185">that would</span> <span m="2676500">be</span> <span m="2679150">free</span> <span m="2679600">q</span> <span m="2683770">and then</span> <span m="2684440">let's</span> <span m="2684730">say</span> <span m="2685050">that would</span> <span m="2685500">be</span> <span m="2686850">free</span> <span m="2687300">p.</span> <span m="2688200">OK.</span> <span m="2688510">So it's</span> <span m="2688950">fairly</span> <span m="2689260">straightforward</span> <span m="2689530">code,</span> <span m="2689800">right?</span> <span m="2690360">Two</span> <span m="2690560">pointers--</span> <span m="2691760">malloc's</span> <span m="2692210">the memory</span> <span m="2692660">for each one of</span> <span m="2692990">them.</span> <span m="2694740">You</span> <span m="2695010">use</span> <span m="2695280">one of these</span> <span m="2695500">on site</span> <span m="2695690">functions,</span> <span m="2695945">the</span> <span m="2696200">buffer</span> <span m="2696310">overflow</span> <span m="2696990">happens,</span> <span m="2697610">and we</span> <span m="2698010">free</span> <span m="2698630">q</span> <span m="2699986">and we</span> <span m="2700440">free</span> <span m="2700740">p.</span> </p>
<p><span m="2703380">Let's</span> <span m="2703700">assume</span> <span m="2708675">that</span> <span m="2710540">p</span> <span m="2710940">and</span> <span m="2711340">q--</span> <span m="2712200">the memory</span> <span m="2712310">that's</span> <span m="2712540">assigned</span> <span m="2712960">to them--</span> <span m="2716190">are</span> <span m="2716770">nearby,</span> <span m="2720640">in</span> <span m="2720830">terms</span> <span m="2721220">of</span> <span m="2721360">the</span> <span m="2721460">layout</span> <span m="2721870">in terms of</span> <span m="2722280">[INAUDIBLE].</span> <span m="2723190">So</span> <span m="2723630">both</span> <span m="2723860">of</span> <span m="2723990">these</span> <span m="2724931">objects</span> <span m="2725793">line</span> <span m="2726224">next to</span> <span m="2726655">each other</span> <span m="2727520">in</span> <span m="2727985">the memory</span> <span m="2728450">space.</span> </p>
<p><span m="2730320">There's</span> <span m="2730520">some</span> <span m="2730640">subtle</span> <span m="2731250">and</span> <span m="2732182">evil</span> <span m="2732664">things that</span> <span m="2733146">can happen,</span> <span m="2734110">right?</span> <span m="2734460">Because</span> <span m="2735180">this</span> <span m="2735530">third</span> <span m="2735890">copy</span> <span m="2736200">here</span> <span m="2737150">might</span> <span m="2737490">actually</span> <span m="2738900">over--</span> <span m="2739860">it'll</span> <span m="2740480">fill p</span> <span m="2740980">with a bunch</span> <span m="2741300">of stuff,</span> <span m="2741830">but it</span> <span m="2742090">might</span> <span m="2742460">also</span> <span m="2744270">corrupt</span> <span m="2744650">some of</span> <span m="2744880">the</span> <span m="2744980">state</span> <span m="2745670">that</span> <span m="2745820">belongs</span> <span m="2746135">to</span> <span m="2746450">q.</span> <span m="2747660">OK?</span> <span m="2748010">And this</span> <span m="2748160">can</span> <span m="2748270">cause</span> <span m="2748520">problems.</span> </p>
<p><span m="2749020">And</span> <span m="2749200">some of</span> <span m="2749240">you may</span> <span m="2749510">have</span> <span m="2749670">done things</span> <span m="2750138">in this</span> <span m="2750606">unintentionally</span> <span m="2751542">in your own</span> <span m="2752010">code,</span> <span m="2752478">when you have</span> <span m="2752950">some type</span> <span m="2753080">of</span> <span m="2753490">weird</span> <span m="2753870">use of</span> <span m="2754250">pointers.</span> <span m="2755110">And then</span> <span m="2755540">stuff</span> <span m="2756290">seems to work,</span> <span m="2756590">but when</span> <span m="2756890">you call</span> <span m="2757362">free</span> <span m="2757834">later on,</span> <span m="2758306">it segfaults</span> <span m="2758778">or something like</span> <span m="2759250">that.</span> <span m="2759880">Right?</span> <span m="2760500">What I'm</span> <span m="2760720">going</span> <span m="2760820">to</span> <span m="2760900">talk</span> <span m="2761120">about</span> <span m="2761390">here</span> <span m="2761660">is the   way that the</span> <span m="2762093">attacker</span> <span m="2762526">can</span> <span m="2762960">take advantage</span> <span m="2763290">of that</span> <span m="2763780">behavior.</span> <span m="2764550">We're  actually</span> <span m="2764815">going to</span> <span m="2765080">explain</span> <span m="2765250">why that</span> <span m="2765460">happens.</span> </p>
<p><span m="2765990">So</span> <span m="2766410">imagine</span> <span m="2767430">that</span> <span m="2770340">inside</span> <span m="2771000">the</span> <span m="2771480">implementation</span> <span m="2772520">of</span> <span m="2772950">free and</span> <span m="2773380">malloc,</span> <span m="2774670">an</span> <span m="2775000">allocated</span> <span m="2775620">block</span> <span m="2776430">looks</span> <span m="2776700">like</span> <span m="2776930">this.</span> <span m="2781040">So</span> <span m="2781570">let's</span> <span m="2781800">say</span> <span m="2782000">that</span> <span m="2782300">there</span> <span m="2782600">is</span> <span m="2785120">the</span> <span m="2785510">app-visible</span> <span m="2786910">data</span> <span m="2788853">that lives up</span> <span m="2789336">here.</span> <span m="2789820">And then</span> <span m="2789960">let's</span> <span m="2790210">say</span> <span m="2793440">you had a</span> <span m="2793820">size</span> <span m="2794115">variable down</span> <span m="2794410">here.</span> <span m="2795250">This is not something</span> <span m="2795670">that</span> <span m="2796090">the</span> <span m="2796340">application</span> <span m="2796750">sees</span> <span m="2797360">directly.</span> <span m="2798310">This is</span> <span m="2798430">like</span> <span m="2798920">some</span> <span m="2799020">bookkeeping</span> <span m="2799530">info</span> <span m="2800200">that</span> <span m="2800430">the</span> <span m="2800640">free</span> <span m="2801020">or</span> <span m="2801490">the</span> <span m="2802280">malloc</span> <span m="2802670">systems</span> <span m="2803110">attract</span> <span m="2803800">so</span> <span m="2804070">that you know</span> <span m="2804500">the sizes</span> <span m="2804690">of the</span> <span m="2805040">buffer</span> <span m="2805390">that it</span> <span m="2805740">allocated.</span> </p>
<p><span m="2807990">Let's</span> <span m="2808240">say</span> <span m="2808630">that</span> <span m="2810000">free</span> <span m="2810325">block</span> <span m="2814420">has</span> <span m="2814825">some</span> <span m="2815230">metadata that</span> <span m="2815480">looks</span> <span m="2815720">like</span> <span m="2815960">this.</span> <span m="2823092">You've got the</span> <span m="2823580">size</span> <span m="2823865">of the</span> <span m="2824150">free  block</span> <span m="2824644">here.</span> <span m="2826126">And then</span> <span m="2826620">you've</span> <span m="2826840">got</span> <span m="2827220">a</span> <span m="2827440">bunch</span> <span m="2827640">of</span> <span m="2827720">empty</span> <span m="2827920">space</span> <span m="2828120">here.</span> </p>
<p><span m="2829150">Then</span> <span m="2829380">let's</span> <span m="2829630">say--</span> <span m="2829800">this is</span> <span m="2830200">where</span> <span m="2830300">things get</span> <span m="2830440">interesting.</span> <span m="2831320">You've</span> <span m="2831660">got</span> <span m="2832080">a</span> <span m="2834400">backwards</span> <span m="2835000">pointer</span> <span m="2836870">and</span> <span m="2837030">then</span> <span m="2837230">you've</span> <span m="2837500">got</span> <span m="2837830">a</span> <span m="2839020">forward</span> <span m="2839395">pointer.</span> <span m="2845600">And maybe   you've got</span> <span m="2845800">some size</span> <span m="2846110">data</span> <span m="2846420">here.</span> <span m="2847060">Now</span> <span m="2847240">why are we</span> <span m="2847580">having</span> <span m="2847860">these two</span> <span m="2848140">pointers</span> <span m="2848600">here?</span> <span m="2848890">It's</span> <span m="2849250">because</span> <span m="2849650">the memory</span> <span m="2849750">allocation</span> <span m="2850415">system,</span> <span m="2851360">in</span> <span m="2851530">this</span> <span m="2851740">case,</span> <span m="2852140">is using</span> <span m="2852755">a</span> <span m="2853030">doubly-linked</span> <span m="2853390">list</span> <span m="2853800">to</span> <span m="2854370">track</span> <span m="2855490">how</span> <span m="2855840">the</span> <span m="2856060">free</span> <span m="2856170">blocks</span> <span m="2856495">related to</span> <span m="2856820">each</span> <span m="2857196">other.</span> </p>
<p><span m="2857950">So</span> <span m="2858190">when</span> <span m="2858410">you</span> <span m="2858590">allocate</span> <span m="2858940">a free</span> <span m="2859330">block,</span> <span m="2859605">you</span> <span m="2859880">take</span> <span m="2860200">it</span> <span m="2860480">off of this</span> <span m="2860850">doubly-linked</span> <span m="2861170">list.</span> <span m="2861520">And</span> <span m="2861865">then</span> <span m="2862210">when you</span> <span m="2862515">deallocate</span> <span m="2863265">it,</span> <span m="2863710">you do</span> <span m="2863800">some pointer</span> <span m="2864230">arithmetic,</span> <span m="2865070">and</span> <span m="2865230">then you</span> <span m="2865520">fix these</span> <span m="2865950">things</span> <span m="2866210">up.</span> <span m="2866480">Then you</span> <span m="2866750">add it</span> <span m="2867070">back to that</span> <span m="2867390">linked</span> <span m="2867710">list,</span> <span m="2868310">right?</span> </p>
<p><span m="2868690">So</span> <span m="2869100">as</span> <span m="2869200">always,</span> <span m="2869610">whenever</span> <span m="2869930">you hear</span> <span m="2870250">pointer</span> <span m="2870525">arithmetic,</span> <span m="2871100">you should</span> <span m="2871330">think it's your</span> <span m="2871750">canary.</span> <span m="2872840">Because</span> <span m="2873030">that's</span> <span m="2873230">where a</span> <span m="2873360">lot</span> <span m="2873670">of these</span> <span m="2873750">problems</span> <span m="2874050">come about.</span> <span m="2875000">And</span> <span m="2875200">so</span> <span m="2875700">the</span> <span m="2875820">thing</span> <span m="2876100">to</span> <span m="2876240">note</span> <span m="2876850">is</span> <span m="2877080">that</span> <span m="2879315">we</span> <span m="2879780">had</span> <span m="2880110">this</span> <span m="2880190">buffer</span> <span m="2880480">overflow</span> <span m="2881230">here,</span> <span m="2882520">the p.</span> <span m="2883007">If we</span> <span m="2883494">assume</span> <span m="2883981">that p</span> <span m="2884468">and q</span> <span m="2884955">are next to</span> <span m="2885442">each other,</span> <span m="2885930">or very</span> <span m="2886190">close</span> <span m="2886520">in</span> <span m="2886770">memory,</span> <span m="2887020">then</span> <span m="2887450">what can</span> <span m="2887770">end up</span> <span m="2888030">happening</span> <span m="2888795">is</span> <span m="2889080">that</span> <span m="2889570">this</span> <span m="2889880">buffer</span> <span m="2890215">overflow</span> <span m="2891235">can</span> <span m="2891520">overwrite</span> <span m="2892080">some of</span> <span m="2892230">this</span> <span m="2892530">size</span> <span m="2892880">data</span> <span m="2894060">for</span> <span m="2894240">the</span> <span m="2894410">allocated</span> <span m="2895390">pointer,</span> <span m="2896460">q.</span> </p>
<p><span m="2899050">Is everybody</span> <span m="2899500">with me</span> <span m="2899780">so</span> <span m="2899920">far?</span> <span m="2900470">Because</span> <span m="2900745">if</span> <span m="2901020">you're with me</span> <span m="2901380">so</span> <span m="2901580">far,</span> <span m="2901940">then</span> <span m="2902300">basically,</span> <span m="2902860">you can</span> <span m="2903190">use</span> <span m="2903420">your</span> <span m="2903510">imagination</span> <span m="2903825">at</span> <span m="2904140">this</span> <span m="2904290">point</span> <span m="2904720">and</span> <span m="2904970">see</span> <span m="2905220">where</span> <span m="2905400">things</span> <span m="2905690">go</span> <span m="2905830">wrong.</span> <span m="2906900">Because</span> <span m="2907100">essentially,</span> <span m="2907440">what's</span> <span m="2907490">going to</span> <span m="2907720">end up</span> <span m="2908210">happening</span> <span m="2909530">is</span> <span m="2909780">that</span> <span m="2910440">these</span> <span m="2910710">free</span> <span m="2911120">operations--</span> <span m="2911480">they</span> <span m="2911840">look at</span> <span m="2912264">this</span> <span m="2912688">metadata</span> <span m="2913960">to</span> <span m="2914070">do</span> <span m="2914520">all</span> <span m="2914790">kinds</span> <span m="2915040">of</span> <span m="2915230">pointer</span> <span m="2915729">manipulations with</span> <span m="2916228">this kind of</span> <span m="2916727">stuff.</span> </p>
<p><span m="2933220">Somewhere</span> <span m="2933830">in the</span> <span m="2933920">implementation</span> <span m="2935020">of</span> <span m="2935340">free,</span> <span m="2936790">it's</span> <span m="2937000">going</span> <span m="2937310">to</span> <span m="2937440">get</span> <span m="2937840">some</span> <span m="2938090">pointer</span> <span m="2945040">based</span> <span m="2945480">on</span> <span m="2947640">the</span> <span m="2947770">value</span> <span m="2948250">of</span> <span m="2948390">size,</span> <span m="2950060">where</span> <span m="2950220">size</span> <span m="2950515">is</span> <span m="2950810">something</span> <span m="2951100">the</span> <span m="2951310">attacker</span> <span m="2951776">controls.</span> <span m="2952242">Because the attacker</span> <span m="2952708">did the</span> <span m="2953174">buffer overflow.</span> <span m="2954110">Right?</span> </p>
<p><span m="2954500">So</span> <span m="2954780">then,</span> <span m="2955480">you can</span> <span m="2955720">imagine</span> <span m="2956360">that</span> <span m="2958080">it</span> <span m="2958250">does</span> <span m="2958610">a</span> <span m="2958670">bunch</span> <span m="2959010">of</span> <span m="2959490">pointer</span> <span m="2959790">arithmetic.</span> <span m="2965030">So</span> <span m="2965160">it's</span> <span m="2965280">going</span> <span m="2965610">to</span> <span m="2966230">look</span> <span m="2966470">at the</span> <span m="2966740">back</span> <span m="2967400">in</span> <span m="2967660">the</span> <span m="2968850">four</span> <span m="2968950">pointers</span> <span m="2971886">of</span> <span m="2972290">this</span> <span m="2972540">block.</span> <span m="2973110">And</span> <span m="2973562">then</span> <span m="2974920">it's</span> <span m="2975070">going</span> <span m="2975200">to</span> <span m="2975270">do</span> <span m="2975440">something</span> <span m="2975910">like</span> <span m="2976660">update</span> <span m="2977180">the back</span> <span m="2977530">pointer.</span> <span m="2981660">And</span> <span m="2981980">also</span> <span m="2982870">update</span> <span m="2984100">the forward</span> <span m="2984430">pointer.</span> </p>
<p><span m="2990240">And</span> <span m="2990320">the</span> <span m="2990550">exact specifics</span> <span m="2990835">of this--</span> <span m="2991120">you don't</span> <span m="2991576">need to  worry</span> <span m="2992032">about.</span> <span m="2993400">This is just an</span> <span m="2993655">example</span> <span m="2993910">of the code that</span> <span m="2994340">takes</span> <span m="2994590">place</span> <span m="2994850">in</span> <span m="2994930">there.</span> <span m="2995450">But</span> <span m="2995600">the</span> <span m="2995700">point</span> <span m="2996130">is</span> <span m="2996920">that</span> <span m="2996940">note</span> <span m="2997140">that</span> <span m="2997350">because</span> <span m="2997820">the</span> <span m="2997970">attacker's</span> <span m="2998520">overwritten</span> <span m="2999000">size,</span> <span m="2999440">the</span> <span m="2999840">attacker</span> <span m="3000360">now</span> <span m="3000570">controls</span> <span m="3000825">this</span> <span m="3001080">pointer</span> <span m="3001290">that's</span> <span m="3001730">passed into the</span> <span m="3001985">free</span> <span m="3002240">code.</span> <span m="3003860">And</span> <span m="3004050">because</span> <span m="3004430">of</span> <span m="3004540">that,</span> <span m="3005110">these</span> <span m="3005460">two</span> <span m="3005620">statements</span> <span m="3006040">here,</span> <span m="3006630">these</span> <span m="3006890">are</span> <span m="3006980">actually</span> <span m="3007450">pointer</span> <span m="3007770">updates.</span> <span m="3009040">Right?</span> </p>
<p><span m="3009330">This</span> <span m="3009480">is</span> <span m="3009580">a</span> <span m="3009690">pointer</span> <span m="3010070">somewhere.</span> <span m="3010870">And</span> <span m="3011170">because</span> <span m="3011810">the</span> <span m="3012550">attacker</span> <span m="3013470">has</span> <span m="3013660">been</span> <span m="3013770">able</span> <span m="3014000">to</span> <span m="3014050">control</span> <span m="3014320">this</span> <span m="3014590">p,</span> <span m="3015080">he</span> <span m="3015300">actually</span> <span m="3015840">controls</span> <span m="3016280">all</span> <span m="3016480">this</span> <span m="3016600">stuff,</span> <span m="3016910">too.</span> <span m="3017690">This is</span> <span m="3018080">where the</span> <span m="3018470">attack can</span> <span m="3018945">actually take</span> <span m="3019420">place.</span> </p>
<p><span m="3020680">So</span> <span m="3021150">when the</span> <span m="3021380">free</span> <span m="3021830">code</span> <span m="3021890">operates</span> <span m="3022660">and it tries</span> <span m="3022965">to do</span> <span m="3023270">things</span> <span m="3023550">like,</span> <span m="3023740">for</span> <span m="3023870">example,</span> <span m="3024640">merge</span> <span m="3025005">these two</span> <span m="3025370">blocks,</span> <span m="3026500">that's typically</span> <span m="3027250">why</span> <span m="3027520">you have</span> <span m="3027860">[INAUDIBLE]</span> <span m="3028050">doubly-linked</span> <span m="3028360">list.</span> <span m="3028580">Because</span> <span m="3028860">if</span> <span m="3028990">you</span> <span m="3029060">have</span> <span m="3029570">two blocks</span> <span m="3030014">that are facing</span> <span m="3030458">to each other and</span> <span m="3030902">they're</span> <span m="3031346">both free,</span> <span m="3031790">you want to</span> <span m="3031980">merge them</span> <span m="3032480">to one</span> <span m="3032820">big</span> <span m="3033235">block.</span> <span m="3033650">Well,</span> <span m="3033800">we</span> <span m="3033910">control</span> <span m="3034290">size.</span> <span m="3036180">That means</span> <span m="3036530">we</span> <span m="3036650">control</span> <span m="3036970">this</span> <span m="3037120">whole</span> <span m="3037290">process</span> <span m="3037680">here.</span> <span m="3038154">That means if we've</span> <span m="3038628">been</span> <span m="3039102">clever</span> <span m="3039576">in how these</span> <span m="3040524">overflows</span> <span m="3040998">are working,</span> <span m="3041472">at these</span> <span m="3041946">points,</span> <span m="3042420">we can</span> <span m="3042894">write</span> <span m="3043368">to a</span> <span m="3043842">memory in the</span> <span m="3044316">way that we</span> <span m="3044790">choose.</span> </p>
<p><span m="3046840">Does that</span> <span m="3047080">make</span> <span m="3047270">sense?</span> <span m="3049065">And like I</span> <span m="3049560">said, this type of</span> <span m="3050055">thing</span> <span m="3050550">often</span> <span m="3051045">happens</span> <span m="3051540">in your own</span> <span m="3052035">code when you're</span> <span m="3052530">not</span> <span m="3053025">getting very</span> <span m="3053520">clever with pointer.</span> <span m="3054015">When you make</span> <span m="3054510">some mistake</span> <span m="3055005">with</span> <span m="3055500">the double</span> <span m="3055995">freeing</span> <span m="3056490">or whatever,</span> <span m="3056985">this is why</span> <span m="3057480">stuff will</span> <span m="3057975">segfault</span> <span m="3058470">sometimes.</span> <span m="3059570">Because</span> <span m="3059830">you've</span> <span m="3060270">messed up</span> <span m="3060590">this</span> <span m="3060910">metadata</span> <span m="3061090">that</span> <span m="3061480">lives</span> <span m="3061745">with each one of</span> <span m="3062010">these</span> <span m="3062305">allocated</span> <span m="3062790">blocks.</span> </p>
<p><span m="3063690">And</span> <span m="3063810">then</span> <span m="3063940">at</span> <span m="3064040">some</span> <span m="3064290">point,</span> <span m="3065400">this</span> <span m="3065590">calculation</span> <span m="3065950">will</span> <span m="3066310">point to</span> <span m="3066730">some</span> <span m="3066890">garbage</span> <span m="3067280">value,</span> <span m="3067580">and then you're</span> <span m="3067880">dead.</span> <span m="3068658">But if you're the attacker,</span> <span m="3069136">you can actually</span> <span m="3069614">choose that</span> <span m="3070092">value</span> <span m="3071048">and use it</span> <span m="3071526">for your own</span> <span m="3072004">advantage.</span> </p>
<p><span m="3077280">OK.</span> <span m="3077790">So</span> <span m="3078260">now</span> <span m="3078550">let's</span> <span m="3078970">get</span> <span m="3079350">to</span> <span m="3081395">another</span> <span m="3081870">approach</span> <span m="3082345">for getting</span> <span m="3082820">rid</span> <span m="3083295">of</span> <span m="3085200">some of</span> <span m="3085370">these</span> <span m="3085750">buffer</span> <span m="3086020">overflow</span> <span m="3086230">attacks.</span> <span m="3087070">And</span> <span m="3087740">that</span> <span m="3088010">approach</span> <span m="3089470">is</span> <span m="3089790">bounds</span> <span m="3090270">checking.</span> </p>
<p><span m="3098480">The</span> <span m="3098780">goal</span> <span m="3099310">of</span> <span m="3100020">bounds</span> <span m="3100380">checking</span> <span m="3103656">is</span> <span m="3104142">to make</span> <span m="3104630">sure</span> <span m="3105090">that</span> <span m="3105467">when you</span> <span m="3105844">use</span> <span m="3106221">a</span> <span m="3106600">particular</span> <span m="3107000">pointer,</span> <span m="3108768">it</span> <span m="3109254">only</span> <span m="3109740">refers</span> <span m="3110450">to</span> <span m="3110850">something</span> <span m="3112190">that</span> <span m="3112360">is a</span> <span m="3112940">memory</span> <span m="3113420">object.</span> <span m="3114380">And that</span> <span m="3114860">pointer's</span> <span m="3115420">in the</span> <span m="3115840">valid</span> <span m="3116330">bounds</span> <span m="3116820">of that memory</span> <span m="3117145">object.</span> <span m="3118380">So</span> <span m="3118630">that's the basic</span> <span m="3118930">idea</span> <span m="3119130">behind</span> <span m="3120680">the idea.</span> <span m="3120760">It's actually</span> <span m="3121090">pretty</span> <span m="3121420">simple--</span> <span m="3122390">at</span> <span m="3122530">a</span> <span m="3122570">high</span> <span m="3122790">level.</span> </p>
<p><span m="3123180">Once</span> <span m="3123420">again,</span> <span m="3123690">in</span> <span m="3123940">C,</span> <span m="3124290">though,</span> <span m="3124640">it's very</span> <span m="3124840">difficult</span> <span m="3125610">to</span> <span m="3125670">actually</span> <span m="3125980">understand</span> <span m="3126710">things.</span> <span m="3127010">Like,</span> <span m="3127190">what</span> <span m="3127370">does it</span> <span m="3127500">actually</span> <span m="3127790">mean</span> <span m="3128080">for a</span> <span m="3128385">pointer</span> <span m="3128690">to be</span> <span m="3128980">in</span> <span m="3129310">bounds</span> <span m="3129600">or out</span> <span m="3129890">of bounds,</span> <span m="3130290">or</span> <span m="3130410">valid</span> <span m="3130470">or</span> <span m="3130770">invalid?</span> <span m="3131260">So</span> <span m="3131420">for</span> <span m="3131560">example,</span> <span m="3132290">let's</span> <span m="3132640">say</span> <span m="3132990">that</span> <span m="3133690">you have</span> <span m="3133920">two pieces</span> <span m="3134325">of</span> <span m="3134730">code</span> <span m="3135921">like</span> <span m="3136320">this.</span> <span m="3136620">So</span> <span m="3136770">you</span> <span m="3137025">declare</span> <span m="3138040">a</span> <span m="3138530">character</span> <span m="3138945">array</span> <span m="3142288">of</span> <span m="3142780">1,024</span> <span m="3143310">bytes.</span> <span m="3144580">And then let's</span> <span m="3144950">say</span> <span m="3145380">that</span> <span m="3146360">you use</span> <span m="3146830">something</span> <span m="3147470">like</span> <span m="3147730">this.</span> </p>
<p><span m="3149570">You declare</span> <span m="3149810">a</span> <span m="3150020">pointer,</span> <span m="3152185">and then</span> <span m="3152620">you'd</span> <span m="3152920">get</span> <span m="3153450">the</span> <span m="3153887">address</span> <span m="3154761">of</span> <span m="3155200">one</span> <span m="3155600">of</span> <span m="3155700">the</span> <span m="3155770">elements</span> <span m="3157778">in</span> <span m="3158232">x.</span> <span m="3161620">Does this</span> <span m="3161830">make</span> <span m="3162120">sense?</span> <span m="3163070">Is this</span> <span m="3163250">a</span> <span m="3163400">good</span> <span m="3163590">idea to do</span> <span m="3164060">that?</span> <span m="3165240">It's</span> <span m="3165420">hard</span> <span m="3165670">to</span> <span m="3165750">say.</span> </p>
<p><span m="3166900">If you're</span> <span m="3167340">treating</span> <span m="3167840">this</span> <span m="3168060">x up</span> <span m="3168500">here</span> <span m="3168740">as</span> <span m="3168980">a</span> <span m="3169040">string,</span> <span m="3170270">maybe it</span> <span m="3170590">makes</span> <span m="3170860">sense</span> <span m="3171100">for</span> <span m="3171260">Jim to</span> <span m="3171630">take a pointer</span> <span m="3172093">like this.</span> <span m="3172556">Then you</span> <span m="3173019">can increment</span> <span m="3173482">and</span> <span m="3173945">decrement,</span> <span m="3174408">because maybe you're</span> <span m="3174871">looking for some</span> <span m="3175334">special value</span> <span m="3175797">of your</span> <span m="3176260">character in</span> <span m="3176723">there.</span> </p>
<p><span m="3177190">But</span> <span m="3177900">if this</span> <span m="3178030">is</span> <span m="3178864">a</span> <span m="3179281">network</span> <span m="3179700">message or</span> <span m="3179800">something</span> <span m="3180080">like</span> <span m="3180280">that,</span> <span m="3180545">maybe</span> <span m="3180810">there's</span> <span m="3181220">actually</span> <span m="3181840">some</span> <span m="3182110">struct</span> <span m="3183110">that's</span> <span m="3183320">embedded</span> <span m="3183720">in here.</span> <span m="3184120">So it</span> <span m="3184500">doesn't</span> <span m="3184740">actually</span> <span m="3185040">make</span> <span m="3185290">sense</span> <span m="3185670">to</span> <span m="3185950">walk this</span> <span m="3186380">character</span> <span m="3186723">by character,</span> <span m="3187640">right?</span> <span m="3187890">So</span> <span m="3188010">the</span> <span m="3188130">challenge</span> <span m="3188580">here is that,</span> <span m="3188920">once again,</span> <span m="3189330">we can</span> <span m="3189740">see</span> <span m="3190240">it</span> <span m="3190290">allows</span> <span m="3190480">you to</span> <span m="3190590">do</span> <span m="3190840">whatever</span> <span m="3191140">you</span> <span m="3191200">want.</span> <span m="3192110">It's</span> <span m="3192300">hard</span> <span m="3192610">to</span> <span m="3192750">determine</span> <span m="3192960">what</span> <span m="3193320">it is you</span> <span m="3193550">actually</span> <span m="3193890">want</span> <span m="3194070">it to do.</span> <span m="3195510">And</span> <span m="3195880">so,</span> <span m="3196240">as</span> <span m="3196440">a</span> <span m="3196530">result,</span> <span m="3197400">it's</span> <span m="3197530">a</span> <span m="3197580">little</span> <span m="3197890">bit</span> <span m="3198280">subtle</span> <span m="3198615">with</span> <span m="3198950">how</span> <span m="3199090">you</span> <span m="3199340">define</span> <span m="3199740">things</span> <span m="3199960">like</span> <span m="3200190">pointer</span> <span m="3200330">safety</span> <span m="3201340">in C.</span> </p>
<p><span m="3203440">You can</span> <span m="3203740">also</span> <span m="3204030">imagine</span> <span m="3204480">that life</span> <span m="3205200">gets even</span> <span m="3205520">more</span> <span m="3205780">complicated</span> <span m="3206470">if</span> <span m="3206630">you</span> <span m="3206730">use</span> <span m="3207530">structs</span> <span m="3207925">and</span> <span m="3208320">unions.</span> <span m="3210600">Imagine</span> <span m="3211060">you</span> <span m="3211140">had</span> <span m="3211405">a</span> <span m="3211670">union.</span> <span m="3212075">It</span> <span m="3212480">would look like</span> <span m="3212977">this.</span> </p>
<p><span m="3215462">It's got some</span> <span m="3215959">integer value</span> <span m="3216456">in there.</span> <span m="3218941">And then</span> <span m="3219438">you've</span> <span m="3219935">got</span> <span m="3220929">some</span> <span m="3221426">struct.</span> <span m="3223414">And then,</span> <span m="3223911">it</span> <span m="3224408">has</span> <span m="3224905">two</span> <span m="3225402">integers inside</span> <span m="3225899">of it.</span> </p>
<p><span m="3239600">Don't forget</span> <span m="3240030">the way</span> <span m="3240290">that</span> <span m="3240540">the</span> <span m="3241020">unions</span> <span m="3241480">work</span> <span m="3241750">is</span> <span m="3242020">that,</span> <span m="3242220">basically,</span> <span m="3242510">the</span> <span m="3242790">union's going to</span> <span m="3243220">allocate</span> <span m="3243720">the</span> <span m="3243870">maximum</span> <span m="3244260">size</span> <span m="3244910">for</span> <span m="3245670">the</span> <span m="3245750">largest</span> <span m="3246230">element.</span> <span m="3247310">At any given</span> <span m="3247615">moment,</span> <span m="3247920">you</span> <span m="3248260">typically</span> <span m="3248600">expect</span> <span m="3248990">that</span> <span m="3249300">either</span> <span m="3249770">this</span> <span m="3250140">ni</span> <span m="3250410">will be</span> <span m="3250680">valid</span> <span m="3251320">or</span> <span m="3251680">this</span> <span m="3251830">struct</span> <span m="3252190">s will be</span> <span m="3252500">valid,</span> <span m="3253424">but not</span> <span m="3253886">both.</span> <span m="3254810">So</span> <span m="3255170">imagine</span> <span m="3255850">that</span> <span m="3256324">you had</span> <span m="3256798">code</span> <span m="3257272">that did</span> <span m="3257746">something like</span> <span m="3258220">this.</span> <span m="3261540">You get a</span> <span m="3261900">pointer</span> <span m="3263430">to</span> <span m="3264140">address</span> <span m="3265442">this</span> <span m="3265928">guy.</span> <span m="3273218">So I get</span> <span m="3274190">an integer</span> <span m="3274676">pointer</span> <span m="3275162">to the address</span> <span m="3275648">of,</span> <span m="3276140">in</span> <span m="3276430">the union,</span> <span m="3277990">this struct,</span> <span m="3278804">and then</span> <span m="3279211">k.</span> </p>
<p><span m="3280800">Well,</span> <span m="3282650">this</span> <span m="3283170">reference</span> <span m="3283610">is</span> <span m="3284080">strictly</span> <span m="3284350">speaking in</span> <span m="3284610">bounds.</span> <span m="3285920">There's</span> <span m="3286415">memory that's been</span> <span m="3286910">allocated for</span> <span m="3287270">this.</span> <span m="3287910">That's</span> <span m="3288110">not</span> <span m="3288370">incorrect.</span> <span m="3289280">But</span> <span m="3289730">are</span> <span m="3289850">you</span> <span m="3289970">actually,</span> <span m="3290330">this</span> <span m="3290630">moment</span> <span m="3291120">in</span> <span m="3291310">program</span> <span m="3291680">of execution,</span> <span m="3291960">treating</span> <span m="3292240">this</span> <span m="3292730">union</span> <span m="3293330">as</span> <span m="3293720">one</span> <span m="3294110">of</span> <span m="3294190">these</span> <span m="3294430">guys</span> <span m="3294700">or</span> <span m="3294970">one</span> <span m="3295250">of these</span> <span m="3295430">guys?</span> <span m="3296470">It's</span> <span m="3296620">hard</span> <span m="3296850">to</span> <span m="3296940">say.</span> </p>
<p><span m="3298200">So</span> <span m="3298740">as</span> <span m="3298990">a</span> <span m="3299020">result</span> <span m="3299640">of</span> <span m="3300120">these</span> <span m="3300600">ambiguous</span> <span m="3301080">pointers</span> <span m="3301560">semantics that can</span> <span m="3302040">arise</span> <span m="3302520">in these C</span> <span m="3303000">programs,</span> <span m="3303960">typically,</span> <span m="3305730">these bound</span> <span m="3306165">checking</span> <span m="3306600">approaches</span> <span m="3308615">can</span> <span m="3309000">only</span> <span m="3309300">offer</span> <span m="3309600">a</span> <span m="3310013">weaker</span> <span m="3310426">notion</span> <span m="3311080">of</span> <span m="3311220">pointer</span> <span m="3311360">correctness.</span> <span m="3312540">And</span> <span m="3312980">so</span> <span m="3314372">that</span> <span m="3314848">notion</span> <span m="3315800">is</span> <span m="3316050">as</span> <span m="3316490">follows.</span> </p>
<p><span m="3323995">If you</span> <span m="3324472">have</span> <span m="3324949">a</span> <span m="3326870">pointer</span> <span m="3327040">p</span> <span m="3327527">prime</span> <span m="3332610">that's</span> <span m="3332860">derived</span> <span m="3338926">from</span> <span m="3339422">the base</span> <span m="3339918">pointer p,</span> <span m="3346870">then</span> <span m="3347160">p</span> <span m="3347530">prime</span> <span m="3350530">should</span> <span m="3350590">only</span> <span m="3350770">be</span> <span m="3350920">used</span> <span m="3356810">to</span> <span m="3357588">deference</span> <span m="3358076">memory</span> <span m="3366860">that</span> <span m="3367348">belongs</span> <span m="3367836">to the  original</span> <span m="3368324">base pointer.</span> <span m="3377620">So</span> <span m="3377970">for</span> <span m="3378600">a</span> <span m="3378700">derived</span> <span m="3379260">pointer</span> <span m="3379680">p</span> <span m="3380100">prime</span> <span m="3380380">that's</span> <span m="3380850">derived</span> <span m="3381145">from some</span> <span m="3381440">original</span> <span m="3381903">p,</span> <span m="3382830">then</span> <span m="3383200">p prime</span> <span m="3383640">should only be used</span> <span m="3383985">to deference</span> <span m="3384680">memory</span> <span m="3385460">that</span> <span m="3385850">belongs</span> <span m="3386210">to p.</span> <span m="3387680">Know that</span> <span m="3388040">this</span> <span m="3388300">is</span> <span m="3389010">a</span> <span m="3389200">weaker</span> <span m="3389920">goal</span> <span m="3390740">than</span> <span m="3390990">enforcing</span> <span m="3391270">completely</span> <span m="3391880">correct</span> <span m="3392367">pointer</span> <span m="3392854">semantics.</span> </p>
<p><span m="3394380">Because</span> <span m="3395010">for</span> <span m="3395360">example,</span> <span m="3395820">you could</span> <span m="3395950">still</span> <span m="3396380">have</span> <span m="3396830">weird</span> <span m="3398000">issues</span> <span m="3398410">like</span> <span m="3399360">with this</span> <span m="3399835">union</span> <span m="3400310">here, for</span> <span m="3400785">example.</span> <span m="3401260">Maybe at</span> <span m="3401735">this particular point</span> <span m="3402210">in the</span> <span m="3402685">program,</span> <span m="3403160">it</span> <span m="3403370">wasn't</span> <span m="3403750">correct</span> <span m="3404460">for the</span> <span m="3404920">program</span> <span m="3405380">to be</span> <span m="3405650">able to</span> <span m="3405920">reference</span> <span m="3406430">that</span> <span m="3406720">particular</span> <span m="3407150">value</span> <span m="3407755">in the union.</span> <span m="3409150">But</span> <span m="3410130">at least</span> <span m="3410430">this</span> <span m="3410730">pointer</span> <span m="3411090">reference</span> <span m="3411410">is</span> <span m="3411730">imbalanced.</span> </p>
<p><span m="3413500">So</span> <span m="3413620">maybe--</span> <span m="3414332">like this</span> <span m="3414690">example</span> <span m="3415160">up here--</span> <span m="3415710">maybe</span> <span m="3416890">this</span> <span m="3419200">creation</span> <span m="3419490">of</span> <span m="3419780">this pointer</span> <span m="3420130">here</span> <span m="3420950">violated</span> <span m="3421320">the</span> <span m="3422060">semantics</span> <span m="3422660">of the</span> <span m="3422860">network</span> <span m="3423225">message</span> <span m="3423590">embedded in</span> <span m="3423926">x.</span> <span m="3424600">But</span> <span m="3424930">at least you're</span> <span m="3425240">not</span> <span m="3425470">trampling</span> <span m="3426030">on</span> <span m="3426320">arbitrary</span> <span m="3427052">memory.</span> <span m="3427710">You're</span> <span m="3428060">only</span> <span m="3428170">trampling</span> <span m="3428800">on the</span> <span m="3429240">memory</span> <span m="3429790">that</span> <span m="3430000">belongs</span> <span m="3430310">to</span> <span m="3430620">you.</span> <span m="3431390">And</span> <span m="3431540">so,</span> <span m="3431810">in the world</span> <span m="3432080">of</span> <span m="3432250">C,</span> <span m="3432380">this</span> <span m="3432675">is considered</span> <span m="3432970">success.</span> <span m="3436970">So that's the basic</span> <span m="3437360">idea.</span> </p>
<p><span m="3437990">Now,</span> <span m="3438350">the</span> <span m="3438460">challenge</span> <span m="3439130">with</span> <span m="3440190">enforcing</span> <span m="3440750">these</span> <span m="3440960">types</span> <span m="3441240">of</span> <span m="3441460">semantics</span> <span m="3442150">here</span> <span m="3442710">is</span> <span m="3442950">that,</span> <span m="3443560">in many</span> <span m="3443950">cases, you need</span> <span m="3444410">help</span> <span m="3444685">from the</span> <span m="3444960">compiler.</span> <span m="3446260">So</span> <span m="3446730">you need</span> <span m="3446930">help from the</span> <span m="3447380">compiler.</span> <span m="3447590">You</span> <span m="3447760">typically</span> <span m="3448560">need</span> <span m="3448890">to</span> <span m="3449390">recompile</span> <span m="3449780">programs</span> <span m="3450640">to</span> <span m="3451350">enforce these</span> <span m="3451848">semantics.</span> <span m="3452346">That</span> <span m="3452844">can be a drag</span> <span m="3453342">for</span> <span m="3453840">backwards</span> <span m="3454338">compatibility.</span> <span m="3454836">But this is the</span> <span m="3455334">basic notion</span> <span m="3455832">of</span> <span m="3457060">bounds</span> <span m="3457410">checking.</span> </p>
<p><span m="3458520">What</span> <span m="3458700">are</span> <span m="3458760">some</span> <span m="3458980">ways</span> <span m="3459270">that you can</span> <span m="3459520">implement</span> <span m="3460445">bounds</span> <span m="3460800">checking?</span> <span m="3469000">One</span> <span m="3469270">very</span> <span m="3469540">simple</span> <span m="3469890">way</span> <span m="3473026">is this</span> <span m="3473480">notion</span> <span m="3473990">called</span> <span m="3474500">electric</span> <span m="3474999">fencing.</span> <span m="3481870">The</span> <span m="3482100">notion</span> <span m="3482440">here is</span> <span m="3482780">that,</span> <span m="3483260">for</span> <span m="3483730">every</span> <span m="3484330">object</span> <span m="3484980">that you</span> <span m="3485370">allocate</span> <span m="3486410">on the</span> <span m="3486740">heap,</span> <span m="3487870">you</span> <span m="3488270">allocate</span> <span m="3488930">a</span> <span m="3489280">guard</span> <span m="3489670">page</span> <span m="3493360">that's</span> <span m="3493930">immediately</span> <span m="3494220">next</span> <span m="3494510">to it.</span> </p>
<p><span m="3495440">And you</span> <span m="3495800">set</span> <span m="3496140">the</span> <span m="3496330">page</span> <span m="3496740">protection</span> <span m="3497570">on</span> <span m="3497740">that</span> <span m="3497890">page,</span> <span m="3498540">such</span> <span m="3498820">that if</span> <span m="3499060">anybody</span> <span m="3499440">tries to</span> <span m="3499715">touch</span> <span m="3499990">that,</span> <span m="3500490">you</span> <span m="3500660">get a</span> <span m="3500800">hard</span> <span m="3501275">fault.</span> <span m="3502150">The</span> <span m="3502410">hard rules</span> <span m="3502610">say</span> <span m="3502770">that's out of</span> <span m="3503270">bounds,</span> <span m="3503770">and then</span> <span m="3503930">the</span> <span m="3504030">program will</span> <span m="3504480">stop</span> <span m="3504735">right</span> <span m="3504990">there.</span> <span m="3506205">And</span> <span m="3506610">so</span> <span m="3506850">this</span> <span m="3507050">is</span> <span m="3507160">a</span> <span m="3507220">very</span> <span m="3507610">simple</span> <span m="3508100">thing</span> <span m="3508287">that</span> <span m="3508349">you</span> <span m="3508412">can</span> <span m="3508475">do.</span> <span m="3509195">And</span> <span m="3509540">what's</span> <span m="3509830">nice</span> <span m="3510140">about</span> <span m="3510390">this</span> <span m="3510621">approach</span> <span m="3510853">actually,</span> <span m="3511316">is</span> <span m="3511547">that</span> <span m="3512242">whenever</span> <span m="3512473">you</span> <span m="3512705">have</span> <span m="3513168">an</span> <span m="3513399">invalid</span> <span m="3513631">memory</span> <span m="3514094">reference,</span> <span m="3514560">this</span> <span m="3514790">causes</span> <span m="3515060">a</span> <span m="3515410">fault</span> <span m="3515585">immediately,</span> <span m="3516730">right.</span> <span m="3517140">If</span> <span m="3517253">you've</span> <span m="3517366">ever</span> <span m="3517480">debugged</span> <span m="3517940">the</span> <span m="3518050">Base</span> <span m="3518315">C</span> <span m="3518403">or</span> <span m="3518491">C++</span> <span m="3518930">program,</span> <span m="3519230">one</span> <span m="3519310">of</span> <span m="3519390">the</span> <span m="3519470">big</span> <span m="3519700">problems</span> <span m="3520030">is</span> <span m="3520360">that</span> <span m="3520470">a</span> <span m="3520530">lot</span> <span m="3520830">of</span> <span m="3520970">times</span> <span m="3521245">when</span> <span m="3521336">you</span> <span m="3521428">corrupt</span> <span m="3521520">memory,</span> <span m="3522480">that</span> <span m="3522780">memory</span> <span m="3523920">is</span> <span m="3524095">corrupted</span> <span m="3524270">silently,</span> <span m="3524980">and</span> <span m="3525360">for</span> <span m="3525810">a</span> <span m="3525860">while,</span> <span m="3526300">and</span> <span m="3526430">it</span> <span m="3526575">isn't</span> <span m="3526720">until</span> <span m="3526810">later</span> <span m="3527160">that</span> <span m="3527510">something</span> <span m="3527655">crashes</span> <span m="3528375">and</span> <span m="3528517">then</span> <span m="3528660">only</span> <span m="3529130">then</span> <span m="3529470">you</span> <span m="3529645">realize</span> <span m="3529820">something</span> <span m="3530260">happened.</span> <span m="3530870">But</span> <span m="3530925">you</span> <span m="3530980">don't</span> <span m="3531130">know</span> <span m="3531250">what</span> <span m="3531410">that</span> <span m="3531600">something</span> <span m="3532060">is.</span> <span m="3532380">You</span> <span m="3532490">simply</span> <span m="3532900">do</span> <span m="3532940">what</span> <span m="3533030">they</span> <span m="3533120">call</span> <span m="3533310">heisenbugs,</span> <span m="3533975">right.</span> <span m="3534390">Things</span> <span m="3534720">that</span> <span m="3534813">have</span> <span m="3534906">this</span> <span m="3535000">notion</span> <span m="3535093">of</span> <span m="3535186">uncertainty</span> <span m="3535280">in</span> <span m="3535550">them.</span> <span m="3536030">So</span> <span m="3536080">what's</span> <span m="3536130">nice</span> <span m="3536610">about</span> <span m="3536745">this</span> <span m="3536812">is</span> <span m="3536880">that</span> <span m="3537370">as</span> <span m="3537750">soon</span> <span m="3538150">as</span> <span m="3538225">the</span> <span m="3538300">pointer</span> <span m="3538800">hits</span> <span m="3539170">here,</span> <span m="3539600">boom,</span> <span m="3540060">it's</span> <span m="3540133">a</span> <span m="3540169">guard</span> <span m="3540206">page,</span> <span m="3540760">everything</span> <span m="3541130">blows</span> <span m="3541371">up.</span> </p>
<p><span m="3543060">Now</span> <span m="3543610">can</span> <span m="3543660">you</span> <span m="3543980">think</span> <span m="3544210">of</span> <span m="3544320">a</span> <span m="3544400">disadvantage</span> <span m="3545130">with</span> <span m="3545230">this</span> <span m="3545380">approach?</span> </p>
<p><span m="3547088">AUDIENCE:</span> <span m="3547504">It</span> <span m="3547712">takes</span> <span m="3547920">longer</span> <span m="3548240">[INAUDIBLE].</span> </p>
<p><span m="3548520">PROFESSOR:</span> <span m="3548800">Yeah</span> <span m="3549260">exactly.</span> <span m="3550055">So</span> <span m="3550380">imagine</span> <span m="3550440">that</span> <span m="3550715">this</span> <span m="3550990">little--</span> <span m="3551260">this</span> <span m="3551460">key</span> <span m="3551680">thing</span> <span m="3551860">here</span> <span m="3552090">was</span> <span m="3552420">super,</span> <span m="3552500">super</span> <span m="3552790">small,</span> <span m="3553430">then</span> <span m="3553500">I've</span> <span m="3553570">allocated</span> <span m="3553830">a</span> <span m="3554090">whole</span> <span m="3554433">page</span> <span m="3555120">just</span> <span m="3555210">to</span> <span m="3555300">make</span> <span m="3555500">sure</span> <span m="3555640">that</span> <span m="3555780">my</span> <span m="3555900">little</span> <span m="3556280">tiny</span> <span m="3556610">thing</span> <span m="3556720">here</span> <span m="3557510">didn't</span> <span m="3557855">get--</span> <span m="3559240">didn't</span> <span m="3559450">have</span> <span m="3559850">one</span> <span m="3559981">of</span> <span m="3560113">these</span> <span m="3560245">pointer</span> <span m="3560442">attacks.</span> <span m="3561133">So</span> <span m="3561626">this</span> <span m="3561873">is</span> <span m="3562120">very</span> <span m="3562800">space</span> <span m="3563110">intensive.</span> <span m="3564030">And</span> <span m="3564110">so--</span> <span m="3564770">but</span> <span m="3564890">people</span> <span m="3565280">don't</span> <span m="3565540">really</span> <span m="3565610">deploy</span> <span m="3565680">something</span> <span m="3565905">like</span> <span m="3566130">this</span> <span m="3566597">in</span> <span m="3566830">production.</span> <span m="3568000">This</span> <span m="3568150">could</span> <span m="3568310">be</span> <span m="3568470">useful</span> <span m="3568583">for</span> <span m="3568696">the</span> <span m="3568810">bugging</span> <span m="3569280">thing,</span> <span m="3569890">but</span> <span m="3569985">you</span> <span m="3570080">would</span> <span m="3570200">never</span> <span m="3570450">do</span> <span m="3570620">this</span> <span m="3570840">for</span> <span m="3570989">a</span> <span m="3571138">real</span> <span m="3571288">program.</span> <span m="3573080">So</span> <span m="3573200">that</span> <span m="3573390">make</span> <span m="3573520">sense?</span> <span m="3573650">So</span> <span m="3574435">these</span> <span m="3574830">electrical</span> <span m="3575260">fences</span> <span m="3575370">are</span> <span m="3575510">actually</span> <span m="3575650">pretty--</span> <span m="3576290">pretty</span> <span m="3576600">simple</span> <span m="3576745">to</span> <span m="3576891">understand.</span> </p>
<p><span m="3579222">AUDIENCE:</span> <span m="3579660">Why</span> <span m="3579830">does</span> <span m="3579885">that</span> <span m="3579940">have</span> <span m="3580033">to</span> <span m="3580126">be</span> <span m="3580800">so</span> <span m="3581100">large,</span> <span m="3581460">necessarily?</span> </p>
<p><span m="3582340">PROFESSOR:</span> <span m="3582780">Ah,</span> <span m="3583240">so</span> <span m="3583830">the</span> <span m="3583970">reason</span> <span m="3584320">is</span> <span m="3584670">because</span> <span m="3585370">this</span> <span m="3585650">guard</span> <span m="3585955">page</span> <span m="3586107">here,</span> <span m="3586930">you're</span> <span m="3587080">typically</span> <span m="3587720">relying</span> <span m="3587800">on</span> <span m="3588260">the</span> <span m="3589180">hardware,</span> <span m="3589640">like</span> <span m="3589900">page</span> <span m="3590110">level</span> <span m="3590320">protections</span> <span m="3590477">to</span> <span m="3590635">deal</span> <span m="3590740">with</span> <span m="3590845">those</span> <span m="3590950">types</span> <span m="3591141">of</span> <span m="3591333">things.</span> <span m="3592100">And</span> <span m="3592310">so</span> <span m="3592880">there's</span> <span m="3593180">like</span> <span m="3593290">certain</span> <span m="3593585">memory</span> <span m="3593880">size</span> <span m="3594230">you</span> <span m="3594355">can</span> <span m="3594480">set</span> <span m="3594870">to</span> <span m="3595006">the</span> <span m="3595143">size</span> <span m="3595280">of</span> <span m="3595416">the</span> <span m="3595553">page,</span> <span m="3596093">according</span> <span m="3596294">to</span> <span m="3596496">[? Hollis ?].</span> <span m="3596900">But</span> <span m="3596995">typically</span> <span m="3597090">that</span> <span m="3597320">page</span> <span m="3597410">is</span> <span m="3597690">4k,</span> <span m="3598060">for</span> <span m="3598320">example.</span> <span m="3598980">So</span> <span m="3599120">getting</span> <span m="3599280">back</span> <span m="3599470">to</span> <span m="3599560">your</span> <span m="3599740">question,</span> <span m="3600260">this</span> <span m="3600430">is</span> <span m="3600600">some</span> <span m="3600840">like</span> <span m="3601340">super</span> <span m="3601760">small</span> <span m="3602110">value</span> <span m="3602500">here,</span> <span m="3602910">then</span> <span m="3603129">yeah</span> <span m="3603348">[INAUDIBLE]</span> <span m="3604224">2</span> <span m="3604443">bytes</span> <span m="3604662">where</span> <span m="3605100">you</span> <span m="3605380">got</span> <span m="3605660">4k</span> <span m="3605910">here</span> <span m="3606380">protecting</span> <span m="3606858">it.</span> </p>
<p><span m="3608292">AUDIENCE:</span> <span m="3608770">In</span> <span m="3609248">protecting</span> <span m="3609726">[INAUDIBLE]</span> <span m="3610682">individual</span> <span m="3611638">[INAUDIBLE].</span> </p>
<p><span m="3613080">PROFESSOR: Oh</span> <span m="3613240">sorry</span> <span m="3613640">yeah,</span> <span m="3613760">yeah</span> <span m="3613920">so</span> <span m="3614080">by</span> <span m="3614240">heap</span> <span m="3614670">I</span> <span m="3614818">mean</span> <span m="3615115">like</span> <span m="3615560">heap</span> <span m="3616026">object.</span> </p>
<p><span m="3616492">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="3616960">PROFESSOR: Yeah</span> <span m="3617340">thank</span> <span m="3617435">you</span> <span m="3617530">for--</span> <span m="3617625">yeah</span> <span m="3617720">exactly.</span> <span m="3618560">So</span> <span m="3619010">imagine</span> <span m="3619440">like</span> <span m="3619565">for</span> <span m="3619627">each</span> <span m="3619690">malloc</span> <span m="3620040">you</span> <span m="3620285">do,</span> <span m="3620530">you</span> <span m="3620693">can</span> <span m="3620856">have</span> <span m="3621020">one</span> <span m="3621183">of</span> <span m="3621346">these--</span> <span m="3622140">and</span> <span m="3622160">set</span> <span m="3622180">the</span> <span m="3622220">guard</span> <span m="3622260">page</span> <span m="3622490">for</span> <span m="3622705">it.</span> </p>
<p><span m="3622920">AUDIENCE:</span> <span m="3623358">And</span> <span m="3623533">you</span> <span m="3623620">do</span> <span m="3623708">it</span> <span m="3623796">for</span> <span m="3624234">log</span> <span m="3624672">and</span> <span m="3624891">above?</span> <span m="3625110">Or</span> <span m="3625329">just</span> <span m="3625548">above?</span> </p>
<p><span m="3625990">PROFESSOR: You</span> <span m="3626260">can</span> <span m="3626503">do</span> <span m="3626747">either.</span> </p>
<p><span m="3627234">AUDIENCE:</span> <span m="3627721">[INAUDIBLE]</span> </p>
<p><span m="3630780">PROFESSOR: That's</span> <span m="3631020">right.</span> </p>
<p><span m="3631260">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="3631740">PROFESSOR:</span> <span m="3632220">That's</span> <span m="3632300">right,</span> <span m="3632380">well</span> <span m="3632406">you</span> <span m="3632433">could</span> <span m="3632460">do</span> <span m="3632600">either.</span> <span m="3633480">The</span> <span m="3633610">ones</span> <span m="3633740">we</span> <span m="3633776">have</span> <span m="3633812">depending</span> <span m="3633885">on</span> <span m="3634030">this--</span> <span m="3634750">on</span> <span m="3635180">the</span> <span m="3635290">size</span> <span m="3635416">of</span> <span m="3635543">the</span> <span m="3635670">object.</span> <span m="3637030">I</span> <span m="3637240">mean</span> <span m="3637450">now</span> <span m="3637660">you</span> <span m="3638130">got</span> <span m="3638286">to</span> <span m="3638443">declare</span> <span m="3638600">two</span> <span m="3639070">guard</span> <span m="3639226">fences,</span> <span m="3639383">right.</span> <span m="3640010">So</span> <span m="3640210">now</span> <span m="3640500">this</span> <span m="3641200">quickly</span> <span m="3641530">gets</span> <span m="3641620">out</span> <span m="3641710">of</span> <span m="3641800">control.</span> <span m="3642610">Which</span> <span m="3642665">yeah,</span> <span m="3642720">you</span> <span m="3642910">could</span> <span m="3643120">have</span> <span m="3643650">a</span> <span m="3643750">booking</span> <span m="3644170">[INAUDIBLE].</span> <span m="3646615">So</span> <span m="3646778">that's</span> <span m="3646941">the</span> <span m="3647104">basic</span> <span m="3647593">idea</span> <span m="3648082">behind</span> <span m="3648326">that.</span> </p>
<p><span m="3658351">And</span> <span m="3658514">then</span> <span m="3658677">another</span> <span m="3658840">approach</span> <span m="3659329">you</span> <span m="3659451">can</span> <span m="3659573">look</span> <span m="3659695">at</span> <span m="3662280">is</span> <span m="3665044">what</span> <span m="3665540">they</span> <span m="3665788">call</span> <span m="3666036">fat</span> <span m="3666532">pointers.</span> <span m="3671990">And</span> <span m="3672085">so</span> <span m="3672180">the</span> <span m="3672300">idea</span> <span m="3672650">here</span> <span m="3673040">is</span> <span m="3673145">we</span> <span m="3673250">actually</span> <span m="3673490">want</span> <span m="3673605">to</span> <span m="3673720">modify</span> <span m="3674060">the</span> <span m="3674400">pointer</span> <span m="3674570">representation</span> <span m="3675080">itself</span> <span m="3676280">to</span> <span m="3676610">include</span> <span m="3676880">bounds</span> <span m="3677280">information</span> <span m="3677750">in</span> <span m="3677970">it.</span> <span m="3678390">So</span> <span m="3679750">if</span> <span m="3679980">you</span> <span m="3680210">look</span> <span m="3680286">at</span> <span m="3680363">your</span> <span m="3680970">regular</span> <span m="3683171">32-bit</span> <span m="3684085">pointer</span> <span m="3687050">what's</span> <span m="3687240">it</span> <span m="3687290">look</span> <span m="3687480">like?</span> <span m="3688430">Well</span> <span m="3688770">the</span> <span m="3688855">answer</span> <span m="3688940">is,</span> <span m="3689210">32-bits.</span> <span m="3690128">And</span> <span m="3690587">then</span> <span m="3691964">you</span> <span m="3692117">got</span> <span m="3692270">[INAUDIBLE].</span> <span m="3692882">Right?</span> <span m="3693341">If</span> <span m="3693570">you</span> <span m="3693800">look</span> <span m="3694160">at</span> <span m="3694350">a</span> <span m="3696190">fat</span> <span m="3696350">pointer</span> <span m="3700450">then</span> <span m="3701030">one</span> <span m="3701130">way</span> <span m="3701230">you</span> <span m="3701385">can</span> <span m="3701540">think</span> <span m="3701710">about</span> <span m="3702015">looking</span> <span m="3702167">at</span> <span m="3702320">this</span> <span m="3702740">is</span> <span m="3703020">you</span> <span m="3703131">got</span> <span m="3703243">a</span> <span m="3703690">4</span> <span m="3704090">byte</span> <span m="3706500">base.</span> <span m="3710580">And</span> <span m="3710750">then</span> <span m="3710950">you</span> <span m="3711090">have</span> <span m="3711470">a</span> <span m="3712650">4</span> <span m="3713130">byte</span> <span m="3716780">end.</span> </p>
<p><span m="3717750">So</span> <span m="3718110">in</span> <span m="3718170">other</span> <span m="3718230">words,</span> <span m="3718315">this</span> <span m="3718400">is</span> <span m="3718550">where</span> <span m="3718780">it</span> <span m="3718895">would</span> <span m="3719010">allocate</span> <span m="3719240">out</span> <span m="3719393">that</span> <span m="3719469">it</span> <span m="3719546">starts,</span> <span m="3720620">that's</span> <span m="3720773">where</span> <span m="3720926">it</span> <span m="3721080">ends</span> <span m="3722000">and</span> <span m="3722460">then</span> <span m="3722850">you've</span> <span m="3723170">got</span> <span m="3723650">a</span> <span m="3725620">4</span> <span m="3726300">byte</span> <span m="3728433">cur</span> <span m="3728664">address.</span> <span m="3732660">So</span> <span m="3732810">this</span> <span m="3733010">is</span> <span m="3733140">where</span> <span m="3733300">the</span> <span m="3733535">pointer</span> <span m="3733770">actually</span> <span m="3734220">is,</span> <span m="3734710">within</span> <span m="3735030">that</span> <span m="3735366">bounds,</span> <span m="3736040">right.</span> <span m="3736500">So</span> <span m="3737170">basically</span> <span m="3737480">what</span> <span m="3737630">happens</span> <span m="3738040">is</span> <span m="3738150">that</span> <span m="3738340">the</span> <span m="3738530">compiler</span> <span m="3738800">will</span> <span m="3740090">generate</span> <span m="3740550">code,</span> <span m="3741010">such</span> <span m="3741142">that</span> <span m="3741275">when</span> <span m="3741407">you</span> <span m="3741540">access</span> <span m="3741860">these</span> <span m="3742180">fat</span> <span m="3742408">pointers</span> <span m="3744460">this</span> <span m="3744505">gets</span> <span m="3744550">updated,</span> <span m="3744770">but</span> <span m="3744866">then</span> <span m="3744963">it'll</span> <span m="3745220">also</span> <span m="3745999">check</span> <span m="3746233">these</span> <span m="3746468">two</span> <span m="3746561">things</span> <span m="3746655">to</span> <span m="3746749">make</span> <span m="3746843">sure</span> <span m="3746937">that</span> <span m="3747171">nothing</span> <span m="3747406">bad</span> <span m="3747875">has</span> <span m="3748109">happened</span> <span m="3748344">during</span> <span m="3748500">that</span> <span m="3748656">upgrade.</span> </p>
<p><span m="3750220">So</span> <span m="3750820">for</span> <span m="3750950">example</span> <span m="3751300">you</span> <span m="3751740">can</span> <span m="3751825">imagine</span> <span m="3751910">that</span> <span m="3752420">if</span> <span m="3752570">I</span> <span m="3752720">had</span> <span m="3752870">code</span> <span m="3753100">like</span> <span m="3753360">this.</span> <span m="3762240">So</span> <span m="3762490">I</span> <span m="3762740">have</span> <span m="3762865">an</span> <span m="3762990">end</span> <span m="3763115">pointer</span> <span m="3763740">and</span> <span m="3763990">then</span> <span m="3764240">I</span> <span m="3764740">allocate</span> <span m="3766850">8</span> <span m="3767070">bytes.</span> <span m="3767780">So</span> <span m="3767995">assuming</span> <span m="3768210">that</span> <span m="3768315">we're</span> <span m="3768420">on</span> <span m="3768525">a</span> <span m="3769050">32-bit</span> <span m="3769530">architecture</span> <span m="3769880">to</span> <span m="3770030">point</span> <span m="3770180">to</span> <span m="3770500">2</span> <span m="3771492">[INAUDIBLE].</span> <span m="3773480">And</span> <span m="3773845">then</span> <span m="3774027">I</span> <span m="3774210">have</span> <span m="3774530">some</span> <span m="3775690">while</span> <span m="3775950">loop</span> <span m="3778710">that</span> <span m="3779080">it</span> <span m="3779277">is</span> <span m="3779475">going</span> <span m="3779870">to</span> <span m="3780790">just</span> <span m="3781000">assign</span> <span m="3781500">some</span> <span m="3781720">value</span> <span m="3782633">to</span> <span m="3782986">the</span> <span m="3783340">pointer</span> <span m="3784166">and</span> <span m="3784652">then</span> <span m="3785138">increment</span> <span m="3785300">the</span> <span m="3785462">pointer--</span> <span m="3790970">what</span> <span m="3791310">you'll</span> <span m="3791490">see</span> <span m="3791520">is</span> <span m="3791550">that</span> <span m="3791580">the</span> <span m="3791610">current</span> <span m="3791940">address</span> <span m="3792305">for</span> <span m="3792487">this</span> <span m="3792670">pointer,</span> <span m="3793830">like</span> <span m="3794220">at</span> <span m="3794610">this</span> <span m="3794850">point</span> <span m="3794990">in</span> <span m="3795130">code,</span> <span m="3795880">will</span> <span m="3796240">point</span> <span m="3796610">to</span> <span m="3797260">the</span> <span m="3797410">base,</span> <span m="3798350">right.</span> <span m="3798700">And</span> <span m="3798800">then</span> <span m="3798900">every</span> <span m="3799130">time</span> <span m="3799520">we</span> <span m="3800120">iterate</span> <span m="3800545">through</span> <span m="3800970">here,</span> <span m="3801930">we</span> <span m="3802065">can</span> <span m="3802200">see</span> <span m="3802480">that</span> <span m="3802570">we're</span> <span m="3802660">either</span> <span m="3803130">checking</span> <span m="3803350">a</span> <span m="3803828">bound,</span> <span m="3804067">or</span> <span m="3804306">incrementing</span> <span m="3804784">a</span> <span m="3805023">bound.</span> </p>
<p><span m="3806700">So</span> <span m="3807270">at</span> <span m="3807480">this</span> <span m="3807670">point</span> <span m="3808015">we</span> <span m="3808130">want</span> <span m="3808245">to</span> <span m="3808302">dereference</span> <span m="3808760">it.</span> <span m="3809100">We</span> <span m="3809215">can</span> <span m="3809330">actually</span> <span m="3809680">check</span> <span m="3810320">and</span> <span m="3810480">see,</span> <span m="3811510">is</span> <span m="3811660">the</span> <span m="3811760">current</span> <span m="3812160">address</span> <span m="3812425">at</span> <span m="3812690">that</span> <span m="3813010">pointer,</span> <span m="3813980">in</span> <span m="3814145">this</span> <span m="3814310">ring.</span> <span m="3815094">And</span> <span m="3815245">if</span> <span m="3815396">it's</span> <span m="3815548">not</span> <span m="3816002">you</span> <span m="3816092">throw</span> <span m="3816183">in</span> <span m="3816274">an</span> <span m="3816365">exception</span> <span m="3816456">here</span> <span m="3816569">and</span> <span m="3816683">so</span> <span m="3816796">on</span> <span m="3816824">and</span> <span m="3816853">so</span> <span m="3816881">forth.</span> <span m="3819180">So</span> <span m="3820250">once</span> <span m="3820290">again,</span> <span m="3820620">where</span> <span m="3820920">is</span> <span m="3821055">this</span> <span m="3821190">taking</span> <span m="3821490">place?</span> <span m="3821765">This</span> <span m="3822040">Is</span> <span m="3822230">taking</span> <span m="3822560">place</span> <span m="3822845">in</span> <span m="3823130">new</span> <span m="3823260">code</span> <span m="3823613">that</span> <span m="3823966">the</span> <span m="3824320">compiler</span> <span m="3824495">generated.</span> </p>
<p><span m="3825230">So</span> <span m="3825565">one</span> <span m="3825900">question</span> <span m="3826280">that</span> <span m="3826416">came</span> <span m="3826553">up</span> <span m="3827510">on</span> <span m="3827715">the</span> <span m="3827920">online</span> <span m="3828240">discussion</span> <span m="3828525">group,</span> <span m="3828810">some</span> <span m="3828925">people</span> <span m="3829040">were</span> <span m="3829140">saying,</span> <span m="3829240">well</span> <span m="3829360">what</span> <span m="3829435">if</span> <span m="3829510">it's</span> <span m="3829740">instrumented</span> <span m="3829970">code,</span> <span m="3830630">what</span> <span m="3831040">does</span> <span m="3831140">that</span> <span m="3831390">mean,</span> <span m="3831870">right?</span> <span m="3832100">So</span> <span m="3832180">when</span> <span m="3832320">I</span> <span m="3832460">say</span> <span m="3832590">that</span> <span m="3832716">the--</span> <span m="3832970">that</span> <span m="3833433">the</span> <span m="3833664">compiler</span> <span m="3833896">generates</span> <span m="3834359">new</span> <span m="3834590">code,</span> <span m="3834822">imagine</span> <span m="3835285">that</span> <span m="3835748">there--</span> <span m="3836211">this</span> <span m="3836326">is</span> <span m="3836442">what</span> <span m="3836558">you</span> <span m="3836674">see</span> <span m="3837137">as</span> <span m="3837291">a</span> <span m="3837445">programmer.</span> <span m="3838530">But</span> <span m="3839650">before</span> <span m="3840020">this</span> <span m="3840450">operation</span> <span m="3840775">actually</span> <span m="3841100">takes</span> <span m="3841350">place,</span> <span m="3842010">imagine</span> <span m="3842470">the</span> <span m="3842647">compiler</span> <span m="3842825">inserted</span> <span m="3843820">some</span> <span m="3844170">new</span> <span m="3844410">C</span> <span m="3844565">code</span> <span m="3844950">here</span> <span m="3845250">that</span> <span m="3845550">basically</span> <span m="3846350">looks</span> <span m="3846515">at</span> <span m="3846680">these</span> <span m="3846845">base</span> <span m="3847092">bounds</span> <span m="3847340">here.</span> <span m="3847835">And</span> <span m="3848330">then</span> <span m="3848495">if</span> <span m="3848660">there</span> <span m="3848825">was</span> <span m="3849072">something</span> <span m="3849320">out</span> <span m="3849485">of</span> <span m="3849650">bounds</span> <span m="3849815">it</span> <span m="3849980">would</span> <span m="3850145">then</span> <span m="3850310">do</span> <span m="3850475">an</span> <span m="3850640">exit,</span> <span m="3850805">or</span> <span m="3850970">an</span> <span m="3851135">abort,</span> <span m="3851300">or</span> <span m="3851465">something</span> <span m="3851630">like</span> <span m="3851795">that.</span> <span m="3852785">So</span> <span m="3853280">that's</span> <span m="3853580">what</span> <span m="3853733">it</span> <span m="3853886">means</span> <span m="3853916">to</span> <span m="3853947">say</span> <span m="3853978">that</span> <span m="3854009">there</span> <span m="3854040">is</span> <span m="3854520">instrumented</span> <span m="3855000">code.</span> <span m="3855440">It's</span> <span m="3855596">that</span> <span m="3855753">you</span> <span m="3855910">take</span> <span m="3856240">the</span> <span m="3856290">source</span> <span m="3856650">code,</span> <span m="3856980">use</span> <span m="3857045">the</span> <span m="3857110">program</span> <span m="3857535">of</span> <span m="3857747">C,</span> <span m="3857960">add</span> <span m="3858240">some</span> <span m="3858387">new</span> <span m="3858535">C</span> <span m="3858830">source</span> <span m="3859140">code</span> <span m="3859520">and</span> <span m="3859746">then</span> <span m="3859972">compile</span> <span m="3860424">that</span> <span m="3860574">video</span> <span m="3860725">program.</span> <span m="3862690">So</span> <span m="3862930">the</span> <span m="3863230">basic</span> <span m="3863570">idea</span> <span m="3863726">I</span> <span m="3863883">think</span> <span m="3864040">behind</span> <span m="3864440">the</span> <span m="3864590">fat</span> <span m="3864665">pointer</span> <span m="3864823">is</span> <span m="3864990">pretty</span> <span m="3865340">simple.</span> </p>
<p><span m="3866860">There's</span> <span m="3867040">some</span> <span m="3867330">disadvantages</span> <span m="3867790">to</span> <span m="3868250">this.</span> <span m="3869520">The</span> <span m="3869690">biggest</span> <span m="3869950">disadvantage</span> <span m="3871190">is</span> <span m="3871400">that,</span> <span m="3872370">oh</span> <span m="3872465">my</span> <span m="3872560">goodness</span> <span m="3872860">look</span> <span m="3872980">how</span> <span m="3873100">big</span> <span m="3873220">the</span> <span m="3873340">pointers</span> <span m="3873440">are</span> <span m="3873540">now,</span> <span m="3874430">right.</span> <span m="3874870">And</span> <span m="3875035">so</span> <span m="3875200">what</span> <span m="3875295">this</span> <span m="3875342">means</span> <span m="3875390">is</span> <span m="3875730">that</span> <span m="3875950">you</span> <span m="3876080">can't</span> <span m="3877100">just</span> <span m="3877370">take</span> <span m="3877700">a</span> <span m="3877930">fat</span> <span m="3878150">pointer</span> <span m="3878540">and</span> <span m="3878850">pass</span> <span m="3879005">it</span> <span m="3879160">to</span> <span m="3879650">an</span> <span m="3879895">unmodified,</span> <span m="3880140">off</span> <span m="3880540">the</span> <span m="3880610">shell</span> <span m="3880920">library.</span> <span m="3882140">Because</span> <span m="3882280">it</span> <span m="3882410">may</span> <span m="3882660">have</span> <span m="3882880">certain</span> <span m="3883150">expectations</span> <span m="3883515">that</span> <span m="3883880">pointers</span> <span m="3884180">are</span> <span m="3884268">a</span> <span m="3884356">certain</span> <span m="3884710">size</span> <span m="3885170">and</span> <span m="3885420">we</span> <span m="3885650">give</span> <span m="3885840">you</span> <span m="3885966">this</span> <span m="3886093">thing,</span> <span m="3886220">it's</span> <span m="3886405">just</span> <span m="3886590">going</span> <span m="3886720">to--</span> <span m="3886850">it's</span> <span m="3886945">going</span> <span m="3887040">to</span> <span m="3887135">blow</span> <span m="3887230">up.</span> <span m="3888830">We</span> <span m="3888910">also</span> <span m="3889220">have</span> <span m="3889360">trouble</span> <span m="3889860">if</span> <span m="3889920">you</span> <span m="3889980">want</span> <span m="3890300">to</span> <span m="3890370">include</span> <span m="3890465">these</span> <span m="3890560">types</span> <span m="3890820">of</span> <span m="3890920">pointers</span> <span m="3891250">and</span> <span m="3891390">structs,</span> <span m="3891530">or</span> <span m="3891810">things</span> <span m="3892070">like</span> <span m="3892270">that.</span> <span m="3892590">Because</span> <span m="3892910">that</span> <span m="3893080">can</span> <span m="3893200">actually</span> <span m="3893530">change</span> <span m="3894020">the</span> <span m="3894120">size</span> <span m="3894620">of</span> <span m="3894660">the</span> <span m="3894700">struct,</span> <span m="3895870">right.</span> </p>
<p><span m="3896180">So</span> <span m="3896210">a</span> <span m="3896240">very</span> <span m="3896610">popular</span> <span m="3897060">thing</span> <span m="3897530">in</span> <span m="3897626">C</span> <span m="3897723">code</span> <span m="3897820">to</span> <span m="3897965">do</span> <span m="3898110">is</span> <span m="3898380">to</span> <span m="3898446">take</span> <span m="3898513">like</span> <span m="3898580">the</span> <span m="3898747">size</span> <span m="3898915">of</span> <span m="3899250">the</span> <span m="3899440">struct</span> <span m="3900270">and</span> <span m="3900696">then</span> <span m="3900909">like</span> <span m="3901122">do</span> <span m="3901335">something</span> <span m="3901548">as</span> <span m="3901633">a</span> <span m="3901718">result</span> <span m="3901803">of</span> <span m="3901888">that.</span> <span m="3901974">Like</span> <span m="3902400">reserve</span> <span m="3902650">some</span> <span m="3903020">disc</span> <span m="3903140">space</span> <span m="3903660">for</span> <span m="3904060">a</span> <span m="3904190">struct</span> <span m="3904320">of</span> <span m="3904450">that</span> <span m="3904650">size,</span> <span m="3905010">and</span> <span m="3905026">so</span> <span m="3905043">on</span> <span m="3905060">and</span> <span m="3905076">so</span> <span m="3905093">forth.</span> <span m="3905515">So</span> <span m="3905920">this</span> <span m="3906150">causes</span> <span m="3906420">all</span> <span m="3906570">that</span> <span m="3906720">stuff</span> <span m="3906990">to</span> <span m="3907170">blow</span> <span m="3907350">up,</span> <span m="3907593">right.</span> <span m="3907837">Because</span> <span m="3907999">once</span> <span m="3908161">again,</span> <span m="3908324">the</span> <span m="3908567">pointers</span> <span m="3908811">have</span> <span m="3909054">gotten</span> <span m="3909298">very,</span> <span m="3909541">very</span> <span m="3909785">big.</span> </p>
<p><span m="3911740">And</span> <span m="3911890">another</span> <span m="3912200">thing</span> <span m="3912470">which</span> <span m="3912530">is</span> <span m="3912590">a</span> <span m="3912790">bit</span> <span m="3912990">subtle,</span> <span m="3913780">but</span> <span m="3914240">it's</span> <span m="3914470">that</span> <span m="3915770">these</span> <span m="3916270">fat</span> <span m="3916520">pointers</span> <span m="3917420">typically</span> <span m="3917810">will</span> <span m="3917990">not</span> <span m="3918380">be</span> <span m="3918535">able</span> <span m="3918690">to</span> <span m="3918845">be</span> <span m="3919000">updated</span> <span m="3919360">in</span> <span m="3919540">an</span> <span m="3919720">atomic</span> <span m="3920120">fashion,</span> <span m="3921210">right.</span> <span m="3921500">So</span> <span m="3922140">on</span> <span m="3922940">32-bit</span> <span m="3923070">architectures</span> <span m="3923610">typically,</span> <span m="3924630">if</span> <span m="3924840">you</span> <span m="3925050">do</span> <span m="3925240">like</span> <span m="3925400">a</span> <span m="3925598">write</span> <span m="3925796">to</span> <span m="3925928">a</span> <span m="3926060">32-bit</span> <span m="3926590">variable,</span> <span m="3927310">that</span> <span m="3927520">write</span> <span m="3927870">is</span> <span m="3928045">atomic,</span> <span m="3928700">right.</span> <span m="3929180">But</span> <span m="3929370">now,</span> <span m="3929980">these</span> <span m="3930190">pointers</span> <span m="3930970">are</span> <span m="3931230">these</span> <span m="3931650">three</span> <span m="3932380">integer</span> <span m="3932810">sized</span> <span m="3933270">things,</span> <span m="3934150">right.</span> <span m="3934590">So</span> <span m="3934620">if</span> <span m="3934650">you</span> <span m="3934680">have</span> <span m="3934895">any</span> <span m="3935110">code</span> <span m="3935470">that</span> <span m="3935600">takes</span> <span m="3936170">advantage</span> <span m="3936670">of</span> <span m="3936890">the</span> <span m="3937080">fact</span> <span m="3937270">that</span> <span m="3937340">it</span> <span m="3937510">expects</span> <span m="3937820">pointer</span> <span m="3938080">writes</span> <span m="3938540">to</span> <span m="3938905">be</span> <span m="3939270">atomic,</span> <span m="3939780">then</span> <span m="3940160">you</span> <span m="3940205">may</span> <span m="3940250">get</span> <span m="3940450">in</span> <span m="3940520">trouble,</span> <span m="3941540">right.</span> <span m="3941830">Because</span> <span m="3941990">you</span> <span m="3942070">can</span> <span m="3942170">imagine</span> <span m="3942680">that</span> <span m="3943970">to</span> <span m="3944110">do</span> <span m="3944330">some</span> <span m="3944520">of</span> <span m="3944570">these</span> <span m="3944830">checks,</span> <span m="3945460">you</span> <span m="3945590">have</span> <span m="3945790">to</span> <span m="3946766">look</span> <span m="3946887">at</span> <span m="3947009">the</span> <span m="3947130">current</span> <span m="3947252">address</span> <span m="3947738">and</span> <span m="3947981">then</span> <span m="3948224">look</span> <span m="3948386">at</span> <span m="3948548">this</span> <span m="3948710">and</span> <span m="3949200">then</span> <span m="3949350">you</span> <span m="3949437">might</span> <span m="3949525">have</span> <span m="3949612">to</span> <span m="3949700">increment</span> <span m="3949960">that,</span> <span m="3950330">and</span> <span m="3950412">so</span> <span m="3950495">on</span> <span m="3950577">and</span> <span m="3950660">so</span> <span m="3950890">forth.</span> </p>
<p><span m="3951570">So</span> <span m="3951640">this</span> <span m="3951710">can</span> <span m="3951780">cause</span> <span m="3951850">very</span> <span m="3952250">subtle</span> <span m="3953040">concurrency</span> <span m="3953200">bugs</span> <span m="3953520">if</span> <span m="3953560">you</span> <span m="3953600">have</span> <span m="3953640">code</span> <span m="3953775">that</span> <span m="3953910">depends</span> <span m="3954180">on</span> <span m="3954430">that</span> <span m="3954680">atomacy</span> <span m="3955180">of</span> <span m="3955430">fail</span> <span m="3955680">[INAUDIBLE].</span> <span m="3958180">So</span> <span m="3958270">does</span> <span m="3958360">that</span> <span m="3958495">all</span> <span m="3958630">make</span> <span m="3958850">sense?</span> <span m="3959770">So</span> <span m="3960220">that's</span> <span m="3960420">one</span> <span m="3960512">approach</span> <span m="3960604">you</span> <span m="3960696">can</span> <span m="3960880">do.</span> <span m="3961340">But</span> <span m="3962400">kind</span> <span m="3962620">of</span> <span m="3962840">like</span> <span m="3964160">electric</span> <span m="3964600">fences,</span> <span m="3965050">this</span> <span m="3965506">has</span> <span m="3965734">some</span> <span m="3966420">nasty</span> <span m="3966930">side</span> <span m="3967220">effects</span> <span m="3968030">that</span> <span m="3968125">means</span> <span m="3968220">the</span> <span m="3968450">people</span> <span m="3968700">don't</span> <span m="3969190">typically</span> <span m="3969760">use</span> <span m="3970150">that</span> <span m="3970520">in</span> <span m="3970750">practice.</span> </p>
<p><span m="3974660">So</span> <span m="3975530">now</span> <span m="3975960">we</span> <span m="3976140">can</span> <span m="3976320">start</span> <span m="3976420">talking</span> <span m="3977020">about</span> <span m="3977890">bounds</span> <span m="3978360">checking,</span> <span m="3979470">with</span> <span m="3979700">respect</span> <span m="3980200">to</span> <span m="3980370">the</span> <span m="3980600">shadow</span> <span m="3980770">of</span> <span m="3981235">the</span> <span m="3981700">infrastructure</span> <span m="3982165">that</span> <span m="3982320">I</span> <span m="3982475">mentioned</span> <span m="3982630">in</span> <span m="3982785">the</span> <span m="3982940">baggy</span> <span m="3983095">bounds</span> <span m="3983327">paper.</span> <span m="3985890">So</span> <span m="3986200">the</span> <span m="3986240">basic</span> <span m="3986640">idea</span> <span m="3989380">for</span> <span m="3989624">the</span> <span m="3989868">shadow</span> <span m="3991332">base</span> <span m="3991820">structure</span> <span m="3997200">is</span> <span m="3998190">for</span> <span m="3998330">each</span> <span m="3998690">object</span> <span m="4000230">that</span> <span m="4000460">you</span> <span m="4000675">allocate,</span> <span m="4003670">you</span> <span m="4003800">want</span> <span m="4004050">to</span> <span m="4005140">store</span> <span m="4005730">how</span> <span m="4006220">big</span> <span m="4006305">the</span> <span m="4006390">object</span> <span m="4006610">is.</span> <span m="4013650">Right,</span> <span m="4013950">so</span> <span m="4014080">for</span> <span m="4014250">example,</span> <span m="4014860">if</span> <span m="4015020">you</span> <span m="4015150">have</span> <span m="4015580">some</span> <span m="4016048">pointer</span> <span m="4018860">that</span> <span m="4019160">you</span> <span m="4019610">call</span> <span m="4019890">malloc</span> <span m="4020265">on</span> <span m="4023568">right,</span> <span m="4023665">you</span> <span m="4023763">need</span> <span m="4023860">to</span> <span m="4023958">store</span> <span m="4024056">that</span> <span m="4024544">size</span> <span m="4025520">of</span> <span m="4026008">that</span> <span m="4026252">object</span> <span m="4026496">there,</span> <span m="4027472">and</span> <span m="4027634">then</span> <span m="4027797">note</span> <span m="4027960">that</span> <span m="4028205">if</span> <span m="4028450">you</span> <span m="4028590">have</span> <span m="4028740">some</span> <span m="4028890">thing</span> <span m="4029175">that's</span> <span m="4029460">like</span> <span m="4029670">a</span> <span m="4029820">static</span> <span m="4030310">variable</span> <span m="4033350">like</span> <span m="4033844">this,</span> <span m="4035820">right,</span> <span m="4035984">the</span> <span m="4036149">compiler</span> <span m="4036314">can</span> <span m="4037302">automatically</span> <span m="4037549">figure</span> <span m="4037796">out</span> <span m="4038290">what</span> <span m="4038454">the</span> <span m="4038619">bounds</span> <span m="4038784">are</span> <span m="4038948">for</span> <span m="4039113">that</span> <span m="4039278">thing</span> <span m="4039525">there,</span> <span m="4040266">statically</span> <span m="4040760">speaking.</span> </p>
<p><span m="4041840">So</span> <span m="4042105">for</span> <span m="4042193">each</span> <span m="4042281">one</span> <span m="4042370">of</span> <span m="4042740">these</span> <span m="4043110">pointers</span> <span m="4043635">you</span> <span m="4043900">need</span> <span m="4044280">to</span> <span m="4045270">interpose</span> <span m="4048270">somehow</span> <span m="4048950">on</span> <span m="4050760">two</span> <span m="4050990">operations.</span> <span m="4054600">Basically</span> <span m="4055200">you</span> <span m="4055490">do</span> <span m="4056200">arithmetic.</span> <span m="4061290">So</span> <span m="4061530">this</span> <span m="4061740">is</span> <span m="4061900">things</span> <span m="4062270">like</span> <span m="4063150">q</span> <span m="4063430">equals</span> <span m="4065890">p</span> <span m="4066240">plus</span> <span m="4066540">7,</span> <span m="4067024">or</span> <span m="4067266">whatever.</span> <span m="4069930">And</span> <span m="4070090">then</span> <span m="4070350">you</span> <span m="4070555">want</span> <span m="4070760">to</span> <span m="4072052">interpose</span> <span m="4073170">on</span> <span m="4073646">dereferencing.</span> <span m="4075550">So</span> <span m="4075669">this</span> <span m="4075788">is</span> <span m="4075907">something</span> <span m="4076026">like</span> <span m="4079370">q</span> <span m="4079770">equals</span> <span m="4082490">a</span> <span m="4082613">or</span> <span m="4082736">something</span> <span m="4082860">like</span> <span m="4083230">that.</span> </p>
<p><span m="4086200">So</span> <span m="4087700">what's</span> <span m="4087880">interesting</span> <span m="4088390">is</span> <span m="4088530">that</span> <span m="4089090">you</span> <span m="4089170">might</span> <span m="4089440">think,</span> <span m="4089730">well</span> <span m="4090390">why</span> <span m="4090600">can't</span> <span m="4091220">we</span> <span m="4091680">just</span> <span m="4091960">rely</span> <span m="4092600">on</span> <span m="4092905">the</span> <span m="4093210">reference</span> <span m="4093690">when</span> <span m="4094170">interposing</span> <span m="4094650">stuff?</span> <span m="4096090">Why</span> <span m="4096282">do</span> <span m="4096474">we</span> <span m="4096551">have</span> <span m="4096628">to</span> <span m="4096705">look</span> <span m="4096782">at</span> <span m="4096859">this</span> <span m="4098500">point</span> <span m="4098800">arithmetic</span> <span m="4099390">here?</span> <span m="4100205">But</span> <span m="4100670">similarly</span> <span m="4100840">you</span> <span m="4100960">might</span> <span m="4101200">wonder</span> <span m="4101340">the</span> <span m="4101487">other</span> <span m="4101635">thing.</span> <span m="4102170">Like</span> <span m="4102256">why</span> <span m="4102343">can't</span> <span m="4102430">you</span> <span m="4102640">just</span> <span m="4102699">deal</span> <span m="4102759">with</span> <span m="4102819">one</span> <span m="4102979">of</span> <span m="4103197">these</span> <span m="4103416">non</span> <span m="4103853">[INAUDIBLE]</span> <span m="4104290">interpose</span> <span m="4104727">[INAUDIBLE]?</span> <span m="4106040">So</span> <span m="4107000">you</span> <span m="4107220">can't</span> <span m="4107560">just</span> <span m="4108710">signal</span> <span m="4109025">an</span> <span m="4109340">error</span> <span m="4109684">if</span> <span m="4110029">you</span> <span m="4110109">see</span> <span m="4110439">the</span> <span m="4110520">arithmetic</span> <span m="4110960">going</span> <span m="4111260">out</span> <span m="4111560">of</span> <span m="4111960">bounds</span> <span m="4112672">because</span> <span m="4113029">in</span> <span m="4113630">c</span> <span m="4114120">that</span> <span m="4114420">may</span> <span m="4114539">or</span> <span m="4114659">may</span> <span m="4114779">not</span> <span m="4114999">be</span> <span m="4115220">there.</span> <span m="4117040">So</span> <span m="4117149">in</span> <span m="4117259">other</span> <span m="4117369">words,</span> <span m="4117479">a</span> <span m="4117694">very</span> <span m="4117910">common</span> <span m="4118270">medium</span> <span m="4118430">is</span> <span m="4118565">C</span> <span m="4118632">and</span> <span m="4118700">C++</span> <span m="4120130">is</span> <span m="4120540">you</span> <span m="4120939">might</span> <span m="4121270">have</span> <span m="4121410">a</span> <span m="4121550">pointer</span> <span m="4122200">that</span> <span m="4122470">points</span> <span m="4122729">to</span> <span m="4122840">one</span> <span m="4123359">pass</span> <span m="4123990">the</span> <span m="4124080">valid</span> <span m="4124620">end</span> <span m="4124695">of</span> <span m="4124770">an</span> <span m="4124860">object</span> <span m="4126120">right,</span> <span m="4126439">and</span> <span m="4126539">then</span> <span m="4126639">you</span> <span m="4126740">use</span> <span m="4126803">that</span> <span m="4126866">as</span> <span m="4126930">a</span> <span m="4127069">stop</span> <span m="4127399">condition,</span> <span m="4127569">right.</span> <span m="4127740">So</span> <span m="4127886">you</span> <span m="4128033">iterate</span> <span m="4128180">to</span> <span m="4128640">the</span> <span m="4128760">object</span> <span m="4129055">and</span> <span m="4129350">once</span> <span m="4129689">you</span> <span m="4129910">hit</span> <span m="4130080">that</span> <span m="4130300">end</span> <span m="4130772">pointer,</span> <span m="4131086">that's</span> <span m="4131244">when</span> <span m="4131480">you</span> <span m="4131716">actually</span> <span m="4132188">stop</span> <span m="4132424">the</span> <span m="4132660">loop</span> <span m="4132896">or</span> <span m="4133132">whatever.</span> </p>
<p><span m="4134076">So</span> <span m="4134194">if</span> <span m="4134312">we</span> <span m="4134430">just</span> <span m="4134548">interpose</span> <span m="4134784">on</span> <span m="4135964">arithmetic</span> <span m="4136908">and</span> <span m="4137390">we</span> <span m="4137569">always</span> <span m="4137939">cause</span> <span m="4138194">a</span> <span m="4138450">hard</span> <span m="4138620">fault,</span> <span m="4138890">when</span> <span m="4139160">we</span> <span m="4139439">see</span> <span m="4139710">a</span> <span m="4139833">pointer</span> <span m="4139956">go</span> <span m="4140080">out</span> <span m="4140165">of</span> <span m="4140250">bounds,</span> <span m="4140990">that</span> <span m="4141189">may</span> <span m="4141290">actually</span> <span m="4141640">break</span> <span m="4141990">a</span> <span m="4142040">lot</span> <span m="4142319">of</span> <span m="4142420">legitimate</span> <span m="4142550">applications,</span> <span m="4143673">right.</span> <span m="4144060">So</span> <span m="4144216">we</span> <span m="4144372">can't</span> <span m="4144529">just</span> <span m="4144710">interpose</span> <span m="4144985">on</span> <span m="4145122">that.</span> <span m="4146520">And</span> <span m="4146720">so</span> <span m="4147310">you</span> <span m="4147620">might</span> <span m="4147870">say,</span> <span m="4147960">well</span> <span m="4148109">why</span> <span m="4148390">can't</span> <span m="4148720">you</span> <span m="4148845">just</span> <span m="4148970">interpose</span> <span m="4149466">on</span> <span m="4149631">the</span> <span m="4149796">reference</span> <span m="4149962">thing,</span> <span m="4150458">and</span> <span m="4150706">you</span> <span m="4150954">just--</span> <span m="4151450">when</span> <span m="4151946">we</span> <span m="4152194">notice</span> <span m="4152442">that</span> <span m="4152690">you've</span> <span m="4153434">cut</span> <span m="4153558">something</span> <span m="4153682">out</span> <span m="4153806">of</span> <span m="4153930">bounds,</span> <span m="4154430">we'll</span> <span m="4154770">just</span> <span m="4155060">read</span> <span m="4155200">there</span> <span m="4155340">and</span> <span m="4155840">there.</span> <span m="4156319">Well</span> <span m="4156460">the</span> <span m="4156540">challenge</span> <span m="4156950">there</span> <span m="4157065">is</span> <span m="4157180">that</span> <span m="4157390">how</span> <span m="4157430">do</span> <span m="4157470">you</span> <span m="4157510">know</span> <span m="4157779">it's</span> <span m="4157839">out</span> <span m="4157899">of</span> <span m="4157960">bounds?</span> <span m="4158310">Right,</span> <span m="4159069">it's</span> <span m="4159204">the--</span> <span m="4159609">it's</span> <span m="4159747">the</span> <span m="4159886">arithmetic</span> <span m="4160025">in</span> <span m="4160441">our</span> <span m="4160859">positioning</span> <span m="4161279">that</span> <span m="4161760">officially</span> <span m="4162120">allows</span> <span m="4162540">us</span> <span m="4162630">to</span> <span m="4162760">tell</span> <span m="4163410">whether</span> <span m="4163620">or</span> <span m="4163750">not</span> <span m="4164140">this</span> <span m="4164380">thing's</span> <span m="4164649">going</span> <span m="4164774">to</span> <span m="4164899">be</span> <span m="4165024">legal</span> <span m="4165399">here,</span> <span m="4165639">right.</span> <span m="4165880">Because</span> <span m="4166210">it's</span> <span m="4166710">the</span> <span m="4166840">interpositioning</span> <span m="4167340">on</span> <span m="4167470">the</span> <span m="4167600">arithmetic</span> <span m="4168290">that</span> <span m="4168399">allows</span> <span m="4168830">us</span> <span m="4169029">to</span> <span m="4169279">track</span> <span m="4169960">where</span> <span m="4170170">the</span> <span m="4170330">pointer</span> <span m="4170685">is</span> <span m="4171040">with</span> <span m="4171300">respect</span> <span m="4171517">to</span> <span m="4171735">it's</span> <span m="4171952">original</span> <span m="4172170">baseline.</span> <span m="4174120">So</span> <span m="4174229">that's</span> <span m="4174859">the</span> <span m="4174920">basic</span> <span m="4175220">idea</span> <span m="4175680">there.</span> </p>
<p><span m="4181740">And</span> <span m="4181850">so</span> <span m="4183755">the</span> <span m="4183957">next</span> <span m="4184160">question</span> <span m="4184569">is</span> <span m="4184770">how</span> <span m="4184933">do</span> <span m="4185096">we</span> <span m="4185260">actually</span> <span m="4185750">implement</span> <span m="4185913">the</span> <span m="4186076">bounds</span> <span m="4186240">checking?</span> <span m="4189550">Because</span> <span m="4189800">basically</span> <span m="4190689">we</span> <span m="4190830">need</span> <span m="4191529">some</span> <span m="4191880">way</span> <span m="4193330">to</span> <span m="4193550">map</span> <span m="4193885">a</span> <span m="4194220">particular</span> <span m="4195210">pointer</span> <span m="4195720">address</span> <span m="4196460">to</span> <span m="4197610">some</span> <span m="4197756">type</span> <span m="4197903">of</span> <span m="4198050">bounds</span> <span m="4198305">information</span> <span m="4198560">for</span> <span m="4198768">that</span> <span m="4198976">pointer.</span> <span m="4200640">And</span> <span m="4200860">so</span> <span m="4201080">a</span> <span m="4201140">lot</span> <span m="4201430">of</span> <span m="4201550">your</span> <span m="4201705">previous</span> <span m="4201860">solutions</span> <span m="4202420">use</span> <span m="4202730">things</span> <span m="4203020">like,</span> <span m="4203310">for</span> <span m="4203350">example,</span> <span m="4203860">like</span> <span m="4203920">a</span> <span m="4203980">hash</span> <span m="4204450">table,</span> <span m="4205180">or</span> <span m="4205325">a</span> <span m="4205470">tree,</span> <span m="4206240">right</span> <span m="4206430">that</span> <span m="4206460">will</span> <span m="4206490">allow</span> <span m="4206520">you</span> <span m="4206550">to</span> <span m="4207010">do</span> <span m="4207070">lookups</span> <span m="4207130">right,</span> <span m="4207190">and</span> <span m="4207670">stay</span> <span m="4208120">the</span> <span m="4208220">gray.</span> <span m="4208620">So</span> <span m="4209020">given</span> <span m="4210155">a</span> <span m="4210372">pointer</span> <span m="4210590">address,</span> <span m="4211460">I</span> <span m="4211610">do</span> <span m="4211760">some</span> <span m="4211910">lookup</span> <span m="4212135">in</span> <span m="4212210">this</span> <span m="4212285">data</span> <span m="4212360">structure,</span> <span m="4212810">figure</span> <span m="4212973">out</span> <span m="4213136">what</span> <span m="4213300">the</span> <span m="4213390">bounds</span> <span m="4213790">are.</span> <span m="4214190">Given</span> <span m="4214333">those</span> <span m="4214476">bounds</span> <span m="4214620">I</span> <span m="4214980">can</span> <span m="4215140">then</span> <span m="4215450">figure</span> <span m="4215710">out</span> <span m="4216050">if</span> <span m="4216113">I</span> <span m="4216176">want</span> <span m="4216239">to</span> <span m="4216302">allow</span> <span m="4216365">the</span> <span m="4217010">action</span> <span m="4217340">to</span> <span m="4217840">take</span> <span m="4217955">place</span> <span m="4218070">or</span> <span m="4218200">not.</span> </p>
<p><span m="4218790">Now</span> <span m="4219310">the</span> <span m="4219480">problem</span> <span m="4219980">with</span> <span m="4220080">that</span> <span m="4220600">is</span> <span m="4220930">that</span> <span m="4221370">it's</span> <span m="4221730">a</span> <span m="4221830">slow</span> <span m="4222200">lookup,</span> <span m="4222947">right</span> <span m="4223135">because</span> <span m="4223229">these</span> <span m="4223324">data</span> <span m="4223512">structures</span> <span m="4223701">you're</span> <span m="4223890">thinking</span> <span m="4224080">it's</span> <span m="4224250">a</span> <span m="4224700">tree,</span> <span m="4224985">or</span> <span m="4225270">you're</span> <span m="4225580">going</span> <span m="4225840">through</span> <span m="4225950">a</span> <span m="4226000">bunch</span> <span m="4226240">of</span> <span m="4226390">branches</span> <span m="4226733">before</span> <span m="4226847">you</span> <span m="4226961">can</span> <span m="4227076">actually</span> <span m="4227420">hit</span> <span m="4227765">the</span> <span m="4228110">value</span> <span m="4228420">potentially.</span> <span m="4229440">And</span> <span m="4229606">even</span> <span m="4229773">if</span> <span m="4229940">it's</span> <span m="4230030">a</span> <span m="4230120">hash</span> <span m="4230300">table</span> <span m="4230750">where</span> <span m="4230975">there's</span> <span m="4231200">an</span> <span m="4231650">overflow</span> <span m="4231762">in</span> <span m="4231875">the</span> <span m="4231987">bucket</span> <span m="4232640">you</span> <span m="4232740">got</span> <span m="4232910">to</span> <span m="4233420">follow</span> <span m="4233650">chains,</span> <span m="4233880">or</span> <span m="4234095">do</span> <span m="4234310">you're</span> <span m="4234525">code,</span> <span m="4234740">or</span> <span m="4234906">things</span> <span m="4235073">like</span> <span m="4235240">that.</span> <span m="4236740">So</span> <span m="4237690">the</span> <span m="4238010">baggy</span> <span m="4238167">bounds</span> <span m="4238640">paper</span> <span m="4239590">that</span> <span m="4239780">we</span> <span m="4240160">are</span> <span m="4240530">about</span> <span m="4240750">to</span> <span m="4240970">look</span> <span m="4241240">at</span> <span m="4241760">actually</span> <span m="4242260">figured</span> <span m="4242460">out</span> <span m="4242585">a</span> <span m="4242710">very</span> <span m="4242920">efficient</span> <span m="4243710">data</span> <span m="4244030">structure</span> <span m="4244700">that</span> <span m="4244810">tracked</span> <span m="4245125">to</span> <span m="4245282">these</span> <span m="4245440">bounds,</span> <span m="4245800">to</span> <span m="4246040">make</span> <span m="4246260">that</span> <span m="4246345">bound</span> <span m="4246430">checking</span> <span m="4246900">very</span> <span m="4247130">fat.</span> <span m="4249480">So</span> <span m="4249530">let's</span> <span m="4249750">just</span> <span m="4249970">step</span> <span m="4250225">into</span> <span m="4250480">that</span> <span m="4250640">right</span> <span m="4250780">now.</span> </p>
<p><span m="4251170">But</span> <span m="4251260">before</span> <span m="4251350">we</span> <span m="4251440">go</span> <span m="4251640">into</span> <span m="4251710">that</span> <span m="4252150">let</span> <span m="4252215">me</span> <span m="4252280">very</span> <span m="4252620">briefly</span> <span m="4253340">talk</span> <span m="4253570">about</span> <span m="4253900">how</span> <span m="4254630">buddy</span> <span m="4254730">allocation</span> <span m="4255240">works.</span> <span m="4255880">Because</span> <span m="4256030">that's</span> <span m="4256240">one</span> <span m="4256293">of</span> <span m="4256346">the</span> <span m="4256400">things</span> <span m="4256680">that</span> <span m="4256770">came</span> <span m="4256850">up</span> <span m="4256985">in</span> <span m="4257052">a</span> <span m="4257120">lot</span> <span m="4257420">of</span> <span m="4257485">the</span> <span m="4257550">questions.</span> <span m="4258480">So</span> <span m="4258670">one</span> <span m="4258783">thing</span> <span m="4258820">you</span> <span m="4258858">will</span> <span m="4258896">see</span> <span m="4259280">for</span> <span m="4259490">these</span> <span m="4259770">papers</span> <span m="4260060">is</span> <span m="4260350">that</span> <span m="4260520">a</span> <span m="4260570">lot</span> <span m="4260830">of</span> <span m="4260960">times</span> <span m="4261090">they</span> <span m="4261247">are</span> <span m="4261405">not</span> <span m="4261720">self-contained,</span> <span m="4262155">right.</span> <span m="4262590">So</span> <span m="4262660">they</span> <span m="4262730">will</span> <span m="4263120">mention</span> <span m="4263490">things</span> <span m="4263850">that</span> <span m="4264100">they</span> <span m="4264310">will</span> <span m="4264490">assume</span> <span m="4264705">that</span> <span m="4264920">you</span> <span m="4265085">know,</span> <span m="4265580">but</span> <span m="4266010">you</span> <span m="4266115">may</span> <span m="4266220">not</span> <span m="4266450">know</span> <span m="4266577">them.</span> <span m="4267310">Don't</span> <span m="4267480">get</span> <span m="4267630">discouraged</span> <span m="4267780">by</span> <span m="4268210">that.</span> <span m="4268385">That</span> <span m="4268560">happens</span> <span m="4268910">to</span> <span m="4269070">me</span> <span m="4269230">too</span> <span m="4269390">sometimes.</span> <span m="4270170">These</span> <span m="4270430">papers</span> <span m="4270630">are</span> <span m="4270830">written</span> <span m="4271050">in</span> <span m="4271180">a</span> <span m="4271310">way</span> <span m="4271450">they</span> <span m="4271820">assume</span> <span m="4271880">a</span> <span m="4271930">lot</span> <span m="4272230">of</span> <span m="4272270">prior</span> <span m="4272530">knowledge,</span> <span m="4272920">so</span> <span m="4273155">don't</span> <span m="4273390">get</span> <span m="4273435">discouraged</span> <span m="4273480">by</span> <span m="4273667">that.</span> <span m="4274500">Luckily</span> <span m="4274900">we</span> <span m="4275300">actually</span> <span m="4275480">access</span> <span m="4275660">to</span> <span m="4275899">the</span> <span m="4276138">internet</span> <span m="4276616">we</span> <span m="4276735">can</span> <span m="4276855">look</span> <span m="4276974">up</span> <span m="4277094">some</span> <span m="4277213">of</span> <span m="4277333">that</span> <span m="4277452">stuff.</span> <span m="4277572">Can</span> <span m="4277691">you</span> <span m="4277811">imagine</span> <span m="4277930">what</span> <span m="4278050">happened</span> <span m="4278210">in</span> <span m="4278530">our</span> <span m="4278680">parents</span> <span m="4278835">time?</span> <span m="4278990">They</span> <span m="4279062">just</span> <span m="4279135">didn't</span> <span m="4279207">understand</span> <span m="4279280">stuff</span> <span m="4279353">they</span> <span m="4279443">just</span> <span m="4279534">had</span> <span m="4279625">to</span> <span m="4279716">go</span> <span m="4279898">home,</span> <span m="4280770">right.</span> <span m="4281182">So</span> <span m="4282830">don't</span> <span m="4283610">be</span> <span m="4283700">afraid</span> <span m="4283772">to</span> <span m="4283845">look</span> <span m="4283990">stuff</span> <span m="4284800">up</span> <span m="4285240">to</span> <span m="4285366">get</span> <span m="4285493">to</span> <span m="4285620">Wikipedia</span> <span m="4285915">it's</span> <span m="4286210">mostly</span> <span m="4286910">correct.</span> </p>
<p><span m="4290210">So</span> <span m="4290850">how</span> <span m="4291210">does--</span> <span m="4295590">how</span> <span m="4295810">does</span> <span m="4295970">the</span> <span m="4296130">buddy</span> <span m="4296236">allocation</span> <span m="4296343">system</span> <span m="4297010">work?</span> <span m="4297600">So</span> <span m="4297920">basically</span> <span m="4298320">what</span> <span m="4298480">it</span> <span m="4298560">does</span> <span m="4298790">at</span> <span m="4298990">first</span> <span m="4300390">it</span> <span m="4300560">treats</span> <span m="4301360">unallocated</span> <span m="4302050">memory</span> <span m="4302480">as</span> <span m="4302670">one</span> <span m="4303030">big</span> <span m="4303340">block.</span> <span m="4304196">OK.</span> <span m="4304870">And</span> <span m="4305330">then</span> <span m="4305600">when</span> <span m="4305680">you</span> <span m="4305760">request</span> <span m="4306700">a</span> <span m="4306860">smaller</span> <span m="4307270">block</span> <span m="4307810">for</span> <span m="4308340">dynamic</span> <span m="4308710">allocation,</span> <span m="4309450">it</span> <span m="4309610">tries</span> <span m="4310150">to</span> <span m="4310440">split</span> <span m="4311010">that</span> <span m="4311470">address</span> <span m="4311662">base</span> <span m="4313010">using</span> <span m="4313370">powers</span> <span m="4313760">of</span> <span m="4313880">2</span> <span m="4314240">until</span> <span m="4314340">it</span> <span m="4314660">finds</span> <span m="4314970">a</span> <span m="4315100">block</span> <span m="4315850">that</span> <span m="4316060">is</span> <span m="4316160">just</span> <span m="4316320">big</span> <span m="4316480">enough</span> <span m="4316641">to</span> <span m="4317122">work.</span> <span m="4317603">So</span> <span m="4318084">let's</span> <span m="4318244">say</span> <span m="4318404">a</span> <span m="4318565">request</span> <span m="4318805">came</span> <span m="4318925">in</span> <span m="4320008">and</span> <span m="4320490">say</span> <span m="4320780">A</span> <span m="4320860">is</span> <span m="4320940">going</span> <span m="4321020">to</span> <span m="4321100">equal</span> <span m="4322885">to</span> <span m="4323320">malloc</span> <span m="4324594">28.</span> <span m="4326835">28</span> <span m="4327280">bytes.</span> <span m="4327440">And</span> <span m="4327630">let's</span> <span m="4327930">just</span> <span m="4328065">say</span> <span m="4328200">this</span> <span m="4328344">toy</span> <span m="4328488">example</span> <span m="4328633">is</span> <span m="4328849">only</span> <span m="4329066">128</span> <span m="4329918">bytes</span> <span m="4330336">of</span> <span m="4330754">memory</span> <span m="4331172">total.</span> <span m="4331590">So</span> <span m="4332010">the</span> <span m="4332210">buddy</span> <span m="4332470">allocator</span> <span m="4332710">is</span> <span m="4332820">going</span> <span m="4332930">to</span> <span m="4333040">look</span> <span m="4333290">at</span> <span m="4333470">this</span> <span m="4333603">and</span> <span m="4333736">say,</span> <span m="4333870">well</span> <span m="4333930">I</span> <span m="4333990">have</span> <span m="4334050">128</span> <span m="4334320">bytes</span> <span m="4334590">of</span> <span m="4334705">memory,</span> <span m="4334820">but</span> <span m="4335085">it's</span> <span m="4335350">too</span> <span m="4335650">wasteful</span> <span m="4335880">to</span> <span m="4336015">allocate</span> <span m="4336580">this</span> <span m="4336750">whole</span> <span m="4337050">thing</span> <span m="4337320">to</span> <span m="4337367">this</span> <span m="4337415">28</span> <span m="4337462">byte</span> <span m="4337780">request.</span> </p>
<p><span m="4338710">So</span> <span m="4339220">I'm</span> <span m="4339386">going</span> <span m="4339553">to</span> <span m="4339720">split</span> <span m="4339790">this</span> <span m="4339860">request</span> <span m="4339930">in</span> <span m="4340215">two</span> <span m="4340780">and</span> <span m="4341060">then</span> <span m="4341360">see</span> <span m="4341680">if</span> <span m="4342000">I</span> <span m="4342130">have</span> <span m="4342450">smaller</span> <span m="4343030">block</span> <span m="4343490">that's</span> <span m="4343720">just</span> <span m="4344180">big</span> <span m="4344390">enough.</span> <span m="4344870">So</span> <span m="4345130">it's</span> <span m="4345250">going</span> <span m="4345350">to</span> <span m="4345430">say,</span> <span m="4345995">OK</span> <span m="4346250">put</span> <span m="4346353">this</span> <span m="4346456">to</span> <span m="4346560">0</span> <span m="4346713">to</span> <span m="4346866">64</span> <span m="4347365">and</span> <span m="4347451">64</span> <span m="4347710">to</span> <span m="4348105">128.</span> <span m="4349290">Ah</span> <span m="4349590">OK,</span> <span m="4349840">but</span> <span m="4350090">this</span> <span m="4350240">block</span> <span m="4350620">here</span> <span m="4350780">is</span> <span m="4350940">still</span> <span m="4351105">too</span> <span m="4351270">big,</span> <span m="4351436">right.</span> <span m="4351932">Basically</span> <span m="4352056">what</span> <span m="4352181">the</span> <span m="4352305">buddy</span> <span m="4352430">algorithm</span> <span m="4352770">wants</span> <span m="4352840">to</span> <span m="4353490">do</span> <span m="4353970">is</span> <span m="4354160">find</span> <span m="4354520">a</span> <span m="4354670">block</span> <span m="4355010">such</span> <span m="4355460">that</span> <span m="4355700">the</span> <span m="4355990">allocated</span> <span m="4356660">data</span> <span m="4356920">in</span> <span m="4357050">the</span> <span m="4357180">real</span> <span m="4357580">object,</span> <span m="4358533">28</span> <span m="4358764">bytes,</span> <span m="4358996">is</span> <span m="4359150">at</span> <span m="4359305">least</span> <span m="4359460">half</span> <span m="4360110">the</span> <span m="4360590">size</span> <span m="4361000">of</span> <span m="4361166">that</span> <span m="4361333">block.</span> <span m="4362000">So</span> <span m="4362250">buddy</span> <span m="4362500">allocator</span> <span m="4362750">says,</span> <span m="4363000">OK</span> <span m="4363166">this</span> <span m="4363333">thing</span> <span m="4363500">over</span> <span m="4364000">here</span> <span m="4364470">is</span> <span m="4364740">still</span> <span m="4365170">too</span> <span m="4365417">big.</span> <span m="4365664">So</span> <span m="4365787">what</span> <span m="4365911">it's</span> <span m="4366034">going</span> <span m="4366158">to</span> <span m="4366322">do</span> <span m="4366487">is</span> <span m="4366652">it's</span> <span m="4366775">going</span> <span m="4366899">to</span> <span m="4367022">split</span> <span m="4367146">the</span> <span m="4367393">memory</span> <span m="4367640">space</span> <span m="4368134">again,</span> <span m="4371600">right.</span> <span m="4371940">So</span> <span m="4372330">from</span> <span m="4372477">0</span> <span m="4372625">to</span> <span m="4372920">32</span> <span m="4376718">and</span> <span m="4377180">then</span> <span m="4377285">it's</span> <span m="4377390">going</span> <span m="4377495">to</span> <span m="4377600">say,</span> <span m="4378050">ah</span> <span m="4378355">OK</span> <span m="4378950">28</span> <span m="4379095">bytes</span> <span m="4380090">that</span> <span m="4380360">is</span> <span m="4380480">more</span> <span m="4380740">than</span> <span m="4380930">half</span> <span m="4381230">the</span> <span m="4381330">size</span> <span m="4381670">of</span> <span m="4381850">this</span> <span m="4382005">block</span> <span m="4382160">here.</span> <span m="4382830">So</span> <span m="4382880">now</span> <span m="4383170">this</span> <span m="4384150">block</span> <span m="4384910">is</span> <span m="4385040">going</span> <span m="4385300">to</span> <span m="4385410">be</span> <span m="4386970">allocated</span> <span m="4387285">to</span> <span m="4387600">A.</span> <span m="4388313">OK,</span> <span m="4388726">and</span> <span m="4389140">so</span> <span m="4389480">it</span> <span m="4389575">gets</span> <span m="4389670">this</span> <span m="4389965">address</span> <span m="4390112">here.</span> </p>
<p><span m="4390940">Now</span> <span m="4391240">let's</span> <span m="4391610">say</span> <span m="4392090">that</span> <span m="4393754">we</span> <span m="4393916">have</span> <span m="4394078">another</span> <span m="4394728">question</span> <span m="4394890">comes</span> <span m="4395052">in</span> <span m="4395702">for</span> <span m="4396190">B</span> <span m="4397910">and</span> <span m="4397940">let's</span> <span m="4397970">say</span> <span m="4398000">we</span> <span m="4398030">want</span> <span m="4398250">to</span> <span m="4398470">malloc</span> <span m="4398960">50</span> <span m="4402730">right.</span> <span m="4403030">So</span> <span m="4403110">what's</span> <span m="4403203">going</span> <span m="4403296">to</span> <span m="4403390">happen</span> <span m="4404520">is</span> <span m="4404730">that</span> <span m="4405135">the</span> <span m="4405540">buddy</span> <span m="4405830">allocator</span> <span m="4406040">will</span> <span m="4406485">say,</span> <span m="4406930">ah</span> <span m="4407375">OK</span> <span m="4407597">I</span> <span m="4407820">actually</span> <span m="4408370">have</span> <span m="4408770">a</span> <span m="4408890">block</span> <span m="4409250">here</span> <span m="4409410">that's</span> <span m="4409650">big</span> <span m="4410145">enough,</span> <span m="4410640">right.</span> <span m="4411015">50</span> <span m="4411390">Is</span> <span m="4411740">greater</span> <span m="4412020">than</span> <span m="4412250">half</span> <span m="4412305">the</span> <span m="4412360">size</span> <span m="4412415">of</span> <span m="4412470">this</span> <span m="4412800">thing</span> <span m="4413270">so</span> <span m="4413356">I'll</span> <span m="4413443">just</span> <span m="4413870">allocate</span> <span m="4414140">that</span> <span m="4414275">right</span> <span m="4414410">there.</span> <span m="4415240">So</span> <span m="4415670">we</span> <span m="4415786">have</span> <span m="4415903">this</span> <span m="4416019">system,</span> <span m="4416136">or</span> <span m="4416602">setup,</span> <span m="4417068">where</span> <span m="4417223">we</span> <span m="4417378">have</span> <span m="4417534">A</span> <span m="4418000">here,</span> <span m="4421740">and</span> <span m="4422000">then</span> <span m="4422390">we</span> <span m="4422520">have</span> <span m="4422930">B</span> <span m="4423150">here,</span> <span m="4424103">and</span> <span m="4424546">then</span> <span m="4424990">let's</span> <span m="4425440">say</span> <span m="4426400">we</span> <span m="4426620">had</span> <span m="4426930">another</span> <span m="4427080">request</span> <span m="4427241">that</span> <span m="4427403">came</span> <span m="4427565">in</span> <span m="4429020">for</span> <span m="4431070">20</span> <span m="4431300">bytes.</span> <span m="4434450">This</span> <span m="4434600">is</span> <span m="4434710">actually</span> <span m="4435080">pretty</span> <span m="4435330">straightforward</span> <span m="4435580">because</span> <span m="4435705">we</span> <span m="4435830">can</span> <span m="4435955">put</span> <span m="4436080">that</span> <span m="4436690">right</span> <span m="4436880">here,</span> <span m="4437600">right.</span> <span m="4437910">So</span> <span m="4438080">then</span> <span m="4438250">you</span> <span m="4438590">have</span> <span m="4439050">something</span> <span m="4439335">that</span> <span m="4439620">looks</span> <span m="4440080">like</span> <span m="4441790">this.</span> </p>
<p><span m="4443496">Then</span> <span m="4443880">what's</span> <span m="4444210">interesting</span> <span m="4444640">is</span> <span m="4444730">that</span> <span m="4444950">when</span> <span m="4445225">you</span> <span m="4445900">deallocate</span> <span m="4446215">memory,</span> <span m="4447280">if</span> <span m="4447440">you</span> <span m="4447600">have</span> <span m="4447960">to</span> <span m="4448110">deallocate</span> <span m="4448720">a</span> <span m="4448970">block</span> <span m="4449670">that</span> <span m="4449780">are</span> <span m="4449840">next</span> <span m="4449905">to</span> <span m="4449970">each</span> <span m="4450195">other</span> <span m="4450420">and</span> <span m="4450570">are</span> <span m="4450720">the</span> <span m="4450870">same</span> <span m="4451065">size,</span> <span m="4451650">the</span> <span m="4451760">buddy</span> <span m="4452040">allocator</span> <span m="4452280">will</span> <span m="4452430">merge</span> <span m="4452730">them</span> <span m="4453310">into</span> <span m="4453730">a</span> <span m="4453940">block</span> <span m="4454150">that's</span> <span m="4454495">twice</span> <span m="4454667">as</span> <span m="4454840">big,</span> <span m="4455270">right.</span> <span m="4455700">So</span> <span m="4456130">if</span> <span m="4456260">we</span> <span m="4456550">had</span> <span m="4459520">free</span> <span m="4462870">let's</span> <span m="4463250">say</span> <span m="4463650">C</span> <span m="4465470">then</span> <span m="4465637">we</span> <span m="4466140">go</span> <span m="4466375">to</span> <span m="4467960">this</span> <span m="4468180">situation,</span> <span m="4469720">we</span> <span m="4470160">can't</span> <span m="4470263">do</span> <span m="4470366">any</span> <span m="4470580">merging,</span> <span m="4471000">because</span> <span m="4471970">this</span> <span m="4472180">is</span> <span m="4472260">the</span> <span m="4472390">only</span> <span m="4472660">possible</span> <span m="4473070">block</span> <span m="4473425">that</span> <span m="4473602">this</span> <span m="4473780">one</span> <span m="4473900">could</span> <span m="4474020">have</span> <span m="4474160">been</span> <span m="4474270">merged</span> <span m="4474445">with.</span> <span m="4475110">It's</span> <span m="4475160">the</span> <span m="4475210">same</span> <span m="4475450">size,</span> <span m="4475790">but</span> <span m="4475870">this</span> <span m="4475950">things</span> <span m="4476030">still</span> <span m="4476130">occupied.</span> </p>
<p><span m="4477330">So</span> <span m="4477510">then</span> <span m="4477790">if</span> <span m="4477883">we</span> <span m="4477976">do</span> <span m="4478070">a</span> <span m="4479760">free</span> <span m="4481170">on</span> <span m="4482170">A,</span> <span m="4485030">then</span> <span m="4489710">we</span> <span m="4489830">have</span> <span m="4490100">this</span> <span m="4490300">situation</span> <span m="4490585">here.</span> <span m="4492480">Right,</span> <span m="4492830">where</span> <span m="4493100">these</span> <span m="4493370">two</span> <span m="4494330">32</span> <span m="4495475">byte</span> <span m="4495780">blocks</span> <span m="4496120">were</span> <span m="4496365">merged</span> <span m="4496610">into</span> <span m="4497050">one</span> <span m="4497410">size</span> <span m="4497740">64,</span> <span m="4498940">and</span> <span m="4499025">that</span> <span m="4499110">this</span> <span m="4499310">one,</span> <span m="4499535">a</span> <span m="4499647">size</span> <span m="4499760">64</span> <span m="4499850">is</span> <span m="4499980">still</span> <span m="4500110">out</span> <span m="4500370">there.</span> <span m="4501405">Right,</span> <span m="4501820">so</span> <span m="4502100">it's</span> <span m="4502270">called</span> <span m="4502376">the</span> <span m="4502483">buddy</span> <span m="4502590">system</span> <span m="4502855">because</span> <span m="4503120">once</span> <span m="4503300">again,</span> <span m="4503840">whenever</span> <span m="4504140">you</span> <span m="4504240">have</span> <span m="4504520">two</span> <span m="4504810">adjacent</span> <span m="4505420">blocks</span> <span m="4506290">that</span> <span m="4506560">are</span> <span m="4507160">of</span> <span m="4507440">the</span> <span m="4507580">same</span> <span m="4507950">size</span> <span m="4508800">and</span> <span m="4508865">that</span> <span m="4508930">could</span> <span m="4508995">be</span> <span m="4509320">merged</span> <span m="4509700">to</span> <span m="4510080">form</span> <span m="4510570">an</span> <span m="4510690">aligned</span> <span m="4511060">block,</span> <span m="4511960">then</span> <span m="4512410">the</span> <span m="4512620">system</span> <span m="4512740">will</span> <span m="4512810">merge</span> <span m="4513250">that</span> <span m="4513690">buddy</span> <span m="4513985">with</span> <span m="4514280">this</span> <span m="4514470">other</span> <span m="4514655">buddy</span> <span m="4514840">and</span> <span m="4515210">then</span> <span m="4515540">create</span> <span m="4515665">that</span> <span m="4515790">new</span> <span m="4516010">block</span> <span m="4516265">that's</span> <span m="4516520">twice</span> <span m="4516656">as</span> <span m="4516793">big.</span> <span m="4518253">So</span> <span m="4518473">the</span> <span m="4518694">thing</span> <span m="4518914">that's</span> <span m="4519135">nice</span> <span m="4519576">about</span> <span m="4519798">this</span> <span m="4520020">system</span> <span m="4520510">is</span> <span m="4520710">that</span> <span m="4521940">it's</span> <span m="4522160">very</span> <span m="4522460">simple</span> <span m="4523190">to</span> <span m="4523290">figure</span> <span m="4523730">out</span> <span m="4524828">where</span> <span m="4525326">buddy's</span> <span m="4525824">are.</span> <span m="4526322">Because</span> <span m="4526446">you</span> <span m="4526571">can</span> <span m="4526695">do</span> <span m="4526820">very</span> <span m="4527318">cutesy</span> <span m="4527816">arithmetic,</span> <span m="4528314">like</span> <span m="4528563">the</span> <span m="4528812">buddy</span> <span m="4529061">bounds</span> <span m="4529310">system--</span> <span m="4529808">baggy</span> <span m="4530057">bounds</span> <span m="4530306">system</span> <span m="4530804">works.</span> <span m="4531310">But</span> <span m="4531460">anyway</span> <span m="4531700">I'm</span> <span m="4531805">not</span> <span m="4531910">going</span> <span m="4531980">into</span> <span m="4532050">details.</span> <span m="4532870">This</span> <span m="4533020">is</span> <span m="4533110">basically</span> <span m="4533420">how</span> <span m="4533600">buddy</span> <span m="4533785">allocation</span> <span m="4534240">works.</span> <span m="4534710">Does</span> <span m="4535260">that</span> <span m="4535880">make</span> <span m="4536130">sense?</span> </p>
<p><span m="4538240">Right,</span> <span m="4538400">and</span> <span m="4538620">one</span> <span m="4538767">question</span> <span m="4538915">that</span> <span m="4539013">came</span> <span m="4539111">up</span> <span m="4539210">a</span> <span m="4539445">lot</span> <span m="4539680">in</span> <span m="4540620">all</span> <span m="4540776">my</span> <span m="4540933">discussions,</span> <span m="4541820">isn't</span> <span m="4542490">this</span> <span m="4542710">wasteful?</span> <span m="4543560">Right,</span> <span m="4543820">so</span> <span m="4543930">for</span> <span m="4544050">example,</span> <span m="4544540">imagine</span> <span m="4545500">that</span> <span m="4546570">up</span> <span m="4546664">here</span> <span m="4546758">at</span> <span m="4546852">the</span> <span m="4546946">beginning</span> <span m="4547510">I</span> <span m="4547960">had</span> <span m="4548280">a</span> <span m="4548660">request</span> <span m="4549065">for</span> <span m="4549610">size</span> <span m="4550330">65</span> <span m="4551140">bytes,</span> <span m="4552253">right.</span> <span m="4552484">So</span> <span m="4552542">if</span> <span m="4552600">I</span> <span m="4552658">have</span> <span m="4552948">a</span> <span m="4553180">request</span> <span m="4553430">for</span> <span m="4553540">65</span> <span m="4554260">bytes,</span> <span m="4554890">I</span> <span m="4555000">would</span> <span m="4555140">allocate</span> <span m="4555630">this</span> <span m="4555840">whole</span> <span m="4556120">structure</span> <span m="4556440">up</span> <span m="4556760">here</span> <span m="4557720">and</span> <span m="4558030">then</span> <span m="4558150">there's--</span> <span m="4558645">actually</span> <span m="4559140">you're</span> <span m="4559145">out</span> <span m="4559150">of</span> <span m="4559155">dynamic</span> <span m="4559160">memory</span> <span m="4559751">and</span> <span m="4559822">can't</span> <span m="4559892">do</span> <span m="4559963">any</span> <span m="4560034">more</span> <span m="4560105">allocations.</span> <span m="4560600">And</span> <span m="4561095">the</span> <span m="4561260">answer</span> <span m="4561425">is</span> <span m="4561590">yes,</span> <span m="4562085">that</span> <span m="4562332">is</span> <span m="4562580">wasteful.</span> <span m="4563075">But</span> <span m="4563240">once</span> <span m="4563405">again,</span> <span m="4563570">it's</span> <span m="4563693">a</span> <span m="4563817">trade</span> <span m="4563941">off,</span> <span m="4564065">right.</span> <span m="4564560">Because</span> <span m="4564807">it's</span> <span m="4565055">very</span> <span m="4565302">easy</span> <span m="4565550">to</span> <span m="4565673">do</span> <span m="4565797">these</span> <span m="4565921">calculations</span> <span m="4566045">on</span> <span m="4566168">how</span> <span m="4566292">to</span> <span m="4566416">do</span> <span m="4566540">merging</span> <span m="4567035">and</span> <span m="4567282">stuff</span> <span m="4567530">like</span> <span m="4567777">that.</span> <span m="4568530">So</span> <span m="4568780">if</span> <span m="4568878">you</span> <span m="4568977">want</span> <span m="4569675">finer</span> <span m="4569780">grain</span> <span m="4570050">allocation,</span> <span m="4570520">there</span> <span m="4570990">are</span> <span m="4571225">other</span> <span m="4571460">valid</span> <span m="4571616">ones</span> <span m="4571773">for</span> <span m="4571930">that.</span> <span m="4572200">It's</span> <span m="4572238">outside</span> <span m="4572277">the</span> <span m="4572315">scope</span> <span m="4572354">of</span> <span m="4572392">the</span> <span m="4572431">lecture</span> <span m="4573040">so,</span> <span m="4573340">we</span> <span m="4573615">can</span> <span m="4573890">buffer</span> <span m="4574081">that</span> <span m="4574272">offline</span> <span m="4574654">if</span> <span m="4574781">you</span> <span m="4574908">want.</span> <span m="4575420">That's</span> <span m="4575630">basically</span> <span m="4575910">how</span> <span m="4576020">the</span> <span m="4576130">buddy--</span> <span m="4577100">sorry</span> <span m="4577570">the,</span> <span m="4578590">the</span> <span m="4578780">buddy</span> <span m="4578970">allocator</span> <span m="4579190">works.</span> </p>
<p><span m="4581300">So</span> <span m="4582040">what</span> <span m="4582410">is</span> <span m="4582920">the</span> <span m="4583000">baggy</span> <span m="4583340">bounds</span> <span m="4583620">system</span> <span m="4583870">going</span> <span m="4584250">to</span> <span m="4584350">do?</span> <span m="4586126">Well,</span> <span m="4586618">it</span> <span m="4586782">is</span> <span m="4586946">going</span> <span m="4587000">through</span> <span m="4587055">a</span> <span m="4587110">y,</span> <span m="4587602">on</span> <span m="4587766">couple</span> <span m="4587930">of</span> <span m="4588586">tricks.</span> <span m="4601400">So</span> <span m="4601760">the</span> <span m="4601850">first</span> <span m="4602190">idea</span> <span m="4602750">is</span> <span m="4603700">you</span> <span m="4604090">round</span> <span m="4604510">up</span> <span m="4606361">each</span> <span m="4606858">allocation</span> <span m="4612830">to</span> <span m="4612897">a</span> <span m="4612965">power</span> <span m="4613032">of</span> <span m="4613100">2,</span> <span m="4618965">and</span> <span m="4619207">you</span> <span m="4619450">align</span> <span m="4622940">the</span> <span m="4623060">request</span> <span m="4624754">to</span> <span m="4625002">that</span> <span m="4625251">power</span> <span m="4625748">of</span> <span m="4625996">2.</span> <span m="4633210">Right,</span> <span m="4633400">so</span> <span m="4633630">essentially</span> <span m="4633920">the</span> <span m="4634280">buddy</span> <span m="4634440">allocators</span> <span m="4634980">very</span> <span m="4635137">nice</span> <span m="4635295">because</span> <span m="4635610">it</span> <span m="4635870">handles</span> <span m="4636150">a</span> <span m="4636230">lot</span> <span m="4636640">of</span> <span m="4636740">that</span> <span m="4636856">for</span> <span m="4636972">you,</span> <span m="4637088">right.</span> <span m="4637205">It</span> <span m="4638060">naturally</span> <span m="4638325">will</span> <span m="4638413">do</span> <span m="4638501">that</span> <span m="4638590">kind</span> <span m="4638686">of</span> <span m="4638783">thing.</span> <span m="4638880">Because</span> <span m="4639540">that's</span> <span m="4639685">just</span> <span m="4639830">the</span> <span m="4639975">way</span> <span m="4640410">that</span> <span m="4640625">it</span> <span m="4641053">allocates</span> <span m="4641160">and</span> <span m="4641320">deallocates</span> <span m="4641970">to</span> <span m="4642460">memory.</span> <span m="4643930">And</span> <span m="4644180">so</span> <span m="4645140">the</span> <span m="4645450">second</span> <span m="4645820">thing</span> <span m="4646190">that's</span> <span m="4646295">going</span> <span m="4646401">to</span> <span m="4646506">happen,</span> <span m="4647880">baggy</span> <span m="4647950">bounds</span> <span m="4648390">system,</span> <span m="4649230">is</span> <span m="4649620">you</span> <span m="4649730">express</span> <span m="4652610">each</span> <span m="4653095">bound</span> <span m="4660380">as</span> <span m="4660650">log</span> <span m="4661150">base</span> <span m="4661530">2</span> <span m="4662740">of</span> <span m="4663030">the</span> <span m="4663340">allocation</span> <span m="4664030">size.</span> </p>
<p><span m="4668290">Right,</span> <span m="4668770">and</span> <span m="4668960">so</span> <span m="4669440">what</span> <span m="4669541">this</span> <span m="4669643">means--</span> <span m="4670050">and</span> <span m="4670190">so</span> <span m="4670310">why</span> <span m="4670550">can</span> <span m="4670980">we</span> <span m="4671080">do</span> <span m="4671250">this?</span> <span m="4671710">Well</span> <span m="4671870">once</span> <span m="4672030">again</span> <span m="4672260">all</span> <span m="4672375">of</span> <span m="4672490">our</span> <span m="4672640">allocation</span> <span m="4673260">sizes</span> <span m="4673950">are</span> <span m="4674090">powers</span> <span m="4674480">of</span> <span m="4674600">2,</span> <span m="4675670">right.</span> <span m="4676070">So</span> <span m="4676250">we</span> <span m="4676380">don't</span> <span m="4676700">need</span> <span m="4676910">very</span> <span m="4677270">many</span> <span m="4677490">bits</span> <span m="4677805">to</span> <span m="4677910">represent</span> <span m="4679512">how</span> <span m="4679744">big</span> <span m="4679976">a</span> <span m="4680208">particular</span> <span m="4680640">allocation</span> <span m="4680930">size</span> <span m="4681220">is.</span> <span m="4681470">So</span> <span m="4681650">for</span> <span m="4681810">example,</span> <span m="4684040">if</span> <span m="4684500">your</span> <span m="4685100">allocation</span> <span m="4685770">size</span> <span m="4686340">is</span> <span m="4687850">16,</span> <span m="4690602">then</span> <span m="4691090">you</span> <span m="4691490">just</span> <span m="4691770">need</span> <span m="4693170">four--</span> <span m="4693640">the</span> <span m="4693796">log</span> <span m="4693953">rhythm</span> <span m="4694110">of</span> <span m="4694287">that,</span> <span m="4694465">4</span> <span m="4694642">bits</span> <span m="4694820">of</span> <span m="4695000">the</span> <span m="4695470">allocation</span> <span m="4695920">size,</span> <span m="4696820">right.</span> <span m="4697420">Does</span> <span m="4697690">that</span> <span m="4697825">make</span> <span m="4697960">sense?</span> </p>
<p><span m="4699340">Right,</span> <span m="4699800">this</span> <span m="4699990">another</span> <span m="4700080">popular</span> <span m="4700760">question</span> <span m="4701210">here.</span> <span m="4701350">This</span> <span m="4701390">is</span> <span m="4701430">why</span> <span m="4701470">you</span> <span m="4701590">only</span> <span m="4701870">need</span> <span m="4702870">small</span> <span m="4703250">number</span> <span m="4703336">of</span> <span m="4703423">bits</span> <span m="4703770">here,</span> <span m="4704250">because</span> <span m="4704370">we're</span> <span m="4704450">basically</span> <span m="4705030">forcing</span> <span m="4705570">the</span> <span m="4705730">allocation</span> <span m="4706350">sizes</span> <span m="4707162">hit</span> <span m="4707570">this</span> <span m="4707740">quantized</span> <span m="4709017">way</span> <span m="4709514">that</span> <span m="4709679">you</span> <span m="4710011">grow.</span> <span m="4710508">Like</span> <span m="4710607">if</span> <span m="4710706">you</span> <span m="4710806">could</span> <span m="4710905">only</span> <span m="4711005">have</span> <span m="4711502">something,</span> <span m="4711626">let's</span> <span m="4711750">say</span> <span m="4712496">16</span> <span m="4712744">bytes</span> <span m="4713490">or</span> <span m="4713655">32</span> <span m="4713821">bytes.</span> <span m="4713987">You</span> <span m="4714235">can't</span> <span m="4714484">have</span> <span m="4714981">for</span> <span m="4715230">example,</span> <span m="4715480">33</span> <span m="4715690">bytes.</span> </p>
<p><span m="4718930">And</span> <span m="4719250">then</span> <span m="4719400">the</span> <span m="4719760">third</span> <span m="4720020">thing</span> <span m="4720180">that</span> <span m="4720600">baggy</span> <span m="4720810">bounds</span> <span m="4720877">is</span> <span m="4720945">going</span> <span m="4721012">to</span> <span m="4721080">do</span> <span m="4721730">is</span> <span m="4722320">store</span> <span m="4724580">the</span> <span m="4724930">limit</span> <span m="4725200">info</span> <span m="4729730">in</span> <span m="4729873">a</span> <span m="4730016">linear</span> <span m="4730160">array</span> <span m="4734900">1</span> <span m="4735580">byte</span> <span m="4736882">per</span> <span m="4737378">entry</span> <span m="4744818">but</span> <span m="4744942">we're</span> <span m="4745066">going</span> <span m="4745190">to</span> <span m="4745314">allocate</span> <span m="4745810">memory</span> <span m="4752258">at</span> <span m="4752509">the</span> <span m="4752760">granularity</span> <span m="4753140">of</span> <span m="4753330">a</span> <span m="4753520">slot.</span> <span m="4757240">Which</span> <span m="4757310">in</span> <span m="4757380">the</span> <span m="4757475">paper</span> <span m="4757570">they</span> <span m="4758180">used</span> <span m="4759450">16</span> <span m="4759945">bytes</span> <span m="4761230">as</span> <span m="4761610">the</span> <span m="4761817">slot</span> <span m="4762025">width.</span> <span m="4764530">So</span> <span m="4764710">for</span> <span m="4764920">example,</span> <span m="4765640">now</span> <span m="4765785">this</span> <span m="4765930">next</span> <span m="4766050">one,</span> <span m="4766170">this</span> <span m="4766355">is</span> <span m="4766540">1</span> <span m="4766750">bit</span> <span m="4766960">that</span> <span m="4767080">wasn't</span> <span m="4767400">actually</span> <span m="4767870">specifically</span> <span m="4767985">said</span> <span m="4768100">in</span> <span m="4768215">the</span> <span m="4768700">paper</span> <span m="4769430">which</span> <span m="4769610">if</span> <span m="4769720">you</span> <span m="4769830">don't</span> <span m="4770590">grasp</span> <span m="4771030">it'll</span> <span m="4771147">make</span> <span m="4771265">the</span> <span m="4771382">paper</span> <span m="4771500">very</span> <span m="4771735">tricky</span> <span m="4771970">to</span> <span m="4772440">understand,</span> <span m="4772910">right.</span> <span m="4773380">So</span> <span m="4773850">now</span> <span m="4774085">you</span> <span m="4774320">can</span> <span m="4774790">have</span> <span m="4775260">a</span> <span m="4775730">slot</span> <span m="4776210">size</span> <span m="4779330">which</span> <span m="4779460">is</span> <span m="4779550">equal</span> <span m="4779760">to</span> <span m="4779820">16,</span> <span m="4780190">so</span> <span m="4780282">if</span> <span m="4780375">you</span> <span m="4780467">do</span> <span m="4781040">p</span> <span m="4781310">equals</span> <span m="4782190">malloc</span> <span m="4786630">16</span> <span m="4787370">so</span> <span m="4787468">what's</span> <span m="4787566">going</span> <span m="4787664">to</span> <span m="4787762">happen?</span> <span m="4788350">So</span> <span m="4788513">in</span> <span m="4788676">this</span> <span m="4788840">bounds</span> <span m="4789085">table</span> <span m="4790800">you're</span> <span m="4791290">going</span> <span m="4791495">to</span> <span m="4791700">say</span> <span m="4793370">take</span> <span m="4793710">that</span> <span m="4793960">pointer</span> <span m="4795190">plot</span> <span m="4795570">it</span> <span m="4795702">by</span> <span m="4795835">plot</span> <span m="4796100">size</span> <span m="4802440">it's</span> <span m="4802600">going</span> <span m="4802680">to</span> <span m="4802760">equal</span> <span m="4803120">4,</span> <span m="4803840">right.</span> <span m="4804240">So</span> <span m="4804440">in</span> <span m="4804685">that</span> <span m="4804930">bounds</span> <span m="4805260">table</span> <span m="4805660">we're</span> <span m="4805793">going</span> <span m="4805926">to</span> <span m="4806060">put</span> <span m="4806260">the</span> <span m="4806460">logarithm</span> <span m="4807400">of</span> <span m="4807890">the</span> <span m="4808760">allocation</span> <span m="4809446">size</span> <span m="4809790">in</span> <span m="4810150">the</span> <span m="4810510">table.</span> <span m="4811830">Does</span> <span m="4812270">that</span> <span m="4812400">make</span> <span m="4812570">sense?</span> </p>
<p><span m="4813060">OK,</span> <span m="4813460">now</span> <span m="4813680">what</span> <span m="4813803">the</span> <span m="4813926">tricky</span> <span m="4814050">thing</span> <span m="4814200">is,</span> <span m="4814350">let's</span> <span m="4814460">say</span> <span m="4814850">that</span> <span m="4814943">you</span> <span m="4815036">have</span> <span m="4815130">something</span> <span m="4815420">like</span> <span m="4815896">this.</span> <span m="4822570">Right,</span> <span m="4822930">so</span> <span m="4823690">let's</span> <span m="4823910">say</span> <span m="4824065">that</span> <span m="4824220">you</span> <span m="4824370">out</span> <span m="4824820">32</span> <span m="4825280">bytes.</span> <span m="4826280">What</span> <span m="4826400">is</span> <span m="4826530">the</span> <span m="4826660">bounds</span> <span m="4827010">table</span> <span m="4827187">going</span> <span m="4827365">to</span> <span m="4827453">look</span> <span m="4827542">like</span> <span m="4827631">there?</span> <span m="4829050">So</span> <span m="4829420">here</span> <span m="4829750">we</span> <span m="4829810">actually</span> <span m="4830050">have</span> <span m="4830170">to</span> <span m="4830290">update</span> <span m="4831080">the</span> <span m="4831170">bounds</span> <span m="4831640">table</span> <span m="4832640">to</span> <span m="4833030">abbreviate</span> <span m="4833410">your</span> <span m="4833790">p,</span> <span m="4834095">or</span> <span m="4834400">sorry</span> <span m="4834545">t</span> <span m="4834690">for</span> <span m="4834836">the</span> <span m="4835272">size</span> <span m="4835418">you</span> <span m="4835564">need.</span> <span m="4837920">But</span> <span m="4838040">that</span> <span m="4838230">fit</span> <span m="4838280">the</span> <span m="4838330">bounds</span> <span m="4838830">table</span> <span m="4839130">twice.</span> <span m="4844970">Right,</span> <span m="4845350">once</span> <span m="4845980">for</span> <span m="4846290">the</span> <span m="4846430">first</span> <span m="4847030">slot</span> <span m="4847620">memory</span> <span m="4847706">that</span> <span m="4847749">this</span> <span m="4848140">allocation</span> <span m="4848440">takes</span> <span m="4848590">up.</span> <span m="4849085">And</span> <span m="4849430">then</span> <span m="4849545">a</span> <span m="4849660">second</span> <span m="4850105">time</span> <span m="4851476">for</span> <span m="4851939">that</span> <span m="4852865">second</span> <span m="4853328">slot</span> <span m="4855180">that</span> <span m="4855650">it</span> <span m="4855910">takes</span> <span m="4856190">up.</span> <span m="4860740">Right,</span> <span m="4861040">so</span> <span m="4861140">once</span> <span m="4861330">again</span> <span m="4861980">32</span> <span m="4862360">is</span> <span m="4862480">the</span> <span m="4862600">allocation</span> <span m="4863320">size.</span> <span m="4863740">This</span> <span m="4864195">is</span> <span m="4864650">the</span> <span m="4865090">log</span> <span m="4865460">of</span> <span m="4865617">that</span> <span m="4865774">allocation</span> <span m="4865932">size.</span> <span m="4866404">So</span> <span m="4866561">for</span> <span m="4866718">the</span> <span m="4866876">two</span> <span m="4867112">slots</span> <span m="4867820">that</span> <span m="4867933">this</span> <span m="4868046">memory</span> <span m="4868590">takes</span> <span m="4868900">up,</span> <span m="4869250">we're</span> <span m="4869540">going</span> <span m="4869636">to</span> <span m="4869733">update</span> <span m="4869830">the</span> <span m="4869973">bounds</span> <span m="4870116">table</span> <span m="4870260">twice.</span> <span m="4871482">Does</span> <span m="4871860">that</span> <span m="4872090">makes</span> <span m="4872280">sense?</span> <span m="4873990">Right,</span> <span m="4874190">and</span> <span m="4874280">this</span> <span m="4874370">is</span> <span m="4874510">really</span> <span m="4874720">the</span> <span m="4874930">key</span> <span m="4875190">that</span> <span m="4875290">I</span> <span m="4875580">think</span> <span m="4875970">for</span> <span m="4875986">a</span> <span m="4876003">lot</span> <span m="4876008">of</span> <span m="4876014">people</span> <span m="4876020">that's</span> <span m="4876150">going</span> <span m="4876313">to</span> <span m="4876476">make</span> <span m="4876640">the</span> <span m="4876665">paper</span> <span m="4876690">make</span> <span m="4876715">sense</span> <span m="4876740">or</span> <span m="4876843">not</span> <span m="4876946">make</span> <span m="4877380">sense,</span> <span m="4878260">right.</span> <span m="4878510">Because</span> <span m="4879720">that</span> <span m="4880090">bounds</span> <span m="4880440">table</span> <span m="4880950">multiple</span> <span m="4881450">times</span> <span m="4881616">if</span> <span m="4881699">any</span> <span m="4881783">outside</span> <span m="4881950">the</span> <span m="4882280">allocation.</span> </p>
<p><span m="4882625">AUDIENCE: Can</span> <span m="4882682">you</span> <span m="4882740">repeat</span> <span m="4882797">that</span> <span m="4882855">for</span> <span m="4882883">me</span> <span m="4882912">again?</span> </p>
<p><span m="4882970">PROFESSOR:</span> <span m="4883452">Excuse</span> <span m="4883693">me?</span> </p>
<p><span m="4883934">AUDIENCE: Can</span> <span m="4884054">you</span> <span m="4884175">repeat</span> <span m="4884295">that</span> <span m="4884416">again?</span> </p>
<p><span m="4885380">PROFESSOR: Oh</span> <span m="4885480">yeah, yeah,</span> <span m="4885700">sure,</span> <span m="4885950">sure.</span> <span m="4886326">So</span> <span m="4886420">basically</span> <span m="4886514">what</span> <span m="4886608">the</span> <span m="4886702">idea</span> <span m="4886891">is</span> <span m="4887080">that</span> <span m="4887440">I</span> <span m="4887580">mean</span> <span m="4887720">you've</span> <span m="4888000">got</span> <span m="4888270">this</span> <span m="4889820">bounds</span> <span m="4890005">table</span> <span m="4890190">here</span> <span m="4892290">and</span> <span m="4892840">it's</span> <span m="4893000">got</span> <span m="4893066">a</span> <span m="4893133">bunch</span> <span m="4893200">of</span> <span m="4893480">entries.</span> <span m="4894230">But</span> <span m="4894345">it</span> <span m="4894460">basically</span> <span m="4895172">needs</span> <span m="4895970">entries</span> <span m="4896610">to</span> <span m="4897060">cover</span> <span m="4898360">all</span> <span m="4898660">of</span> <span m="4898960">p</span> <span m="4899125">size,</span> <span m="4899620">all</span> <span m="4899940">the</span> <span m="4900170">allocation</span> <span m="4900435">size.</span> <span m="4901167">OK,</span> <span m="4901634">so</span> <span m="4901750">in</span> <span m="4901867">this</span> <span m="4901984">case</span> <span m="4902101">it</span> <span m="4902568">was</span> <span m="4902723">very</span> <span m="4902879">simple</span> <span m="4903035">because</span> <span m="4904440">basically</span> <span m="4904770">this</span> <span m="4904900">is</span> <span m="4904950">just</span> <span m="4905130">one</span> <span m="4905330">slot,</span> <span m="4905790">due</span> <span m="4905949">to</span> <span m="4906108">the</span> <span m="4906267">size.</span> <span m="4906744">Here</span> <span m="4907221">it's</span> <span m="4907459">multiple</span> <span m="4907698">slot</span> <span m="4907936">sizes,</span> <span m="4908175">right.</span> <span m="4909130">So</span> <span m="4909240">what's</span> <span m="4909306">going</span> <span m="4909373">to</span> <span m="4909440">happen</span> <span m="4909930">is</span> <span m="4909995">that</span> <span m="4910060">imagine</span> <span m="4910211">then</span> <span m="4910363">that</span> <span m="4910515">we</span> <span m="4910628">had</span> <span m="4910742">a</span> <span m="4910856">pointer</span> <span m="4910970">that's</span> <span m="4911880">moving</span> <span m="4912380">in</span> <span m="4912540">the</span> <span m="4912700">range</span> <span m="4912917">of</span> <span m="4913135">p.</span> <span m="4913570">You</span> <span m="4913675">have</span> <span m="4913780">to</span> <span m="4914250">have</span> <span m="4914560">some</span> <span m="4914605">of</span> <span m="4914650">the</span> <span m="4914800">back</span> <span m="4915180">end</span> <span m="4915340">table</span> <span m="4915700">slot</span> <span m="4916350">for</span> <span m="4916590">each</span> <span m="4916830">one</span> <span m="4917030">of</span> <span m="4917080">those</span> <span m="4917290">places</span> <span m="4917700">where</span> <span m="4917970">p</span> <span m="4918210">[INAUDIBLE],</span> <span m="4918930">right.</span> <span m="4919410">And</span> <span m="4919890">so</span> <span m="4920460">it's</span> <span m="4921000">this</span> <span m="4921150">second</span> <span m="4921610">piece</span> <span m="4921920">that</span> <span m="4922260">makes</span> <span m="4922390">the</span> <span m="4922625">paper</span> <span m="4922860">a</span> <span m="4922950">little</span> <span m="4923040">bit</span> <span m="4923130">confusing</span> <span m="4923400">I</span> <span m="4923575">think.</span> <span m="4923750">But</span> <span m="4924100">it</span> <span m="4924240">doesn't</span> <span m="4924380">really</span> <span m="4924430">go</span> <span m="4924830">into</span> <span m="4924885">depth</span> <span m="4925160">about</span> <span m="4925470">that,</span> <span m="4926140">but</span> <span m="4926616">this</span> <span m="4926854">is</span> <span m="4927092">how</span> <span m="4927250">that</span> <span m="4927409">works.</span> </p>
<p><span m="4930430">OK</span> <span m="4931100">so</span> <span m="4938853">armed</span> <span m="4939011">with</span> <span m="4939170">the</span> <span m="4939645">bounds</span> <span m="4940120">table</span> <span m="4940357">stuff</span> <span m="4944894">what</span> <span m="4945350">happens</span> <span m="4945436">if</span> <span m="4945523">we</span> <span m="4945610">have</span> <span m="4945790">a</span> <span m="4945990">C</span> <span m="4946190">code</span> <span m="4947944">that</span> <span m="4948421">looks</span> <span m="4948898">like</span> <span m="4949375">this?</span> <span m="4950806">So</span> <span m="4951283">you</span> <span m="4951760">have</span> <span m="4952237">a</span> <span m="4952714">pointer,</span> <span m="4955110">p-prime,</span> <span m="4956080">you</span> <span m="4956132">derive</span> <span m="4956185">it</span> <span m="4956237">from</span> <span m="4956290">p,</span> <span m="4956870">we</span> <span m="4957220">would</span> <span m="4957570">add</span> <span m="4957970">some</span> <span m="4958330">variable</span> <span m="4958730">i.</span> <span m="4960210">So</span> <span m="4960660">how</span> <span m="4960690">do</span> <span m="4960720">you</span> <span m="4960917">get</span> <span m="4961510">the</span> <span m="4961800">size</span> <span m="4964521">of</span> <span m="4964950">the</span> <span m="4965050">allocation</span> <span m="4965310">belonging</span> <span m="4965940">to</span> <span m="4966050">p?</span> <span m="4967340">Well</span> <span m="4967790">you</span> <span m="4968260">look</span> <span m="4968990">in</span> <span m="4971440">the</span> <span m="4971685">table</span> <span m="4974870">using</span> <span m="4975520">this</span> <span m="4975730">lookup</span> <span m="4976175">here.</span> </p>
<p><span m="4985910">Right,</span> <span m="4986240">so</span> <span m="4986350">the</span> <span m="4986470">size</span> <span m="4987510">of</span> <span m="4987690">the</span> <span m="4987780">data</span> <span m="4988590">that's</span> <span m="4988810">been</span> <span m="4988990">allocated</span> <span m="4989170">to</span> <span m="4989350">p</span> <span m="4989890">is</span> <span m="4990070">going</span> <span m="4990250">to</span> <span m="4990432">be</span> <span m="4990615">equal</span> <span m="4990980">to</span> <span m="4991137">1</span> <span m="4991295">and</span> <span m="4991400">then</span> <span m="4991452">when</span> <span m="4991505">you</span> <span m="4991610">Left</span> <span m="4991910">Shift</span> <span m="4992530">that</span> <span m="4992860">by</span> <span m="4993270">looking</span> <span m="4993535">at</span> <span m="4993667">the</span> <span m="4993800">table,</span> <span m="4994420">taking</span> <span m="4994810">that</span> <span m="4995170">pointer</span> <span m="4995312">value,</span> <span m="4996410">and</span> <span m="4996575">then</span> <span m="4996740">Right</span> <span m="4997140">Shifting</span> <span m="4997360">that</span> <span m="4997475">by</span> <span m="4997590">the</span> <span m="4997705">log</span> <span m="4997820">of</span> <span m="4997960">the</span> <span m="4998100">table</span> <span m="4998460">size.</span> <span m="4999360">Right,</span> <span m="4999730">if</span> <span m="4999818">the</span> <span m="4999906">arithmetic</span> <span m="5000590">works</span> <span m="5000910">out</span> <span m="5001600">because</span> <span m="5002030">of</span> <span m="5002140">the</span> <span m="5002250">way</span> <span m="5002600">that</span> <span m="5002730">we're</span> <span m="5003710">binding</span> <span m="5004385">pointers</span> <span m="5005121">to</span> <span m="5005592">the</span> <span m="5006063">table</span> <span m="5006534">bounds,</span> <span m="5007480">right.</span> <span m="5007730">So</span> <span m="5007800">this</span> <span m="5008040">will</span> <span m="5008220">get</span> <span m="5008480">us--</span> <span m="5009150">this</span> <span m="5009400">thing</span> <span m="5009695">right</span> <span m="5009990">here,</span> <span m="5010230">will</span> <span m="5010575">get</span> <span m="5010920">us</span> <span m="5012620">the</span> <span m="5012955">log</span> <span m="5013290">of</span> <span m="5013430">the</span> <span m="5013510">sides.</span> <span m="5013765">And</span> <span m="5014020">then</span> <span m="5014490">this</span> <span m="5014720">thing</span> <span m="5014950">over</span> <span m="5015160">here</span> <span m="5015690">basically</span> <span m="5016130">expands</span> <span m="5016760">that</span> <span m="5017340">into</span> <span m="5017550">like</span> <span m="5017870">the</span> <span m="5018190">regular</span> <span m="5018460">value,</span> <span m="5019010">right.</span> </p>
<p><span m="5019280">So</span> <span m="5019550">for</span> <span m="5019700">example,</span> <span m="5020430">if</span> <span m="5020690">the</span> <span m="5020750">size</span> <span m="5021080">of</span> <span m="5021245">this</span> <span m="5021410">pointer</span> <span m="5022120">were</span> <span m="5024150">32,</span> <span m="5024690">in</span> <span m="5024840">terms</span> <span m="5024990">of</span> <span m="5025140">bytes</span> <span m="5025415">we've</span> <span m="5025690">allocated,</span> <span m="5026580">right.</span> <span m="5026890">This</span> <span m="5027170">is</span> <span m="5027490">going</span> <span m="5027580">to</span> <span m="5027670">get</span> <span m="5027855">us</span> <span m="5028040">five</span> <span m="5029290">when</span> <span m="5029351">we</span> <span m="5029412">look</span> <span m="5029473">at</span> <span m="5029534">the</span> <span m="5029564">table,</span> <span m="5030295">then</span> <span m="5030492">when</span> <span m="5030690">we</span> <span m="5030965">Left</span> <span m="5031240">Shift</span> <span m="5031610">it</span> <span m="5031730">this</span> <span m="5031930">way,</span> <span m="5032830">Left</span> <span m="5032960">Shift</span> <span m="5033090">the</span> <span m="5033220">one</span> <span m="5033430">this</span> <span m="5033600">way,</span> <span m="5033880">then</span> <span m="5033978">we're</span> <span m="5034076">going</span> <span m="5034174">to</span> <span m="5034272">get</span> <span m="5034370">32</span> <span m="5034740">back</span> <span m="5034910">again</span> <span m="5034995">from</span> <span m="5035080">here.</span> <span m="5037810">OK.</span> </p>
<p><span m="5038680">And</span> <span m="5038870">then</span> <span m="5042040">we</span> <span m="5042360">want</span> <span m="5042610">to</span> <span m="5042770">find</span> <span m="5043510">the</span> <span m="5043770">base</span> <span m="5044005">of</span> <span m="5044240">that</span> <span m="5044555">pointer.</span> <span m="5046738">Take</span> <span m="5047205">a</span> <span m="5047438">pointer</span> <span m="5047672">itself</span> <span m="5050950">and</span> <span m="5051470">then</span> <span m="5054720">we're</span> <span m="5054930">going</span> <span m="5055220">to</span> <span m="5055320">and</span> <span m="5055570">that</span> <span m="5061628">with</span> <span m="5062120">the</span> <span m="5062290">side</span> <span m="5062730">minus</span> <span m="5062950">1.</span> <span m="5064640">Now</span> <span m="5064820">what</span> <span m="5064980">this</span> <span m="5065140">is</span> <span m="5065280">going</span> <span m="5065520">to</span> <span m="5065630">do</span> <span m="5066030">is,</span> <span m="5066190">this</span> <span m="5066245">is</span> <span m="5066300">actually</span> <span m="5066590">going</span> <span m="5066750">to</span> <span m="5066790">give</span> <span m="5067100">us</span> <span m="5067890">a</span> <span m="5068020">mass,</span> <span m="5068430">that</span> <span m="5068500">you</span> <span m="5068571">can</span> <span m="5068641">think</span> <span m="5068712">of</span> <span m="5068782">it.</span> <span m="5069700">And</span> <span m="5069890">that</span> <span m="5070040">mass</span> <span m="5070190">is</span> <span m="5070280">going</span> <span m="5070370">to</span> <span m="5070460">allow</span> <span m="5070920">us</span> <span m="5071480">to</span> <span m="5072286">recover</span> <span m="5072980">the</span> <span m="5073070">base</span> <span m="5073340">here.</span> <span m="5074280">So</span> <span m="5075100">imagine</span> <span m="5076290">that</span> <span m="5076570">your</span> <span m="5076830">size</span> <span m="5077845">equals</span> <span m="5078610">16.</span> <span m="5080100">So</span> <span m="5080380">16</span> <span m="5080830">equals</span> <span m="5085170">this</span> <span m="5089280">in</span> <span m="5089420">binary.</span> <span m="5090060">Right,</span> <span m="5090250">there's</span> <span m="5090420">a</span> <span m="5090460">bunch</span> <span m="5090650">of</span> <span m="5090720">zeros</span> <span m="5091040">off</span> <span m="5091440">this</span> <span m="5091575">way.</span> <span m="5091642">So</span> <span m="5091710">we've</span> <span m="5091910">got</span> <span m="5092030">a</span> <span m="5092150">1</span> <span m="5092440">here,</span> <span m="5092990">we've</span> <span m="5093120">got</span> <span m="5093320">some</span> <span m="5093470">zeros</span> <span m="5093780">over</span> <span m="5094160">here.</span> </p>
<p><span m="5095300">So</span> <span m="5096120">if</span> <span m="5096270">we</span> <span m="5096410">look</span> <span m="5096790">at</span> <span m="5100354">the</span> <span m="5103130">bit-wide</span> <span m="5103720">inverse</span> <span m="5104450">of</span> <span m="5104740">16</span> <span m="5105250">minus</span> <span m="5105600">1,</span> <span m="5107394">then--</span> <span m="5108350">actually</span> <span m="5108620">sorry.</span> <span m="5109070">So</span> <span m="5109126">if</span> <span m="5109183">we</span> <span m="5109240">look</span> <span m="5109570">at</span> <span m="5109890">16</span> <span m="5110060">minus</span> <span m="5110180">1,</span> <span m="5110300">so</span> <span m="5110490">what's</span> <span m="5110990">that</span> <span m="5111086">going</span> <span m="5111182">to</span> <span m="5111278">look</span> <span m="5111374">like?</span> <span m="5112450">60</span> <span m="5112665">minus</span> <span m="5113310">1</span> <span m="5113740">we're</span> <span m="5113902">going</span> <span m="5114064">to</span> <span m="5114226">look</span> <span m="5114712">like</span> <span m="5119090">right,</span> <span m="5119410">something</span> <span m="5119620">like</span> <span m="5119840">this.</span> <span m="5120270">OK.</span> <span m="5121040">And</span> <span m="5121365">if</span> <span m="5121690">we</span> <span m="5123100">take</span> <span m="5123520">the</span> <span m="5123630">inverse</span> <span m="5124120">of</span> <span m="5124260">that</span> <span m="5126540">what</span> <span m="5126645">is</span> <span m="5126750">that</span> <span m="5126980">going</span> <span m="5127095">to</span> <span m="5127211">give</span> <span m="5127327">us?</span> <span m="5132536">Right,</span> <span m="5133000">in</span> <span m="5133200">binary.</span> <span m="5133530">So</span> <span m="5133740">basically</span> <span m="5134540">this</span> <span m="5134660">thing</span> <span m="5135000">here</span> <span m="5135630">allows</span> <span m="5136150">us</span> <span m="5136530">to</span> <span m="5136590">basically</span> <span m="5136940">clear</span> <span m="5137290">the</span> <span m="5137502">bit</span> <span m="5138390">that</span> <span m="5139630">essentially</span> <span m="5139790">would</span> <span m="5139950">be</span> <span m="5140130">offset</span> <span m="5140860">from</span> <span m="5141370">that</span> <span m="5141590">valid</span> <span m="5141890">pointer</span> <span m="5142190">and</span> <span m="5142610">just</span> <span m="5142890">give</span> <span m="5143060">us</span> <span m="5143230">the</span> <span m="5143260">base</span> <span m="5143490">of</span> <span m="5143650">that</span> <span m="5143810">pointer.</span> <span m="5144556">OK.</span> <span m="5146260">And</span> <span m="5146460">so</span> <span m="5147140">once</span> <span m="5147380">we've</span> <span m="5147530">got</span> <span m="5147820">this,</span> <span m="5148280">then</span> <span m="5148510">it's</span> <span m="5148740">very</span> <span m="5148990">simple</span> <span m="5149300">to</span> <span m="5149380">check</span> <span m="5149670">whether</span> <span m="5150060">this</span> <span m="5150210">pointer's</span> <span m="5150360">in</span> <span m="5150510">bounds,</span> <span m="5150810">right.</span> </p>
<p><span m="5151110">So</span> <span m="5151253">we</span> <span m="5151396">can</span> <span m="5151540">basically</span> <span m="5151840">just</span> <span m="5152140">check</span> <span m="5152820">whether</span> <span m="5154300">p-prime</span> <span m="5155360">is</span> <span m="5155500">greater</span> <span m="5155880">than</span> <span m="5156120">or</span> <span m="5156190">equal</span> <span m="5156450">to</span> <span m="5156550">base</span> <span m="5161580">and</span> <span m="5162080">whether</span> <span m="5163510">p-prime</span> <span m="5164990">minus</span> <span m="5166000">the</span> <span m="5166400">base</span> <span m="5171351">is</span> <span m="5171504">less</span> <span m="5171657">than</span> <span m="5172240">size.</span> <span m="5173422">This</span> <span m="5173770">is</span> <span m="5173960">just</span> <span m="5174150">a</span> <span m="5174200">straightforward</span> <span m="5174720">thing</span> <span m="5175210">you</span> <span m="5175353">do,</span> <span m="5175496">right.</span> <span m="5175640">Just</span> <span m="5175730">seeing</span> <span m="5176100">whether</span> <span m="5176760">that</span> <span m="5176980">derived</span> <span m="5177326">pointer</span> <span m="5177672">exists</span> <span m="5178020">within</span> <span m="5178195">the</span> <span m="5178370">bounds</span> <span m="5178675">of</span> <span m="5178751">this</span> <span m="5178827">[INAUDIBLE].</span> <span m="5180255">Right,</span> <span m="5180680">so</span> <span m="5180730">at</span> <span m="5180780">this</span> <span m="5180950">point</span> <span m="5181280">things</span> <span m="5181410">are</span> <span m="5181540">pretty</span> <span m="5181670">straightforward.</span> <span m="5182080">Now</span> <span m="5182340">they</span> <span m="5182560">have</span> <span m="5182960">like</span> <span m="5183110">a</span> <span m="5183260">optimized</span> <span m="5183430">check</span> <span m="5183600">in</span> <span m="5183725">the</span> <span m="5183850">paper,</span> <span m="5184300">I'm</span> <span m="5184373">not</span> <span m="5184446">going</span> <span m="5184520">to</span> <span m="5184610">go</span> <span m="5184690">into</span> <span m="5184770">that</span> <span m="5184910">detail.</span> <span m="5185690">But</span> <span m="5185720">suffice</span> <span m="5185900">it</span> <span m="5186080">to</span> <span m="5186160">say</span> <span m="5186310">that</span> <span m="5186470">all</span> <span m="5186790">the</span> <span m="5187010">binary</span> <span m="5187230">arithmetic,</span> <span m="5187640">it</span> <span m="5188050">resolves</span> <span m="5188325">down</span> <span m="5188416">to</span> <span m="5188508">the</span> <span m="5188600">same</span> <span m="5188835">thing.</span> <span m="5189860">There's</span> <span m="5189955">just</span> <span m="5190050">some</span> <span m="5190470">clever</span> <span m="5190630">tricks</span> <span m="5190960">there</span> <span m="5191380">to</span> <span m="5191670">avoid</span> <span m="5192040">some</span> <span m="5192205">of</span> <span m="5192370">the</span> <span m="5192670">explicit</span> <span m="5192870">calculations</span> <span m="5193341">we</span> <span m="5193498">do</span> <span m="5193655">here.</span> <span m="5195700">That's</span> <span m="5195890">the</span> <span m="5196080">basic</span> <span m="5196385">idea.</span> </p>
<p><span m="5196690">And</span> <span m="5197188">so</span> <span m="5197686">the</span> <span m="5200176">fifth</span> <span m="5200674">trick</span> <span m="5201670">that</span> <span m="5202168">the</span> <span m="5202334">baggy</span> <span m="5202500">bounds</span> <span m="5202666">system</span> <span m="5203662">uses</span> <span m="5209140">is</span> <span m="5209360">that</span> <span m="5209830">it</span> <span m="5210326">uses</span> <span m="5211318">the</span> <span m="5211483">virtual</span> <span m="5211648">memory</span> <span m="5211814">system</span> <span m="5215782">to</span> <span m="5216030">prevent</span> <span m="5219750">out</span> <span m="5219915">of</span> <span m="5220080">bounds</span> <span m="5220246">[INAUDIBLE]</span> <span m="5224214">right.</span> <span m="5224710">So</span> <span m="5225206">the</span> <span m="5225702">idea</span> <span m="5226198">here</span> <span m="5226694">is</span> <span m="5226942">that--</span> <span m="5227190">how</span> <span m="5227355">much</span> <span m="5227520">time</span> <span m="5227543">do</span> <span m="5227567">we</span> <span m="5227591">have</span> <span m="5227614">by</span> <span m="5227638">the</span> <span m="5227662">way?</span> <span m="5228182">Probably like zero?</span> <span m="5229174">So</span> <span m="5229670">the</span> <span m="5229918">basic</span> <span m="5230166">idea</span> <span m="5231200">here</span> <span m="5231700">is</span> <span m="5231860">that</span> <span m="5232125">if</span> <span m="5232390">we</span> <span m="5232490">have</span> <span m="5232940">a</span> <span m="5233420">pointer</span> <span m="5233660">[INAUDIBLE]</span> <span m="5233900">here,</span> <span m="5235340">that</span> <span m="5235680">we</span> <span m="5235835">detect</span> <span m="5235990">is</span> <span m="5236220">out</span> <span m="5236316">of</span> <span m="5236413">bounds,</span> <span m="5236510">what</span> <span m="5236582">we</span> <span m="5236655">can</span> <span m="5236727">do</span> <span m="5237170">is</span> <span m="5237380">actually</span> <span m="5237720">set</span> <span m="5238450">the</span> <span m="5238695">high</span> <span m="5238940">order</span> <span m="5239145">bit</span> <span m="5239950">on</span> <span m="5240065">a</span> <span m="5240180">pointer, right.</span> <span m="5241820">And</span> <span m="5242035">by</span> <span m="5242250">doing</span> <span m="5242530">that</span> <span m="5242900">we</span> <span m="5243270">guarantee</span> <span m="5243600">that</span> <span m="5243930">pointer</span> <span m="5244414">is</span> <span m="5244656">dereferenced,</span> <span m="5246350">then</span> <span m="5246592">the</span> <span m="5246834">caging</span> <span m="5247076">hardware's</span> <span m="5247318">going</span> <span m="5247479">to</span> <span m="5247640">be</span> <span m="5247802">[INAUDIBLE],</span> <span m="5248770">we're</span> <span m="5248891">going</span> <span m="5249012">to</span> <span m="5249133">throw</span> <span m="5249163">a</span> <span m="5249193">hard</span> <span m="5249223">error,</span> <span m="5249740">right.</span> <span m="5250210">Now</span> <span m="5250490">in</span> <span m="5250585">and</span> <span m="5250680">of</span> <span m="5250810">itself,</span> <span m="5251085">just</span> <span m="5251360">setting</span> <span m="5251540">that</span> <span m="5251840">bit</span> <span m="5252140">does</span> <span m="5252440">not</span> <span m="5252740">cause</span> <span m="5253040">a</span> <span m="5253190">problem.</span> <span m="5253940">It's</span> <span m="5254240">only</span> <span m="5254340">when</span> <span m="5254440">you</span> <span m="5254840">dereference</span> <span m="5254990">that</span> <span m="5255140">pointer</span> <span m="5255740">that</span> <span m="5256040">you</span> <span m="5256140">get</span> <span m="5256240">into</span> <span m="5256340">problems.</span> <span m="5257540">OK?</span> </p>
</div>
        <div id="vid_related" itemprop="description" class="tabContent hide">
<h2 class="subhead">Free Downloads</h2>
<h3 class="subsubhead">Video</h3>
<ul>
<li>iTunes U (<a href="https://itunes.apple.com/us/itunes-u/id1017908130">MP4 - 193MB</a>)</li>
<li>Internet Archive (<a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec02_300k.mp4">MP4 - 193MB</a>)</li>
</ul>
<br>
<h3 class="subsubhead">Caption</h3>
<ul>
<li>English-US (<a href="../../../contents/video-lectures/lecture-2-control-hijacking-attacks/r4KjHEgg9Wg.srt">SRT</a>)</li>
</ul>
</div>
    
   </div>  




      					 
        <div class="" id="parent-fieldname-bottom_html_area">
            
            
        </div>
    
               </main><!--Course_inner_media tag close -->
           		</div>
<!--Course_wrapper tag close -->
            </div>
<!--left tag close -->
            <aside id="right">
                <!--Begin Right Portion -->
                    <div>
    



</div>

                	<div>
    



</div>


        <div class="" id="parent-fieldname-rsi_top_html_area">
            
            
        </div>
    

<!-- RSI google ad space-->



<div id="google_ads">    
    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <script type="text/javascript">var googletag = googletag || {}; googletag.cmd = googletag.cmd || [];</script>
    <script type="text/javascript">
googletag.cmd.push(function() {googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_A_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_A_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_B_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_B_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_C_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_C_DL').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
 googletag.enableServices();
});</script>
    <script language="javascript" type="text/javascript">
googletag.cmd.push(function() {googletag.pubads().set("TYPE","HOUSE");googletag.pubads().set("DEPARTMENT","6");googletag.pubads().set("CRS_BEG2","85");googletag.pubads().set("CRS_END","8");googletag.pubads().set("SESSION","F");googletag.pubads().set("YEAR","14");})
</script>
    
    <div id="VIDEO_INDIVIDUAL_SLOT_A_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_A_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_B_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_B_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_C_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_C_DL'); });</script>
    </div>
</div>

<!-- End RSI ads--> 


<div>
    



</div>

            </aside><!--Right div close -->
            <div class="clear"></div>
        </div>
<!--grid tag close -->
      </div>
		
		<footer id="bottom">
			<div id="grid">
				
<div id="portletwrapper-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572" class="portletWrapper kssattr-portlethash-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572">
<div class="portletStaticText portlet-static-site-footer"><div id="footer">
<nav aria-label="Footer">     <nav id="foot-c1" class="grid_2 alpha" aria-labelledby="f-find-courses">       <span class="footer" id="f-find-courses" aria-hidden="true">Find Courses</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Find by Topic</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-number/">Find by Course Number</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-department/">Find by Department</a></li>
    <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights</a></li>
    <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
    <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    <li><a href="https://ocw.mit.edu/courses/translated-courses/">Translated Courses</a></li>
</ul>
</nav>
<div id="foot-c2" class="grid_2"><nav aria-labelledby="f-for-educators">         <span id="f-for-educators" class="footer" aria-hidden="true">For Educators</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
    <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal </a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
    <li><a href="https://openlearning.mit.edu/campus/digital-innovations/" aria-label="External Link: Residential Digital Innovations">Residential Digital Innovations </a></li>
    <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
</ul>
</nav></div>
<nav class="grid_2" id="foot-c3" aria-labelledby="f-donate">       <span id="f-donate" class="footer" aria-hidden="true">Give Now</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
    <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
    <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
    <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
    <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
</ul>
</nav>
<div class="grid_2" id="foot-c4">
<nav aria-labelledby="f-about">         <span id="f-about" class="footer" aria-hidden="true">About</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/about/">About OpenCourseWare</a></li>
    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
    <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
    <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
</ul>
</nav><!--about-->       <nav aria-labelledby="f-tools">         <span id="f-tools" class="footer" aria-hidden="true">Tools</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/help/">Help &amp; FAQs</a></li>
    <li><a href="https://ocw.mit.edu/about/contactus">Contact Us</a></li>
    <li><a href="https://accessibility.mit.edu/" target="_blank">Accessibility</a></li>
    <li><a href="https://ocw.mit.edu/help/site-map/">Site Map</a></li>
    <li><a href="../../../common/terms/index.htm">Privacy &amp; Terms of Use</a></li>
    <li><a href="https://ocw.mit.edu/help/rss/">RSS Feeds</a></li>
</ul>
</nav><!--tools-->
</div>
</nav> <aside style="min-height: 289px;" aria-labelledby="f-our-corporate-supporters" class="grid_4 omega" id="foot-c5">           <span aria-hidden="true" class="footer" id="f-our-corporate-supporters">Our Corporate Supporters</span>           <!-- HOME_CORP_LOGO_1 -->
<div id="div-gpt-ad-1388181177156-0" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-0'); });
            </script></div>
<!-- HOME_CORP_LOGO_2 -->
<div id="div-gpt-ad-1388181177156-1" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-1'); });
            </script></div>
<!-- HOME_CORP_LOGO_3 -->
<div id="div-gpt-ad-1388181177156-2" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-2'); });
            </script></div>
<!-- HOME_CORP_LOGO_4 -->
<div id="div-gpt-ad-1388181177156-3" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-3'); });
            </script></div>
<!-- HOME_CORP_LOGO_5 -->
<div id="div-gpt-ad-1388181177156-4" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-4'); });
              </script></div>
<!-- HOME_CORP_LOGO_6 -->
<div id="div-gpt-ad-1388181177156-5" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-5'); });
              </script></div>
</aside>
<div class="grid_12 alpha omega" itemprop="publisher" itemscope="" itemtype="http://schema.org/CollegeOrUniversity">
<h4 class="footer" style="border-top: thin solid #d5c9ba; padding-top: 10px; margin-bottom: 10px;">About <span itemprop="name">MIT OpenCourseWare</span>
</h4>
<p style="color: #999; font-size: 1em; line-height: 1.5em; margin-top: 10px;" itemprop="description">MIT OpenCourseWare is an online publication of materials from over 2,500 MIT courses, freely sharing knowledge with learners and educators around the world. <a href="https://ocw.mit.edu/about/">Learn more »</a></p>
</div>
<div id="foot-copy" class="grid_12 alpha omega" style="border-top: none;">
<a href="http://web.mit.edu"><img src="../../../common/images/logo_mit.png" alt="Massachusetts Institute of Technology logo and name." style="width: 195; height: 44;"></a><a href="https://openlearning.mit.edu/"><img src="https://ocw.mit.edu/images/mitol_logo.png" alt="MIT Open Learning logo and name." style="width: 265; height: 50; vertical-align: top; padding-left:30px;"></a><a href="https://www.oeglobal.org/"><img src="https://ocw.mit.edu/images/oeg_logo.gif" alt="Open Education Consortium logo." style="width: 219px; height: 59px; vertical-align: top; padding-left:20px;"></a><a rel="license" itemprop="useRightsUrl" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="../../../common/images/cc_by-nc-sa.png" alt="Creative Commons logo with terms BY-NC-SA." style="width: 126px; height: 44px; margin-right: 0; padding-left: 20px;"></a>
<p class="copyright">© 2001–2018<br>
Massachusetts Institute of Technology</p>
<p style="font-size: 0.9em; margin-bottom: 15px;">Your use of the MIT OpenCourseWare site and materials is subject to our <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license">Creative Commons License</a> and other <a href="../../../common/terms/index.htm" rel="cc:morePermissions">terms of use</a>.</p>
</div>
</div></div>

</div>





                
			</div> <!-- bottom grid end -->
		</footer><!-- footer bottom end -->


   </body>
 </html>
