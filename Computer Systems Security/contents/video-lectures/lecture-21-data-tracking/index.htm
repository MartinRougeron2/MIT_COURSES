<!DOCTYPE html><html lang="en">
      
      
        
    
    
    
    

      
      
      <head>
        <meta charset="utf-8">
        <meta name="format-detection" content="telephone=no">  
        
        <title>Lecture 21: Data Tracking | Lecture Videos | Computer Systems Security | Electrical Engineering and Computer Science | MIT OpenCourseWare</title>
    <!-- Begin Automatic Metadata Insertion -->
    <meta content="6-858-computer-systems-security-fall-2014" name="WT.cg_n">
    <meta content="Lecture 21: Data Tracking" name="WT.cg_s">
    <meta content="In this lecture, Professor Mickens discusses the concept of taint tracking, looking at information flow analysis in the context of the Android platform." name="Description">
    <meta content="Zeldovich, Nickolai" name="Author">
    <meta content="6.858,Android,taint tracking,malware,TaintDroid,Computer Design and Engineering,Software Design and Engineering" name="keywords">
    <meta content="6.858 Computer Systems Security | Lecture 21: Data Tracking" name="Search_Display">
    <meta content="Computer Design and Engineering" itemprop="about">
    <meta content="Software Design and Engineering" itemprop="about">
    <!-- End Automatic Metadata Insertion -->

	<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/grid.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/base.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/menu.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.bubblepopup.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/search.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses_new.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.jscrollpane.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/media_tabs.css">
	<link href="../../../common/xml/ocwcc.rdf" type="application/rdf+xml" rel="metadata">
	<link rel="canonical" href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-21-data-tracking/">
	<link rel="apple-touch-icon" href="../../../common/images/apple-touch-icon.png">
	
	
      
	
	<script type="text/javascript" src="../../../common/scripts/jquery.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-media-utils-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/ocw-offline.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.bubblepopup.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery-ui.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/jquery.jscrollpane.min.js"></script>
	<script type="text/javascript" src="../../../common/scripts/expandy.js"></script>
	<script type="text/javascript" src="../../../common/scripts/bubble-popup-offline.js"></script>
	
	
	
    <script type="text/javascript">
      $(document).ready(function() {
        $("#tabs").tabs();
        IpadScroller();
      });
    </script>
    
    
    
    
    
    
      
       
		 

        
        
        

        
        
        
        
        
        
        
        
        
      </head>
    <body itemscope itemtype="http://schema.org/WebPage">
        
	

        <header id="top">
			<div id="grid">
				
				
					
<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572">
<div class="portletStaticText portlet-static-site-header">
<!--googleoff: index-->
<div class="grid_6 alpha" id="banner"><a href="https://ocw.mit.edu/"><img src="../../../common/images/ocw_mast.png" class="logo" alt="MIT OpenCourseWare, Massachusetts Institute of Technology"></a></div>
<div class="grid_6 omega" id="subscribe">
<aside class="module" aria-label="Connect with OCW">
<table class="social">
    <tbody>
        <tr>
            <td class="socialbutton"><a aria-label="Subscribe to the OCW Newsletter" href="https://ocw.mit.edu/subscribe/index.htm?utm_source=header"><img src="../../../common/images/trans.gif" alt="An icon depicting an envelope.">Subscribe to the OCW Newsletter</a></td>
            <td>
<a aria-label="Facebook" href="https://facebook.com/mitocw"><img src="../../../common/images/icon_fb.png" alt="Click to visit our Facebook page."></a>  <a aria-label="Instagram" href="https://www.instagram.com/mitocw/"><img src="https://ocw.mit.edu/images/icon_ig.png" alt="Click to visit our Instagram page."></a> <a aria-label="Twitter" href="https://twitter.com/mitocw"><img src="https://ocw.mit.edu/images/icon_twitter.png" alt="Click to visit our Twitter feed."></a><a aria-label="YouTube" href="https://www.youtube.com/mitocw" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_yt.png" alt="Click to visit our YouTube page."></a><span style="font-size: 12.208px;">   </span><a aria-label="Open Matters blog on WordPress" href="https://www.ocw-openmatters.org/" style="font-size: 12.208px;"><img src="https://ocw.mit.edu/images/icon_wp.png" alt="Click to visit our blog on WordPress."></a>
</td>
        </tr>
    </tbody>
</table>
</aside><nav aria-label="Help Links" class="helplinks">     <a aria-label="OCW Site Help" href="https://ocw.mit.edu/help">Help</a><span aria-hidden="true">|</span>     <a href="../../../common/about/contactus.htm">Contact Us</a>   </nav>
</div>
<div class="clear"> </div>
<!--googleon: index-->
</div>

</div>

<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a6d6567612d6d656e75">
<div class="portletStaticText portlet-static-mega-menu"><div><nav id="mega" class="grid_8 alpha" aria-label="Site">
<ul id="menu" role="presentation">
    <li id="menu_home">
<a href="https://ocw.mit.edu/" aria-label="Homepage"><img src="../../../common/images/top-nav_home.png" class="home_icon" alt="Click for site home page."></a><!-- Begin Home Item -->
</li>
    <!-- End Home Item -->
    <li id="drop_1" aria-label="Find Courses">
<a href="#" aria-hidden="true">FIND COURSES</a><!-- Begin 5 columns Item -->
    <div class="dropdown_5columns-a mega-courses">
    <div class="col_1a">
    <div class="row_1a">
<nav aria-labelledby="mm-find-courses-by">     <span id="mm-find-courses-by" class="nav" aria-hidden="true">Find courses by:</span>
    <ul class="find_by" role="presentation">
        <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Topic</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-number/">MIT Course Number</a></li>
        <li><a href="https://ocw.mit.edu/courses/find-by-department/">Department</a></li>
    </ul>
    </nav>     <nav aria-labelledby="mm-collections">     <span id="mm-collections" class="nav" aria-hidden="true">Collections</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Lectures</a></li>
        <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
        <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
        <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
        <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    </ul>
    </nav>     <nav class="col_1b" aria-labelledby="mm-translated-courses">     <span id="mm-translated-courses" class="nav" aria-hidden="true" style="line-height: 1.3;">Cross-Disciplinary Topic Lists</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/energy-courses">Energy</a></li>
        <li><a href="https://ocw.mit.edu/courses/entrepreneurship">Entrepreneurship</a></li>
        <li><a href="https://ocw.mit.edu/courses/environment-courses">Environment</a></li>
        <li><a href="https://ocw.mit.edu/courses/intro-programming">Introductory Programming</a></li>
        <li><a href="https://ocw.mit.edu/courses/life-sciences">Life Sciences</a></li>
        <li><a href="https://ocw.mit.edu/courses/transportation-courses">Transportation</a></li>
    </ul>
    </nav>
</div>
    <div class="row_1b"><nav aria-labelledby="mm-cross-disciplinary-topic-lists">     <span id="mm-cross-disciplinary-topic-lists" class="nav" aria-hidden="true">Translated Courses</span>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/translated-courses/traditional-chinese" aria-label="Traditional Chinese">繁體字 / Traditional Chinese</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/turkish" aria-label="Turkish">Türkçe / Turkish</a></li>
        <li><a href="https://ocw.mit.edu/courses/translated-courses/korean" aria-label="Korean">(비디오)한국 / Korean</a></li>
    </ul>
    </nav></div>
    </div>
    </div>
    </li>
    <li id="drop_2">
<a href="#" aria-label="For Educators">For Educators</a>
    <div class="dropdown_1column-a" style="width: 270px;"><nav aria-labelledby="mm-find-courses-by">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/chalk-radio-podcast">Chalk Radio Podcast</a></li>
        <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
        <li><a href="https://openlearning.mit.edu/campus/digital-innovations/">Residential Digital Innovations </a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    </ul>
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_3">
<a href="#" aria-hidden="true">Give Now</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="Donate">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
        <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
        <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
        <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
        <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
    </ul>
    </nav></div>
    </li>
    <li id="drop_4">
<a href="#" aria-hidden="true">About</a>
    <div class="dropdown_1column-a"><nav class="col_1" aria-label="About">
    <ul role="presentation">
        <li><a href="https://ocw.mit.edu/about/">About MIT OpenCourseWare</a></li>
        <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
        <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
        <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
        <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
        <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
    </ul>
    </nav></div>
    </li>
</ul>
</nav></div></div>

</div>





<!--googleoff: index-->
<script>
  (function() {
	var cx = '012626166551961672889:owjdpuboktq';
	var gcse = document.createElement('script');
	gcse.type = 'text/javascript';
	gcse.async = true;
	gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(gcse, s);
  })();
  window.onload = function(){
	document.getElementById('gsc-i-id1').placeholder = 'Search';	
  };

$(document).ready(function(){

$('.advanceSearch a').keydown(function(event){showSearchTips($(this),event);})
$('#searchTipsModal').keydown(function(event){showSearchTips($(this),event);})

function showSearchTips(obj,evt) {
// if pressed enter key
	if ( evt.which == 13 || evt.which == 32) {
		showModal();
		ga('send', 'pageview', "AdvanceSearch");
		$(".advanceSearch a").attr('aria-expanded', 'true');
		$('.searchTipsModal').focus();
		evt.preventDefault();
		}
	if ( evt.which == 27 ) {
		hideModal();
		$(".advanceSearch a").attr('aria-expanded', 'false');
		var modal = document.getElementById('searchTipsModal');
		modal.style.display = "none";
		$(".advanceSearch a").focus();
		evt.preventDefault();
		}
}

});
function showModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "block";
	ga('send', 'pageview', "AdvanceSearch");
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", true);
	window.setTimeout(function () {
    document.getElementById('searchTipsModal').focus(); }, 0);
}

function hideModal(){
	var modal = document.getElementById('searchTipsModal');
	modal.style.display = "none";
	document.getElementById("searchTipsBtn").setAttribute("aria-expanded", false);
}
</script>
<div id="search" role="search" class="grid_4 omega">
    	<table class="search">
				<tbody>
					<tr>
						<td><div class="searchboxheader"><searchbox-only resultsurl="/search/ocwsearch.htm"></searchbox-only></div></td>
						<td>
							<div class="advanceSearch">
								<a id="searchTipsBtn" onclick="showModal();" href="#" role="button" aria-label="search tips" aria-expanded="false" aria-describedby="searchtips">Search Tips</a>

								<!-- The Modal -->
								<div id="searchTipsModal" class="modal" tabindex="-1">
								  <!-- Modal content -->
									<div class="modal-content">
										<div class="modal-body">
											<button class="close" onclick="hideModal();" aria-label="close">X</button>
											<span>
												<b>Exclude words from your search</b>
												<br>Put - in front of a word you want to leave out. For example, jaguar speed -car
												<br><br>
												<b>Search for an exact match</b>
												<br>Put a word or phrase inside quotes. For example, "tallest building".
												<br><br>
												<b>Search for wildcards or unknown words</b>
												<br>Put a * in your word or phrase where you want to leave a placeholder. For example, "largest * in the world".
												<br><br>
												<b>Search within a range of numbers</b>
												<br>Put .. between two numbers. For example, camera $50..$100.
												<br><br>
												<b>Combine searches</b>
												<br>Put "OR" between each search query. For example,  marathon OR race.
												<br><br>
											</span>
										</div>
								  </div>
								</div>
							</div>
						</td>
					</tr>
				</tbody>
		</table>
</div>
<div class="clear"></div>
<!--googleon: index-->
<!-- *end header* -->

				
				
			</div>
<!-- top grid end -->
		</header><!-- top end -->
			
		<div id="center_media">
      	<div id="grid">
      		<div id="left">
        		<nav id="breadcrumb_media" aria-label="Breadcrumb">
                	<p>

    <a href="https://ocw.mit.edu/">Home</a>
    
        »
        
    
    
        
            <a href="https://ocw.mit.edu/courses">Courses</a>
            
                »
                
            
            
         
    
    
        
            <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science">Electrical Engineering and Computer Science</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/index.htm">Computer Systems Security</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/video-lectures/index.htm">Lecture Videos</a>
            
                »
                
            
            
         
    
    
        
            
            
            Lecture 21: Data Tracking
         
    
</p>

            	</nav>
            	<div class="clear"></div>
        		<div id="media_title">
        		<h1 class="title" itemprop="name" property="dct:title">
        <span class="" id="parent-fieldname-title">
            Lecture 21: Data Tracking
        </span>
    </h1>
        		</div>
           		<div class="clear"></div>
           		<div id="course_wrapper_media">
           			<nav id="course_nav" aria-label="Course">
           				<script language="javascript" type="text/javascript">
function toggleMenu(objID) {
  if (!document.getElementById) return;
  var ob = document.getElementById(objID);
  ob.className = (ob.className == 'selected')?'': 'selected';
}
function toggleClass(id)
{
  var divtoggleClass= document.getElementById(id);
  divtoggleClass.className = (divtoggleClass.className == 'mO')?'mC': 'mO';
  return false;
}
function changeAlt(id)
{
  id.alt = (id.alt == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
  id.title = (id.title == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
}
</script>
<!--Left Nav Starts -->


	<ul>			  
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/index.htm">
		                  Course Home  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/syllabus/index.htm">
		                  Syllabus  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/calendar/index.htm">
		                  Calendar  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/readings/index.htm">
		                  Readings  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/lecture-notes/index.htm">
		                  Lecture Notes  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="selected">
			   			<a href="../../../contents/video-lectures/index.htm">
		                  Lecture Videos  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/labs/index.htm">
		                  Labs  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/exams/index.htm">
		                  Exams  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/final-project/index.htm">
		                  Final Project  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/related-resources/index.htm">
		                  Related Resources  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    
		    
         	
	<!--second tal block close-->  
	
</ul>


<!--Left Nav Ends -->





           			</nav>
           			<main id="course_inner_media" aria-labelledby="media_title">
      					 
        <div class="" id="parent-fieldname-text">
            
            
        </div>
    
      					     
    
    



<script type="text/javascript">var caption_embed_1 ={'English - US': '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-21-data-tracking/WG5UbMrUiLU.srt'}</script>     
     <div id="media-embed">
         <div class="attention_message" id="embed_1">
<p>Flash and JavaScript are required for this feature.</p>
<p>Download the video from <a href="https://itunes.apple.com/us/itunes-u/id1017908130">iTunes U</a> or the <a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec21_300k.mp4">Internet Archive</a>.</p>
</div>
     </div>
    
     <script type="text/javascript">ocw_embed_chapter_media('embed_1', 'https://www.youtube.com/v/WG5UbMrUiLU', 'youtube', '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-21-data-tracking', 'https://img.youtube.com/vi/WG5UbMrUiLU/0.jpg',0,0, 'https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-21-data-tracking/WG5UbMrUiLU.srt')</script>
	 
	 
	 		
	 		<div id="transcript1"></div>
				 <script type="text/javascript">createThreePlayParams(2, 662964, "embed_1", 0, 0)</script>
			 
	

     <div id="media_resource_next_prev_nav" style="margin-top: 1em;">
        <p>
        
            <a href="../../../contents/video-lectures/lecture-20-mobile-phone-security/index.htm">
                <img src="../../../common/images/btn_previous_resource.png" style="margin: 0 30px 0 50px;" alt="Previous track" title="Previous track"></a>
     	
     	
        
            <a href="../../../contents/video-lectures/lecture-22-guest-lecture-by-mit-is-t/index.htm"> 
                <img src="../../../common/images/btn_next_resource.png" alt="Next track" title="Next track"></a>
       
       </p>
     </div>
 


<script type="text/javascript">
		window.onload=function(){
		init();
		
		}
		var tabLinks = new Array();
		var contentDivs = new Array();
		function init() {
		  // Grab the tab links and content divs from the page
		  var tabListItems = document.getElementById('tabs').childNodes;
		  for ( var i = 0; i < tabListItems.length; i++ ) {
			if ( tabListItems[i].nodeName == "LI" ) {
			  var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
			  var id = getHash( tabLink.getAttribute('href') );
			  tabLinks[id] = tabLink;
			  contentDivs[id] = document.getElementById( id );
			}
		  }
		  // Assign onclick events to the tab links, and
		  // highlight the first tab
		  var i = 0;
		  for ( var id in tabLinks ) {
			tabLinks[id].onclick = showTab;
			tabLinks[id].onfocus = function() { this.blur() };
			if ( i == 0 ) tabLinks[id].className = 'selected';
			i++;
		  }
		  // Hide all content divs except the first
		  var i = 0;
		  for ( var id in contentDivs ) {
			if ( i != 0 ) contentDivs[id].className = 'tabContent hide';
			i++;
		  }
		}
		function showTab() {
		  var selectedId = getHash( this.getAttribute('href') );
		  // Highlight the selected tab, and dim all others.
		  // Also show the selected content div, and hide all others.
		  for ( var id in contentDivs ) {
			if ( id == selectedId ) {
			  tabLinks[id].className = 'selected';
			  contentDivs[id].className = 'tabContent';
			} else {
			  tabLinks[id].className = '';
			  contentDivs[id].className = 'tabContent hide';
			}
		  }
		  // Stop the browser following the link
		  return false;
		}
		function getFirstChildWithTagName( element, tagName ) {
		  for ( var i = 0; i < element.childNodes.length; i++ ) {
			if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
		  }
		}
		function getHash( url ) {
		  var hashPos = url.lastIndexOf ( '#' );
		  return url.substring( hashPos + 1 );
		}
 </script>	
 

  <div id="media_tabs">
     
        <ul id="tabs">
            <li class="first">
                <a href="#vid_about" class="selected">About this Video</a>
            </li>
            <li class="">
                <a href="#vid_index" class="">Playlist</a>
            </li>
            <li class="">
                <a href="#vid_playlist" class="">Transcript</a>
            </li>
            <li class="">
                <a href="#vid_related" class="">Download this Video</a>
            </li>
        </ul>
   
        <div id="vid_about" itemprop="description" class="tabContent">
<p><strong>Description:</strong> In this lecture, Professor Mickens discusses the concept of taint tracking, looking at information flow analysis in the context of the Android platform.</p>  <p><strong>Instructor:</strong> James Mickens</p>
</div>
        <div id="vid_index" itemprop="description" class="tabContent hide">
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-1-introduction-threat-models/index.htm">
<img src="https://img.youtube.com/vi/GqmQg-cszw4/default.jpg" title="Lecture 1: Introduction, Threat Models" alt="Lecture 1: Introduction, Threat Models">
<p>Lecture 1: Introduction, Th...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-2-control-hijacking-attacks/index.htm">
<img src="https://img.youtube.com/vi/r4KjHEgg9Wg/default.jpg" title="Lecture 2: Control Hijacking Attacks" alt="Lecture 2: Control Hijacking Attacks">
<p>Lecture 2: Control Hijackin...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-3-buffer-overflow-exploits-and-defenses/index.htm">
<img src="https://img.youtube.com/vi/xSQxaie_h1o/default.jpg" title="Lecture 3: Buffer Overflow Exploits and Defenses" alt="Lecture 3: Buffer Overflow Exploits and Defenses">
<p>Lecture 3: Buffer Overflow ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-4-privilege-separation/index.htm">
<img src="https://img.youtube.com/vi/dNl22h1kW1k/default.jpg" title="Lecture 4: Privilege Separation" alt="Lecture 4: Privilege Separation">
<p>Lecture 4: Privilege Separa...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-6-capabilities/index.htm">
<img src="https://img.youtube.com/vi/TQhmua7Z2cY/default.jpg" title="Lecture 6: Capabilities" alt="Lecture 6: Capabilities">
<p>Lecture 6: Capabilities</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-7-sandboxing-native-code/index.htm">
<img src="https://img.youtube.com/vi/I0Psvvky-44/default.jpg" title="Lecture 7: Sandboxing Native Code	" alt="Lecture 7: Sandboxing Native Code	">
<p>Lecture 7: Sandboxing Nativ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-8-web-security-model/index.htm">
<img src="https://img.youtube.com/vi/eRJ_r8WF1Y0/default.jpg" title="Lecture 8: Web Security Model" alt="Lecture 8: Web Security Model">
<p>Lecture 8: Web Security Model</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-9-securing-web-applications/index.htm">
<img src="https://img.youtube.com/vi/WlmKwIe9z1Q/default.jpg" title="Lecture 9: Securing Web Applications" alt="Lecture 9: Securing Web Applications">
<p>Lecture 9: Securing Web App...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-10-symbolic-execution/index.htm">
<img src="https://img.youtube.com/vi/yRVZPvHYHzw/default.jpg" title="Lecture 10: Symbolic Execution" alt="Lecture 10: Symbolic Execution">
<p>Lecture 10: Symbolic Execution</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-11-ur-web/index.htm">
<img src="https://img.youtube.com/vi/XMEFdofERLI/default.jpg" title="Lecture 11: Ur/Web" alt="Lecture 11: Ur/Web">
<p>Lecture 11: Ur/Web</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-12-network-security/index.htm">
<img src="https://img.youtube.com/vi/BZTWXl9QNK8/default.jpg" title="Lecture 12: Network Security" alt="Lecture 12: Network Security">
<p>Lecture 12: Network Security</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-13-network-protocols/index.htm">
<img src="https://img.youtube.com/vi/QOtA76ga_fY/default.jpg" title="Lecture 13: Network Protocols" alt="Lecture 13: Network Protocols">
<p>Lecture 13: Network Protocols</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-14-ssl-and-https/index.htm">
<img src="https://img.youtube.com/vi/q1OF_0ICt9A/default.jpg" title="Lecture 14: SSL and HTTPS" alt="Lecture 14: SSL and HTTPS">
<p>Lecture 14: SSL and HTTPS</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-15-medical-software/index.htm">
<img src="https://img.youtube.com/vi/bA3xCpYLA34/default.jpg" title="Lecture 15: Medical Software" alt="Lecture 15: Medical Software">
<p>Lecture 15: Medical Software</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-16-side-channel-attacks/index.htm">
<img src="https://img.youtube.com/vi/3v5Von-oNUg/default.jpg" title="Lecture 16: Side-Channel Attacks" alt="Lecture 16: Side-Channel Attacks">
<p>Lecture 16: Side-Channel At...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-17-user-authentication/index.htm">
<img src="https://img.youtube.com/vi/MT7X17ZRo1U/default.jpg" title="Lecture 17: User Authentication" alt="Lecture 17: User Authentication">
<p>Lecture 17: User Authentica...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-18-private-browsing/index.htm">
<img src="https://img.youtube.com/vi/YTWXAFJf8bw/default.jpg" title="Lecture 18: Private Browsing" alt="Lecture 18: Private Browsing">
<p>Lecture 18: Private Browsing</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-19-anonymous-communication/index.htm">
<img src="https://img.youtube.com/vi/OgGTJIgNewE/default.jpg" title="Lecture 19: Anonymous Communication" alt="Lecture 19: Anonymous Communication">
<p>Lecture 19: Anonymous Commu...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-20-mobile-phone-security/index.htm">
<img src="https://img.youtube.com/vi/uT7BXusDgDM/default.jpg" title="Lecture 20: Mobile Phone Security" alt="Lecture 20: Mobile Phone Security">
<p>Lecture 20: Mobile Phone Se...</p></a>
</div>
<div class="related-media-thumbnail-nolink">
<div class="now-playing-resource">Now Playing</div>
<img src="https://img.youtube.com/vi/WG5UbMrUiLU/default.jpg" title="Lecture 21: Data Tracking" alt="Lecture 21: Data Tracking">
<p>Lecture 21: Data Tracking</p>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-22-guest-lecture-by-mit-is-t/index.htm">
<img src="https://img.youtube.com/vi/2PO8h1pVW50/default.jpg" title="Lecture 22: Guest Lecture by MIT IS&amp;T" alt="Lecture 22: Guest Lecture by MIT IS&amp;T">
<p>Lecture 22: Guest Lecture b...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-23-security-economics/index.htm">
<img src="https://img.youtube.com/vi/8PdnOZI7H5E/default.jpg" title="Lecture 23: Security Economics" alt="Lecture 23: Security Economics">
<p>Lecture 23: Security Economics</p></a>
</div>
</div>
        <div id="vid_playlist" itemprop="description" class="tabContent hide">
<ul><li><a class="transcript-link" title="Open in a new window." alt="Open in a new window." style="text-decoration: none; font-size: 1.0em;" target="_blank" text-decoration: none font-size: href="../../../contents/video-lectures/lecture-21-data-tracking/WG5UbMrUiLU.pdf"> Download English-US transcript (PDF)</a></li></ul>
<p><span m="80">The</span> <span m="170">following</span> <span m="610">content</span> <span m="1120">is</span> <span m="1230">provided</span> <span m="1670">under</span> <span m="1940">a</span> <span m="1980">Creative</span> <span m="2430">Commons</span> <span m="2830">license.</span> <span m="3810">Your</span> <span m="3910">support</span> <span m="4420">will</span> <span m="4560">help</span> <span m="4820">MIT</span> <span m="5310">OpenCourseWare</span> <span m="6050">continue</span> <span m="6540">to</span> <span m="6680">offer</span> <span m="7000">high</span> <span m="7210">quality</span> <span m="7720">educational</span> <span m="8370">resources</span> <span m="8940">for</span> <span m="9080">free.</span> <span m="10150">To</span> <span m="10250">make</span> <span m="10340">a</span> <span m="10400">donation</span> <span m="11090">or</span> <span m="11340">to</span> <span m="11450">view</span> <span m="11660">additional</span> <span m="12070">materials</span> <span m="12690">from</span> <span m="12860">hundreds</span> <span m="13190">of</span> <span m="13300">MIT</span> <span m="13680">courses,</span> <span m="15000">visit</span> <span m="15160">MIT</span> <span m="15690">OpenCourseWare</span> <span m="16600">at</span> <span m="16830">ocw.mit.edu.</span> </p>
<p><span m="25732">PROFESSOR:</span> <span m="26216">All right,</span> <span m="26700">let's</span> <span m="26940">get</span> <span m="27750">started.</span> <span m="28210">Thank</span> <span m="28400">you</span> <span m="28510">for</span> <span m="28630">showing</span> <span m="29010">up</span> <span m="29140">to</span> <span m="29260">this</span> <span m="29590">very</span> <span m="29820">special</span> <span m="30370">pre-Thanksgiving</span> <span m="31510">lecture.</span> <span m="32619">I'm</span> <span m="32700">glad</span> <span m="33120">you</span> <span m="33240">guys</span> <span m="33490">have</span> <span m="33670">such</span> <span m="34140">devotion</span> <span m="34970">to</span> <span m="35070">security,</span> <span m="35570">I'm</span> <span m="35660">sure</span> <span m="35860">that you will</span> <span m="36140">be</span> <span m="36260">rewarded</span> <span m="36970">on</span> <span m="37170">the</span> <span m="37240">job</span> <span m="37500">market</span> <span m="37790">at</span> <span m="37850">some</span> <span m="38030">point.</span> <span m="38260">Feel</span> <span m="38410">free</span> <span m="38600">to</span> <span m="38820">list me as a</span> <span m="39030">recommendation.</span> <span m="40340">So</span> <span m="40940">today</span> <span m="41240">we're</span> <span m="41410">going</span> <span m="41620">to</span> <span m="41700">talk</span> <span m="42120">about</span> <span m="42550">taint</span> <span m="43000">tracking,</span> <span m="43450">and</span> <span m="43660">in</span> <span m="43890">particular</span> <span m="44170">we're going to</span> <span m="44250">look</span> <span m="44450">at</span> <span m="44510">a</span> <span m="44560">system</span> <span m="44940">called</span> <span m="45210">TaintDroid</span> <span m="46000">that</span> <span m="46150">looks</span> <span m="46510">at</span> <span m="46680">how</span> <span m="46860">to</span> <span m="46980">do</span> <span m="47130">this</span> <span m="47270">type</span> <span m="47410">of</span> <span m="47500">information</span> <span m="47950">flow</span> <span m="48220">analysis</span> <span m="48960">in</span> <span m="49080">the</span> <span m="49170">context</span> <span m="50190">of</span> <span m="50440">Android</span> <span m="50870">smartphones.</span> </p>
<p><span m="51930">And</span> <span m="52150">so</span> <span m="52380">the</span> <span m="52480">basic</span> <span m="52830">problem</span> <span m="54080">the paper</span> <span m="54300">deals</span> <span m="54590">with</span> <span m="54970">is</span> <span m="55070">this</span> <span m="55200">fact</span> <span m="55430">that</span> <span m="55600">apps</span> <span m="55945">can</span> <span m="56290">exfiltrate</span> <span m="56930">data.</span> <span m="57190">So</span> <span m="57320">the</span> <span m="57380">basic</span> <span m="57650">idea</span> <span m="57910">is</span> <span m="57970">that</span> <span m="58060">your</span> <span m="58180">phone</span> <span m="58940">contains</span> <span m="59420">a</span> <span m="59500">lot</span> <span m="60130">of</span> <span m="60220">sensitive</span> <span m="60610">information,</span> <span m="61460">right.</span> <span m="61670">It contains</span> <span m="62500">your</span> <span m="62680">contacts</span> <span m="63300">list</span> <span m="63700">and</span> <span m="63800">your phone</span> <span m="64190">number</span> <span m="65060">and your</span> <span m="65239">email</span> <span m="65519">and</span> <span m="65800">all that</span> <span m="65870">kind</span> <span m="66020">of</span> <span m="66090">stuff.</span> <span m="66920">So</span> <span m="68290">if</span> <span m="68590">the</span> <span m="69170">operating</span> <span m="69610">system</span> <span m="70110">or</span> <span m="70460">the</span> <span m="70580">phone</span> <span m="70830">itself</span> <span m="71180">isn't</span> <span m="71370">careful,</span> <span m="72070">then</span> <span m="72620">a</span> <span m="73040">malicious</span> <span m="73570">app</span> <span m="73810">might</span> <span m="73950">be</span> <span m="74030">able</span> <span m="74180">to</span> <span m="74280">take</span> <span m="74550">some of that</span> <span m="74680">information</span> <span m="75670">and</span> <span m="75880">send</span> <span m="76120">it</span> <span m="76220">back</span> <span m="77030">to</span> <span m="77500">its</span> <span m="77930">home</span> <span m="78180">server,</span> <span m="78750">and</span> <span m="79080">that</span> <span m="79180">server</span> <span m="79480">can</span> <span m="79600">use</span> <span m="79780">it</span> <span m="79890">for</span> <span m="80000">all</span> <span m="80110">types</span> <span m="80350">of</span> <span m="80480">nefarious</span> <span m="80880">things</span> <span m="81170">as</span> <span m="81280">we'll</span> <span m="81380">talk</span> <span m="81610">about</span> <span m="81830">later.</span> </p>
<p><span m="83810">The</span> <span m="84440">high-level</span> <span m="84900">solution</span> <span m="86000">that</span> <span m="86310">the</span> <span m="86580">TaintDroid</span> <span m="87530">paper</span> <span m="89130">suggests</span> <span m="89900">is</span> <span m="90250">that</span> <span m="90420">we</span> <span m="90550">should</span> <span m="91060">basically</span> <span m="91760">track</span> <span m="93000">the</span> <span m="93270">sensitive</span> <span m="93780">data</span> <span m="94910">as</span> <span m="95190">it</span> <span m="95320">flows</span> <span m="95670">through</span> <span m="95770">the</span> <span m="95870">system,</span> <span m="96890">and</span> <span m="97100">essentially,</span> <span m="97800">we</span> <span m="97940">need</span> <span m="98210">to</span> <span m="98320">stop</span> <span m="98820">it</span> <span m="100290">from</span> <span m="100440">going</span> <span m="100710">over</span> <span m="100900">the</span> <span m="101010">network.</span> <span m="102980">In</span> <span m="103072">other</span> <span m="103165">words,</span> <span m="103257">we</span> <span m="103350">need</span> <span m="103490">to</span> <span m="103570">stop</span> <span m="103960">it</span> <span m="104170">from</span> <span m="104810">being</span> <span m="105020">passed</span> <span m="107000">as</span> <span m="107160">an</span> <span m="107250">argument</span> <span m="108290">to</span> <span m="108890">networking</span> <span m="109630">system</span> <span m="109990">calls.</span> <span m="114260">And</span> <span m="114490">so</span> <span m="114690">presumably,</span> <span m="115250">if</span> <span m="115380">we</span> <span m="115490">can</span> <span m="115640">do</span> <span m="115810">that,</span> <span m="116400">then</span> <span m="116560">we</span> <span m="116700">can</span> <span m="116820">essentially</span> <span m="117330">stop</span> <span m="117800">the</span> <span m="117880">leak</span> <span m="118480">right</span> <span m="118780">at</span> <span m="118850">the</span> <span m="118920">moment</span> <span m="119230">that it's</span> <span m="119430">about</span> <span m="119690">to</span> <span m="119750">happen.</span> </p>
<p><span m="120940">So</span> <span m="121260">you</span> <span m="121380">might</span> <span m="121560">think to</span> <span m="121720">yourself,</span> <span m="122050">so</span> <span m="122220">why</span> <span m="122660">are</span> <span m="123660">traditional</span> <span m="124300">Android</span> <span m="124710">permissions</span> <span m="125470">insufficient</span> <span m="126430">to</span> <span m="126710">stop</span> <span m="127060">these</span> <span m="127270">types</span> <span m="127750">of</span> <span m="128100">data</span> <span m="128430">exfiltrations?</span> <span m="129770">And</span> <span m="130070">the</span> <span m="130169">reason</span> <span m="130539">is</span> <span m="130699">that</span> <span m="131060">these</span> <span m="131250">permissions</span> <span m="131820">don't</span> <span m="132070">really</span> <span m="132660">have</span> <span m="132870">the</span> <span m="132960">appropriate</span> <span m="133420">grammar</span> <span m="133870">to</span> <span m="133960">talk</span> <span m="134310">about</span> <span m="134790">the</span> <span m="134870">type</span> <span m="135050">of</span> <span m="135160">attack</span> <span m="135500">that we're</span> <span m="135690">trying</span> <span m="135900">to</span> <span m="135960">prevent.</span> <span m="136660">So</span> <span m="136740">a</span> <span m="136770">lot</span> <span m="136950">of</span> <span m="137010">times</span> <span m="137330">these</span> <span m="137670">Android</span> <span m="137970">permissions,</span> <span m="138380">they</span> <span m="138490">deal</span> <span m="138790">with</span> <span m="139320">these</span> <span m="139530">things</span> <span m="139810">like</span> <span m="140070">can an</span> <span m="140350">application</span> <span m="141400">read</span> <span m="141610">or</span> <span m="141720">write</span> <span m="142010">to a</span> <span m="142050">particular</span> <span m="142450">device.</span> <span m="143550">But</span> <span m="143650">we're</span> <span m="143810">talking</span> <span m="144110">about</span> <span m="144300">something</span> <span m="144940">at</span> <span m="145200">a</span> <span m="145400">sort</span> <span m="145550">of</span> <span m="145670">different</span> <span m="146340">level of</span> <span m="146770">semantics.</span> <span m="147570">We're</span> <span m="147760">saying</span> <span m="148100">even</span> <span m="148440">if</span> <span m="148540">an</span> <span m="148670">application</span> <span m="149360">has</span> <span m="150080">been</span> <span m="150220">granted</span> <span m="150620">the</span> <span m="150740">authority</span> <span m="151490">to</span> <span m="151690">read</span> <span m="151880">or</span> <span m="151970">write</span> <span m="152510">a</span> <span m="152580">particular</span> <span m="152920">device,</span> <span m="153330">like</span> <span m="153450">the</span> <span m="153540">network,</span> <span m="153930">for</span> <span m="154070">example,</span> <span m="155250">it</span> <span m="155410">still</span> <span m="155830">might</span> <span m="156080">not</span> <span m="156960">be</span> <span m="157100">good</span> <span m="157450">to</span> <span m="157630">allow</span> <span m="157920">that</span> <span m="158060">application</span> <span m="159010">to</span> <span m="159340">read</span> <span m="159600">or</span> <span m="159720">write</span> <span m="160100">certain</span> <span m="160500">sensitive</span> <span m="161060">data</span> <span m="161820">over</span> <span m="162120">that</span> <span m="162290">device</span> <span m="162660">to</span> <span m="162740">which</span> <span m="162920">it</span> <span m="163000">has</span> <span m="163210">permissions.</span> </p>
<p><span m="164890">In</span> <span m="164960">other</span> <span m="165090">words,</span> <span m="165640">using</span> <span m="165750">these</span> <span m="165930">traditional</span> <span m="166290">Android</span> <span m="167580">security</span> <span m="168060">policies,</span> <span m="168660">it is</span> <span m="168810">difficult</span> <span m="169170">to</span> <span m="169260">speak</span> <span m="169690">about</span> <span m="169930">specific</span> <span m="170540">types</span> <span m="170910">of</span> <span m="171040">data.</span> <span m="172030">It's much</span> <span m="172140">easier</span> <span m="172520">to</span> <span m="172560">talk</span> <span m="172830">about</span> <span m="173050">whether</span> <span m="173260">an</span> <span m="173490">application</span> <span m="174210">accesses</span> <span m="174580">a device</span> <span m="175010">or not.</span> <span m="175620">So</span> <span m="177100">you</span> <span m="177290">might think,</span> <span m="177490">all</span> <span m="177620">right,</span> <span m="177950">so</span> <span m="179360">that's</span> <span m="179580">kind</span> <span m="179740">of</span> <span m="179840">a</span> <span m="179900">bummer,</span> <span m="180490">but</span> <span m="180710">maybe</span> <span m="181180">we can solve</span> <span m="181470">this</span> <span m="181610">problem</span> <span m="182870">by--</span> <span m="184960">we have</span> <span m="185250">this</span> <span m="185450">alternate</span> <span m="185920">solution,</span> <span m="186760">so we'll</span> <span m="187015">call this</span> <span m="187270">solution</span> <span m="187870">star.</span> <span m="188600">So</span> <span m="188910">maybe</span> <span m="189290">we</span> <span m="189440">can</span> <span m="189640">just</span> <span m="190460">never</span> <span m="190820">install</span> <span m="191410">applications</span> <span m="195401">that</span> <span m="195870">can</span> <span m="196120">do</span> <span m="197940">reads</span> <span m="198410">of</span> <span m="198500">sensitive</span> <span m="198920">data</span> <span m="201410">and</span> <span m="201800">also</span> <span m="203130">have</span> <span m="203940">network</span> <span m="204320">access.</span> </p>
<p><span m="207660">At first</span> <span m="207930">glance,</span> <span m="208180">that</span> <span m="208350">seems</span> <span m="208550">to</span> <span m="208630">solve</span> <span m="208890">the</span> <span m="208970">problem.</span> <span m="209890">Because</span> <span m="210200">if</span> <span m="210270">it</span> <span m="210570">can't do</span> <span m="210690">both</span> <span m="211000">of</span> <span m="211050">these</span> <span m="211230">things,</span> <span m="211430">it</span> <span m="211660">either</span> <span m="211860">can't</span> <span m="211990">get to the</span> <span m="212160">sensitive</span> <span m="212400">data</span> <span m="212700">in the first</span> <span m="212950">place,</span> <span m="213390">or</span> <span m="213640">it</span> <span m="213710">can,</span> <span m="213990">but</span> <span m="214110">it</span> <span m="214190">can't</span> <span m="214430">send</span> <span m="214670">it</span> <span m="215360">anywhere.</span> <span m="216080">So</span> <span m="216830">does anyone</span> <span m="216980">have any</span> <span m="217090">ideas</span> <span m="217570">where this</span> <span m="217740">probably</span> <span m="218020">isn't</span> <span m="218170">going</span> <span m="218250">to</span> <span m="218300">work</span> <span m="218480">out</span> <span m="218610">very</span> <span m="218780">well?</span> <span m="222380">Everyone's</span> <span m="222710">already</span> <span m="222980">thinking</span> <span m="223200">about</span> <span m="223420">turkey.</span> <span m="223960">I</span> <span m="224050">can</span> <span m="224200">see</span> <span m="224410">in</span> <span m="224540">your</span> <span m="224740">eyes.</span> </p>
<p><span m="226760">The</span> <span m="227175">main</span> <span m="227590">reason why</span> <span m="227910">this</span> <span m="228170">is</span> <span m="228300">probably</span> <span m="229230">a</span> <span m="229430">bad</span> <span m="229760">idea</span> <span m="230500">is</span> <span m="230730">that</span> <span m="231180">this</span> <span m="231440">is</span> <span m="231590">going</span> <span m="231920">to</span> <span m="232897">break</span> <span m="234180">a</span> <span m="234600">lot</span> <span m="235310">of</span> <span m="235450">legitimate</span> <span m="236760">applications.</span> <span m="239950">So</span> <span m="240080">you</span> <span m="240220">could</span> <span m="240320">imagine</span> <span m="240790">that</span> <span m="240930">there</span> <span m="241090">are</span> <span m="241110">a</span> <span m="241180">lot</span> <span m="241410">of</span> <span m="241490">programs,</span> <span m="242240">like</span> <span m="242410">maybe</span> <span m="242730">email</span> <span m="243050">clients</span> <span m="243300">or</span> <span m="243400">things</span> <span m="243650">like</span> <span m="243850">that,</span> <span m="244480">that</span> <span m="244680">should</span> <span m="244960">actually</span> <span m="245720">have</span> <span m="246500">the</span> <span m="246670">ability,</span> <span m="247090">perhaps,</span> <span m="247550">to</span> <span m="247810">read</span> <span m="248190">some</span> <span m="248280">data</span> <span m="248510">that's</span> <span m="248680">sensitive</span> <span m="249060">and</span> <span m="249130">also</span> <span m="249770">send</span> <span m="250840">information</span> <span m="251390">over</span> <span m="251440">the</span> <span m="251540">network.</span> <span m="252200">So</span> <span m="252620">if we</span> <span m="252720">just</span> <span m="252900">say that</span> <span m="253250">we're</span> <span m="253360">going</span> <span m="253460">to</span> <span m="253530">prevent</span> <span m="253930">this</span> <span m="254100">sort</span> <span m="254310">of</span> <span m="254880">and</span> <span m="255270">type</span> <span m="255570">of</span> <span m="255800">activity,</span> <span m="256589">then you're actually</span> <span m="256890">going to make</span> <span m="257170">a</span> <span m="257209">lot</span> <span m="257399">of</span> <span m="257490">things</span> <span m="257700">that</span> <span m="257790">work</span> <span m="258000">right</span> <span m="258170">now</span> <span m="259130">fail.</span> <span m="260019">So</span> <span m="260170">users</span> <span m="260510">are</span> <span m="260540">not</span> <span m="260720">going</span> <span m="261019">to like</span> <span m="261419">that.</span> </p>
<p><span m="262220">There's</span> <span m="262420">also</span> <span m="262860">a</span> <span m="262940">problem</span> <span m="263350">here</span> <span m="263650">is</span> <span m="263730">that</span> <span m="265610">even</span> <span m="265860">if</span> <span m="265960">we</span> <span m="266060">did</span> <span m="266240">implement</span> <span m="266580">this</span> <span m="266670">solution,</span> <span m="267770">it's</span> <span m="267810">not</span> <span m="268080">going</span> <span m="268420">to</span> <span m="269640">stop</span> <span m="270720">a</span> <span m="270800">bunch</span> <span m="271050">of</span> <span m="271150">different</span> <span m="271900">side</span> <span m="272300">channel</span> <span m="273020">mechanisms</span> <span m="274590">for</span> <span m="275110">data</span> <span m="275360">leakage.</span> <span m="275890">So</span> <span m="276040">for</span> <span m="276160">example,</span> <span m="276450">we've</span> <span m="276670">looked</span> <span m="277030">in</span> <span m="277090">previous</span> <span m="277460">classes</span> <span m="277930">about</span> <span m="278230">how</span> <span m="279010">the</span> <span m="279080">browser</span> <span m="279580">cache,</span> <span m="279940">for</span> <span m="280070">example,</span> <span m="280750">can</span> <span m="280940">leak</span> <span m="281200">information</span> <span m="282100">about</span> <span m="282450">whether a</span> <span m="282750">particular</span> <span m="283360">site</span> <span m="283680">has been</span> <span m="284120">visited or</span> <span m="284270">not.</span> <span m="285200">And</span> <span m="285350">so</span> <span m="285830">even</span> <span m="286160">if</span> <span m="286590">we</span> <span m="286780">have</span> <span m="286990">a</span> <span m="287200">security</span> <span m="287440">policy</span> <span m="287710">like</span> <span m="287870">this,</span> <span m="288200">maybe</span> <span m="288320">we</span> <span m="288450">don't</span> <span m="288610">capture</span> <span m="288950">all</span> <span m="289070">kinds of</span> <span m="289360">side</span> <span m="290040">channels.</span> <span m="290500">We'll talk</span> <span m="290650">about</span> <span m="290840">some</span> <span m="290960">other</span> <span m="291130">side channels</span> <span m="291400">a</span> <span m="291670">little</span> <span m="292340">later</span> <span m="292720">in</span> <span m="292790">the</span> <span m="292870">lecture.</span> </p>
<p><span m="294870">Another</span> <span m="295240">thing</span> <span m="295470">that</span> <span m="295600">this</span> <span m="296450">wouldn't</span> <span m="296830">stop</span> <span m="297320">is</span> <span m="298630">app</span> <span m="299023">collusion.</span> <span m="301250">So</span> <span m="301630">two</span> <span m="301960">apps</span> <span m="302370">can</span> <span m="302530">actually</span> <span m="303840">collaborate</span> <span m="305040">to</span> <span m="305890">break</span> <span m="306140">the</span> <span m="306220">security</span> <span m="306660">system.</span> <span m="307220">So</span> <span m="307460">for</span> <span m="307680">example,</span> <span m="308420">what</span> <span m="308670">if</span> <span m="308900">there's</span> <span m="309500">one</span> <span m="309750">app</span> <span m="310230">that</span> <span m="310400">doesn't</span> <span m="310630">have</span> <span m="310760">access</span> <span m="311090">network,</span> <span m="311840">but</span> <span m="311960">it</span> <span m="312060">can</span> <span m="312240">talk</span> <span m="312570">to</span> <span m="312670">a</span> <span m="312740">second</span> <span m="313090">application,</span> <span m="313700">which</span> <span m="313810">does.</span> <span m="314600">So</span> <span m="314680">maybe</span> <span m="314950">it can</span> <span m="315110">use</span> <span m="315310">Android's</span> <span m="316070">IPC</span> <span m="316280">mechanisms</span> <span m="316970">to</span> <span m="317400">pass</span> <span m="317690">the</span> <span m="317810">sensitive</span> <span m="317950">data</span> <span m="318000">to an</span> <span m="318410">application</span> <span m="318860">that</span> <span m="318920">does have</span> <span m="319330">network</span> <span m="319410">permissions,</span> <span m="319810">and</span> <span m="320210">that</span> <span m="320430">second app</span> <span m="320730">can</span> <span m="321010">actually</span> <span m="321320">upload</span> <span m="321600">that</span> <span m="321710">information</span> <span m="322700">to</span> <span m="322780">the</span> <span m="322870">server.</span> </p>
<p><span m="324780">And</span> <span m="325850">even</span> <span m="326100">if</span> <span m="326220">the</span> <span m="326350">apps</span> <span m="326680">aren't</span> <span m="326910">colluding,</span> <span m="327920">then</span> <span m="328150">there</span> <span m="328310">may</span> <span m="328600">be</span> <span m="328850">some</span> <span m="329100">type</span> <span m="329380">of</span> <span m="330610">trickery</span> <span m="331540">that an</span> <span m="331790">application</span> <span m="332930">can</span> <span m="333450">engage</span> <span m="333980">in</span> <span m="334300">to</span> <span m="334550">trick</span> <span m="334910">some</span> <span m="335150">other</span> <span m="335360">applications</span> <span m="335705">into</span> <span m="336050">accidentally</span> <span m="336590">revealing</span> <span m="337000">sensitive</span> <span m="337350">data.</span> <span m="338040">So</span> <span m="338170">maybe</span> <span m="338650">there's</span> <span m="338950">some</span> <span m="339200">type</span> <span m="339510">of</span> <span m="340350">weakness</span> <span m="340680">in</span> <span m="340740">the</span> <span m="340810">way</span> <span m="340960">that</span> <span m="341060">the</span> <span m="341180">email</span> <span m="341490">program</span> <span m="341960">is written,</span> <span m="342510">and</span> <span m="342780">so</span> <span m="343160">perhaps</span> <span m="344220">that</span> <span m="344560">email</span> <span m="344750">program</span> <span m="345010">accepts</span> <span m="345370">too</span> <span m="345560">many</span> <span m="345770">random</span> <span m="346070">messages</span> <span m="346490">from</span> <span m="346630">other</span> <span m="346890">things</span> <span m="347260">that are</span> <span m="347300">living</span> <span m="347530">on</span> <span m="347620">the</span> <span m="347700">system.</span> <span m="348340">So</span> <span m="348520">perhaps</span> <span m="348970">we</span> <span m="349070">could</span> <span m="349190">craft a</span> <span m="349680">special</span> <span m="350040">intent</span> <span m="350410">that's</span> <span m="350590">somehow</span> <span m="350850">going</span> <span m="350980">to</span> <span m="351060">trick</span> <span m="351750">your</span> <span m="351910">Gmail</span> <span m="352300">application,</span> <span m="352890">for</span> <span m="352990">example,</span> <span m="353360">into</span> <span m="353800">emailing</span> <span m="354250">something</span> <span m="354740">to</span> <span m="355040">someone</span> <span m="355600">outside</span> <span m="355930">of</span> <span m="356070">the phone.</span> <span m="357610">At a high level,</span> <span m="358490">this</span> <span m="358670">approach</span> <span m="358930">doesn't</span> <span m="359050">really</span> <span m="359230">work</span> <span m="359510">very</span> <span m="359670">well.</span> </p>
<p><span m="362890">One</span> <span m="363170">important</span> <span m="363350">thing</span> <span m="363480">to</span> <span m="363550">think</span> <span m="363710">about</span> <span m="363960">is</span> <span m="364120">OK,</span> <span m="364390">so</span> <span m="364570">it seems</span> <span m="364800">like</span> <span m="364920">we're</span> <span m="365040">very</span> <span m="365270">worried</span> <span m="365560">about</span> <span m="365760">the</span> <span m="365850">sensitive</span> <span m="366240">data</span> <span m="367070">leaving</span> <span m="367350">the</span> <span m="367430">phone.</span> <span m="367710">So</span> <span m="367860">what</span> <span m="368120">does</span> <span m="368470">Android</span> <span m="369000">malware</span> <span m="370130">actually</span> <span m="370620">do</span> <span m="372110">in</span> <span m="372230">practice.</span> <span m="372690">Are</span> <span m="373020">there any kinds</span> <span m="373290">of</span> <span m="374100">real</span> <span m="374370">world</span> <span m="375080">attacks</span> <span m="376560">that</span> <span m="376740">we're going</span> <span m="377000">to be</span> <span m="377275">preventing</span> <span m="377550">by</span> <span m="377730">all</span> <span m="378030">this</span> <span m="378605">taint</span> <span m="378920">tracking</span> <span m="379270">type</span> <span m="379610">stuff.</span> <span m="379950">And</span> <span m="380070">the answer</span> <span m="380250">is</span> <span m="380540">yes.</span> <span m="381320">So</span> <span m="381650">increasingly,</span> <span m="382570">malware</span> <span m="382740">is</span> <span m="383200">becoming</span> <span m="383500">a</span> <span m="383540">bigger</span> <span m="383770">problem</span> <span m="384200">for</span> <span m="384440">these mobile</span> <span m="384760">phones.</span> <span m="385080">So</span> <span m="385390">one thing</span> <span m="385700">it might</span> <span m="385960">do</span> <span m="386635">is it</span> <span m="386990">might</span> <span m="387260">use</span> <span m="388440">your</span> <span m="388670">location</span> <span m="391020">or</span> <span m="391390">maybe</span> <span m="393170">your</span> <span m="395220">IMEI</span> <span m="396740">for</span> <span m="396950">ads.</span> <span m="400360">So</span> <span m="400520">similarly</span> <span m="400810">to</span> <span m="400930">malware,</span> <span m="401460">it's</span> <span m="401540">actually</span> <span m="401810">going</span> <span m="402060">to</span> <span m="402190">look</span> <span m="402460">and</span> <span m="402560">see</span> <span m="402770">where</span> <span m="402910">you</span> <span m="403070">are</span> <span m="403140">physically</span> <span m="403560">located</span> <span m="404040">in</span> <span m="404140">the</span> <span m="404230">world</span> <span m="404870">and</span> <span m="405020">then maybe</span> <span m="405325">it</span> <span m="405630">will</span> <span m="406030">that</span> <span m="406460">oh,</span> <span m="407040">you're located</span> <span m="407460">near the</span> <span m="407570">MIT</span> <span m="407940">campus,</span> <span m="408310">therefore</span> <span m="408620">you</span> <span m="408720">must</span> <span m="408890">be a</span> <span m="408970">hungry</span> <span m="409300">student so</span> <span m="409700">hey,</span> <span m="409960">why</span> <span m="410130">don't you</span> <span m="410190">go</span> <span m="410320">to</span> <span m="410380">my</span> <span m="410520">food</span> <span m="410760">truck</span> <span m="410940">that</span> <span m="411050">happens</span> <span m="411320">to be</span> <span m="411410">located</span> <span m="411770">right</span> <span m="411930">where</span> <span m="412210">you</span> <span m="412340">are.</span> </p>
<p><span m="414130">IMEI</span> <span m="415010">is kind</span> <span m="415180">of</span> <span m="415310">like</span> <span m="415600">this--</span> <span m="416970">you can think</span> <span m="417440">of it</span> <span m="417560">as an</span> <span m="417640">integer</span> <span m="418550">that's</span> <span m="418680">like</span> <span m="418820">a</span> <span m="418980">per device</span> <span m="419430">uniquefier.</span> <span m="420410">So</span> <span m="420630">this</span> <span m="421000">could</span> <span m="421140">be used</span> <span m="421740">perhaps</span> <span m="422180">to</span> <span m="422520">track you in</span> <span m="422860">ways</span> <span m="423180">that you</span> <span m="423380">don't want</span> <span m="423530">to</span> <span m="423580">be</span> <span m="423710">tracked,</span> <span m="424170">in</span> <span m="424450">different</span> <span m="424710">locations,</span> <span m="424965">so on</span> <span m="425220">and</span> <span m="425450">so</span> <span m="425590">forth.</span> <span m="426170">So</span> <span m="426200">there's</span> <span m="426340">actually</span> <span m="426650">malware</span> <span m="426950">in</span> <span m="427060">the wild</span> <span m="427120">that</span> <span m="427430">does</span> <span m="427620">things</span> <span m="427840">like</span> <span m="428010">that.</span> <span m="428840">Another</span> <span m="429240">thing</span> <span m="429550">that</span> <span m="429630">malware</span> <span m="429910">might</span> <span m="429990">try</span> <span m="430130">to</span> <span m="430260">do</span> <span m="431080">is</span> <span m="431850">steal</span> <span m="432330">your</span> <span m="432650">credentials.</span> <span m="437250">So</span> <span m="437500">for</span> <span m="437700">example,</span> <span m="438670">it</span> <span m="438840">might</span> <span m="440060">try</span> <span m="440480">to</span> <span m="441520">take</span> <span m="441770">your</span> <span m="441870">phone</span> <span m="442210">number,</span> <span m="442850">or it</span> <span m="442970">might</span> <span m="443020">try to</span> <span m="443280">take</span> <span m="443530">your</span> <span m="443790">contact</span> <span m="444380">list,</span> <span m="444880">it</span> <span m="444960">might</span> <span m="445150">try</span> <span m="445420">to</span> <span m="445580">upload</span> <span m="446070">those</span> <span m="446380">things</span> <span m="446610">to a</span> <span m="446730">remote</span> <span m="447040">server.</span> <span m="447680">Maybe</span> <span m="447850">that's</span> <span m="448080">useful</span> <span m="448600">for</span> <span m="449130">trying</span> <span m="449640">to</span> <span m="449770">impersonate</span> <span m="450440">you,</span> <span m="450690">for</span> <span m="450770">example,</span> <span m="452070">in</span> <span m="452770">a</span> <span m="452810">message</span> <span m="453360">that's</span> <span m="453600">going</span> <span m="453690">to</span> <span m="453730">be used</span> <span m="454040">for</span> <span m="454190">spam</span> <span m="454640">later</span> <span m="454920">on.</span> <span m="455790">There's</span> <span m="456840">malware</span> <span m="457100">out there</span> <span m="457130">that does things</span> <span m="457400">like</span> <span m="457570">this</span> <span m="457720">today.</span> </p>
<p><span m="459990">Perhaps</span> <span m="460900">most</span> <span m="461230">horrifyingly,</span> <span m="462200">at</span> <span m="462310">least</span> <span m="462520">for</span> <span m="462630">me,</span> <span m="464290">malware</span> <span m="464750">might</span> <span m="464970">be</span> <span m="465080">able</span> <span m="465240">to</span> <span m="465360">turn</span> <span m="465800">your</span> <span m="465930">phone</span> <span m="467560">into</span> <span m="468280">a</span> <span m="468380">bot.</span> <span m="470300">This,</span> <span m="470450">of</span> <span m="470540">course,</span> <span m="470780">is</span> <span m="470880">a</span> <span m="470950">problem</span> <span m="471290">that</span> <span m="471430">our</span> <span m="471560">parents</span> <span m="471980">did not</span> <span m="472140">have</span> <span m="472280">to</span> <span m="472370">deal</span> <span m="472640">with.</span> <span m="473120">Modern</span> <span m="473510">phones</span> <span m="473830">are</span> <span m="474280">so</span> <span m="474410">powerful</span> <span m="474665">that</span> <span m="474920">they</span> <span m="475000">can</span> <span m="475120">actually</span> <span m="475380">be</span> <span m="475490">used</span> <span m="475950">to</span> <span m="476160">send</span> <span m="476490">out spam</span> <span m="476800">messages</span> <span m="477420">themselves.</span> <span m="477845">So there's</span> <span m="478370">actually</span> <span m="478620">a pretty</span> <span m="478850">nasty</span> <span m="480050">piece</span> <span m="480230">of</span> <span m="480450">malware</span> <span m="480650">that's going around</span> <span m="481050">right</span> <span m="481300">now</span> <span m="481900">that</span> <span m="482090">seems</span> <span m="482390">to be targeting</span> <span m="482940">some</span> <span m="483010">corporate</span> <span m="483320">environments</span> <span m="483710">that's</span> <span m="483810">doing</span> <span m="484020">precisely</span> <span m="484510">this.</span> <span m="485010">So</span> <span m="485100">it gets</span> <span m="485290">to</span> <span m="485380">your</span> <span m="485500">phone</span> <span m="485765">and</span> <span m="486030">just</span> <span m="486120">starts</span> <span m="486390">sending out</span> <span m="486670">stuff.</span> </p>
<p><span m="487168">AUDIENCE:</span> <span m="487666">So this</span> <span m="488164">type of</span> <span m="488662">malware,</span> <span m="489160">is</span> <span m="489658">it malware</span> <span m="490156">that subverts</span> <span m="490654">the Android</span> <span m="491152">OS,</span> <span m="491650">or is</span> <span m="492148">it just</span> <span m="492646">a typical app?</span> <span m="493642">If it's a typical</span> <span m="494140">app,</span> <span m="494638">it seems</span> <span m="495136">that</span> <span m="495634">it should be able--</span> </p>
<p><span m="496630">PROFESSOR:</span> <span m="497130">Yeah.</span> <span m="498810">That's</span> <span m="498990">a</span> <span m="499030">good</span> <span m="499150">question.</span> <span m="500720">There's</span> <span m="500880">both</span> <span m="501170">types</span> <span m="501400">of</span> <span m="501460">malware</span> <span m="501810">out</span> <span m="501990">there.</span> <span m="502720">As</span> <span m="502900">it</span> <span m="503000">turns</span> <span m="503290">out,</span> <span m="503560">it's</span> <span m="503680">actually</span> <span m="504230">fairly</span> <span m="504650">easy</span> <span m="504990">to</span> <span m="505100">get</span> <span m="505430">users</span> <span m="505510">to click</span> <span m="505720">on</span> <span m="505860">things.</span> <span m="508620">So</span> <span m="508760">I'll</span> <span m="508840">give</span> <span m="509010">you</span> <span m="509100">an</span> <span m="509160">example.</span> <span m="509790">This</span> <span m="509870">isn't</span> <span m="510050">necessarily</span> <span m="510370">indicative</span> <span m="510670">of</span> <span m="510740">malware,</span> <span m="511290">more</span> <span m="511510">about</span> <span m="511690">the</span> <span m="511830">sad</span> <span m="512080">state</span> <span m="512370">of</span> <span m="512520">humanity.</span> <span m="512980">There'll</span> <span m="513159">be</span> <span m="513260">a</span> <span m="513320">popular</span> <span m="513780">game</span> <span m="514049">out</span> <span m="514179">there,</span> <span m="514289">let's</span> <span m="514490">say</span> <span m="514659">Angry</span> <span m="514929">Birds,</span> <span m="515240">for</span> <span m="515330">example.</span> <span m="515900">You</span> <span m="515990">go</span> <span m="516120">to</span> <span m="516179">the</span> <span m="516309">App</span> <span m="516500">Store</span> <span m="516919">and</span> <span m="516990">you</span> <span m="517179">type</span> <span m="517390">in</span> <span m="517500">Angry</span> <span m="517919">Birds,</span> <span m="517980">I</span> <span m="518120">want to get</span> <span m="518159">Angry</span> <span m="518340">Birds.</span> <span m="519110">So</span> <span m="519320">hopefully</span> <span m="519659">the</span> <span m="519740">first</span> <span m="520070">hit</span> <span m="520179">that</span> <span m="520360">you get</span> <span m="520880">is</span> <span m="521179">the</span> <span m="521299">actual</span> <span m="521630">Angry</span> <span m="521900">Birds.</span> </p>
<p><span m="522530">But</span> <span m="522750">then</span> <span m="522929">the</span> <span m="523000">second</span> <span m="523620">hit will</span> <span m="523730">be</span> <span m="523880">something</span> <span m="524179">like</span> <span m="524630">Angry</span> <span m="524980">Birdss,</span> <span m="526160">with</span> <span m="526270">two</span> <span m="526780">S's,</span> <span m="527120">for</span> <span m="527260">example.</span> <span m="527840">And</span> <span m="528250">a lot</span> <span m="528400">of people will go</span> <span m="528560">there,</span> <span m="528790">and</span> <span m="528960">maybe it's</span> <span m="529320">cheaper</span> <span m="529440">than the</span> <span m="529530">regular</span> <span m="529830">version,</span> <span m="530560">and</span> <span m="530890">they</span> <span m="530980">go</span> <span m="531160">there.</span> <span m="531700">It's</span> <span m="531830">going</span> <span m="531930">to</span> <span m="531970">present</span> <span m="532300">that</span> <span m="532610">thing</span> <span m="533040">that</span> <span m="533130">says,</span> <span m="533440">do</span> <span m="533530">you</span> <span m="533750">allow</span> <span m="533980">this</span> <span m="534140">application</span> <span m="534630">to</span> <span m="534690">do</span> <span m="534800">this,</span> <span m="535150">this, and</span> <span m="535260">this.</span> <span m="535450">The</span> <span m="535840">person</span> <span m="536150">is going</span> <span m="536230">say,</span> <span m="536430">yeah,</span> <span m="536710">because</span> <span m="536760">I got to</span> <span m="536980">get my</span> <span m="537090">Angry Birds,</span> <span m="537460">yeah, sure.</span> <span m="538190">Boom,</span> <span m="538560">then</span> <span m="538670">that</span> <span m="538820">person</span> <span m="539120">could be</span> <span m="539380">owned.</span> <span m="540280">So in</span> <span m="540560">practice</span> <span m="540875">you</span> <span m="541190">see</span> <span m="541660">now where it</span> <span m="541910">exploits</span> <span m="542100">both</span> <span m="542330">types</span> <span m="542410">of vectors.</span> <span m="543520">But</span> <span m="543630">you're exactly</span> <span m="544020">right</span> <span m="544220">that</span> <span m="544400">if</span> <span m="545070">you</span> <span m="545220">assume</span> <span m="545880">that</span> <span m="546050">the</span> <span m="546270">Android</span> <span m="546800">security</span> <span m="547280">model</span> <span m="548030">is</span> <span m="548230">correct,</span> <span m="549080">then</span> <span m="549270">the</span> <span m="549340">malware</span> <span m="549750">sort</span> <span m="549950">has</span> <span m="550140">to</span> <span m="550230">depend</span> <span m="550780">on</span> <span m="551140">users</span> <span m="551500">being</span> <span m="551720">foolish</span> <span m="552300">or</span> <span m="552780">naive</span> <span m="553760">and</span> <span m="554410">giving</span> <span m="554740">it</span> <span m="554760">network</span> <span m="555130">access,</span> <span m="555420">for</span> <span m="555510">example,</span> <span m="556270">when</span> <span m="556410">your</span> <span m="556570">tic-tac-toe</span> <span m="557100">game</span> <span m="557290">shouldn't</span> <span m="557580">really</span> <span m="557660">have</span> <span m="557820">network</span> <span m="558110">access.</span> </p>
<p><span m="561920">Yes,</span> <span m="562220">so</span> <span m="562590">you</span> <span m="562670">can</span> <span m="562780">actually</span> <span m="563030">have</span> <span m="563190">your</span> <span m="563280">phone</span> <span m="563480">get</span> <span m="563630">turned</span> <span m="563890">into</span> <span m="564010">a</span> <span m="564050">bot.</span> <span m="564470">This</span> <span m="564650">is</span> <span m="564750">horrible</span> <span m="565070">for</span> <span m="565170">multiple</span> <span m="565480">reasons,</span> <span m="565860">not</span> <span m="566060">only because</span> <span m="566300">your</span> <span m="566590">phone</span> <span m="566670">is a bot but</span> <span m="567010">also</span> <span m="567220">because</span> <span m="567860">maybe</span> <span m="568090">you're</span> <span m="568250">paying</span> <span m="568930">for</span> <span m="569070">data</span> <span m="569850">for</span> <span m="569980">all</span> <span m="570090">those</span> <span m="570200">emails</span> <span m="570560">that are</span> <span m="570620">getting</span> <span m="570690">sent</span> <span m="570960">from</span> <span m="571210">your</span> <span m="571320">phone.</span> <span m="571820">Maybe</span> <span m="572030">your</span> <span m="572160">battery's</span> <span m="572640">getting</span> <span m="572850">ground</span> <span m="573160">down</span> <span m="573640">because</span> <span m="573960">you</span> <span m="574570">phone's</span> <span m="574900">just</span> <span m="575080">sitting</span> <span m="575260">around</span> <span m="575470">constantly</span> <span m="576610">sending</span> <span m="577350">ads</span> <span m="577660">about</span> <span m="578130">whenever,</span> <span m="578900">free</span> <span m="579660">trips</span> <span m="579890">to</span> <span m="580150">Bermuda</span> <span m="580420">or</span> <span m="580530">whatever.</span> </p>
<p><span m="581740">There</span> <span m="582020">are</span> <span m="582190">actually</span> <span m="583480">malicious</span> <span m="583860">applications</span> <span m="584470">out</span> <span m="584650">there</span> <span m="585170">that</span> <span m="585840">will</span> <span m="586060">use</span> <span m="586250">your</span> <span m="586360">private</span> <span m="586670">information</span> <span m="588510">for</span> <span m="588710">bad.</span> <span m="589420">And</span> <span m="589510">the</span> <span m="589560">particularly</span> <span m="589950">bad</span> <span m="590170">thing</span> <span m="590300">about</span> <span m="590470">this</span> <span m="590620">bot</span> <span m="590850">here is</span> <span m="591100">that</span> <span m="591340">it can actually</span> <span m="591890">look at your</span> <span m="591970">contact</span> <span m="592390">list</span> <span m="592500">and</span> <span m="592610">some</span> <span m="592740">spam</span> <span m="593680">on</span> <span m="593910">your</span> <span m="594020">behalf</span> <span m="594380">to</span> <span m="594470">people</span> <span m="594780">that</span> <span m="594910">you</span> <span m="595040">know</span> <span m="595680">and</span> <span m="595950">make</span> <span m="596110">the</span> <span m="596190">likelihood</span> <span m="596600">of</span> <span m="596710">the</span> <span m="596770">victim</span> <span m="597130">clicking</span> <span m="597390">on</span> <span m="597500">something</span> <span m="597850">in that email</span> <span m="597990">much,</span> <span m="598600">much</span> <span m="598670">higher.</span> </p>
<p><span m="601960">One</span> <span m="602230">thing</span> <span m="602380">to</span> <span m="602490">note,</span> <span m="602790">and this</span> <span m="602940">kind of</span> <span m="603040">getting back</span> <span m="603510">to</span> <span m="603600">the discussion</span> <span m="603850">we</span> <span m="603930">just had,</span> <span m="604530">so</span> <span m="604660">preventing</span> <span m="604900">this</span> <span m="605130">data</span> <span m="605350">exfiltration</span> <span m="605970">is</span> <span m="606090">very</span> <span m="606310">nice,</span> <span m="607010">right.</span> <span m="607240">But</span> <span m="607360">in</span> <span m="607550">and</span> <span m="607650">of</span> <span m="607660">itself,</span> <span m="608010">preventing</span> <span m="608380">that</span> <span m="608540">exfiltration</span> <span m="609440">doesn't</span> <span m="609690">stop</span> <span m="610040">the</span> <span m="610110">hack in</span> <span m="610600">the first</span> <span m="610930">place.</span> <span m="611770">So</span> <span m="611840">there's</span> <span m="612000">actually</span> <span m="612330">mechanisms</span> <span m="612890">that</span> <span m="613040">we</span> <span m="613180">actually</span> <span m="613470">should</span> <span m="613640">look</span> <span m="613890">at</span> <span m="614260">to</span> <span m="614460">prevent</span> <span m="614940">your</span> <span m="615050">machine</span> <span m="615500">from getting</span> <span m="615740">owned</span> <span m="615910">in</span> <span m="615970">the</span> <span m="616030">first</span> <span m="616310">place</span> <span m="616560">or</span> <span m="616800">to</span> <span m="617210">educate</span> <span m="617620">users</span> <span m="617860">about</span> <span m="618080">what</span> <span m="618190">they</span> <span m="618270">should</span> <span m="618610">and should</span> <span m="618780">not click</span> <span m="619120">on.</span> <span m="619540">So</span> <span m="619730">just</span> <span m="620050">doing</span> <span m="620240">this</span> <span m="620340">taint</span> <span m="620590">tracking</span> <span m="620840">isn't</span> <span m="621000">a</span> <span m="621050">full</span> <span m="621670">solution</span> <span m="622080">for</span> <span m="622250">preventing</span> <span m="622520">your</span> <span m="622600">machine</span> <span m="623550">from getting</span> <span m="623860">compromised.</span> </p>
<p><span m="626910">How</span> <span m="627430">is</span> <span m="628980">TaintDroid</span> <span m="630070">in</span> <span m="630210">particular</span> <span m="631270">going</span> <span m="631690">to</span> <span m="632160">work?</span> <span m="633240">Let's</span> <span m="633450">see.</span> <span m="635520">So</span> <span m="636000">as</span> <span m="636190">I</span> <span m="636240">mentioned</span> <span m="636540">before,</span> <span m="637580">TaintDroid</span> <span m="638460">is</span> <span m="639430">going</span> <span m="639810">to</span> <span m="640150">track</span> <span m="641340">all</span> <span m="641630">of</span> <span m="641750">your</span> <span m="642030">sensitive</span> <span m="643330">information</span> <span m="643760">as</span> <span m="643840">it</span> <span m="643920">propagates</span> <span m="644670">through</span> <span m="644750">the</span> <span m="644840">system.</span> <span m="645520">So</span> <span m="645640">TaintDroid</span> <span m="646180">distinguishes</span> <span m="646880">between</span> <span m="648210">what</span> <span m="648340">they</span> <span m="648420">call</span> <span m="648580">information</span> <span m="649060">sources</span> <span m="649850">and</span> <span m="649890">information</span> <span m="650400">sinks.</span> <span m="651140">So</span> <span m="652130">these</span> <span m="652300">sources</span> <span m="654460">are</span> <span m="654620">things</span> <span m="655390">that</span> <span m="655770">generate</span> <span m="657440">sensitive</span> <span m="657840">data.</span> <span m="658240">So</span> <span m="658260">you</span> <span m="658320">might</span> <span m="658490">think</span> <span m="658650">of</span> <span m="658740">this</span> <span m="659330">as</span> <span m="660200">things</span> <span m="660630">like</span> <span m="661950">sensors.</span> <span m="662520">So</span> <span m="662870">for</span> <span m="662980">example,</span> <span m="663280">GPS,</span> <span m="663990">accelerometer,</span> <span m="665310">things</span> <span m="665570">like</span> <span m="665770">that.</span> <span m="666780">This</span> <span m="666970">could</span> <span m="667140">be</span> <span m="668010">your</span> <span m="668770">contact</span> <span m="669380">list</span> <span m="669640">database,</span> <span m="672600">this</span> <span m="672920">could</span> <span m="673070">be</span> <span m="675250">things</span> <span m="675460">like</span> <span m="675640">the</span> <span m="675820">IMEI,</span> <span m="678960">basically</span> <span m="679460">anything</span> <span m="680050">that</span> <span m="680520">might</span> <span m="681440">help</span> <span m="681790">to</span> <span m="681920">tie</span> <span m="682270">you,</span> <span m="682540">a</span> <span m="682810">particular</span> <span m="683190">user,</span> <span m="684000">to</span> <span m="684290">your</span> <span m="684480">actual</span> <span m="684790">phone.</span> </p>
<p><span m="685250">So</span> <span m="685390">these</span> <span m="685660">are</span> <span m="685810">the things</span> <span m="686240">that</span> <span m="686430">generate</span> <span m="687420">the</span> <span m="687600">taint.</span> <span m="688220">And</span> <span m="688460">then</span> <span m="688930">you</span> <span m="689010">can think</span> <span m="689300">of</span> <span m="689670">these</span> <span m="689890">sinks</span> <span m="691280">as</span> <span m="691550">being</span> <span m="691990">the</span> <span m="692770">places</span> <span m="693820">where</span> <span m="694040">we</span> <span m="694240">don't</span> <span m="694590">want</span> <span m="695110">tainted</span> <span m="695400">data</span> <span m="695690">to</span> <span m="695790">go.</span> <span m="696170">And</span> <span m="696280">so</span> <span m="696740">in</span> <span m="696860">the</span> <span m="696950">case</span> <span m="697340">of</span> <span m="697660">TaintDroid,</span> <span m="698150">the</span> <span m="698260">particular</span> <span m="698720">sink</span> <span m="698980">that</span> <span m="699100">we're</span> <span m="699240">concerned</span> <span m="699690">about</span> <span m="700760">is</span> <span m="700920">the</span> <span m="701030">network.</span> <span m="704090">As</span> <span m="704290">we'll</span> <span m="704380">talk</span> <span m="704600">about</span> <span m="704840">later,</span> <span m="705080">you</span> <span m="705190">can</span> <span m="705350">generalize</span> <span m="705920">information</span> <span m="706440">flow</span> <span m="707690">to</span> <span m="708060">more</span> <span m="708300">scenarios</span> <span m="708760">than</span> <span m="708870">TaintDroid</span> <span m="709220">specifically</span> <span m="709650">covers.</span> <span m="709990">So you</span> <span m="710090">can</span> <span m="710190">imagine</span> <span m="710530">there</span> <span m="710630">might</span> <span m="710790">be</span> <span m="710930">other</span> <span m="711150">sinks</span> <span m="711730">in</span> <span m="711820">a</span> <span m="711870">more</span> <span m="712030">general</span> <span m="712310">purpose</span> <span m="712630">system.</span> <span m="713430">But</span> <span m="713590">for</span> <span m="714060">TaintDroid,</span> <span m="714230">they're literally</span> <span m="714630">caring</span> <span m="714950">about</span> <span m="715490">the</span> <span m="715610">network</span> <span m="716540">as</span> <span m="716740">the</span> <span m="716830">sink</span> <span m="717080">for</span> <span m="717180">information.</span> </p>
<p><span m="719180">So</span> <span m="719880">in</span> <span m="720030">TaintDroid,</span> <span m="720900">they're</span> <span m="721050">going</span> <span m="721280">to</span> <span m="721320">use</span> <span m="721890">a</span> <span m="723250">32-bit</span> <span m="725310">bitvector</span> <span m="728550">to</span> <span m="728980">represent</span> <span m="729530">taint.</span> <span m="732300">And</span> <span m="732530">so</span> <span m="733010">what</span> <span m="733130">this</span> <span m="733290">basically</span> <span m="733760">means</span> <span m="734150">is</span> <span m="734280">that</span> <span m="734780">you</span> <span m="734930">can</span> <span m="735110">have,</span> <span m="735590">at</span> <span m="735830">most,</span> <span m="737440">32</span> <span m="738560">distinct</span> <span m="738800">taint</span> <span m="739180">sources.</span> <span m="740140">So</span> <span m="740350">each</span> <span m="740830">sensitive</span> <span m="741230">data</span> <span m="741470">value</span> <span m="742190">will</span> <span m="742510">have</span> <span m="742850">a one</span> <span m="743310">in</span> <span m="743530">a particular</span> <span m="743630">position</span> <span m="744490">if</span> <span m="744550">it</span> <span m="744690">has</span> <span m="744880">been</span> <span m="745080">tainted</span> <span m="745420">by</span> <span m="745590">some</span> <span m="745780">particular</span> <span m="745910">source</span> <span m="746140">of</span> <span m="746240">taint.</span> <span m="746620">That's</span> <span m="746820">like,</span> <span m="747850">has</span> <span m="748140">it</span> <span m="748990">been</span> <span m="749180">derived</span> <span m="749750">from</span> <span m="750400">your</span> <span m="750580">GPS</span> <span m="751070">data,</span> <span m="751370">for</span> <span m="751390">example.</span> <span m="752140">Has</span> <span m="752330">it</span> <span m="752430">been</span> <span m="752580">derived</span> <span m="753060">from</span> <span m="753290">something</span> <span m="753560">from</span> <span m="753650">your</span> <span m="753770">contacts</span> <span m="754370">list,</span> <span m="754900">and</span> <span m="755020">so on and</span> <span m="755170">so forth.</span> </p>
<p><span m="757540">One</span> <span m="757820">interesting</span> <span m="758270">thing</span> <span m="758370">is that</span> <span m="759460">32</span> <span m="761030">sources</span> <span m="761390">of taint</span> <span m="761680">is</span> <span m="761770">actually</span> <span m="762200">not</span> <span m="762510">that</span> <span m="762750">big,</span> <span m="763640">right.</span> <span m="764120">And</span> <span m="764380">so</span> <span m="766380">an</span> <span m="766490">interesting</span> <span m="766850">question</span> <span m="767270">is,</span> <span m="767960">is that</span> <span m="768250">big</span> <span m="768440">enough</span> <span m="768920">for</span> <span m="769000">this</span> <span m="769160">particular</span> <span m="769540">system</span> <span m="769900">and is</span> <span m="770010">it</span> <span m="770070">big</span> <span m="770260">enough</span> <span m="770700">in</span> <span m="770930">general</span> <span m="771260">for these</span> <span m="771490">information</span> <span m="771950">flow</span> <span m="772190">systems.</span> <span m="773430">So</span> <span m="774060">in</span> <span m="774160">a</span> <span m="774210">particular</span> <span m="774540">case</span> <span m="774780">of</span> <span m="774890">TaintDroid,</span> <span m="775860">32</span> <span m="776490">possible</span> <span m="776990">sources</span> <span m="777300">of</span> <span m="777370">taint</span> <span m="777630">seems</span> <span m="778160">to</span> <span m="778260">be</span> <span m="778780">somewhat</span> <span m="779230">reasonable,</span> <span m="780080">because</span> <span m="780680">it's</span> <span m="780870">actually</span> <span m="781160">looking</span> <span m="781490">at</span> <span m="781560">a</span> <span m="781620">fairly</span> <span m="782050">constrained</span> <span m="782660">information</span> <span m="783150">flow</span> <span m="783360">problem.</span> </p>
<p><span m="784360">So it's</span> <span m="784510">saying</span> <span m="785220">given</span> <span m="785700">all</span> <span m="785920">the</span> <span m="786000">sensors</span> <span m="786310">you</span> <span m="786420">have</span> <span m="786650">on</span> <span m="786720">your</span> <span m="786820">phone,</span> <span m="787230">given</span> <span m="787490">all of</span> <span m="787640">these</span> <span m="788530">sensitive</span> <span m="788910">databases,</span> <span m="789400">and</span> <span m="789500">things</span> <span m="789700">like</span> <span m="789890">that,</span> <span m="790770">32</span> <span m="791290">seems</span> <span m="791580">roughly</span> <span m="792000">the</span> <span m="792120">right</span> <span m="793760">order</span> <span m="793950">of</span> <span m="794020">magnitude</span> <span m="794940">in</span> <span m="795040">terms</span> <span m="795250">of</span> <span m="795310">storing</span> <span m="796840">these</span> <span m="797050">taint</span> <span m="797270">flags.</span> <span m="798170">And as</span> <span m="798360">we'll</span> <span m="798480">see</span> <span m="798730">in</span> <span m="798830">the</span> <span m="798910">implementation</span> <span m="799550">of</span> <span m="799640">this</span> <span m="800220">system,</span> <span m="801130">32</span> <span m="801680">is</span> <span m="801760">actually</span> <span m="801970">very</span> <span m="802160">convenient, too,</span> <span m="802600">because</span> <span m="802960">what</span> <span m="803300">else</span> <span m="803470">is</span> <span m="803570">32</span> <span m="803960">bits?</span> <span m="804390">Well,</span> <span m="804660">an</span> <span m="804750">integer.</span> <span m="805590">So</span> <span m="805690">you</span> <span m="805800">can</span> <span m="805890">actually</span> <span m="806160">do some</span> <span m="806280">very</span> <span m="806500">efficient</span> <span m="806770">representations</span> <span m="807430">of</span> <span m="807490">these</span> <span m="807670">taint</span> <span m="807880">flags</span> <span m="808830">in the</span> <span m="808990">way that</span> <span m="809240">they</span> <span m="809310">actually</span> <span m="809630">build</span> <span m="809960">this.</span> </p>
<p><span m="810650">As</span> <span m="810810">we'll</span> <span m="810880">discuss</span> <span m="811220">a</span> <span m="811280">little</span> <span m="811390">bit</span> <span m="811550">later,</span> <span m="811910">though,</span> <span m="812320">if</span> <span m="812470">you</span> <span m="812590">want</span> <span m="812750">to</span> <span m="812790">expose</span> <span m="814360">information</span> <span m="814910">flow</span> <span m="815160">to</span> <span m="815240">programmers</span> <span m="816090">in</span> <span m="816240">a</span> <span m="816310">more</span> <span m="816550">generic</span> <span m="817080">way,</span> <span m="817520">so</span> <span m="817680">for</span> <span m="817830">example,</span> <span m="818310">if</span> <span m="818460">you</span> <span m="818590">want</span> <span m="818890">programmers</span> <span m="819380">be</span> <span m="819520">able</span> <span m="819660">to</span> <span m="819720">specify</span> <span m="820440">their</span> <span m="820750">own</span> <span m="821020">sources</span> <span m="821450">of</span> <span m="821540">taint</span> <span m="822200">and their</span> <span m="822510">own</span> <span m="823160">types</span> <span m="823420">of</span> <span m="823510">sink,</span> <span m="824080">then</span> <span m="824370">32</span> <span m="824780">bits</span> <span m="825010">probably</span> <span m="825340">isn't</span> <span m="825950">enough.</span> <span m="826660">In</span> <span m="826830">systems</span> <span m="827200">like</span> <span m="827410">that</span> <span m="827790">you actually</span> <span m="828060">have to think</span> <span m="828210">about</span> <span m="828430">including</span> <span m="830140">more</span> <span m="830350">complex</span> <span m="830790">runtime</span> <span m="831260">support</span> <span m="831790">for</span> <span m="832450">a</span> <span m="832570">larger</span> <span m="833040">label</span> <span m="833370">space.</span> <span m="834960">So</span> <span m="835070">does that</span> <span m="835280">all make</span> <span m="835430">sense?</span> </p>
<p><span m="837720">OK</span> <span m="838310">so</span> <span m="840240">roughly</span> <span m="840690">speaking,</span> <span m="841870">when you</span> <span m="842170">look</span> <span m="842390">at</span> <span m="842460">the</span> <span m="842560">way</span> <span m="842830">that</span> <span m="843280">a</span> <span m="843400">taint</span> <span m="843610">flows</span> <span m="844360">through</span> <span m="844480">the</span> <span m="844590">system,</span> <span m="845520">at</span> <span m="845650">a</span> <span m="845680">high</span> <span m="845970">level,</span> <span m="846370">it</span> <span m="846450">basically</span> <span m="846890">goes</span> <span m="847430">from</span> <span m="847680">the</span> <span m="847800">right</span> <span m="848040">hand</span> <span m="848280">side</span> <span m="848600">of</span> <span m="849220">a</span> <span m="849370">statement</span> <span m="849750">to</span> <span m="850010">the</span> <span m="850120">left</span> <span m="850370">hand</span> <span m="850560">side.</span> <span m="851160">So</span> <span m="851580">as</span> <span m="851740">a</span> <span m="851780">very</span> <span m="851990">simple</span> <span m="852260">example,</span> <span m="852780">if</span> <span m="852860">you</span> <span m="852970">had</span> <span m="853230">some</span> <span m="855730">statement,</span> <span m="856060">like</span> <span m="856220">you</span> <span m="856290">declare</span> <span m="857080">an</span> <span m="857200">integer</span> <span m="857550">variable</span> <span m="858460">that's</span> <span m="858640">going</span> <span m="858760">to</span> <span m="858920">get</span> <span m="859180">your</span> <span m="859720">latitude,</span> <span m="861460">and</span> <span m="861540">then</span> <span m="861650">a</span> <span m="861680">high</span> <span m="861940">level you</span> <span m="862200">call</span> <span m="862980">gps.getLat(),</span> <span m="867520">then</span> <span m="867640">essentially</span> <span m="868340">this</span> <span m="868580">thing</span> <span m="868770">here</span> <span m="869000">is</span> <span m="869070">going</span> <span m="869190">to</span> <span m="870940">generate</span> <span m="871230">a</span> <span m="871280">value</span> <span m="871770">that</span> <span m="871930">has</span> <span m="872240">some</span> <span m="872520">taint</span> <span m="872800">that's</span> <span m="872980">associated</span> <span m="873450">with</span> <span m="873590">it.</span> </p>
<p><span m="874130">Some</span> <span m="874300">particular</span> <span m="874670">flag</span> <span m="874940">will be set</span> <span m="875390">that</span> <span m="875490">indicates</span> <span m="875930">that</span> <span m="876400">hey,</span> <span m="876740">this</span> <span m="876840">value</span> <span m="877150">I'm returning</span> <span m="878400">comes</span> <span m="878660">from</span> <span m="878770">a</span> <span m="879040">sensitive</span> <span m="879230">source.</span> <span m="879930">So</span> <span m="880020">the</span> <span m="880130">taint</span> <span m="880420">will come</span> <span m="880620">from</span> <span m="880750">here</span> <span m="880920">on</span> <span m="880990">the</span> <span m="881050">right</span> <span m="881280">hand</span> <span m="881510">side</span> <span m="881910">and</span> <span m="882200">go</span> <span m="882330">over</span> <span m="882490">here</span> <span m="882580">to the</span> <span m="882700">left</span> <span m="882950">hand</span> <span m="883130">side,</span> <span m="883600">and</span> <span m="883760">now</span> <span m="883950">that</span> <span m="884450">is</span> <span m="884770">actually</span> <span m="885140">tainted.</span> <span m="885840">So</span> <span m="886270">that's</span> <span m="886480">sort of</span> <span m="886770">what it</span> <span m="886860">looks</span> <span m="887130">like</span> <span m="887710">from</span> <span m="888110">the</span> <span m="888540">perspective</span> <span m="889210">of</span> <span m="889380">the</span> <span m="889590">human</span> <span m="889850">developer</span> <span m="890520">who</span> <span m="890890">writes</span> <span m="891110">source</span> <span m="891470">code.</span> <span m="892080">However,</span> <span m="892460">the</span> <span m="892570">Dalvik</span> <span m="893480">VM</span> <span m="893910">actually</span> <span m="894210">uses</span> <span m="894480">this</span> <span m="895220">register-based</span> <span m="895860">format</span> <span m="896300">at the lower</span> <span m="896580">level to</span> <span m="896890">actually</span> <span m="897170">build</span> <span m="897370">programs,</span> <span m="898200">and</span> <span m="898450">that's</span> <span m="898720">actually</span> <span m="899170">the</span> <span m="899280">way</span> <span m="899530">that</span> <span m="899960">these</span> <span m="900050">taint</span> <span m="900270">semantics</span> <span m="900770">are</span> <span m="900880">implemented</span> <span m="902810">in</span> <span m="902870">reality.</span> </p>
<p><span m="904500">This</span> <span m="904580">is what's</span> <span m="904800">explained in</span> <span m="905130">table</span> <span m="905430">one</span> <span m="905600">of</span> <span m="905650">the</span> <span m="905740">papers,</span> <span m="906030">so</span> <span m="906100">they</span> <span m="906220">have</span> <span m="906490">this</span> <span m="906880">big</span> <span m="907210">list</span> <span m="907620">of</span> <span m="908430">classes</span> <span m="908960">of</span> <span m="909080">opcodes,</span> <span m="909345">and</span> <span m="909610">they</span> <span m="909990">describe</span> <span m="910500">how</span> <span m="910740">taint</span> <span m="911140">sort of</span> <span m="911290">flows</span> <span m="911720">for</span> <span m="911810">those</span> <span m="911950">types</span> <span m="912160">of</span> <span m="912260">opcodes.</span> <span m="912880">So</span> <span m="913010">for</span> <span m="913120">example,</span> <span m="914100">you</span> <span m="914220">might</span> <span m="914410">imagine</span> <span m="914950">that</span> <span m="915920">you</span> <span m="916050">have</span> <span m="917390">an</span> <span m="917520">operation</span> <span m="918090">that</span> <span m="918570">looks</span> <span m="918790">kind</span> <span m="918920">of</span> <span m="919010">like</span> <span m="919150">a</span> <span m="919200">move,</span> <span m="920060">and</span> <span m="920260">so</span> <span m="921210">it</span> <span m="921320">mentions</span> <span m="921940">a</span> <span m="922040">destination</span> <span m="923990">and</span> <span m="924270">a</span> <span m="924340">source.</span> <span m="924990">So</span> <span m="925330">in</span> <span m="925490">Dalvik,</span> <span m="926310">to</span> <span m="926470">register</span> <span m="927120">a</span> <span m="927520">base</span> <span m="927840">virtual</span> <span m="928140">machines,</span> <span m="928800">so you</span> <span m="928840">can think</span> <span m="929080">of</span> <span m="929190">these</span> <span m="929410">as being</span> <span m="929750">registers</span> <span m="930590">on</span> <span m="930820">this</span> <span m="931120">sort</span> <span m="931300">of</span> <span m="931390">abstract</span> <span m="932240">computation</span> <span m="932770">engine.</span> <span m="933450">And</span> <span m="933660">so</span> <span m="934230">essentially</span> <span m="934580">what</span> <span m="934700">happens</span> <span m="935060">here</span> <span m="935390">is</span> <span m="935610">that,</span> <span m="936040">like</span> <span m="936340">I</span> <span m="936520">said,</span> <span m="936990">taint</span> <span m="937230">goes</span> <span m="937450">from</span> <span m="937580">the</span> <span m="937700">right</span> <span m="937970">hand</span> <span m="938190">side</span> <span m="938470">to the</span> <span m="938550">left</span> <span m="938800">hand</span> <span m="938990">side.</span> <span m="939630">So</span> <span m="939740">in</span> <span m="939810">this</span> <span m="940020">case,</span> <span m="940280">when</span> <span m="940430">the Dalvik</span> <span m="940840">interpreter</span> <span m="941390">executes</span> <span m="941880">this</span> <span m="942030">instruction</span> <span m="942470">here,</span> <span m="943010">it's</span> <span m="943190">going</span> <span m="943420">to</span> <span m="943630">look</span> <span m="943960">at</span> <span m="944550">the</span> <span m="944710">taint label,</span> <span m="945320">this,</span> <span m="945830">and it's</span> <span m="946070">going</span> <span m="946320">to</span> <span m="946700">assign</span> <span m="947140">it</span> <span m="947520">over</span> <span m="947770">here.</span> </p>
<p><span m="950910">Then</span> <span m="951350">you</span> <span m="951420">might</span> <span m="951580">imagine</span> <span m="951900">you</span> <span m="951940">have</span> <span m="952090">another</span> <span m="952390">instruction</span> <span m="952950">that's</span> <span m="953130">like</span> <span m="953540">a</span> <span m="953610">binary</span> <span m="954070">operation.</span> <span m="955110">So</span> <span m="955470">think</span> <span m="955760">of</span> <span m="955870">this</span> <span m="956140">as</span> <span m="956290">something</span> <span m="956600">like</span> <span m="957400">addition,</span> <span m="958070">for</span> <span m="958230">example.</span> <span m="959300">So</span> <span m="959360">here</span> <span m="959670">you'll</span> <span m="959850">have</span> <span m="960050">a</span> <span m="960110">single</span> <span m="960440">destination,</span> <span m="961480">but</span> <span m="961640">then</span> <span m="961800">you'll</span> <span m="962010">have</span> <span m="964350">two</span> <span m="964580">sources.</span> <span m="967350">And</span> <span m="967510">what</span> <span m="967650">will</span> <span m="967750">happen</span> <span m="968050">in</span> <span m="968160">this</span> <span m="968410">case</span> <span m="969000">is</span> <span m="969430">that</span> <span m="969780">when</span> <span m="969850">Dalvik</span> <span m="970830">interpreter</span> <span m="971050">encounters</span> <span m="971310">this</span> <span m="971420">instruction,</span> <span m="972120">it'll</span> <span m="972360">take</span> <span m="972580">the</span> <span m="972690">taints</span> <span m="973040">of</span> <span m="973140">both</span> <span m="973450">of</span> <span m="973560">these,</span> <span m="974040">construct</span> <span m="974520">a</span> <span m="974640">union</span> <span m="975530">of</span> <span m="975750">those,</span> <span m="976280">and</span> <span m="976490">then</span> <span m="976640">assign</span> <span m="977480">that</span> <span m="977740">union</span> <span m="978960">to</span> <span m="979060">be the</span> <span m="979870">taint</span> <span m="980100">tag</span> <span m="980350">over</span> <span m="980530">here.</span> </p>
<p><span m="982570">Does that all</span> <span m="982620">make</span> <span m="982970">sense?</span> <span m="983090">It's fairly</span> <span m="983380">straightforward.</span> <span m="984470">So</span> <span m="984580">the</span> <span m="984690">table</span> <span m="986190">breaks</span> <span m="986600">down</span> <span m="986940">all</span> <span m="987100">the</span> <span m="987170">different</span> <span m="987400">types</span> <span m="987620">of</span> <span m="987710">instructions</span> <span m="988250">that</span> <span m="988340">you'll</span> <span m="988460">see,</span> <span m="989050">but</span> <span m="989670">to</span> <span m="989810">a first</span> <span m="990090">approximation,</span> <span m="991130">these</span> <span m="991370">are</span> <span m="991410">the</span> <span m="991510">most</span> <span m="991770">common</span> <span m="992080">ways</span> <span m="992340">that taint</span> <span m="992660">propagates</span> <span m="993120">through</span> <span m="993190">the</span> <span m="993280">system.</span> <span m="994500">Now</span> <span m="994520">there</span> <span m="994660">are</span> <span m="994940">actually</span> <span m="995420">some</span> <span m="995970">interesting</span> <span m="996410">special</span> <span m="996800">cases</span> <span m="997350">that</span> <span m="997470">they</span> <span m="997510">mention</span> <span m="998350">in</span> <span m="998490">the</span> <span m="998570">paper.</span> <span m="999240">So</span> <span m="999580">one</span> <span m="999780">of</span> <span m="999920">those</span> <span m="1001640">special</span> <span m="1001920">cases</span> <span m="1003890">involves</span> <span m="1004360">arrays.</span> </p>
<p><span m="1006680">Let's</span> <span m="1007020">say</span> <span m="1007770">that</span> <span m="1008060">you</span> <span m="1008130">have</span> <span m="1008330">some</span> <span m="1008510">code</span> <span m="1008940">that's</span> <span m="1009130">going</span> <span m="1009260">to</span> <span m="1010000">declare</span> <span m="1010500">a</span> <span m="1010560">character,</span> <span m="1012610">and</span> <span m="1013330">you</span> <span m="1013470">get</span> <span m="1013690">the</span> <span m="1013830">value</span> <span m="1014180">for</span> <span m="1014280">the</span> <span m="1014390">character</span> <span m="1014730">somehow,</span> <span m="1015170">doesn't</span> <span m="1015380">really</span> <span m="1015510">matter.</span> <span m="1016480">And</span> <span m="1016610">then</span> <span m="1016950">let's</span> <span m="1017220">say</span> <span m="1017890">the</span> <span m="1017990">program</span> <span m="1018530">declares</span> <span m="1019540">some</span> <span m="1019870">array,</span> <span m="1022380">we'll</span> <span m="1022520">call</span> <span m="1022780">it</span> <span m="1022960">upper().</span> <span m="1024609">And</span> <span m="1024730">it's</span> <span m="1024890">basically</span> <span m="1025440">going</span> <span m="1025660">to</span> <span m="1025730">have</span> <span m="1027950">uppercase</span> <span m="1029180">versions</span> <span m="1030560">of</span> <span m="1033440">letters.</span> <span m="1035020">And</span> <span m="1035119">so</span> <span m="1035250">one</span> <span m="1035390">very</span> <span m="1035589">common</span> <span m="1035890">thing</span> <span m="1036030">to</span> <span m="1036079">do</span> <span m="1036290">in</span> <span m="1036380">code</span> <span m="1036980">is</span> <span m="1037210">to</span> <span m="1037619">index</span> <span m="1038089">into</span> <span m="1038290">an</span> <span m="1038380">array</span> <span m="1038660">like</span> <span m="1038930">this</span> <span m="1039560">using,</span> <span m="1040060">for</span> <span m="1040180">example,</span> <span m="1040480">maybe</span> <span m="1040690">just</span> <span m="1040790">C</span> <span m="1041030">directly,</span> <span m="1041780">because</span> <span m="1042030">as</span> <span m="1042170">we</span> <span m="1042310">all</span> <span m="1042470">know,</span> <span m="1042859">Kernighan and Ritchie</span> <span m="1043319">teach</span> <span m="1043680">us that</span> <span m="1044270">basically</span> <span m="1044640">characters</span> <span m="1045040">are</span> <span m="1045079">integers,</span> <span m="1045640">so</span> <span m="1046150">hooray</span> <span m="1046380">for</span> <span m="1046470">that.</span> <span m="1046710">So</span> <span m="1046790">you</span> <span m="1046880">can</span> <span m="1046970">imagine</span> <span m="1047270">that</span> <span m="1047369">you</span> <span m="1047460">have</span> <span m="1049090">some</span> <span m="1049280">code</span> <span m="1049550">that</span> <span m="1049670">says</span> <span m="1049860">something</span> <span m="1049930">like</span> <span m="1050420">the</span> <span m="1050580">upper</span> <span m="1050910">case</span> <span m="1051240">version</span> <span m="1052881">of</span> <span m="1053280">this</span> <span m="1053510">character</span> <span m="1053960">here</span> <span m="1054710">is</span> <span m="1055000">going</span> <span m="1055290">to</span> <span m="1055420">be</span> <span m="1056390">whatever</span> <span m="1056900">is</span> <span m="1057010">at</span> <span m="1057110">a</span> <span m="1057180">particular</span> <span m="1057640">index</span> <span m="1058080">in</span> <span m="1058170">this</span> <span m="1058350">table</span> <span m="1058680">here,</span> <span m="1059370">in</span> <span m="1059550">the</span> <span m="1059700">index</span> <span m="1060110">that</span> <span m="1060330">table</span> <span m="1062020">by c</span> <span m="1062490">like</span> <span m="1062690">this.</span> <span m="1063400">So there's</span> <span m="1063540">a</span> <span m="1063600">question</span> <span m="1064060">of</span> <span m="1064300">what</span> <span m="1064860">taint</span> <span m="1065390">should</span> <span m="1066740">this</span> <span m="1067030">receive.</span> </p>
<p><span m="1069020">It</span> <span m="1069110">seems</span> <span m="1069350">pretty</span> <span m="1069540">straightforward</span> <span m="1070140">what</span> <span m="1070280">should</span> <span m="1070400">happen</span> <span m="1070730">in</span> <span m="1070860">these</span> <span m="1071210">cases,</span> <span m="1072030">but</span> <span m="1072210">in</span> <span m="1072340">this</span> <span m="1072590">case,</span> <span m="1072930">it</span> <span m="1072950">seems</span> <span m="1073250">like</span> <span m="1073460">we</span> <span m="1073600">have</span> <span m="1074130">multiple</span> <span m="1074580">things</span> <span m="1074800">that</span> <span m="1074950">are going</span> <span m="1075250">on.</span> <span m="1075550">We've</span> <span m="1075700">got</span> <span m="1075870">this</span> <span m="1075950">array</span> <span m="1076420">here</span> <span m="1076690">that</span> <span m="1076820">may have</span> <span m="1077070">some type</span> <span m="1077220">of taint,</span> <span m="1077810">we've got</span> <span m="1077910">this</span> <span m="1078250">character</span> <span m="1078610">c</span> <span m="1078910">here</span> <span m="1079080">that</span> <span m="1079180">may</span> <span m="1079440">have</span> <span m="1079510">some</span> <span m="1079730">type</span> <span m="1080080">of</span> <span m="1080580">taint.</span> <span m="1081500">What</span> <span m="1082570">Dalvik</span> <span m="1082800">decides</span> <span m="1083150">to</span> <span m="1083230">do</span> <span m="1083380">in</span> <span m="1083480">this</span> <span m="1083710">case</span> <span m="1084350">is</span> <span m="1084790">a little</span> <span m="1085110">bit</span> <span m="1085260">similar</span> <span m="1085570">to</span> <span m="1085650">what</span> <span m="1085800">it does</span> <span m="1085870">in the</span> <span m="1086280">case</span> <span m="1086530">of</span> <span m="1086600">this</span> <span m="1086760">binary</span> <span m="1087230">op</span> <span m="1087430">here.</span> <span m="1088000">So</span> <span m="1088150">it's</span> <span m="1088250">essentially</span> <span m="1088630">going</span> <span m="1088810">to</span> <span m="1088890">say</span> <span m="1089210">that</span> <span m="1090140">this</span> <span m="1090310">character</span> <span m="1090680">over</span> <span m="1090840">here</span> <span m="1091450">is</span> <span m="1091620">going</span> <span m="1091780">to</span> <span m="1091840">get</span> <span m="1092060">the</span> <span m="1092190">union</span> <span m="1092760">of</span> <span m="1092900">the</span> <span m="1093010">taint</span> <span m="1093820">of c</span> <span m="1094820">and</span> <span m="1095070">also</span> <span m="1095500">of the</span> <span m="1095730">array.</span> </p>
<p><span m="1096800">And</span> <span m="1097080">the</span> <span m="1097300">intuition</span> <span m="1097850">behind</span> <span m="1098280">that</span> <span m="1098690">is</span> <span m="1098820">that</span> <span m="1099250">to</span> <span m="1099430">generate</span> <span m="1099930">this</span> <span m="1100120">character,</span> <span m="1100880">we</span> <span m="1101030">somehow</span> <span m="1101420">had</span> <span m="1101630">to</span> <span m="1101700">know</span> <span m="1102130">something</span> <span m="1103000">about</span> <span m="1103620">this</span> <span m="1103820">array</span> <span m="1104130">here.</span> <span m="1104320">We</span> <span m="1104610">had to</span> <span m="1104900">know</span> <span m="1105260">something</span> <span m="1105630">about</span> <span m="1106090">this</span> <span m="1106270">index</span> <span m="1106630">here.</span> <span m="1107090">So</span> <span m="1107140">therefore</span> <span m="1107420">I</span> <span m="1107450">guess</span> <span m="1107620">it</span> <span m="1107710">makes</span> <span m="1107920">sense</span> <span m="1108160">that</span> <span m="1108620">this</span> <span m="1108840">thing</span> <span m="1109370">should</span> <span m="1109640">be</span> <span m="1109960">as</span> <span m="1110090">sensitive</span> <span m="1110540">as</span> <span m="1110660">both</span> <span m="1110890">of</span> <span m="1110980">these</span> <span m="1111180">things</span> <span m="1111390">combined.</span> </p>
<p><span m="1115580">AUDIENCE:</span> <span m="1116060">Can you</span> <span m="1116540">explain again</span> <span m="1117020">move</span> <span m="1117500">op and</span> <span m="1117980">binary op,</span> <span m="1118460">what exactly it means,</span> <span m="1118940">like</span> <span m="1119420">the union</span> <span m="1119900">of a</span> <span m="1120380">taint.</span> </p>
<p><span m="1120860">PROFESSOR:</span> <span m="1121340">Yes,</span> <span m="1121700">so</span> <span m="1122190">imagine</span> <span m="1123470">that--</span> <span m="1127950">let's</span> <span m="1128180">look</span> <span m="1128320">at</span> <span m="1128480">the</span> <span m="1128960">move</span> <span m="1129200">op</span> <span m="1129380">here.</span> <span m="1129800">So</span> <span m="1130030">imagine</span> <span m="1130540">that</span> <span m="1131000">this</span> <span m="1131290">source</span> <span m="1131600">operation</span> <span m="1132180">here</span> <span m="1132740">just</span> <span m="1133030">had--</span> <span m="1134770">actually,</span> <span m="1135170">let me get</span> <span m="1135210">more</span> <span m="1135370">concrete.</span> <span m="1136050">So</span> <span m="1136200">each</span> <span m="1136560">variable,</span> <span m="1137140">as</span> <span m="1137280">I'll</span> <span m="1137310">described</span> <span m="1137760">in a</span> <span m="1137840">second</span> <span m="1138250">what</span> <span m="1138410">a</span> <span m="1138620">variable</span> <span m="1139060">is,</span> <span m="1139450">has</span> <span m="1139630">this</span> <span m="1139780">integer,</span> <span m="1140270">essentially,</span> <span m="1140610">that</span> <span m="1140750">has</span> <span m="1140960">a</span> <span m="1141000">bunch</span> <span m="1141250">of</span> <span m="1141340">bits</span> <span m="1141710">that</span> <span m="1141990">are set</span> <span m="1142460">according</span> <span m="1142800">to</span> <span m="1142910">what</span> <span m="1143160">taint</span> <span m="1143500">it has.</span> <span m="1144550">So</span> <span m="1144680">imagine</span> <span m="1145130">each</span> <span m="1145300">one</span> <span m="1145430">of</span> <span m="1145470">these</span> <span m="1145660">values</span> <span m="1146060">flying</span> <span m="1146410">around</span> <span m="1146760">has</span> <span m="1146940">this</span> <span m="1147090">associated</span> <span m="1147540">integer</span> <span m="1147990">flying</span> <span m="1148270">around</span> <span m="1148440">that</span> <span m="1148510">has</span> <span m="1148660">some</span> <span m="1148770">bits</span> <span m="1149060">set.</span> </p>
<p><span m="1149740">So</span> <span m="1150630">let's</span> <span m="1150920">say</span> <span m="1151150">that this</span> <span m="1151360">source</span> <span m="1152190">had</span> <span m="1153040">two</span> <span m="1153310">bits set,</span> <span m="1154040">corresponding</span> <span m="1154620">to</span> <span m="1154680">the fact</span> <span m="1154890">that it had</span> <span m="1155020">been tainted</span> <span m="1155470">by</span> <span m="1155630">two</span> <span m="1155850">things,</span> <span m="1156540">it</span> <span m="1156650">doesn't</span> <span m="1156860">really</span> <span m="1157010">matter.</span> <span m="1157510">So</span> <span m="1157640">what</span> <span m="1157760">the</span> <span m="1157850">interpreter</span> <span m="1158330">will</span> <span m="1158480">do</span> <span m="1158970">is</span> <span m="1159120">it will</span> <span m="1159220">look</span> <span m="1159480">at</span> <span m="1159570">this</span> <span m="1159670">source</span> <span m="1160040">thing,</span> <span m="1161080">it'll</span> <span m="1161350">look</span> <span m="1161560">at</span> <span m="1161640">the</span> <span m="1161740">associated</span> <span m="1162280">integer,</span> <span m="1162560">and</span> <span m="1162910">it'll</span> <span m="1163150">say</span> <span m="1163390">aha.</span> <span m="1164550">I</span> <span m="1164650">should</span> <span m="1164890">take</span> <span m="1165450">that</span> <span m="1165680">integer</span> <span m="1166100">has</span> <span m="1166280">those</span> <span m="1166470">two</span> <span m="1166600">bits</span> <span m="1166890">set</span> <span m="1167410">and</span> <span m="1167610">then</span> <span m="1168210">essentially</span> <span m="1170040">make</span> <span m="1170390">that</span> <span m="1171010">integer</span> <span m="1171810">the</span> <span m="1172250">taint</span> <span m="1172550">tag for</span> <span m="1172670">this.</span> </p>
<p><span m="1173940">So</span> <span m="1174130">that's sort of a</span> <span m="1174250">simple</span> <span m="1174600">case,</span> <span m="1174900">right.</span> <span m="1175400">The</span> <span m="1175490">more</span> <span m="1175650">complicated</span> <span m="1176025">case,</span> <span m="1176400">like what</span> <span m="1176560">does</span> <span m="1176680">the union</span> <span m="1177160">actually</span> <span m="1177490">look</span> <span m="1177670">like.</span> <span m="1178060">So</span> <span m="1178220">imagine</span> <span m="1178680">that</span> <span m="1182520">we've</span> <span m="1182800">got</span> <span m="1183230">these</span> <span m="1183560">two</span> <span m="1183730">things</span> <span m="1184070">here</span> <span m="1184480">and</span> <span m="1184650">we've</span> <span m="1184900">got</span> <span m="1186250">source</span> <span m="1186730">0,</span> <span m="1188130">source</span> <span m="1188510">1.</span> <span m="1188960">And</span> <span m="1189110">so</span> <span m="1189190">I'm</span> <span m="1189270">going</span> <span m="1189360">to</span> <span m="1189400">show</span> <span m="1189600">you here,</span> <span m="1189940">these</span> <span m="1190190">are</span> <span m="1192250">the</span> <span m="1192400">tainted</span> <span m="1192790">bits</span> <span m="1193410">for</span> <span m="1193520">this</span> <span m="1193700">particular--</span> </p>
<p><span m="1193990">AUDIENCE:</span> <span m="1194280">[INAUDIBLE]?</span> </p>
<p><span m="1194635">PROFESSOR:</span> <span m="1194990">Yeah,</span> <span m="1195440">so</span> <span m="1196090">imagine</span> <span m="1196500">that</span> <span m="1196650">you</span> <span m="1196720">have</span> <span m="1198950">this</span> <span m="1199130">is</span> <span m="1199240">the</span> <span m="1199330">taint</span> <span m="1199660">for this</span> <span m="1199860">one.</span> <span m="1200110">And</span> <span m="1200190">imagine</span> <span m="1200620">that</span> <span m="1202450">the</span> <span m="1202550">taint</span> <span m="1202770">for this</span> <span m="1202990">one</span> <span m="1203100">is</span> <span m="1203220">this.</span> <span m="1203650">So</span> <span m="1204120">what's</span> <span m="1204280">the</span> <span m="1204400">taint</span> <span m="1204640">going to</span> <span m="1204680">look</span> <span m="1204970">like</span> <span m="1205380">for</span> <span m="1206270">dest?</span> <span m="1207030">You basically</span> <span m="1207430">take</span> <span m="1207720">all</span> <span m="1208050">of</span> <span m="1208300">the bits</span> <span m="1209866">that</span> <span m="1210320">are</span> <span m="1210560">saying</span> <span m="1210910">either</span> <span m="1211160">one</span> <span m="1211390">of</span> <span m="1211490">those</span> <span m="1212140">and then</span> <span m="1212290">assign</span> <span m="1212760">that</span> <span m="1212970">to</span> <span m="1213050">that</span> <span m="1214570">throwback</span> <span m="1214870">to</span> <span m="1215000">this</span> <span m="1215260">one.</span> </p>
<p><span m="1215710">AUDIENCE:</span> <span m="1216160">All right, thanks.</span> </p>
<p><span m="1216610">PROFESSOR:</span> <span m="1216700">Yeah,</span> <span m="1216870">no</span> <span m="1216950">problem.</span> <span m="1217510">And</span> <span m="1217620">so</span> <span m="1218320">one</span> <span m="1218590">reasons,</span> <span m="1218910">so once</span> <span m="1219100">again</span> <span m="1219940">I</span> <span m="1220030">should</span> <span m="1220330">emphasize</span> <span m="1220480">this,</span> <span m="1220940">so</span> <span m="1221300">since</span> <span m="1221690">we</span> <span m="1221990">can</span> <span m="1222350">represent</span> <span m="1222930">all the</span> <span m="1223270">possible</span> <span m="1223630">taints</span> <span m="1224050">in this</span> <span m="1224200">32 bits,</span> <span m="1225170">as</span> <span m="1225370">we</span> <span m="1225500">were just</span> <span m="1225550">discussing,</span> <span m="1226590">doing</span> <span m="1226850">this</span> <span m="1227020">operation</span> <span m="1227430">here,</span> <span m="1227710">it's just</span> <span m="1227880">bitwise</span> <span m="1228210">operations.</span> <span m="1229110">So</span> <span m="1229130">this</span> <span m="1229230">actually</span> <span m="1229470">really</span> <span m="1229780">cuts</span> <span m="1230020">down</span> <span m="1230440">on the</span> <span m="1230570">overhead</span> <span m="1231040">from implementing</span> <span m="1231300">these</span> <span m="1231560">taint</span> <span m="1231890">bits.</span> <span m="1232500">If</span> <span m="1232620">you</span> <span m="1232710">had</span> <span m="1232860">to</span> <span m="1233070">express</span> <span m="1233700">a</span> <span m="1233810">larger</span> <span m="1234190">universe</span> <span m="1234485">of</span> <span m="1234780">taints then</span> <span m="1235160">you</span> <span m="1235330">might</span> <span m="1235520">be</span> <span m="1235610">in</span> <span m="1235690">trouble,</span> <span m="1236030">because</span> <span m="1236250">you</span> <span m="1236310">might</span> <span m="1236450">not</span> <span m="1236570">be</span> <span m="1236650">able</span> <span m="1236830">to</span> <span m="1236930">use</span> <span m="1237420">these</span> <span m="1237570">very</span> <span m="1237830">efficient</span> <span m="1238570">bitwise</span> <span m="1239070">operations</span> <span m="1239540">to do things.</span> <span m="1241440">Any</span> <span m="1241550">other</span> <span m="1241710">questions</span> <span m="1242100">about</span> <span m="1242350">that?</span> <span m="1244100">OK.</span> </p>
<p><span m="1247270">So</span> <span m="1247620">the</span> <span m="1247740">way</span> <span m="1247910">that</span> <span m="1248130">arrays</span> <span m="1248430">work</span> <span m="1248980">is</span> <span m="1249290">a</span> <span m="1249350">little</span> <span m="1249490">bit</span> <span m="1249600">like</span> <span m="1249730">that</span> <span m="1249840">binary</span> <span m="1250180">op</span> <span m="1250490">like I mentioned.</span> <span m="1250920">So</span> <span m="1251430">this</span> <span m="1251770">is</span> <span m="1251880">going to get</span> <span m="1252090">the</span> <span m="1252560">union</span> <span m="1253010">of</span> <span m="1253120">the taint</span> <span m="1253600">of this</span> <span m="1254670">and</span> <span m="1254850">that.</span> <span m="1256290">And</span> <span m="1256440">so</span> <span m="1257120">one</span> <span m="1257390">design</span> <span m="1257850">decision</span> <span m="1258120">that</span> <span m="1258390">they made</span> <span m="1259030">in</span> <span m="1259490">TaintDroid</span> <span m="1259950">is</span> <span m="1260200">that</span> <span m="1260880">they</span> <span m="1261080">associate</span> <span m="1262330">a</span> <span m="1263000">single</span> <span m="1264080">taint</span> <span m="1264480">tab</span> <span m="1265510">with</span> <span m="1266980">each</span> <span m="1267210">array.</span> <span m="1267900">So</span> <span m="1268110">in</span> <span m="1268150">other</span> <span m="1268240">words,</span> <span m="1268500">they're</span> <span m="1268680">not</span> <span m="1268980">going</span> <span m="1269240">to</span> <span m="1269810">try</span> <span m="1270160">to</span> <span m="1271290">taint</span> <span m="1271700">all</span> <span m="1271980">the</span> <span m="1272210">individual</span> <span m="1273210">elements</span> <span m="1273590">in</span> <span m="1273720">there.</span> <span m="1274130">So</span> <span m="1274240">basically</span> <span m="1274310">what's</span> <span m="1274450">going to</span> <span m="1274670">end</span> <span m="1274850">up</span> <span m="1274950">happening</span> <span m="1275310">is</span> <span m="1275420">that</span> <span m="1276630">this</span> <span m="1276970">is</span> <span m="1277190">going</span> <span m="1277570">to</span> <span m="1277990">save</span> <span m="1278410">them</span> <span m="1278550">storage</span> <span m="1278960">space,</span> <span m="1279660">right,</span> <span m="1280290">because for</span> <span m="1280650">each array they</span> <span m="1281030">declare,</span> <span m="1281840">they'll</span> <span m="1281970">just</span> <span m="1282080">have</span> <span m="1282250">a</span> <span m="1282300">single</span> <span m="1282730">through route to the entity</span> <span m="1283790">that sort of</span> <span m="1283900">floats</span> <span m="1284290">around</span> <span m="1284580">that</span> <span m="1284700">array</span> <span m="1285250">and</span> <span m="1285330">represents</span> <span m="1285690">all</span> <span m="1285900">the</span> <span m="1285990">taint</span> <span m="1286840">that</span> <span m="1287040">belongs</span> <span m="1287940">to</span> <span m="1287990">that</span> <span m="1288210">array.</span> </p>
<p><span m="1292270">There</span> <span m="1292490">is</span> <span m="1292600">one</span> <span m="1292820">question</span> <span m="1293220">about</span> <span m="1293510">why</span> <span m="1293950">is</span> <span m="1294170">it</span> <span m="1294570">safe</span> <span m="1295210">to</span> <span m="1295630">not</span> <span m="1296270">have</span> <span m="1296620">a</span> <span m="1296840">finer</span> <span m="1297240">grain</span> <span m="1297690">system</span> <span m="1298670">for</span> <span m="1298860">taint.</span> <span m="1300010">Because</span> <span m="1300310">it</span> <span m="1300440">seems</span> <span m="1300700">like</span> <span m="1300880">an</span> <span m="1300960">array</span> <span m="1301430">is</span> <span m="1301580">a</span> <span m="1301710">collection</span> <span m="1302300">of</span> <span m="1302400">data,</span> <span m="1303110">so</span> <span m="1303290">why</span> <span m="1303510">shouldn't</span> <span m="1303770">we</span> <span m="1303880">have</span> <span m="1304130">a</span> <span m="1304170">bunch</span> <span m="1304500">of</span> <span m="1304620">labels</span> <span m="1305030">flying</span> <span m="1305380">around</span> <span m="1305680">for</span> <span m="1305830">each</span> <span m="1306160">thing</span> <span m="1306350">that's</span> <span m="1306630">in</span> <span m="1306800">that</span> <span m="1306960">array?</span> <span m="1308010">And</span> <span m="1308470">so</span> <span m="1309040">the</span> <span m="1309220">answer</span> <span m="1309510">to</span> <span m="1309580">that</span> <span m="1309960">is</span> <span m="1310100">that</span> <span m="1310630">by</span> <span m="1310840">only</span> <span m="1311190">associating</span> <span m="1311880">one</span> <span m="1312150">taint</span> <span m="1312420">tag</span> <span m="1312690">with</span> <span m="1312830">the</span> <span m="1313000">array</span> <span m="1313380">and</span> <span m="1313570">making</span> <span m="1313910">it</span> <span m="1314070">the</span> <span m="1314560">union</span> <span m="1315140">of</span> <span m="1315250">all</span> <span m="1315430">the</span> <span m="1315540">things</span> <span m="1315850">that's</span> <span m="1316020">inside,</span> <span m="1316910">that actually</span> <span m="1317210">is</span> <span m="1317310">going</span> <span m="1317560">to</span> <span m="1318170">overestimate</span> <span m="1318655">taint.</span> <span m="1320500">So</span> <span m="1320710">in</span> <span m="1320800">other</span> <span m="1320920">words,</span> <span m="1321440">if</span> <span m="1321500">you</span> <span m="1321630">have</span> <span m="1321810">an</span> <span m="1321880">array</span> <span m="1322450">that</span> <span m="1322590">has</span> <span m="1322860">two</span> <span m="1323110">items</span> <span m="1323490">in it,</span> <span m="1323960">and</span> <span m="1324050">that</span> <span m="1324180">array</span> <span m="1324580">is</span> <span m="1324700">tainted</span> <span m="1324830">with</span> <span m="1324960">the</span> <span m="1325060">union</span> <span m="1325390">of</span> <span m="1325490">all of</span> <span m="1325790">those</span> <span m="1326010">things,</span> <span m="1326640">well,</span> <span m="1326820">that's</span> <span m="1327040">probably</span> <span m="1327670">a</span> <span m="1327740">little</span> <span m="1328010">bit--</span> <span m="1328780">it's</span> <span m="1329180">conservative.</span> <span m="1329930">Because</span> <span m="1330100">it</span> <span m="1330220">may be</span> <span m="1330475">that if</span> <span m="1330730">something</span> <span m="1331050">only</span> <span m="1331300">accesses</span> <span m="1331770">this,</span> <span m="1332270">maybe</span> <span m="1332580">it didn't</span> <span m="1332810">learn</span> <span m="1333070">anything</span> <span m="1333420">about</span> <span m="1333620">the</span> <span m="1333710">taint</span> <span m="1333880">that</span> <span m="1333980">was</span> <span m="1334140">over</span> <span m="1334320">here.</span> </p>
<p><span m="1335070">But</span> <span m="1335260">by</span> <span m="1335380">being</span> <span m="1335650">conservative,</span> <span m="1336740">hopefully</span> <span m="1337560">we</span> <span m="1337720">will</span> <span m="1337910">always</span> <span m="1338430">be</span> <span m="1338920">correct.</span> <span m="1339900">In</span> <span m="1340000">other</span> <span m="1340110">words,</span> <span m="1340450">if</span> <span m="1340480">we</span> <span m="1340630">underestimate</span> <span m="1341065">the</span> <span m="1341500">amount of taint that</span> <span m="1342000">something</span> <span m="1342200">had,</span> <span m="1342620">then</span> <span m="1342720">we might</span> <span m="1343030">accidentally</span> <span m="1343820">disclose</span> <span m="1344320">something</span> <span m="1344540">that</span> <span m="1344630">we</span> <span m="1344750">didn't</span> <span m="1344960">want</span> <span m="1345090">to</span> <span m="1345130">actually</span> <span m="1345410">disclose.</span> <span m="1346050">But if we</span> <span m="1346410">overestimate,</span> <span m="1347470">then</span> <span m="1347760">in the</span> <span m="1347860">worst</span> <span m="1348310">case,</span> <span m="1348570">maybe</span> <span m="1348935">we</span> <span m="1349300">prevent</span> <span m="1349900">something</span> <span m="1350270">from going</span> <span m="1350510">outside</span> <span m="1350820">of</span> <span m="1350880">the</span> <span m="1350950">phone</span> <span m="1351540">that</span> <span m="1351700">should</span> <span m="1351860">actually</span> <span m="1352260">OK,</span> <span m="1353220">but we're</span> <span m="1353290">going</span> <span m="1353380">to</span> <span m="1353470">be</span> <span m="1353590">err</span> <span m="1353770">on the side</span> <span m="1354100">of safety.</span> <span m="1355110">Does</span> <span m="1355150">that</span> <span m="1355350">all</span> <span m="1355500">makes</span> <span m="1355690">sense?</span> </p>
<p><span m="1358790">Another</span> <span m="1359780">instance</span> <span m="1360850">of--</span> <span m="1362180">a sort of</span> <span m="1362400">special</span> <span m="1362800">case</span> <span m="1363710">taint</span> <span m="1363910">propagation</span> <span m="1364500">that they</span> <span m="1364620">mention</span> <span m="1365860">are</span> <span m="1366280">things</span> <span m="1366720">like</span> <span m="1369090">native</span> <span m="1369540">methods.</span> <span m="1374120">And</span> <span m="1374360">so</span> <span m="1374740">native</span> <span m="1375060">methods</span> <span m="1375610">might</span> <span m="1375900">exist</span> <span m="1376320">inside</span> <span m="1377010">of</span> <span m="1377340">the v</span> <span m="1377570">in</span> <span m="1377680">itself,</span> <span m="1378900">so</span> <span m="1379280">for</span> <span m="1379400">example,</span> <span m="1379860">the Dalvik</span> <span m="1380190">VM</span> <span m="1381020">exposes</span> <span m="1381580">some</span> <span m="1381830">function</span> <span m="1382360">like</span> <span m="1383030">a</span> <span m="1383220">System.arraycopy(),</span> <span m="1386500">so</span> <span m="1386650">we</span> <span m="1386710">can</span> <span m="1386840">pass</span> <span m="1387190">in</span> <span m="1387550">anything</span> <span m="1387810">through</span> <span m="1388120">this,</span> <span m="1388330">and</span> <span m="1388630">internal</span> <span m="1389040">to</span> <span m="1389110">the</span> <span m="1389270">VM,</span> <span m="1390440">this</span> <span m="1390630">is</span> <span m="1390740">implemented</span> <span m="1391560">in</span> <span m="1392170">C</span> <span m="1392230">or</span> <span m="1392576">C++</span> <span m="1393270">code</span> <span m="1394490">for</span> <span m="1394640">reasons</span> <span m="1394940">of</span> <span m="1395020">speed.</span> <span m="1395750">That's</span> <span m="1395950">one</span> <span m="1396110">type</span> <span m="1396300">of</span> <span m="1396700">example</span> <span m="1397140">of a native</span> <span m="1397430">method</span> <span m="1397670">you</span> <span m="1397760">might</span> <span m="1397920">have.</span> </p>
<p><span m="1398510">Another</span> <span m="1398880">thing</span> <span m="1399170">you</span> <span m="1399250">might</span> <span m="1399480">have,</span> <span m="1402280">a</span> <span m="1402380">type of</span> <span m="1402620">native</span> <span m="1402780">method</span> <span m="1402950">is what</span> <span m="1403060">they</span> <span m="1403150">call</span> <span m="1404130">JNI</span> <span m="1405540">expose</span> <span m="1405980">methods.</span> <span m="1408800">So</span> <span m="1409960">the</span> <span m="1410090">native</span> <span m="1410430">interface</span> <span m="1410890">essentially</span> <span m="1411310">allows</span> <span m="1412420">Java</span> <span m="1412880">code</span> <span m="1413400">to</span> <span m="1413680">call</span> <span m="1414200">into</span> <span m="1415120">code</span> <span m="1415330">that</span> <span m="1415440">is</span> <span m="1415580">not</span> <span m="1415830">Java,</span> <span m="1416400">that's</span> <span m="1416570">implemented</span> <span m="1417020">using</span> <span m="1417650">x86</span> <span m="1417935">or</span> <span m="1418220">ARM</span> <span m="1418520">or</span> <span m="1418590">something</span> <span m="1418830">like that.</span> <span m="1419450">There's</span> <span m="1419590">a</span> <span m="1419650">whole</span> <span m="1419920">calling</span> <span m="1420990">convention</span> <span m="1421430">that's</span> <span m="1421550">exposed</span> <span m="1422010">here</span> <span m="1422380">to</span> <span m="1422530">allow</span> <span m="1422770">those</span> <span m="1422950">two</span> <span m="1423060">types</span> <span m="1423280">of</span> <span m="1423350">stacks to</span> <span m="1423850">interoperate.</span> <span m="1425330">And</span> <span m="1425500">so</span> <span m="1426110">the</span> <span m="1426260">problem</span> <span m="1427260">with</span> <span m="1427990">these</span> <span m="1428280">native</span> <span m="1428680">code</span> <span m="1429030">methods,</span> <span m="1429460">from</span> <span m="1429600">the</span> <span m="1429690">perspective</span> <span m="1430950">of</span> <span m="1431190">tracking</span> <span m="1431660">taint,</span> <span m="1432370">is</span> <span m="1432820">that</span> <span m="1433680">this</span> <span m="1433970">native</span> <span m="1434390">code</span> <span m="1434900">is</span> <span m="1435100">not</span> <span m="1435460">being</span> <span m="1435670">executed</span> <span m="1436780">directly</span> <span m="1437440">by</span> <span m="1437750">the</span> <span m="1437980">Dalvik</span> <span m="1438380">interpreter.</span> <span m="1439540">In</span> <span m="1439710">fact,</span> <span m="1440010">it is</span> <span m="1440200">often</span> <span m="1440660">not</span> <span m="1440850">even</span> <span m="1441080">Java</span> <span m="1441450">code,</span> <span m="1441840">maybe</span> <span m="1442060">C or</span> <span m="1442430">C++</span> <span m="1442770">code.</span> <span m="1443400">So</span> <span m="1443540">that</span> <span m="1443690">means</span> <span m="1444000">that</span> <span m="1444410">once</span> <span m="1444930">execution</span> <span m="1445600">flow</span> <span m="1445910">goes</span> <span m="1446300">into</span> <span m="1446970">one of</span> <span m="1447110">these</span> <span m="1447340">native</span> <span m="1447610">methods,</span> <span m="1449020">TaintDroid</span> <span m="1449760">can't</span> <span m="1449970">do any</span> <span m="1450300">of this</span> <span m="1451460">taint</span> <span m="1451760">propagation</span> <span m="1452690">that</span> <span m="1452820">it's</span> <span m="1452980">doing</span> <span m="1453240">for</span> <span m="1453380">code</span> <span m="1454030">that</span> <span m="1454210">lives</span> <span m="1454800">in</span> <span m="1455020">the</span> <span m="1455150">Java</span> <span m="1455490">world.</span> </p>
<p><span m="1457010">So</span> <span m="1457130">that</span> <span m="1457340">seems</span> <span m="1457560">a</span> <span m="1457630">little</span> <span m="1457810">bit</span> <span m="1457970">problematic</span> <span m="1458930">because</span> <span m="1459230">these</span> <span m="1459430">things</span> <span m="1459630">are</span> <span m="1459700">kind</span> <span m="1459870">of</span> <span m="1459970">like</span> <span m="1460180">black</span> <span m="1460450">boxes.</span> <span m="1461630">You</span> <span m="1461790">want</span> <span m="1461950">to</span> <span m="1462000">make</span> <span m="1462180">sure</span> <span m="1462560">that</span> <span m="1463020">when</span> <span m="1463190">these</span> <span m="1463400">methods</span> <span m="1464260">return,</span> <span m="1465360">we</span> <span m="1465490">can</span> <span m="1465640">actually</span> <span m="1465970">somehow</span> <span m="1466480">represent</span> <span m="1468640">the</span> <span m="1468720">new</span> <span m="1469045">taint</span> <span m="1469370">that was</span> <span m="1469550">created</span> <span m="1470190">by</span> <span m="1470330">the</span> <span m="1470400">execution</span> <span m="1470720">of those</span> <span m="1471040">methods.</span> <span m="1471690">And</span> <span m="1471870">so</span> <span m="1472570">the</span> <span m="1472970">way</span> <span m="1473440">that</span> <span m="1473780">the</span> <span m="1474230">authors</span> <span m="1476630">solve</span> <span m="1477160">this</span> <span m="1477430">issue</span> <span m="1478180">is,</span> <span m="1478490">they</span> <span m="1478630">essentially</span> <span m="1479190">result</span> <span m="1479730">to</span> <span m="1481530">manual</span> <span m="1482560">analysis.</span> <span m="1486160">So</span> <span m="1486840">they</span> <span m="1487630">basically</span> <span m="1488250">say,</span> <span m="1488950">there</span> <span m="1489080">are not</span> <span m="1489310">a</span> <span m="1489390">whole</span> <span m="1489680">lot</span> <span m="1489890">of</span> <span m="1489980">these</span> <span m="1490150">types</span> <span m="1490380">of</span> <span m="1490460">methods</span> <span m="1490830">here.</span> <span m="1491890">So</span> <span m="1492040">for</span> <span m="1492180">example,</span> <span m="1493230">the</span> <span m="1493380">Dalvik</span> <span m="1493690">VM</span> <span m="1493930">only</span> <span m="1494350">exposes</span> <span m="1494650">a</span> <span m="1494780">certain</span> <span m="1495100">number</span> <span m="1495430">of</span> <span m="1495580">functions</span> <span m="1495930">like</span> <span m="1496270">Systems.arraycopy(),</span> <span m="1497290">so</span> <span m="1497630">we</span> <span m="1498000">as human</span> <span m="1498160">developers</span> <span m="1498840">can</span> <span m="1498990">look</span> <span m="1499200">through</span> <span m="1499420">this</span> <span m="1499600">relatively</span> <span m="1500080">small</span> <span m="1500420">number</span> <span m="1501640">of</span> <span m="1501820">calls</span> <span m="1502540">and</span> <span m="1502670">essentially</span> <span m="1503040">figure</span> <span m="1503510">out</span> <span m="1503730">what</span> <span m="1503860">the</span> <span m="1503970">taint</span> <span m="1504240">relationship</span> <span m="1504760">should</span> <span m="1504980">be.</span> </p>
<p><span m="1505560">So</span> <span m="1505770">for</span> <span m="1505930">example,</span> <span m="1506330">they</span> <span m="1506450">can</span> <span m="1506610">look</span> <span m="1506950">at</span> <span m="1507060">something</span> <span m="1507440">like</span> <span m="1507870">array</span> <span m="1508150">copy</span> <span m="1508510">and</span> <span m="1508620">say,</span> <span m="1508950">OK,</span> <span m="1509190">based</span> <span m="1509440">on</span> <span m="1509480">what</span> <span m="1509600">we</span> <span m="1509700">know</span> <span m="1509840">the</span> <span m="1509950">semantics</span> <span m="1510420">of this</span> <span m="1510590">operation</span> <span m="1511140">are,</span> <span m="1511840">we</span> <span m="1512010">know</span> <span m="1512360">that</span> <span m="1512490">we</span> <span m="1512610">should</span> <span m="1512840">taint</span> <span m="1513110">the</span> <span m="1513200">return</span> <span m="1513590">values</span> <span m="1513950">from</span> <span m="1514020">this</span> <span m="1514170">function</span> <span m="1515070">in</span> <span m="1515200">a</span> <span m="1515240">certain</span> <span m="1515590">way</span> <span m="1515960">given</span> <span m="1516510">the</span> <span m="1516620">input</span> <span m="1516910">values</span> <span m="1517970">to this</span> <span m="1518150">function.</span> <span m="1519660">And</span> <span m="1519740">so</span> <span m="1521000">how</span> <span m="1521230">well</span> <span m="1521550">does this</span> <span m="1521660">scale?</span> <span m="1522700">Well,</span> <span m="1523430">if</span> <span m="1523650">there</span> <span m="1523940">are</span> <span m="1524190">in fact</span> <span m="1524500">only</span> <span m="1524760">a</span> <span m="1524820">small</span> <span m="1525260">number</span> <span m="1525690">of</span> <span m="1525940">things</span> <span m="1526210">exposed</span> <span m="1527840">by,</span> <span m="1528220">for</span> <span m="1528330">example,</span> <span m="1528690">the VM</span> <span m="1528970">in</span> <span m="1529250">native</span> <span m="1529550">code,</span> <span m="1530300">this actually</span> <span m="1530630">works</span> <span m="1531170">OK.</span> <span m="1531960">Because</span> <span m="1532290">if</span> <span m="1532370">you</span> <span m="1532500">assume</span> <span m="1532880">that</span> <span m="1533000">the</span> <span m="1533080">Dalvik</span> <span m="1533430">VM</span> <span m="1533710">interface</span> <span m="1534150">doesn't</span> <span m="1534410">change</span> <span m="1534760">very</span> <span m="1534980">often,</span> <span m="1535730">then</span> <span m="1535870">it's</span> <span m="1535980">actually</span> <span m="1536350">not</span> <span m="1536640">too</span> <span m="1536820">burdensome</span> <span m="1537670">to</span> <span m="1537770">look</span> <span m="1537970">at</span> <span m="1538060">these</span> <span m="1538290">things,</span> <span m="1538670">view the</span> <span m="1538920">documentation,</span> <span m="1539300">and</span> <span m="1539680">figure</span> <span m="1539930">out</span> <span m="1540020">how</span> <span m="1540160">taint's</span> <span m="1541364">going</span> <span m="1541806">to</span> <span m="1542410">spread.</span> </p>
<p><span m="1543350">This</span> <span m="1543890">may</span> <span m="1544360">or</span> <span m="1544470">may</span> <span m="1544600">not</span> <span m="1544990">be</span> <span m="1545120">more</span> <span m="1545360">troublesome.</span> <span m="1546590">They</span> <span m="1546860">give</span> <span m="1547020">some</span> <span m="1547180">empirical</span> <span m="1547640">data</span> <span m="1547990">that suggests</span> <span m="1548430">that</span> <span m="1548520">a</span> <span m="1548570">lot</span> <span m="1548790">of</span> <span m="1548880">applications</span> <span m="1549790">are</span> <span m="1549940">not,</span> <span m="1550290">in</span> <span m="1550370">fact,</span> <span m="1551100">including</span> <span m="1554110">code</span> <span m="1554730">alongside</span> <span m="1555280">of them</span> <span m="1555680">that's actually</span> <span m="1555960">going to</span> <span m="1556190">execute</span> <span m="1556970">in</span> <span m="1557110">C</span> <span m="1557400">or</span> <span m="1557500">C++.</span> <span m="1558320">So</span> <span m="1558450">they</span> <span m="1559070">argued</span> <span m="1559140">that empirically,</span> <span m="1559650">this</span> <span m="1559820">is</span> <span m="1559910">not</span> <span m="1560140">going to be a big</span> <span m="1560520">problem.</span> <span m="1561170">They</span> <span m="1561260">also</span> <span m="1561600">argue</span> <span m="1561990">that</span> <span m="1563410">for</span> <span m="1563570">certain</span> <span m="1563950">types</span> <span m="1564440">of</span> <span m="1564870">method</span> <span m="1564990">signatures,</span> <span m="1565840">you</span> <span m="1565940">can</span> <span m="1566070">actually</span> <span m="1566470">automate</span> <span m="1567090">the</span> <span m="1567180">way</span> <span m="1567680">in</span> <span m="1567820">which</span> <span m="1568430">these</span> <span m="1569610">taint</span> <span m="1569900">calculations</span> <span m="1570540">are</span> <span m="1570610">done.</span> <span m="1571160">So</span> <span m="1571270">they</span> <span m="1571410">say</span> <span m="1571720">that,</span> <span m="1572150">for</span> <span m="1572270">example,</span> <span m="1572555">if</span> <span m="1572840">only</span> <span m="1573170">integers</span> <span m="1573580">or</span> <span m="1573690">strings</span> <span m="1574130">are</span> <span m="1574210">pass</span> <span m="1574540">in to</span> <span m="1574710">some</span> <span m="1574900">of</span> <span m="1574980">these</span> <span m="1575300">native</span> <span m="1575900">functions</span> <span m="1576310">here,</span> <span m="1576860">then</span> <span m="1577000">we</span> <span m="1577080">can</span> <span m="1577280">just</span> <span m="1577410">do the</span> <span m="1577510">standard</span> <span m="1578010">thing</span> <span m="1578360">of</span> <span m="1578790">tagging</span> <span m="1579380">the</span> <span m="1579700">output</span> <span m="1580150">value</span> <span m="1580810">with</span> <span m="1580980">the</span> <span m="1581150">union</span> <span m="1581580">of</span> <span m="1581700">all</span> <span m="1581830">things</span> <span m="1582290">the</span> <span m="1582673">taints</span> <span m="1583056">of the</span> <span m="1583440">input.</span> <span m="1583660">So in</span> <span m="1583760">practice,</span> <span m="1584270">it</span> <span m="1584360">seems</span> <span m="1584470">like this</span> <span m="1584780">isn't</span> <span m="1585140">probably</span> <span m="1585430">going to be</span> <span m="1585780">too</span> <span m="1585950">big</span> <span m="1586210">of a</span> <span m="1586270">problem</span> <span m="1586545">here.</span> <span m="1587315">AUDIENCE:</span> <span m="1587810">But</span> <span m="1588305">why couldn't you</span> <span m="1588800">just scan--</span> <span m="1589295">whatever</span> <span m="1590780">scans</span> <span m="1591275">your code</span> <span m="1593255">[INAUDIBLE]?</span> </p>
<p><span m="1596720">PROFESSOR:</span> <span m="1597230">Oh</span> <span m="1597360">yeah,</span> <span m="1598000">so</span> <span m="1598290">in</span> <span m="1598400">practice,</span> <span m="1598940">what</span> <span m="1599250">do they</span> <span m="1599370">do.</span> <span m="1599610">So</span> <span m="1599750">they</span> <span m="1599900">know</span> <span m="1600220">that</span> <span m="1601130">whenever</span> <span m="1601550">the</span> <span m="1601730">interpreter</span> <span m="1602280">is</span> <span m="1602470">going</span> <span m="1602690">to</span> <span m="1603270">execute</span> <span m="1603610">something</span> <span m="1603820">like</span> <span m="1604040">this,</span> <span m="1604590">then</span> <span m="1604870">when</span> <span m="1605110">the</span> <span m="1605180">return</span> <span m="1605490">value</span> <span m="1605720">comes</span> <span m="1605940">back,</span> <span m="1606410">they</span> <span m="1606580">do</span> <span m="1606870">have</span> <span m="1607110">special</span> <span m="1607400">case</span> <span m="1607640">code</span> <span m="1607900">that's</span> <span m="1608040">going</span> <span m="1608210">to</span> <span m="1608390">automagically</span> <span m="1609130">say</span> <span m="1609830">return</span> <span m="1610200">values</span> <span m="1611005">of</span> <span m="1611280">System.arraycopy()</span> <span m="1612170">should</span> <span m="1612370">have</span> <span m="1612750">this</span> <span m="1612980">taint</span> <span m="1613220">assigned</span> <span m="1613620">to</span> <span m="1614680">it.</span> </p>
<p><span m="1614960">AUDIENCE:</span> <span m="1615370">Right,</span> <span m="1615780">so what's the manual part of it?</span> </p>
<p><span m="1616190">PROFESSOR:</span> <span m="1616600">Oh,</span> <span m="1616770">the</span> <span m="1616870">manual</span> <span m="1617200">part</span> <span m="1617380">of</span> <span m="1617440">it is</span> <span m="1617650">figuring</span> <span m="1617870">out</span> <span m="1617990">what</span> <span m="1618100">that</span> <span m="1618250">policy</span> <span m="1618560">should</span> <span m="1618690">be</span> <span m="1618870">in the first</span> <span m="1619180">place.</span> <span m="1620260">So</span> <span m="1620360">in</span> <span m="1620430">other</span> <span m="1620580">words,</span> <span m="1621450">if</span> <span m="1621500">you</span> <span m="1621600">just</span> <span m="1621780">look</span> <span m="1621930">at</span> <span m="1622720">off the</span> <span m="1623080">shelf</span> <span m="1623450">Taint</span> <span m="1623660">or</span> <span m="1623790">off</span> <span m="1624140">the</span> <span m="1624450">shelf</span> <span m="1624590">Android,</span> <span m="1625650">this</span> <span m="1625790">is</span> <span m="1625860">going</span> <span m="1625950">to</span> <span m="1626020">do</span> <span m="1626180">something</span> <span m="1626410">for</span> <span m="1626560">you,</span> <span m="1626630">but</span> <span m="1626740">it's</span> <span m="1626870">not going to</span> <span m="1627140">automatically</span> <span m="1627740">assign</span> <span m="1628050">Taint</span> <span m="1628360">in</span> <span m="1628440">the</span> <span m="1628520">right</span> <span m="1628680">way.</span> <span m="1629630">So</span> <span m="1629660">someone</span> <span m="1629950">looks</span> <span m="1630040">at this</span> <span m="1630140">and figures</span> <span m="1630630">out</span> <span m="1630910">what that</span> <span m="1631090">policy is.</span> <span m="1633050">Make</span> <span m="1633370">sense?</span> <span m="1633490">Any other</span> <span m="1633610">questions?</span> </p>
<p><span m="1636070">It</span> <span m="1636160">doesn't</span> <span m="1636410">look</span> <span m="1636540">like</span> <span m="1636660">this</span> <span m="1636800">is</span> <span m="1636900">going</span> <span m="1637000">to</span> <span m="1637070">be</span> <span m="1638170">a</span> <span m="1638260">big</span> <span m="1638540">problem</span> <span m="1639600">in</span> <span m="1639740">practice,</span> <span m="1640820">although</span> <span m="1641070">you</span> <span m="1641170">can</span> <span m="1641280">imagine</span> <span m="1641890">that,</span> <span m="1643210">for</span> <span m="1643420">example,</span> <span m="1643950">if</span> <span m="1643970">there</span> <span m="1644110">was</span> <span m="1644530">this</span> <span m="1645120">increasing</span> <span m="1646120">amount</span> <span m="1646500">of</span> <span m="1646600">applications</span> <span m="1646925">that</span> <span m="1647250">define</span> <span m="1647700">these</span> <span m="1648460">native</span> <span m="1648980">outcalls,</span> <span m="1649280">then</span> <span m="1649490">we could be</span> <span m="1649580">in</span> <span m="1649710">a</span> <span m="1649780">little</span> <span m="1649940">bit</span> <span m="1650040">of</span> <span m="1650120">a</span> <span m="1650180">problem.</span> <span m="1652875">All right.</span> </p>
<p><span m="1658790">So</span> <span m="1659140">another</span> <span m="1659580">type</span> <span m="1660420">of</span> <span m="1661890">data</span> <span m="1662240">that</span> <span m="1662370">we</span> <span m="1662480">have</span> <span m="1662780">to</span> <span m="1663130">worry</span> <span m="1663420">about</span> <span m="1663860">assigning</span> <span m="1664400">taint</span> <span m="1664630">to,</span> <span m="1665850">IPC</span> <span m="1666510">messages.</span> <span m="1669290">And</span> <span m="1669540">so</span> <span m="1669950">IPC</span> <span m="1670550">messages</span> <span m="1671690">are</span> <span m="1672130">essentially</span> <span m="1673480">treated</span> <span m="1673790">like</span> <span m="1673990">arrays.</span> <span m="1676610">So</span> <span m="1677120">each</span> <span m="1677970">one</span> <span m="1678500">of</span> <span m="1678780">these</span> <span m="1678990">messages</span> <span m="1681580">is</span> <span m="1681680">going</span> <span m="1681790">to</span> <span m="1681860">be</span> <span m="1681980">associated</span> <span m="1682620">with</span> <span m="1682840">a</span> <span m="1682960">single</span> <span m="1683380">taint</span> <span m="1684040">that</span> <span m="1684310">is</span> <span m="1684520">the</span> <span m="1684670">union</span> <span m="1685660">of</span> <span m="1685860">the</span> <span m="1685950">taint</span> <span m="1686240">of</span> <span m="1686340">all</span> <span m="1686520">the</span> <span m="1686590">constituent</span> <span m="1687150">parts.</span> <span m="1688230">Once</span> <span m="1688400">again,</span> <span m="1688530">this</span> <span m="1688670">helps with</span> <span m="1689070">efficiency</span> <span m="1689900">because</span> <span m="1690140">we</span> <span m="1690230">only</span> <span m="1690470">have</span> <span m="1690620">to</span> <span m="1690720">store</span> <span m="1692270">one</span> <span m="1692540">taint</span> <span m="1692810">tag</span> <span m="1693140">for each</span> <span m="1693320">one</span> <span m="1693440">of</span> <span m="1693480">these</span> <span m="1693630">messages.</span> <span m="1695360">And</span> <span m="1695500">in</span> <span m="1695580">the</span> <span m="1695670">worst</span> <span m="1696010">case,</span> <span m="1696610">this</span> <span m="1696770">is</span> <span m="1696960">conservative,</span> <span m="1697860">it</span> <span m="1698070">overestimates</span> <span m="1698830">taint.</span> <span m="1699170">But that</span> <span m="1699340">should</span> <span m="1699450">never</span> <span m="1700480">result</span> <span m="1700750">in a</span> <span m="1700850">security</span> <span m="1701320">leak.</span> <span m="1701730">At</span> <span m="1701930">worst,</span> <span m="1702060">it</span> <span m="1702190">should only</span> <span m="1702470">result</span> <span m="1703050">in</span> <span m="1703200">something</span> <span m="1703560">that</span> <span m="1703800">should</span> <span m="1704000">have</span> <span m="1704070">been</span> <span m="1704170">able</span> <span m="1704350">to</span> <span m="1704410">go</span> <span m="1704600">over</span> <span m="1704810">the network</span> <span m="1705230">not</span> <span m="1705460">being</span> <span m="1705650">able</span> <span m="1705840">to</span> <span m="1706480">go on</span> <span m="1706720">the</span> <span m="1706760">network.</span> </p>
<p><span m="1710110">This</span> <span m="1710290">is</span> <span m="1710560">how</span> <span m="1710850">things</span> <span m="1711130">work</span> <span m="1711990">when</span> <span m="1712090">you're</span> <span m="1712200">constructing</span> <span m="1712730">the</span> <span m="1712830">message,</span> <span m="1713680">so</span> <span m="1713750">that</span> <span m="1713940">message</span> <span m="1714650">gets</span> <span m="1714800">the</span> <span m="1714870">union</span> <span m="1715210">of</span> <span m="1715290">all</span> <span m="1715420">the</span> <span m="1715500">taint</span> <span m="1715720">of</span> <span m="1715810">its</span> <span m="1715920">components.</span> <span m="1716880">Then</span> <span m="1717650">when</span> <span m="1717770">you're</span> <span m="1717960">reading</span> <span m="1718300">it,</span> <span m="1720230">what</span> <span m="1720410">you</span> <span m="1720570">receive</span> <span m="1720810">in the</span> <span m="1720920">message--</span> <span m="1721310">so</span> <span m="1723620">extracted</span> <span m="1724240">data</span> <span m="1726500">gets</span> <span m="1727000">the</span> <span m="1728340">taint</span> <span m="1728540">of</span> <span m="1728610">the</span> <span m="1728710">message</span> <span m="1729070">itself,</span> <span m="1731860">which</span> <span m="1732050">makes</span> <span m="1732290">sense.</span> <span m="1735240">So</span> <span m="1735350">that's</span> <span m="1735510">how</span> <span m="1735650">IPC</span> <span m="1735940">messages</span> <span m="1736400">are</span> <span m="1736490">treated.</span> </p>
<p><span m="1737200">Another</span> <span m="1737540">resource</span> <span m="1737950">you</span> <span m="1738030">might</span> <span m="1738230">worry</span> <span m="1738490">about</span> <span m="1740914">is</span> <span m="1741400">how</span> <span m="1741530">a</span> <span m="1742030">file's</span> <span m="1742120">handled.</span> <span m="1743000">So</span> <span m="1743250">once</span> <span m="1743490">again</span> <span m="1745210">each</span> <span m="1745420">file</span> <span m="1745900">gets</span> <span m="1746260">a</span> <span m="1746500">single</span> <span m="1746920">taint</span> <span m="1747230">tag,</span> <span m="1750160">and</span> <span m="1750330">that</span> <span m="1750540">tag</span> <span m="1750910">is</span> <span m="1751010">essentially</span> <span m="1751380">stored</span> <span m="1751770">alongside</span> <span m="1752330">the</span> <span m="1752410">file</span> <span m="1752685">in</span> <span m="1752960">its</span> <span m="1753180">metadata</span> <span m="1754090">on</span> <span m="1754320">stable</span> <span m="1754610">stores</span> <span m="1754970">like</span> <span m="1755110">the</span> <span m="1755320">SD card</span> <span m="1755620">or</span> <span m="1755670">whatever.</span> <span m="1757500">So</span> <span m="1757600">this</span> <span m="1757730">is</span> <span m="1757920">basically the</span> <span m="1758010">same</span> <span m="1758320">conservative</span> <span m="1758700">scheme</span> <span m="1759260">that</span> <span m="1759410">we've</span> <span m="1759490">seen</span> <span m="1759690">before.</span> <span m="1760360">So</span> <span m="1760460">the</span> <span m="1760560">basic</span> <span m="1760820">idea</span> <span m="1761140">is that</span> <span m="1762240">the</span> <span m="1762470">application</span> <span m="1764710">accesses</span> <span m="1765030">some</span> <span m="1765430">sensitive</span> <span m="1765700">data</span> <span m="1766040">like,</span> <span m="1766180">for</span> <span m="1766323">example,</span> <span m="1766466">your</span> <span m="1766610">GPS</span> <span m="1767090">location,</span> <span m="1767900">maybe</span> <span m="1768150">it's</span> <span m="1768280">going</span> <span m="1768450">to</span> <span m="1768660">write</span> <span m="1768920">that</span> <span m="1769150">data</span> <span m="1770680">to</span> <span m="1770920">a</span> <span m="1770990">file.</span> </p>
<p><span m="1771710">So</span> <span m="1771880">TaintDroid</span> <span m="1772780">updates</span> <span m="1773230">that</span> <span m="1773490">file's</span> <span m="1774150">taint tag</span> <span m="1774730">with</span> <span m="1775050">the</span> <span m="1775770">GPS</span> <span m="1776240">flag,</span> <span m="1777240">maybe the</span> <span m="1777550">application</span> <span m="1778020">closes</span> <span m="1778380">down,</span> <span m="1778700">later</span> <span m="1779000">on</span> <span m="1779190">some</span> <span m="1779330">other</span> <span m="1779480">application</span> <span m="1780090">comes</span> <span m="1780350">out,</span> <span m="1780870">it</span> <span m="1781030">reads</span> <span m="1781360">that</span> <span m="1781600">file.</span> <span m="1782940">When</span> <span m="1783070">it</span> <span m="1783170">comes</span> <span m="1783550">into</span> <span m="1783870">the</span> <span m="1784215">VM,</span> <span m="1784560">into the</span> <span m="1784800">application,</span> <span m="1787000">TaintDroid</span> <span m="1787400">will</span> <span m="1787460">look</span> <span m="1787760">and</span> <span m="1787860">see</span> <span m="1787960">that</span> <span m="1788100">it</span> <span m="1788200">has</span> <span m="1788400">that</span> <span m="1788610">flag</span> <span m="1790310">marked,</span> <span m="1790960">and</span> <span m="1791380">so</span> <span m="1791860">any</span> <span m="1791980">data that's</span> <span m="1792150">derived</span> <span m="1792660">from</span> <span m="1792850">reading</span> <span m="1793170">that</span> <span m="1793380">file</span> <span m="1793820">will</span> <span m="1793950">also</span> <span m="1794190">have</span> <span m="1794500">that GPS</span> <span m="1794990">flag</span> <span m="1795550">set.</span> <span m="1796240">So</span> <span m="1796450">pretty</span> <span m="1796650">straightforward,</span> <span m="1797180">I think.</span> </p>
<p><span m="1799590">So</span> <span m="1800620">what</span> <span m="1801940">kind</span> <span m="1802470">of</span> <span m="1802890">things</span> <span m="1803370">do</span> <span m="1803540">we</span> <span m="1804100">have</span> <span m="1804410">to</span> <span m="1804670">taint</span> <span m="1805380">in</span> <span m="1805490">terms</span> <span m="1805680">of</span> <span m="1805770">Java</span> <span m="1806620">State.</span> <span m="1807170">So</span> <span m="1807300">there's</span> <span m="1807440">basically</span> <span m="1812340">five</span> <span m="1812620">types</span> <span m="1812990">of</span> <span m="1814440">Java</span> <span m="1814620">objects</span> <span m="1815990">that</span> <span m="1816300">need</span> <span m="1818850">taint</span> <span m="1819190">flags.</span> <span m="1823190">And</span> <span m="1823520">so</span> <span m="1823910">the</span> <span m="1825370">first</span> <span m="1825710">kind</span> <span m="1826040">of</span> <span m="1826220">thing</span> <span m="1828950">is</span> <span m="1829100">local</span> <span m="1829450">variables</span> <span m="1831330">that</span> <span m="1831690">live in a</span> <span m="1832020">method.</span> <span m="1834370">So</span> <span m="1834600">we</span> <span m="1834710">can</span> <span m="1834820">imagine</span> <span m="1836360">back</span> <span m="1836610">over</span> <span m="1836820">here,</span> <span m="1837430">this</span> <span m="1838040">is</span> <span m="1838150">a</span> <span m="1838230">local</span> <span m="1838560">variable,</span> <span m="1839120">char</span> <span m="1839370">c,</span> <span m="1839600">for</span> <span m="1839700">example.</span> <span m="1840110">So we</span> <span m="1840210">have</span> <span m="1840240">to</span> <span m="1840700">assign</span> <span m="1841350">taint</span> <span m="1841770">flags</span> <span m="1842030">to</span> <span m="1842080">those</span> <span m="1842350">things.</span> <span m="1844560">You</span> <span m="1844630">can</span> <span m="1844750">also</span> <span m="1845000">imagine</span> <span m="1845460">that</span> <span m="1846450">method</span> <span m="1846880">arguments</span> <span m="1850560">need</span> <span m="1850860">to</span> <span m="1851560">have</span> <span m="1851750">taint</span> <span m="1851870">flags.</span> <span m="1852440">Both</span> <span m="1852680">of</span> <span m="1852750">these</span> <span m="1852940">things</span> <span m="1853592">here,</span> <span m="1857370">these</span> <span m="1857590">live</span> <span m="1858200">in</span> <span m="1858560">a</span> <span m="1858690">stack.</span> <span m="1863280">So</span> <span m="1863570">a</span> <span m="1863720">TaintDroid</span> <span m="1863940">has</span> <span m="1864060">to</span> <span m="1864170">keep</span> <span m="1864380">track</span> <span m="1865180">of</span> <span m="1865260">assigning</span> <span m="1865710">flags</span> <span m="1866090">and</span> <span m="1866170">whatnot</span> <span m="1866540">for</span> <span m="1866610">those</span> <span m="1866800">types</span> <span m="1867000">of</span> <span m="1867100">things.</span> <span m="1868070">Also</span> <span m="1870790">we</span> <span m="1870960">need</span> <span m="1871380">to</span> <span m="1871580">assign</span> <span m="1871900">flags</span> <span m="1872420">to</span> <span m="1872830">object</span> <span m="1874520">instance</span> <span m="1875000">fields.</span> <span m="1879980">And</span> <span m="1880490">so</span> <span m="1880670">this</span> <span m="1880880">is</span> <span m="1881030">like,</span> <span m="1881420">imagine</span> <span m="1881950">that</span> <span m="1882140">I</span> <span m="1882260">have</span> <span m="1882560">some</span> <span m="1883240">object</span> <span m="1883640">called</span> <span m="1884670">c,</span> <span m="1886060">it's a</span> <span m="1886170">circle</span> <span m="1886520">so</span> <span m="1886870">of</span> <span m="1886980">course</span> <span m="1887200">the</span> <span m="1887290">proper</span> <span m="1887680">thing</span> <span m="1887960">to do is</span> <span m="1888270">I</span> <span m="1888310">want to</span> <span m="1888680">look at its</span> <span m="1888860">radius.</span> <span m="1889730">Here's</span> <span m="1890370">a</span> <span m="1890430">field</span> <span m="1890800">here.</span> <span m="1891520">And</span> <span m="1891570">so</span> <span m="1891690">we</span> <span m="1891810">have</span> <span m="1892120">to</span> <span m="1892340">associate</span> <span m="1895820">taint information</span> <span m="1896350">for each</span> <span m="1896530">one</span> <span m="1896690">of</span> <span m="1896780">these</span> <span m="1897040">fields</span> <span m="1897330">here.</span> </p>
<p><span m="1899030">Java</span> <span m="1899300">also</span> <span m="1899730">allows</span> <span m="1900200">you</span> <span m="1900920">to</span> <span m="1901390">have</span> <span m="1901890">a</span> <span m="1902030">static</span> <span m="1902440">class</span> <span m="1902780">field,</span> <span m="1906660">and</span> <span m="1907060">so</span> <span m="1907260">you</span> <span m="1907390">need</span> <span m="1909250">taint</span> <span m="1909320">information</span> <span m="1909760">for</span> <span m="1909860">those.</span> <span m="1910300">This</span> <span m="1910470">is</span> <span m="1910570">saying</span> <span m="1910840">something</span> <span m="1911150">like,</span> <span m="1912520">for</span> <span m="1912530">example,</span> <span m="1912940">maybe</span> <span m="1915300">the</span> <span m="1915350">circle</span> <span m="1916030">that</span> <span m="1916710">some</span> <span m="1916940">property,</span> <span m="1918150">OK,</span> <span m="1918400">we'll</span> <span m="1918590">assign some</span> <span m="1918920">taint</span> <span m="1919200">information</span> <span m="1919650">there.</span> <span m="1920530">Then</span> <span m="1920810">arrays,</span> <span m="1921430">as</span> <span m="1921500">we've already</span> <span m="1921580">discussed</span> <span m="1922340">before,</span> <span m="1924080">we'll</span> <span m="1924290">assign</span> <span m="1926350">one</span> <span m="1926590">piece</span> <span m="1926800">of taint</span> <span m="1926980">information</span> <span m="1927750">per</span> <span m="1927950">that</span> <span m="1928090">entire</span> <span m="1928740">array.</span> <span m="1929350">And</span> <span m="1929510">so</span> <span m="1929710">the</span> <span m="1929810">basic</span> <span m="1930250">idea</span> <span m="1930830">for</span> <span m="1931080">how</span> <span m="1931620">we're</span> <span m="1932030">going</span> <span m="1932300">to</span> <span m="1932730">store</span> <span m="1933250">these</span> <span m="1933510">taint flags</span> <span m="1933940">at</span> <span m="1934060">the</span> <span m="1934160">implementation</span> <span m="1934850">level,</span> <span m="1935450">is</span> <span m="1935600">that</span> <span m="1935740">we're</span> <span m="1935820">going</span> <span m="1935990">to</span> <span m="1936060">try</span> <span m="1936490">to</span> <span m="1939820">basically</span> <span m="1940290">store</span> <span m="1941320">the</span> <span m="1941660">taint flags</span> <span m="1943020">for</span> <span m="1943470">a</span> <span m="1943510">variable</span> <span m="1944660">near</span> <span m="1946660">the</span> <span m="1946820">variable</span> <span m="1947280">itself.</span> </p>
<p><span m="1953620">The</span> <span m="1953710">basic</span> <span m="1954100">idea</span> <span m="1954430">here</span> <span m="1954910">is</span> <span m="1956020">we've</span> <span m="1956400">got,</span> <span m="1956740">for</span> <span m="1956880">example,</span> <span m="1958170">let's</span> <span m="1958370">say</span> <span m="1958520">some</span> <span m="1958810">integer</span> <span m="1959190">variable,</span> <span m="1959730">and</span> <span m="1959980">we</span> <span m="1960070">want</span> <span m="1960260">to</span> <span m="1960350">store</span> <span m="1960840">some</span> <span m="1961185">taint</span> <span m="1961530">state</span> <span m="1961790">with</span> <span m="1961950">that.</span> <span m="1962740">We</span> <span m="1962830">want</span> <span m="1963020">to</span> <span m="1963080">try</span> <span m="1963210">to</span> <span m="1963310">keep</span> <span m="1963580">that</span> <span m="1963760">state</span> <span m="1964050">as</span> <span m="1964190">close</span> <span m="1964790">to</span> <span m="1964900">the</span> <span m="1964970">variable</span> <span m="1965430">as possible</span> <span m="1966220">for</span> <span m="1966330">reasons</span> <span m="1966700">of</span> <span m="1966810">making</span> <span m="1967180">the</span> <span m="1967290">cache</span> <span m="1967660">work</span> <span m="1967860">efficiently</span> <span m="1968960">at the</span> <span m="1969040">processor</span> <span m="1969540">level.</span> <span m="1970420">So</span> <span m="1970570">if we</span> <span m="1970780">were to</span> <span m="1970900">store</span> <span m="1971240">taint</span> <span m="1972110">very</span> <span m="1972440">far</span> <span m="1972790">away</span> <span m="1973410">from</span> <span m="1973700">that</span> <span m="1973890">variable,</span> <span m="1974090">that can be</span> <span m="1974520">problematic</span> <span m="1975170">because</span> <span m="1975510">probably,</span> <span m="1976030">the</span> <span m="1976120">interpreter</span> <span m="1976640">is</span> <span m="1976730">going</span> <span m="1976920">to</span> <span m="1977010">look</span> <span m="1977250">at</span> <span m="1977330">the</span> <span m="1977700">memory value</span> <span m="1978350">for</span> <span m="1978450">the</span> <span m="1978530">actual</span> <span m="1978920">Java</span> <span m="1979250">variable.</span> <span m="1979860">It's</span> <span m="1980040">going</span> <span m="1980240">to</span> <span m="1980350">want</span> <span m="1980550">to</span> <span m="1980630">very</span> <span m="1980920">quickly</span> <span m="1981270">thereafter,</span> <span m="1981820">or</span> <span m="1982180">even before</span> <span m="1982440">that,</span> <span m="1982920">look</span> <span m="1983080">and see</span> <span m="1983210">what the</span> <span m="1983470">taint</span> <span m="1983750">information</span> <span m="1984025">is.</span> <span m="1984990">Because</span> <span m="1985210">if</span> <span m="1985320">you</span> <span m="1985430">look</span> <span m="1985680">at</span> <span m="1987430">these</span> <span m="1987640">operations</span> <span m="1988180">here,</span> <span m="1989570">the</span> <span m="1989710">same</span> <span m="1990050">places</span> <span m="1990380">in</span> <span m="1990460">the</span> <span m="1990550">code</span> <span m="1990840">where</span> <span m="1990940">the</span> <span m="1991150">interpreter's</span> <span m="1991470">looking</span> <span m="1991580">at the</span> <span m="1991820">values,</span> <span m="1992280">it's</span> <span m="1992320">also</span> <span m="1992490">looking at</span> <span m="1992670">taint.</span> </p>
<p><span m="1993710">Basically</span> <span m="1995930">by</span> <span m="1996060">storing</span> <span m="1996330">these</span> <span m="1996600">things</span> <span m="1996830">close</span> <span m="1997060">to</span> <span m="1997150">each</span> <span m="1997260">other,</span> <span m="1997710">you</span> <span m="1997820">try</span> <span m="1997970">to</span> <span m="1998050">make</span> <span m="1998380">the</span> <span m="1998470">cache</span> <span m="1998720">behavior</span> <span m="1999050">better.</span> <span m="1999880">And</span> <span m="2000790">the</span> <span m="2000900">way</span> <span m="2001160">that</span> <span m="2001350">they</span> <span m="2001490">do</span> <span m="2001720">this</span> <span m="2002020">is</span> <span m="2002150">actually</span> <span m="2002840">pretty</span> <span m="2003940">straightforward.</span> <span m="2005520">So</span> <span m="2005820">if</span> <span m="2005960">you</span> <span m="2006100">look</span> <span m="2006400">at</span> <span m="2006650">what</span> <span m="2006850">they</span> <span m="2007020">do</span> <span m="2007430">for</span> <span m="2010020">method</span> <span m="2010370">arguments</span> <span m="2010660">and</span> <span m="2010950">local</span> <span m="2011290">variables</span> <span m="2011570">that live on</span> <span m="2011970">a stack,</span> <span m="2012500">they</span> <span m="2012660">essentially</span> <span m="2013070">allocate</span> <span m="2014430">the</span> <span m="2014740">taint</span> <span m="2015070">flags</span> <span m="2016390">right</span> <span m="2016730">next</span> <span m="2017100">to</span> <span m="2018030">where</span> <span m="2018180">the</span> <span m="2018290">variables</span> <span m="2018740">are</span> <span m="2018790">allocated.</span> <span m="2019330">So</span> <span m="2019970">let's</span> <span m="2020300">say</span> <span m="2020730">that</span> <span m="2021580">we</span> <span m="2022670">have</span> <span m="2023420">our</span> <span m="2023600">favorite</span> <span m="2024060">thing</span> <span m="2024250">in</span> <span m="2024320">this</span> <span m="2024470">class,</span> <span m="2024860">a</span> <span m="2025010">stack</span> <span m="2025420">diagram,</span> <span m="2026365">which</span> <span m="2026650">you'll</span> <span m="2026960">probably</span> <span m="2027360">hate</span> <span m="2027860">after you</span> <span m="2027970">get</span> <span m="2028270">out of here.</span> </p>
<p><span m="2029110">So</span> <span m="2029440">you've</span> <span m="2029700">got some</span> <span m="2030220">local</span> <span m="2030520">variable</span> <span m="2030910">0</span> <span m="2032050">on</span> <span m="2032410">the</span> <span m="2033900">stack,</span> <span m="2036740">and</span> <span m="2037110">then</span> <span m="2037460">what</span> <span m="2037890">TaintDroid</span> <span m="2038250">will do</span> <span m="2039000">is</span> <span m="2039220">it will</span> <span m="2039470">store</span> <span m="2039910">the</span> <span m="2040020">taint</span> <span m="2040350">tag</span> <span m="2040640">for</span> <span m="2040710">that</span> <span m="2040930">variable</span> <span m="2042270">right</span> <span m="2042570">next</span> <span m="2042890">to</span> <span m="2043150">where</span> <span m="2043790">that</span> <span m="2043980">local</span> <span m="2044290">variable</span> <span m="2044700">is</span> <span m="2045010">in</span> <span m="2045180">memory.</span> <span m="2045540">So</span> <span m="2045670">similarly,</span> <span m="2046270">if</span> <span m="2046380">you</span> <span m="2046520">had</span> <span m="2048389">another</span> <span m="2048710">local</span> <span m="2049070">variable</span> <span m="2049480">here,</span> <span m="2050810">then</span> <span m="2051170">you</span> <span m="2051300">would</span> <span m="2051449">see</span> <span m="2052900">its</span> <span m="2053120">taint</span> <span m="2053420">tag</span> <span m="2054540">right</span> <span m="2054800">down</span> <span m="2055010">here.</span> <span m="2056900">So</span> <span m="2057179">on</span> <span m="2057280">and</span> <span m="2057330">so</span> <span m="2057469">forth.</span> <span m="2059560">Pretty</span> <span m="2059639">straightforward.</span> <span m="2060320">So</span> <span m="2060870">hopefully</span> <span m="2061800">you</span> <span m="2062170">get</span> <span m="2062489">these</span> <span m="2062710">things</span> <span m="2063000">in</span> <span m="2063060">the</span> <span m="2063130">same</span> <span m="2063389">cache</span> <span m="2063770">line,</span> <span m="2064270">that's</span> <span m="2064449">going</span> <span m="2064530">to</span> <span m="2064570">make</span> <span m="2064730">the</span> <span m="2064790">accesses very</span> <span m="2065150">cheap.</span> <span m="2065830">Yeah?</span> </p>
<p><span m="2066170">AUDIENCE:</span> <span m="2066510">I</span> <span m="2066710">was</span> <span m="2066820">just</span> <span m="2067186">wondering,</span> <span m="2067920">how can you have a</span> <span m="2068210">single</span> <span m="2068500">flag</span> <span m="2068845">for</span> <span m="2069190">an</span> <span m="2069639">entire</span> <span m="2069860">array</span> <span m="2070350">and a different</span> <span m="2070780">flag for</span> <span m="2071210">every</span> <span m="2071550">property</span> <span m="2072242">of</span> <span m="2072590">an object.</span> <span m="2073810">What</span> <span m="2074250">if</span> <span m="2074620">one</span> <span m="2074889">of</span> <span m="2075150">the</span> <span m="2076126">methods</span> <span m="2076614">of</span> <span m="2077102">the</span> <span m="2077590">object</span> <span m="2078080">can access</span> <span m="2078520">data which</span> <span m="2078870">is stored</span> <span m="2079219">in</span> <span m="2079670">its</span> <span m="2080121">properties.</span> <span m="2081023">That would like--</span> <span m="2081474">know</span> <span m="2081925">what I mean?</span> </p>
<p><span m="2082895">PROFESSOR:</span> <span m="2083290">Let's</span> <span m="2083635">see.</span> <span m="2084190">So</span> <span m="2084949">you're</span> <span m="2085159">asking</span> <span m="2085770">as</span> <span m="2085900">a</span> <span m="2085960">policy</span> <span m="2086540">reason,</span> <span m="2086950">why?</span> </p>
<p><span m="2087360">AUDIENCE:</span> <span m="2087750">As a policy reason,</span> <span m="2088140">right.</span> </p>
<p><span m="2088530">PROFESSOR:</span> <span m="2088920">So</span> <span m="2089380">I think some</span> <span m="2089460">of this</span> <span m="2089949">they do</span> <span m="2090249">for</span> <span m="2091239">implementation</span> <span m="2091840">efficiency</span> <span m="2092114">reasons.</span> <span m="2093489">I</span> <span m="2093679">think</span> <span m="2094090">that</span> <span m="2094560">for</span> <span m="2094900">the</span> <span m="2095139">case--</span> <span m="2095750">so</span> <span m="2095889">they</span> <span m="2095980">have</span> <span m="2096139">some</span> <span m="2096260">other</span> <span m="2096639">rules, too.</span> <span m="2097030">For</span> <span m="2097280">example,</span> <span m="2097480">they</span> <span m="2097600">say</span> <span m="2097890">that</span> <span m="2098440">they</span> <span m="2098590">don't</span> <span m="2099110">say</span> <span m="2099660">a</span> <span m="2100040">length of the data array,</span> <span m="2101250">is</span> <span m="2101670">actually going to</span> <span m="2101800">leak</span> <span m="2102010">information,</span> <span m="2102750">so</span> <span m="2102890">they</span> <span m="2103040">don't</span> <span m="2103280">propagate</span> <span m="2103540">taint</span> <span m="2104110">for that.</span> <span m="2104700">So</span> <span m="2104960">some of it</span> <span m="2105220">is just</span> <span m="2105550">for reasons</span> <span m="2105815">of</span> <span m="2106080">efficiency.</span> <span m="2107000">I</span> <span m="2107130">think</span> <span m="2107390">that</span> <span m="2107570">in</span> <span m="2107670">principle,</span> <span m="2108500">that</span> <span m="2108630">there's nothing</span> <span m="2108900">that</span> <span m="2109120">stops</span> <span m="2109700">you</span> <span m="2109820">from saying,</span> <span m="2112300">take</span> <span m="2112590">every</span> <span m="2112900">element</span> <span m="2113290">in</span> <span m="2113480">the</span> <span m="2113590">array</span> <span m="2114450">and,</span> <span m="2114765">when you</span> <span m="2115080">do</span> <span m="2115260">some</span> <span m="2115420">particular</span> <span m="2115810">access</span> <span m="2116310">on</span> <span m="2116480">it,</span> <span m="2116900">then</span> <span m="2117090">you just</span> <span m="2117210">say</span> <span m="2117680">the</span> <span m="2117970">thing</span> <span m="2118080">on the</span> <span m="2118270">left hand</span> <span m="2118630">side's</span> <span m="2118760">going</span> <span m="2119100">to get</span> <span m="2119190">the taint,</span> <span m="2119720">only</span> <span m="2120430">that</span> <span m="2120590">items.</span> </p>
<p><span m="2122190">It's</span> <span m="2122360">not</span> <span m="2122660">completely clear</span> <span m="2122960">that's</span> <span m="2123240">the</span> <span m="2123350">right</span> <span m="2123630">thing to do, though,</span> <span m="2124070">because</span> <span m="2124820">presumably</span> <span m="2125910">in</span> <span m="2126040">getting</span> <span m="2126440">that</span> <span m="2126700">thing</span> <span m="2126900">into</span> <span m="2127130">the array</span> <span m="2127320">in</span> <span m="2127480">the first</span> <span m="2127820">place,</span> <span m="2128980">the</span> <span m="2129130">thing that</span> <span m="2129230">did</span> <span m="2129510">that</span> <span m="2129650">had</span> <span m="2129900">to</span> <span m="2129940">know</span> <span m="2130290">something</span> <span m="2130930">about</span> <span m="2131220">the</span> <span m="2131480">array</span> <span m="2131690">in</span> <span m="2131870">some</span> <span m="2132290">way.</span> <span m="2133060">So</span> <span m="2133240">I</span> <span m="2133320">think it's</span> <span m="2133530">a combination</span> <span m="2133710">of both</span> <span m="2134100">policy</span> <span m="2134395">reasons--</span> <span m="2135100">they</span> <span m="2135260">think</span> <span m="2135540">that</span> <span m="2136180">by</span> <span m="2136320">being</span> <span m="2136760">overly</span> <span m="2137170">conservative,</span> <span m="2138060">you</span> <span m="2138180">shouldn't</span> <span m="2139580">allow</span> <span m="2140260">any</span> <span m="2140500">data leaks</span> <span m="2140800">that</span> <span m="2140930">you</span> <span m="2141030">want</span> <span m="2141190">to</span> <span m="2141240">prevent.</span> <span m="2142200">And</span> <span m="2142380">also</span> <span m="2142610">I</span> <span m="2142710">think</span> <span m="2143200">that</span> <span m="2143770">it</span> <span m="2143880">kind</span> <span m="2144050">of</span> <span m="2144130">does</span> <span m="2144450">intuitively</span> <span m="2144740">make</span> <span m="2145030">sense</span> <span m="2145310">that</span> <span m="2145820">accessing</span> <span m="2146120">an</span> <span m="2146420">array,</span> <span m="2147230">you</span> <span m="2147380">should</span> <span m="2147530">have to know</span> <span m="2148070">something</span> <span m="2148380">about</span> <span m="2148490">that</span> <span m="2148630">array.</span> <span m="2149160">And when you</span> <span m="2149360">have</span> <span m="2149510">to</span> <span m="2149640">know</span> <span m="2149880">something</span> <span m="2150240">about</span> <span m="2150470">something,</span> <span m="2150740">that</span> <span m="2150920">typically means that you want</span> <span m="2151430">to</span> <span m="2151570">get</span> <span m="2151690">tainted</span> <span m="2151890">by.</span> <span m="2154810">Any</span> <span m="2154970">other</span> <span m="2155280">questions?</span> </p>
<p><span m="2157210">OK,</span> <span m="2157700">so</span> <span m="2158200">this</span> <span m="2158420">is</span> <span m="2158480">the basic</span> <span m="2158870">scheme that</span> <span m="2159260">they use</span> <span m="2159590">for</span> <span m="2161150">essentially</span> <span m="2161470">storing</span> <span m="2161860">all of</span> <span m="2162080">this</span> <span m="2162220">information</span> <span m="2162640">close</span> <span m="2162830">to</span> <span m="2162890">each</span> <span m="2162990">other.</span> <span m="2163500">So</span> <span m="2163600">you</span> <span m="2163700">can</span> <span m="2163800">imagine</span> <span m="2164030">that</span> <span m="2164840">for class fields</span> <span m="2165300">and for</span> <span m="2165630">object</span> <span m="2166120">fields,</span> <span m="2166240">you</span> <span m="2166360">do</span> <span m="2166560">a similar</span> <span m="2166870">thing.</span> <span m="2167440">So</span> <span m="2167640">in the</span> <span m="2167790">declaration</span> <span m="2168650">of</span> <span m="2168780">the</span> <span m="2168870">class,</span> <span m="2169280">you've</span> <span m="2169380">got</span> <span m="2169620">some</span> <span m="2170160">slot</span> <span m="2170660">memory</span> <span m="2171040">for a</span> <span m="2171230">particular</span> <span m="2171710">instance</span> <span m="2172060">variable,</span> <span m="2172580">and</span> <span m="2172750">then</span> <span m="2172850">right</span> <span m="2173080">next to</span> <span m="2173540">that slot</span> <span m="2174240">you</span> <span m="2174530">have the</span> <span m="2174760">taint</span> <span m="2175090">information</span> <span m="2175750">for</span> <span m="2175820">that</span> <span m="2175960">particular</span> <span m="2176320">variable.</span> <span m="2178660">So</span> <span m="2178700">I</span> <span m="2178780">think</span> <span m="2178980">that's</span> <span m="2179240">all</span> <span m="2180620">pretty</span> <span m="2181000">reasonable.</span> </p>
<p></p>
<p><span m="2182860">That's</span> <span m="2183290">kind</span> <span m="2183600">of</span> <span m="2183750">a</span> <span m="2183890">high</span> <span m="2184150">level</span> <span m="2184560">overview</span> <span m="2185250">of</span> <span m="2185830">how</span> <span m="2186400">TaintDroid</span> <span m="2186780">works,</span> <span m="2187640">so</span> <span m="2188350">if</span> <span m="2188520">you</span> <span m="2188890">get</span> <span m="2189100">all</span> <span m="2189300">this,</span> <span m="2189960">then</span> <span m="2190390">the basic</span> <span m="2190760">idea</span> <span m="2190990">behind</span> <span m="2191320">TaintDroid</span> <span m="2191690">is</span> <span m="2191830">actually</span> <span m="2192090">pretty</span> <span m="2192280">simple.</span> <span m="2193900">So</span> <span m="2194900">at</span> <span m="2196220">system</span> <span m="2196540">initialization</span> <span m="2197200">time or</span> <span m="2197680">whatever,</span> <span m="2197900">TaintDroid</span> <span m="2198120">looks</span> <span m="2198380">at</span> <span m="2198800">all</span> <span m="2199110">these</span> <span m="2199240">sources</span> <span m="2200330">of</span> <span m="2200780">potentially</span> <span m="2201230">tainted</span> <span m="2201660">information,</span> <span m="2202550">and</span> <span m="2202660">essentially</span> <span m="2203050">assigns</span> <span m="2203465">a flag</span> <span m="2203880">to each one of these</span> <span m="2204110">things.</span> <span m="2204360">So</span> <span m="2204640">things</span> <span m="2204980">like</span> <span m="2205110">your</span> <span m="2205190">GPS,</span> <span m="2205770">your</span> <span m="2205870">camera,</span> <span m="2206370">and</span> <span m="2206630">so on and so</span> <span m="2206800">forth.</span> <span m="2207940">As</span> <span m="2208330">the program</span> <span m="2208660">executes,</span> <span m="2209780">it's</span> <span m="2210130">going to pull</span> <span m="2210470">out sensitive</span> <span m="2210840">information</span> <span m="2211670">from</span> <span m="2211950">these sensitive</span> <span m="2212340">sources,</span> <span m="2212980">and</span> <span m="2213383">then</span> <span m="2213786">as that kind</span> <span m="2214190">of</span> <span m="2214540">thing happens,</span> <span m="2214900">the</span> <span m="2215020">interpreter</span> <span m="2215950">is</span> <span m="2216170">going</span> <span m="2216460">to</span> <span m="2216870">look</span> <span m="2217070">at</span> <span m="2217120">all these types of</span> <span m="2217380">op codes</span> <span m="2217640">here and</span> <span m="2217976">basically</span> <span m="2218850">follow</span> <span m="2221020">those</span> <span m="2221210">policy</span> <span m="2221640">rules</span> <span m="2221850">in the</span> <span m="2222050">table</span> <span m="2222350">on</span> <span m="2222520">the</span> <span m="2222590">paper,</span> <span m="2223230">and</span> <span m="2223350">figure</span> <span m="2223540">out how to</span> <span m="2223880">propagate</span> <span m="2224380">taint</span> <span m="2224880">through the</span> <span m="2225080">system.</span> </p>
<p><span m="2226780">So</span> <span m="2227070">the</span> <span m="2227960">most</span> <span m="2228215">interesting</span> <span m="2228470">part</span> <span m="2228710">is</span> <span m="2228800">what</span> <span m="2228990">happens</span> <span m="2229520">if</span> <span m="2230190">data</span> <span m="2230890">attempts</span> <span m="2231270">to</span> <span m="2231380">exfiltrate</span> <span m="2231840">itself.</span> <span m="2232570">So</span> <span m="2232720">essentially,</span> <span m="2233100">TaintDroid</span> <span m="2233540">can sit</span> <span m="2234310">at the</span> <span m="2234520">network</span> <span m="2234820">interfaces</span> <span m="2235660">and</span> <span m="2235860">they can</span> <span m="2236010">see</span> <span m="2236440">everything</span> <span m="2236810">that</span> <span m="2236920">tries</span> <span m="2237340">to</span> <span m="2237450">go over</span> <span m="2237870">the</span> <span m="2238030">network</span> <span m="2238320">interface.</span> <span m="2238970">We</span> <span m="2239160">actually</span> <span m="2239420">look at</span> <span m="2239580">the taint tags</span> <span m="2240040">there</span> <span m="2240610">and</span> <span m="2240850">we</span> <span m="2241010">can</span> <span m="2241160">say</span> <span m="2241620">if</span> <span m="2242780">data</span> <span m="2242800">that's</span> <span m="2243040">trying to leave</span> <span m="2243385">the</span> <span m="2243730">network</span> <span m="2244520">has</span> <span m="2246270">one</span> <span m="2246750">or</span> <span m="2246880">more</span> <span m="2247380">taint flags,</span> <span m="2248030">then we</span> <span m="2248470">will say</span> <span m="2248590">no.</span> <span m="2249070">That</span> <span m="2249240">data</span> <span m="2249390">will</span> <span m="2249590">not</span> <span m="2249970">be allowed</span> <span m="2250260">to</span> <span m="2250330">go in the</span> <span m="2250620">network.</span> </p>
<p><span m="2252060">Now</span> <span m="2252610">what</span> <span m="2252850">happens</span> <span m="2253190">at</span> <span m="2253290">that</span> <span m="2253560">point</span> <span m="2254452">is</span> <span m="2254900">actually</span> <span m="2255175">kind of</span> <span m="2255450">application-dependent.</span> <span m="2257090">You</span> <span m="2257230">could</span> <span m="2257420">imagine</span> <span m="2258200">that</span> <span m="2258730">TaintDroid</span> <span m="2259160">shows</span> <span m="2259220">an alert</span> <span m="2259730">to</span> <span m="2260120">the</span> <span m="2260240">user</span> <span m="2260500">which</span> <span m="2260760">says</span> <span m="2261140">hey,</span> <span m="2261400">somebody's</span> <span m="2261690">trying</span> <span m="2261890">to</span> <span m="2261960">send</span> <span m="2262880">your</span> <span m="2263310">location</span> <span m="2263675">over the</span> <span m="2264040">network.</span> <span m="2265190">You could</span> <span m="2265410">imagine</span> <span m="2265800">that maybe</span> <span m="2266225">TaintDroid has</span> <span m="2266650">some</span> <span m="2266840">policies</span> <span m="2267390">that</span> <span m="2267460">are</span> <span m="2267530">built</span> <span m="2267880">in</span> <span m="2268430">which,</span> <span m="2269090">for</span> <span m="2269110">example,</span> <span m="2269380">maybe</span> <span m="2269640">it allows</span> <span m="2270090">that</span> <span m="2270310">network</span> <span m="2270690">flow</span> <span m="2270910">to go</span> <span m="2271110">out,</span> <span m="2271390">but</span> <span m="2271560">it</span> <span m="2271720">zeros</span> <span m="2272170">out</span> <span m="2272420">all</span> <span m="2272560">that sensitive</span> <span m="2273050">data,</span> <span m="2273610">so on</span> <span m="2273840">and</span> <span m="2273990">so</span> <span m="2274370">forth.</span> <span m="2274620">That's</span> <span m="2275410">from a</span> <span m="2275620">certain</span> <span m="2275890">perspective,</span> <span m="2276530">a little bit</span> <span m="2276895">orthogonal</span> <span m="2277260">to the</span> <span m="2277570">core contribution</span> <span m="2277850">of</span> <span m="2278130">the</span> <span m="2278230">paper,</span> <span m="2278760">which</span> <span m="2278930">is to</span> <span m="2279010">find those</span> <span m="2279560">data</span> <span m="2279850">exfiltrations</span> <span m="2280250">in the</span> <span m="2280650">first</span> <span m="2280880">place.</span> </p>
<p><span m="2283460">In</span> <span m="2283680">the evaluation</span> <span m="2284100">section</span> <span m="2284220">of</span> <span m="2284440">the</span> <span m="2284670">paper,</span> <span m="2284960">they</span> <span m="2285100">discuss</span> <span m="2285505">some of</span> <span m="2285910">the things</span> <span m="2286175">that they</span> <span m="2286440">found.</span> <span m="2287240">They do</span> <span m="2287630">find</span> <span m="2288320">that</span> <span m="2289380">Android</span> <span m="2289770">applications</span> <span m="2290490">will</span> <span m="2290740">try</span> <span m="2290950">to</span> <span m="2291030">exfiltrate</span> <span m="2291650">data</span> <span m="2292270">in</span> <span m="2292440">ways</span> <span m="2292930">that</span> <span m="2293410">were</span> <span m="2293510">not</span> <span m="2293670">exposed</span> <span m="2294190">to</span> <span m="2294270">the</span> <span m="2294420">user.</span> <span m="2295370">So</span> <span m="2295410">for</span> <span m="2295520">example,</span> <span m="2295800">they</span> <span m="2295890">will try</span> <span m="2296190">to use</span> <span m="2296330">your</span> <span m="2296700">location</span> <span m="2297187">for</span> <span m="2297674">advertisements,</span> <span m="2298650">they</span> <span m="2298790">will</span> <span m="2299210">send</span> <span m="2299340">your</span> <span m="2299450">phone</span> <span m="2299760">number</span> <span m="2300090">and</span> <span m="2300160">things</span> <span m="2300400">like</span> <span m="2300560">this</span> <span m="2300830">to remote</span> <span m="2301170">servers.</span> <span m="2302080">Once</span> <span m="2302190">again,</span> <span m="2302750">it's</span> <span m="2303005">important</span> <span m="2303260">to</span> <span m="2303530">note</span> <span m="2303800">that</span> <span m="2304150">these</span> <span m="2304360">applications,</span> <span m="2306170">typically</span> <span m="2306690">they weren't</span> <span m="2308390">breaking</span> <span m="2309450">the</span> <span m="2310240">Android</span> <span m="2310730">security</span> <span m="2311200">model</span> <span m="2311670">in</span> <span m="2311830">the</span> <span m="2311940">sense</span> <span m="2312360">that</span> <span m="2312850">the</span> <span m="2313010">user</span> <span m="2313490">had</span> <span m="2313870">allowed</span> <span m="2314570">these</span> <span m="2314750">applications</span> <span m="2315120">with</span> <span m="2315490">access</span> <span m="2315850">to</span> <span m="2315930">the</span> <span m="2316030">network,</span> <span m="2316350">for</span> <span m="2316460">example.</span> <span m="2317160">Or</span> <span m="2317310">they</span> <span m="2317750">had allowed</span> <span m="2317940">these</span> <span m="2318100">applications</span> <span m="2318670">to have</span> <span m="2318890">access</span> <span m="2319520">to things like a</span> <span m="2319660">contact</span> <span m="2319965">list.</span> </p>
<p><span m="2320760">However,</span> <span m="2322030">the</span> <span m="2322180">applications</span> <span m="2322820">did</span> <span m="2322930">not</span> <span m="2323140">exposed</span> <span m="2323720">to</span> <span m="2323790">the</span> <span m="2323910">user</span> <span m="2324580">in</span> <span m="2324790">the</span> <span m="2325330">EULA,</span> <span m="2325810">in the</span> <span m="2326010">End User</span> <span m="2326220">License</span> <span m="2326570">Agreement,</span> <span m="2327090">that</span> <span m="2327190">hey,</span> <span m="2327800">I'm going to take</span> <span m="2328080">your phone number</span> <span m="2328360">and actually</span> <span m="2328630">send</span> <span m="2328890">it</span> <span m="2329100">to</span> <span m="2329670">some</span> <span m="2329920">server</span> <span m="2331640">in</span> <span m="2331930">Silk</span> <span m="2332370">Road 8</span> <span m="2332550">or</span> <span m="2332896">whatever.</span> <span m="2334280">That's</span> <span m="2334500">actually</span> <span m="2334950">misleading</span> <span m="2335260">and</span> <span m="2335570">deceptive,</span> <span m="2336070">because</span> <span m="2336340">most</span> <span m="2336620">users,</span> <span m="2337230">if</span> <span m="2337380">they'd</span> <span m="2337510">actually</span> <span m="2337820">seen</span> <span m="2338220">that in</span> <span m="2338610">the EULA</span> <span m="2338800">and</span> <span m="2338930">they'd known</span> <span m="2339180">that was</span> <span m="2339530">happening,</span> <span m="2340140">they might</span> <span m="2340540">have</span> <span m="2340760">at least</span> <span m="2341530">had</span> <span m="2342060">a</span> <span m="2342210">second</span> <span m="2342580">thought</span> <span m="2343030">about</span> <span m="2343340">whether</span> <span m="2343490">they want to</span> <span m="2343610">install</span> <span m="2343900">this</span> <span m="2344040">application</span> <span m="2344295">or not.</span> </p>
<p><span m="2345035">AUDIENCE:</span> <span m="2345520">Is it</span> <span m="2346005">reasonable</span> <span m="2346490">to</span> <span m="2346975">guess</span> <span m="2347460">that even</span> <span m="2347945">if</span> <span m="2348430">they put it</span> <span m="2348915">in the</span> <span m="2349400">EULA,</span> <span m="2349885">that that's</span> <span m="2350370">not really worth</span> <span m="2350855">it because people</span> <span m="2351340">never read those.</span> </p>
<p><span m="2351830">PROFESSOR: Yes,</span> <span m="2352430">it</span> <span m="2352560">is,</span> <span m="2352740">in</span> <span m="2352850">fact,</span> <span m="2353170">quite</span> <span m="2354080">reasonable</span> <span m="2354500">to</span> <span m="2354580">assume</span> <span m="2354920">that.</span> <span m="2355770">So</span> <span m="2356360">even</span> <span m="2356630">well trained</span> <span m="2357080">computer</span> <span m="2357400">scientists</span> <span m="2357700">like</span> <span m="2357800">myself</span> <span m="2358620">do not</span> <span m="2358960">always</span> <span m="2359190">check out the EULA</span> <span m="2359465">because</span> <span m="2359740">it's like,</span> <span m="2359900">you</span> <span m="2360170">gotta</span> <span m="2360890">have</span> <span m="2361100">Flappy</span> <span m="2361310">Birds</span> <span m="2361670">or what</span> <span m="2361710">are you</span> <span m="2361890">going</span> <span m="2362010">to</span> <span m="2362070">do.</span> <span m="2363000">I</span> <span m="2363160">think</span> <span m="2364020">what</span> <span m="2364140">is</span> <span m="2364430">useful,</span> <span m="2364870">though,</span> <span m="2365590">and this is</span> <span m="2366020">kind of spiritually</span> <span m="2366360">unsatisfying</span> <span m="2366700">but</span> <span m="2367330">useful</span> <span m="2367710">in practice,</span> <span m="2368390">is</span> <span m="2368550">that</span> <span m="2368860">if</span> <span m="2369550">it is put</span> <span m="2369830">in the EULA,</span> <span m="2370110">then</span> <span m="2370230">maybe</span> <span m="2370450">there</span> <span m="2370630">will</span> <span m="2370980">be</span> <span m="2371300">some</span> <span m="2371470">virtuous</span> <span m="2372070">individuals</span> <span m="2372260">who</span> <span m="2372330">do</span> <span m="2372630">actually</span> <span m="2373120">read</span> <span m="2373510">the</span> <span m="2373940">EULA.</span> </p>
<p><span m="2374050">AUDIENCE:</span> <span m="2374325">And they could tell you like--</span> </p>
<p><span m="2374600">PROFESSOR: That's</span> <span m="2374850">right,</span> <span m="2375140">that's right.</span> </p>
<p><span m="2375490">AUDIENCE:</span> <span m="2375568">--don't</span> <span m="2375646">do</span> <span m="2375724">that</span> <span m="2375802">one.</span> </p>
<p><span m="2375880">PROFESSOR: Yeah,</span> <span m="2377120">Consumer</span> <span m="2377540">Reports</span> <span m="2377960">or</span> <span m="2378030">some</span> <span m="2378260">moral equivalent</span> <span m="2378620">will</span> <span m="2378980">say</span> <span m="2379930">our</span> <span m="2380130">job is to</span> <span m="2380570">read</span> <span m="2380975">EULAs,</span> <span m="2381380">and by</span> <span m="2381830">the way,</span> <span m="2382254">you shouldn't</span> <span m="2382678">download this</span> <span m="2383102">app.</span> <span m="2383526">But you're</span> <span m="2383950">exactly</span> <span m="2384420">correct</span> <span m="2384730">that relying</span> <span m="2385040">on</span> <span m="2385130">users</span> <span m="2385820">to</span> <span m="2385970">read</span> <span m="2386480">pages</span> <span m="2386870">of</span> <span m="2386970">tiny</span> <span m="2387340">print</span> <span m="2388260">is</span> <span m="2388470">basically--</span> <span m="2388840">they're</span> <span m="2388940">not</span> <span m="2389205">going to do it.</span> <span m="2389470">They're going</span> <span m="2389570">to</span> <span m="2389610">hit</span> <span m="2389800">Next</span> <span m="2390100">and</span> <span m="2390562">then</span> <span m="2391024">keep</span> <span m="2391486">on going.</span> <span m="2394260">OK,</span> <span m="2394590">so</span> <span m="2394740">any</span> <span m="2394890">questions</span> <span m="2395310">up to</span> <span m="2395460">this</span> <span m="2395600">point?</span> </p>
<p><span m="2397500">I</span> <span m="2397630">think</span> <span m="2398010">that</span> <span m="2399130">the</span> <span m="2401390">rules</span> <span m="2401810">for</span> <span m="2402030">how</span> <span m="2402380">information</span> <span m="2402890">flows</span> <span m="2403230">through</span> <span m="2403310">the</span> <span m="2403430">system</span> <span m="2404000">are</span> <span m="2404290">fairly</span> <span m="2404610">straightforward.</span> <span m="2405650">So</span> <span m="2405770">as</span> <span m="2405880">we</span> <span m="2405980">were</span> <span m="2406040">discussing,</span> <span m="2406530">it's</span> <span m="2406660">basically</span> <span m="2407560">taint</span> <span m="2408010">from the</span> <span m="2408100">right</span> <span m="2408330">hand</span> <span m="2408530">side</span> <span m="2408790">goes</span> <span m="2409100">to the</span> <span m="2409180">left</span> <span m="2409600">side.</span> <span m="2410400">Sometimes,</span> <span m="2411040">though,</span> <span m="2411640">these</span> <span m="2412060">information</span> <span m="2412570">flow rules</span> <span m="2413010">can</span> <span m="2413410">have somewhat</span> <span m="2413760">counterintuitive</span> <span m="2414520">results.</span> <span m="2415140">So</span> <span m="2415250">imagine</span> <span m="2415800">that</span> <span m="2416780">an application</span> <span m="2417260">is</span> <span m="2417580">going</span> <span m="2417880">to</span> <span m="2418570">implement</span> <span m="2418870">its</span> <span m="2419170">own</span> <span m="2420142">linked</span> <span m="2420630">list</span> <span m="2420880">class.</span> <span m="2422120">So</span> <span m="2423410">it's</span> <span m="2423520">going to</span> <span m="2423900">define</span> <span m="2426180">some</span> <span m="2426500">simple</span> <span m="2426710">class</span> <span m="2427055">up</span> <span m="2427400">here</span> <span m="2427710">called</span> <span m="2428550">ListNode</span> <span m="2429090">and</span> <span m="2429470">it's</span> <span m="2429740">going</span> <span m="2429890">to</span> <span m="2429940">have</span> <span m="2431080">an</span> <span m="2431250">object</span> <span m="2431830">field</span> <span m="2432980">for</span> <span m="2433320">data.</span> <span m="2435020">And</span> <span m="2435660">then</span> <span m="2435820">it</span> <span m="2435960">will</span> <span m="2436100">have</span> <span m="2437330">a</span> <span m="2437670">ListNode</span> <span m="2439336">object which</span> <span m="2439720">represents</span> <span m="2442380">the</span> <span m="2442540">next</span> <span m="2442870">thing</span> <span m="2443130">in</span> <span m="2443150">the</span> <span m="2443480">linked</span> <span m="2443780">list.</span> </p>
<p><span m="2446310">Suppose</span> <span m="2446980">if</span> <span m="2447080">the</span> <span m="2447210">application</span> <span m="2448340">assigned</span> <span m="2448920">some</span> <span m="2449120">tainted</span> <span m="2449540">data</span> <span m="2450770">to</span> <span m="2453040">this</span> <span m="2453230">field</span> <span m="2453540">here.</span> <span m="2454590">Some</span> <span m="2454770">sensitive</span> <span m="2455120">data</span> <span m="2455400">derived</span> <span m="2455695">from a</span> <span m="2455990">GPS</span> <span m="2456470">or</span> <span m="2456520">whatever.</span> <span m="2457400">So</span> <span m="2458280">one question</span> <span m="2458555">you</span> <span m="2458830">might</span> <span m="2459200">have</span> <span m="2459550">is</span> <span m="2459810">what</span> <span m="2460090">happens</span> <span m="2460880">when</span> <span m="2460990">we</span> <span m="2461120">calculate</span> <span m="2461810">the</span> <span m="2462205">length</span> <span m="2462600">for</span> <span m="2462750">this</span> <span m="2462950">list.</span> <span m="2463730">Should</span> <span m="2463990">the</span> <span m="2464130">length</span> <span m="2464680">of</span> <span m="2464890">the</span> <span m="2464980">list</span> <span m="2465450">be</span> <span m="2465920">tainted?</span> <span m="2468660">It</span> <span m="2468810">may</span> <span m="2468990">strike</span> <span m="2469310">you as</span> <span m="2469430">a</span> <span m="2469500">bit</span> <span m="2469630">counterintuitive</span> <span m="2470870">that</span> <span m="2471060">the</span> <span m="2471500">answer</span> <span m="2471910">is</span> <span m="2472370">probability</span> <span m="2473056">no,</span> <span m="2473400">at</span> <span m="2473755">least</span> <span m="2474110">in the way</span> <span m="2474480">that TaintDroid</span> <span m="2474720">and a lot</span> <span m="2475020">of these</span> <span m="2475330">systems</span> <span m="2475670">define</span> <span m="2476050">information</span> <span m="2476480">flow.</span> <span m="2476980">So</span> <span m="2477140">what</span> <span m="2477290">does it</span> <span m="2477530">mean</span> <span m="2479800">to</span> <span m="2480210">add</span> <span m="2480570">a</span> <span m="2481055">node</span> <span m="2482510">to</span> <span m="2483120">the</span> <span m="2483260">linked</span> <span m="2483460">list.</span> </p>
<p><span m="2485530">It</span> <span m="2485790">basically</span> <span m="2486670">means</span> <span m="2487620">three</span> <span m="2487960">things.</span> <span m="2488460">So</span> <span m="2488640">the</span> <span m="2488730">first</span> <span m="2489000">thing</span> <span m="2489140">you</span> <span m="2489190">do</span> <span m="2489740">is</span> <span m="2490050">you</span> <span m="2490810">allocate</span> <span m="2492800">a</span> <span m="2492990">new</span> <span m="2493290">list node</span> <span m="2495440">to</span> <span m="2495540">contain</span> <span m="2495970">this</span> <span m="2496110">new data</span> <span m="2496365">that you</span> <span m="2496620">want</span> <span m="2496770">to add.</span> <span m="2497680">Then</span> <span m="2498060">the</span> <span m="2498120">second</span> <span m="2498385">thing</span> <span m="2498650">you</span> <span m="2499020">do</span> <span m="2499290">is</span> <span m="2499860">you</span> <span m="2500650">assign</span> <span m="2504020">to</span> <span m="2504360">the</span> <span m="2505090">data</span> <span m="2505420">field</span> <span m="2506500">of</span> <span m="2506950">this</span> <span m="2507160">new</span> <span m="2507350">node.</span> <span m="2508050">And then</span> <span m="2508290">the</span> <span m="2508420">third</span> <span m="2508770">thing</span> <span m="2508930">that</span> <span m="2509060">you</span> <span m="2509180">do</span> <span m="2510130">is</span> <span m="2510520">you</span> <span m="2511860">do</span> <span m="2512030">some</span> <span m="2512240">type</span> <span m="2512430">of</span> <span m="2512540">patch</span> <span m="2512930">up</span> <span m="2513270">of</span> <span m="2514670">the</span> <span m="2515120">next</span> <span m="2515400">pointers</span> <span m="2517140">to</span> <span m="2517260">actually</span> <span m="2517610">splice</span> <span m="2518100">the</span> <span m="2518200">node</span> <span m="2519560">into</span> <span m="2520410">the</span> <span m="2520540">list.</span> </p>
<p><span m="2522380">What's</span> <span m="2522550">interesting</span> <span m="2523050">is</span> <span m="2523150">that</span> <span m="2523410">this</span> <span m="2523650">step</span> <span m="2523870">here</span> <span m="2524650">doesn't</span> <span m="2525230">actually</span> <span m="2525710">involve</span> <span m="2527260">the</span> <span m="2527430">data</span> <span m="2527730">field</span> <span m="2528050">at</span> <span m="2528100">all.</span> <span m="2528960">Just</span> <span m="2529050">looking</span> <span m="2529420">at these</span> <span m="2529790">next</span> <span m="2530110">values.</span> <span m="2530840">Right,</span> <span m="2531250">so</span> <span m="2531820">what's</span> <span m="2531960">interesting</span> <span m="2532370">is</span> <span m="2532440">that</span> <span m="2532640">since</span> <span m="2532860">only</span> <span m="2534230">these</span> <span m="2534480">data</span> <span m="2534820">objects</span> <span m="2535195">are</span> <span m="2535570">tainted,</span> <span m="2538180">how</span> <span m="2538460">we</span> <span m="2538620">calculate</span> <span m="2539330">the length</span> <span m="2539665">of a list.</span> <span m="2540000">We</span> <span m="2540140">basically</span> <span m="2540780">start</span> <span m="2541260">from</span> <span m="2541390">some head</span> <span m="2541710">node</span> <span m="2541930">and we</span> <span m="2542040">traverse</span> <span m="2542170">these</span> <span m="2542610">next</span> <span m="2542870">pointers,</span> <span m="2543200">and we</span> <span m="2543530">count how</span> <span m="2543860">many we</span> <span m="2544190">traverse.</span> <span m="2545050">So</span> <span m="2545120">that</span> <span m="2545590">algorithm</span> <span m="2545720">is not</span> <span m="2545910">going</span> <span m="2546280">to</span> <span m="2546410">touch the tainted</span> <span m="2546690">data</span> <span m="2546950">at</span> <span m="2547010">all.</span> </p>
<p><span m="2547920">So</span> <span m="2548630">interestingly,</span> <span m="2549380">even</span> <span m="2549680">if</span> <span m="2549880">you have</span> <span m="2550370">a</span> <span m="2550920">linked</span> <span m="2551170">list</span> <span m="2551690">that's</span> <span m="2551990">filled</span> <span m="2552810">with</span> <span m="2554380">tainted</span> <span m="2554760">data,</span> <span m="2555840">then</span> <span m="2555980">just</span> <span m="2556190">calculating</span> <span m="2556770">the</span> <span m="2556910">length</span> <span m="2557225">of</span> <span m="2557540">that</span> <span m="2557850">list</span> <span m="2558410">won't</span> <span m="2558750">actually</span> <span m="2559130">result</span> <span m="2559870">in</span> <span m="2559980">the</span> <span m="2560050">generation</span> <span m="2560480">of</span> <span m="2560600">value</span> <span m="2561360">that</span> <span m="2561480">is</span> <span m="2561590">tainted</span> <span m="2561810">at</span> <span m="2561970">all.</span> <span m="2563630">So</span> <span m="2563760">does that</span> <span m="2564210">makes</span> <span m="2564400">sense?</span> <span m="2565200">That</span> <span m="2565540">may</span> <span m="2565820">seem a</span> <span m="2566235">little</span> <span m="2566650">bit counterintuitive,</span> <span m="2567988">and</span> <span m="2568434">this is</span> <span m="2568880">one of the</span> <span m="2568980">reasons why,</span> <span m="2569230">for example,</span> <span m="2569370">like</span> <span m="2569470">when</span> <span m="2569760">we were</span> <span m="2570060">talking</span> <span m="2570230">about</span> <span m="2570420">the</span> <span m="2570570">array, for</span> <span m="2570930">example.</span> <span m="2572080">They</span> <span m="2572220">say</span> <span m="2572590">array.length,</span> <span m="2573965">I'm</span> <span m="2574220">not going to</span> <span m="2574505">generate</span> <span m="2575150">any</span> <span m="2575510">taint for</span> <span m="2575760">that.</span> <span m="2576110">It's</span> <span m="2576270">because</span> <span m="2576630">of</span> <span m="2577400">reasons</span> <span m="2577730">like</span> <span m="2577940">this.</span> </p>
<p><span m="2580390">If you</span> <span m="2580540">wanted</span> <span m="2583530">a</span> <span m="2583680">stronger</span> <span m="2584430">assurance</span> <span m="2584950">about--</span> <span m="2585940">not</span> <span m="2586260">stronger assurance.</span> <span m="2586810">But</span> <span m="2587090">if you</span> <span m="2587180">actually</span> <span m="2587500">want</span> <span m="2587850">to</span> <span m="2588250">calculate</span> <span m="2588730">the</span> <span m="2589482">length</span> <span m="2589860">of the</span> <span m="2591300">list</span> <span m="2592020">to</span> <span m="2592370">generate</span> <span m="2593300">a kind of</span> <span m="2593740">value,</span> <span m="2594620">we could</span> <span m="2595060">imagine</span> <span m="2595500">that your</span> <span m="2595630">implementation,</span> <span m="2596610">it's</span> <span m="2596650">a</span> <span m="2596790">bit</span> <span m="2597010">goofy,</span> <span m="2597200">but</span> <span m="2597250">you</span> <span m="2597420">can just</span> <span m="2597600">decide</span> <span m="2598020">to</span> <span m="2598170">touch</span> <span m="2598520">data</span> <span m="2600120">for no</span> <span m="2600300">real</span> <span m="2600590">semantic</span> <span m="2601130">reason</span> <span m="2601280">other than</span> <span m="2601450">to generate</span> <span m="2601940">taint</span> <span m="2602820">in</span> <span m="2602970">the</span> <span m="2603060">resulting</span> <span m="2603510">length.</span> <span m="2604240">Or,</span> <span m="2604540">as</span> <span m="2604650">I'll</span> <span m="2604680">discuss</span> <span m="2605410">towards</span> <span m="2605860">the end of</span> <span m="2606130">the lecture,</span> <span m="2606280">you could</span> <span m="2606380">actually</span> <span m="2606690">use</span> <span m="2607000">a</span> <span m="2607070">language</span> <span m="2607780">which</span> <span m="2607990">allows</span> <span m="2609050">you</span> <span m="2609190">the</span> <span m="2609320">programmer</span> <span m="2610190">to</span> <span m="2610920">define</span> <span m="2611740">your</span> <span m="2612060">own types</span> <span m="2612460">of</span> <span m="2612570">taint.</span> <span m="2613780">And</span> <span m="2614110">then</span> <span m="2614230">you</span> <span m="2614320">can</span> <span m="2614440">actually</span> <span m="2614680">define</span> <span m="2615100">your</span> <span m="2615370">own</span> <span m="2615630">policies</span> <span m="2616530">for</span> <span m="2616670">things</span> <span m="2616970">like</span> <span m="2617180">this.</span> </p>
<p><span m="2618280">One</span> <span m="2618560">nice</span> <span m="2618850">thing</span> <span m="2619020">about</span> <span m="2619300">TaintDroid</span> <span m="2619490">is</span> <span m="2619810">that</span> <span m="2620040">you</span> <span m="2620180">as</span> <span m="2620300">a</span> <span m="2620350">developer,</span> <span m="2621210">you</span> <span m="2621220">don't</span> <span m="2621370">have</span> <span m="2621510">to</span> <span m="2621600">label</span> <span m="2621840">anything.</span> <span m="2622520">TaintDroid</span> <span m="2622970">basically</span> <span m="2623230">does</span> <span m="2623300">that for you.</span> <span m="2624030">It</span> <span m="2624170">says</span> <span m="2624590">here's</span> <span m="2625070">all the</span> <span m="2625200">sensitive</span> <span m="2625370">stuff</span> <span m="2626160">that</span> <span m="2626340">can</span> <span m="2626450">be</span> <span m="2626550">a</span> <span m="2626600">source,</span> <span m="2627250">here's</span> <span m="2627590">all the</span> <span m="2627700">sensitive</span> <span m="2627980">stuff</span> <span m="2628250">that</span> <span m="2628420">can be</span> <span m="2628700">a sink.</span> <span m="2628850">You as</span> <span m="2629000">a</span> <span m="2629050">developer,</span> <span m="2629910">you're</span> <span m="2630060">ready</span> <span m="2630240">to</span> <span m="2630310">go.</span> <span m="2631430">But</span> <span m="2631560">if</span> <span m="2631650">you</span> <span m="2631770">want</span> <span m="2631940">that</span> <span m="2632220">pointer</span> <span m="2632310">to be</span> <span m="2632480">controlled,</span> <span m="2633020">you might</span> <span m="2633260">have</span> <span m="2633425">to</span> <span m="2633507">build</span> <span m="2633590">some of the</span> <span m="2633915">policies</span> <span m="2634240">yourself.</span> </p>
<p><span m="2636700">All</span> <span m="2637190">right,</span> <span m="2637580">so</span> <span m="2639420">in</span> <span m="2639560">terms</span> <span m="2640140">of</span> <span m="2642510">performance</span> <span m="2643200">overhead</span> <span m="2644385">of</span> <span m="2644850">TaintDroid,</span> <span m="2645270">what</span> <span m="2645450">does</span> <span m="2645540">that</span> <span m="2645890">look like?</span> <span m="2648550">The</span> <span m="2648730">overheads</span> <span m="2649300">actually</span> <span m="2649680">seem</span> <span m="2650120">to be pretty</span> <span m="2650840">reasonable.</span> <span m="2651710">So</span> <span m="2652550">there's</span> <span m="2652750">going</span> <span m="2652880">to</span> <span m="2652960">be</span> <span m="2653801">memory</span> <span m="2654242">overhead,</span> <span m="2655565">and that's</span> <span m="2656006">the memory</span> <span m="2656540">overhead,</span> <span m="2656910">essentially,</span> <span m="2658070">of</span> <span m="2658370">storing</span> <span m="2659040">all</span> <span m="2659310">of</span> <span m="2659430">these</span> <span m="2660140">taint</span> <span m="2660450">tags.</span> <span m="2661730">And</span> <span m="2661960">so</span> <span m="2662690">there's</span> <span m="2662950">going</span> <span m="2663070">to</span> <span m="2663150">be</span> <span m="2664180">CPU</span> <span m="2664980">overhead,</span> <span m="2667320">and</span> <span m="2667660">this</span> <span m="2667860">is</span> <span m="2668000">basically</span> <span m="2668750">to</span> <span m="2669160">assign,</span> <span m="2669920">propagate,</span> <span m="2670810">and</span> <span m="2671010">check</span> <span m="2672290">those</span> <span m="2672680">taint</span> <span m="2673650">calculations.</span> <span m="2674720">And</span> <span m="2674890">that's</span> <span m="2675150">because</span> <span m="2675280">of</span> <span m="2675360">overhead</span> <span m="2675720">like</span> <span m="2675890">here.</span> <span m="2676600">So</span> <span m="2677100">any</span> <span m="2677540">interpreting</span> <span m="2677980">for</span> <span m="2678080">the Dalvik</span> <span m="2678360">VM,</span> <span m="2678640">we're</span> <span m="2679010">actually</span> <span m="2679330">doing</span> <span m="2679650">additional</span> <span m="2680030">work.</span> <span m="2680470">So</span> <span m="2681030">looking</span> <span m="2681260">at</span> <span m="2681330">the</span> <span m="2681450">source,</span> <span m="2682080">looking</span> <span m="2682530">at</span> <span m="2682670">this</span> <span m="2683590">32</span> <span m="2683880">bit</span> <span m="2683980">taint</span> <span m="2684080">information,</span> <span m="2685040">we're</span> <span m="2685190">doing</span> <span m="2686550">the</span> <span m="2686920">or</span> <span m="2687220">operations</span> <span m="2687730">that we</span> <span m="2687940">discussed</span> <span m="2688270">before,</span> <span m="2688650">and so on and</span> <span m="2688870">so</span> <span m="2689020">forth.</span> <span m="2689250">So</span> <span m="2689480">that's</span> <span m="2689670">computational</span> <span m="2690190">overhead.</span> </p>
<p><span m="2692260">These</span> <span m="2692400">overheads</span> <span m="2692850">actually</span> <span m="2693120">seem</span> <span m="2693390">to</span> <span m="2693450">be</span> <span m="2693580">pretty</span> <span m="2693790">moderate.</span> <span m="2694610">So</span> <span m="2695290">for memory,</span> <span m="2695970">the authors</span> <span m="2696386">report</span> <span m="2699110">about</span> <span m="2699540">3% to</span> <span m="2700040">5%</span> <span m="2701540">in</span> <span m="2701670">terms</span> <span m="2701950">of</span> <span m="2702050">the</span> <span m="2702180">extra</span> <span m="2703200">RAM space</span> <span m="2703555">you</span> <span m="2703910">need</span> <span m="2704410">to</span> <span m="2704490">store</span> <span m="2704770">those</span> <span m="2705370">taint</span> <span m="2705620">tags.</span> <span m="2706015">So</span> <span m="2706410">that's</span> <span m="2706680">not too</span> <span m="2707040">bad.</span> <span m="2707550">The</span> <span m="2707620">CPU</span> <span m="2708170">overhead</span> <span m="2708665">is</span> <span m="2709160">higher,</span> <span m="2710390">which</span> <span m="2710670">I think</span> <span m="2710880">makes</span> <span m="2711100">sense.</span> <span m="2711460">They're</span> <span m="2711660">both</span> <span m="2712060">somewhere</span> <span m="2712325">between,</span> <span m="2712590">let's</span> <span m="2712680">say,</span> <span m="2712840">3%</span> <span m="2713780">and</span> <span m="2713910">about</span> <span m="2714300">29%</span> <span m="2718070">CPU</span> <span m="2718610">overhead.</span> <span m="2719890">And</span> <span m="2720170">the</span> <span m="2720250">reason</span> <span m="2720520">why</span> <span m="2720740">I think it's</span> <span m="2721100">reasonable</span> <span m="2721530">to</span> <span m="2721600">see</span> <span m="2721790">why</span> <span m="2721950">that's</span> <span m="2722160">higher</span> <span m="2722470">is</span> <span m="2722780">because</span> <span m="2723330">you</span> <span m="2723420">can</span> <span m="2723530">imagine</span> <span m="2724020">that</span> <span m="2726060">every</span> <span m="2726360">time</span> <span m="2726810">you</span> <span m="2727080">step</span> <span m="2727350">into</span> <span m="2727550">the</span> <span m="2727750">interpreter</span> <span m="2728200">loop,</span> <span m="2728730">you're</span> <span m="2728850">having</span> <span m="2729140">to</span> <span m="2729260">look</span> <span m="2729530">at</span> <span m="2729620">these</span> <span m="2729790">tags</span> <span m="2730360">and do some</span> <span m="2730520">operations.</span> <span m="2731440">So</span> <span m="2731590">even</span> <span m="2731860">though</span> <span m="2732000">it</span> <span m="2732090">is</span> <span m="2733040">all</span> <span m="2733310">these</span> <span m="2733500">bitwise</span> <span m="2733920">operations,</span> <span m="2734850">you have to</span> <span m="2734930">do</span> <span m="2735020">that</span> <span m="2735320">all</span> <span m="2735700">the time.</span> <span m="2736690">So</span> <span m="2736820">that seems</span> <span m="2737215">like</span> <span m="2737610">it's going</span> <span m="2737720">to get painful,</span> <span m="2738490">whereas</span> <span m="2739640">basically,</span> <span m="2739960">the</span> <span m="2740100">overhead</span> <span m="2740520">for</span> <span m="2740580">this,</span> <span m="2741280">OK,</span> <span m="2741740">so you</span> <span m="2742020">put</span> <span m="2742570">a</span> <span m="2742590">couple</span> <span m="2742900">extra</span> <span m="2743160">integers</span> <span m="2743630">in</span> <span m="2743940">memory</span> <span m="2744000">somewhere.</span> <span m="2744740">That</span> <span m="2745050">doesn't</span> <span m="2745340">seem,</span> <span m="2745720">maybe,</span> <span m="2745880">too</span> <span m="2745920">bad.</span> </p>
<p><span m="2748340">Even</span> <span m="2748670">on</span> <span m="2748820">it's</span> <span m="2749100">high end,</span> <span m="2749380">29%,</span> <span m="2751080">in</span> <span m="2751260">of</span> <span m="2751380">itself</span> <span m="2752000">maybe</span> <span m="2752200">that's</span> <span m="2752460">OK,</span> <span m="2753570">because</span> <span m="2755850">Silicon</span> <span m="2755980">Valley</span> <span m="2756430">keeps telling</span> <span m="2756770">us</span> <span m="2757080">that</span> <span m="2757390">we need</span> <span m="2757830">phones</span> <span m="2758080">that have</span> <span m="2758400">like</span> <span m="2758630">quad cores</span> <span m="2758890">and whatnot,</span> <span m="2759080">so</span> <span m="2759190">probably</span> <span m="2759450">have a lot of</span> <span m="2759760">spare</span> <span m="2759990">cycles</span> <span m="2760390">sitting around.</span> <span m="2760940">So maybe</span> <span m="2761120">that's not</span> <span m="2761890">all</span> <span m="2762260">that</span> <span m="2762610">crushing.</span> <span m="2763550">Although</span> <span m="2764140">there</span> <span m="2764290">might</span> <span m="2764510">be</span> <span m="2764620">a</span> <span m="2764700">problem</span> <span m="2764970">with</span> <span m="2765160">battery life.</span> <span m="2766750">So</span> <span m="2767540">even if you</span> <span m="2767640">have</span> <span m="2768010">these</span> <span m="2768340">extra cores,</span> <span m="2768900">you</span> <span m="2769000">might</span> <span m="2769190">not</span> <span m="2769410">want your</span> <span m="2769675">phone</span> <span m="2769940">getting</span> <span m="2770210">hot</span> <span m="2770490">in your</span> <span m="2770570">pocket</span> <span m="2770900">as</span> <span m="2771060">you're just</span> <span m="2771350">sitting there,</span> <span m="2772070">just</span> <span m="2772510">sort</span> <span m="2772950">of</span> <span m="2773390">churning</span> <span m="2773685">and calculating</span> <span m="2773980">some of this</span> <span m="2774160">stuff.</span> </p>
<p><span m="2775100">I</span> <span m="2775180">think</span> <span m="2775400">for</span> <span m="2775540">here,</span> <span m="2776440">the</span> <span m="2776690">main</span> <span m="2776940">issue</span> <span m="2777150">here</span> <span m="2777400">would</span> <span m="2777770">be if</span> <span m="2778030">this</span> <span m="2778415">is bad for your</span> <span m="2778800">battery.</span> <span m="2779400">If it's</span> <span m="2779650">not</span> <span m="2779870">bad</span> <span m="2780330">for your</span> <span m="2780920">battery,</span> <span m="2781235">then probably</span> <span m="2781550">even at that high end,</span> <span m="2782524">that</span> <span m="2783011">may not be</span> <span m="2783498">that bad.</span> <span m="2788800">So</span> <span m="2789010">that is</span> <span m="2789360">essentially</span> <span m="2790300">an</span> <span m="2790390">overview</span> <span m="2790860">of</span> <span m="2790970">how</span> <span m="2791915">TaintDroid</span> <span m="2792340">works.</span> <span m="2792785">Any more</span> <span m="2793230">questions</span> <span m="2793580">before</span> <span m="2794072">we--</span> </p>
<p><span m="2794564">AUDIENCE:</span> <span m="2795056">Do you</span> <span m="2795548">tag</span> <span m="2796040">something</span> <span m="2796532">that</span> <span m="2797024">also</span> <span m="2797516">has</span> <span m="2798008">been there all the time?</span> <span m="2799484">Do</span> <span m="2799976">you tag</span> <span m="2800468">every</span> <span m="2800960">variable,</span> <span m="2801452">or only tag the</span> <span m="2801944">ones</span> <span m="2802436">that have</span> <span m="2802928">this?</span> </p>
<p><span m="2803420">PROFESSOR:</span> <span m="2803920">Yes,</span> <span m="2804140">so</span> <span m="2804515">you</span> <span m="2804890">basically</span> <span m="2805240">tag</span> <span m="2805590">everything.</span> <span m="2806840">So</span> <span m="2808690">in</span> <span m="2809350">theory,</span> <span m="2810300">there's</span> <span m="2810550">nothing</span> <span m="2811042">that</span> <span m="2811534">prevents</span> <span m="2812026">you</span> <span m="2812518">from</span> <span m="2814486">not</span> <span m="2814978">allocating</span> <span m="2815470">any taint</span> <span m="2815962">information</span> <span m="2816454">for stuff</span> <span m="2816946">that has no</span> <span m="2817450">taint at all.</span> <span m="2817750">I</span> <span m="2818050">think</span> <span m="2818200">the</span> <span m="2818310">problem,</span> <span m="2818770">then,</span> <span m="2818950">with it--</span> <span m="2820170">then</span> <span m="2820760">once</span> <span m="2820900">something</span> <span m="2821590">gains</span> <span m="2822210">even</span> <span m="2822677">one</span> <span m="2823144">bit</span> <span m="2823611">of</span> <span m="2824078">taint,</span> <span m="2824545">then</span> <span m="2825012">you have</span> <span m="2825480">to do</span> <span m="2825825">dynamic</span> <span m="2826170">sort</span> <span m="2826450">of</span> <span m="2826570">layout</span> <span m="2826970">changes.</span> <span m="2827770">So</span> <span m="2828600">what</span> <span m="2828990">if on the</span> <span m="2829265">stack,</span> <span m="2830050">this</span> <span m="2830230">local</span> <span m="2830600">here,</span> <span m="2831527">then it</span> <span m="2831974">had a taint,</span> <span m="2832421">so now</span> <span m="2832870">you're allocating</span> <span m="2833270">with this,</span> <span m="2833670">and</span> <span m="2833710">it</span> <span m="2833750">does get taint.</span> <span m="2834303">Or</span> <span m="2834776">you</span> <span m="2835250">have</span> <span m="2835570">that extra</span> <span m="2835760">taint flag</span> <span m="2836140">live on the heap,</span> <span m="2836520">and you're going to</span> <span m="2836830">see how</span> <span m="2836960">it rewrites</span> <span m="2837210">the stack,</span> <span m="2838020">and then someone</span> <span m="2838360">made your</span> <span m="2838500">code--</span> <span m="2839570">so</span> <span m="2839900">we're</span> <span m="2840140">going to see how</span> <span m="2840300">that works.</span> <span m="2840780">So in</span> <span m="2840910">practice,</span> <span m="2842900">typical use</span> <span m="2843283">is</span> <span m="2843666">like</span> <span m="2844050">shadow</span> <span m="2844330">memory</span> <span m="2844750">somehow,</span> <span m="2845210">so</span> <span m="2846160">every</span> <span m="2846535">byte</span> <span m="2847245">in</span> <span m="2847580">the</span> <span m="2848080">application</span> <span m="2848770">is</span> <span m="2849280">backed up</span> <span m="2849800">by</span> <span m="2849920">some</span> <span m="2850240">byte of</span> <span m="2850660">extra</span> <span m="2851060">information</span> <span m="2851560">somewhere.</span> <span m="2852060">And</span> <span m="2852560">in the</span> <span m="2853060">case of TaintDroid,</span> <span m="2853560">that</span> <span m="2854060">shadowing</span> <span m="2854560">actually</span> <span m="2855060">lives alongside</span> <span m="2855560">of the actual</span> <span m="2856060">variable itself.</span> <span m="2857060">Anyone</span> <span m="2857560">has</span> <span m="2858060">another question?</span> <span m="2860060">OK.</span> <span m="2861860">Cool.</span> </p>
<p><span m="2863302">This</span> <span m="2863758">system</span> <span m="2864214">essentially</span> <span m="2865130">tracks</span> <span m="2865590">information</span> <span m="2866720">at</span> <span m="2867240">the</span> <span m="2867270">level</span> <span m="2867840">of</span> <span m="2868040">these</span> <span m="2869020">high</span> <span m="2869450">level</span> <span m="2870370">Dalvik</span> <span m="2871240">VM</span> <span m="2871390">instructions.</span> <span m="2873840">So</span> <span m="2874370">one</span> <span m="2874630">thing</span> <span m="2875073">you</span> <span m="2875516">might</span> <span m="2877700">think</span> <span m="2877930">to</span> <span m="2878030">yourself</span> <span m="2879310">is,</span> <span m="2880220">could</span> <span m="2880470">we</span> <span m="2882930">track</span> <span m="2883756">taint</span> <span m="2886030">at</span> <span m="2886530">the</span> <span m="2887050">level</span> <span m="2889080">of</span> <span m="2889540">x86</span> <span m="2890370">instructions</span> <span m="2891230">or</span> <span m="2891490">the</span> <span m="2892770">ARM</span> <span m="2893590">instructions.</span> <span m="2897830">One</span> <span m="2898176">reason why</span> <span m="2898522">that might be</span> <span m="2898870">useful</span> <span m="2899255">is</span> <span m="2899640">because</span> <span m="2900330">then</span> <span m="2901370">we</span> <span m="2901550">could</span> <span m="2901730">actually</span> <span m="2902470">understand</span> <span m="2903860">how</span> <span m="2904080">information</span> <span m="2904750">flows</span> <span m="2905050">through</span> <span m="2905350">arbitrary</span> <span m="2905930">applications,</span> <span m="2906650">not</span> <span m="2907056">just</span> <span m="2907462">ones</span> <span m="2907868">that are</span> <span m="2908274">running</span> <span m="2908680">inside</span> <span m="2909060">this tricked</span> <span m="2909420">out</span> <span m="2910160">VM</span> <span m="2910550">that</span> <span m="2910880">requires</span> <span m="2911230">you to run</span> <span m="2911720">Java</span> <span m="2912050">and</span> <span m="2912380">so on and</span> <span m="2912820">so forth.</span> <span m="2913270">So</span> <span m="2913560">why not</span> <span m="2914628">track</span> <span m="2915544">taint</span> <span m="2916002">at</span> <span m="2916460">that</span> <span m="2916918">level.</span> </p>
<p><span m="2917376">It turns</span> <span m="2917834">out that</span> <span m="2918300">you can, in fact,</span> <span m="2918635">do that.</span> <span m="2919200">So there are</span> <span m="2919380">projects</span> <span m="2919770">that</span> <span m="2920160">we looked</span> <span m="2920557">at</span> <span m="2920954">at</span> <span m="2921351">tracking</span> <span m="2921750">taint</span> <span m="2922100">at this</span> <span m="2922385">low level.</span> <span m="2923960">What's</span> <span m="2924420">nice</span> <span m="2924600">is</span> <span m="2924810">that</span> <span m="2925230">you</span> <span m="2925400">maybe</span> <span m="2925790">get</span> <span m="2926279">that increased coverage.</span> <span m="2926768">You don't</span> <span m="2927257">throw a line</span> <span m="2927746">into</span> <span m="2928235">[INAUDIBLE]</span> <span m="2928724">for</span> <span m="2929213">how,</span> <span m="2929702">for</span> <span m="2930191">example,</span> <span m="2930354">Java</span> <span m="2930517">code</span> <span m="2930680">interacts with</span> <span m="2931169">native</span> <span m="2931660">code methods.</span> <span m="2932060">It's</span> <span m="2932520">all</span> <span m="2932800">eventually</span> <span m="2933165">going to result</span> <span m="2933530">down</span> <span m="2934015">to x86</span> <span m="2934500">instructions</span> <span m="2934985">executed,</span> <span m="2935470">so</span> <span m="2935970">that</span> <span m="2936360">removed</span> <span m="2936520">a</span> <span m="2936570">lot</span> <span m="2936980">of</span> <span m="2937390">the</span> <span m="2937650">manual</span> <span m="2937930">effort</span> <span m="2938235">that</span> <span m="2938540">you as a developer</span> <span m="2938740">have</span> <span m="2939085">to do</span> <span m="2939430">to</span> <span m="2939884">sort of understand</span> <span m="2940338">it's the</span> <span m="2940792">taint</span> <span m="2941246">semantics</span> <span m="2941700">if you use</span> <span m="2942154">native methods.</span> <span m="2942610">But</span> <span m="2942800">the</span> <span m="2942880">problem</span> <span m="2943175">with</span> <span m="2943470">that,</span> <span m="2944170">if we</span> <span m="2944790">track</span> <span m="2945055">at</span> <span m="2945320">this low</span> <span m="2945480">level,</span> <span m="2947210">it</span> <span m="2947560">can be</span> <span m="2947920">very</span> <span m="2948270">expensive</span> <span m="2949106">to</span> <span m="2949592">do</span> <span m="2950078">this.</span> <span m="2951540">You can</span> <span m="2951830">also</span> <span m="2952240">get</span> <span m="2952920">a</span> <span m="2952970">lot</span> <span m="2954430">of</span> <span m="2954510">false</span> <span m="2954945">positives.</span> <span m="2957460">So if</span> <span m="2957670">they're</span> <span m="2957940">spec'd</span> <span m="2958220">to the</span> <span m="2958686">expense,</span> <span m="2960160">there's</span> <span m="2960300">also</span> <span m="2961451">this</span> <span m="2961912">issue</span> <span m="2962834">of</span> <span m="2963756">correctness.</span> </p>
<p><span m="2966750">As you may</span> <span m="2967224">know,</span> <span m="2967698">x86</span> <span m="2968646">is</span> <span m="2969120">an adversarially</span> <span m="2970070">complex</span> <span m="2971050">instruction</span> <span m="2971620">set.</span> <span m="2972690">There's</span> <span m="2972900">all</span> <span m="2973180">kinds</span> <span m="2973380">of</span> <span m="2973470">crazy</span> <span m="2973800">things</span> <span m="2974143">that it</span> <span m="2974486">can do.</span> <span m="2974830">I don't know</span> <span m="2975110">if you've ever</span> <span m="2975360">seen</span> <span m="2975950">an x86</span> <span m="2977040">instruction</span> <span m="2977340">manual,</span> <span m="2978540">they're</span> <span m="2978700">huge.</span> <span m="2979810">So</span> <span m="2980020">they'll</span> <span m="2980330">have</span> <span m="2980710">one</span> <span m="2980850">huge</span> <span m="2981230">manual</span> <span m="2981610">that's</span> <span m="2981990">this thick,</span> <span m="2982730">and then it'll</span> <span m="2982950">say</span> <span m="2983320">this</span> <span m="2983790">is</span> <span m="2984276">instructions</span> <span m="2984762">whose</span> <span m="2985250">letters</span> <span m="2985710">start</span> <span m="2985960">with</span> <span m="2986270">M</span> <span m="2986580">through</span> <span m="2986790">P,</span> <span m="2987110">and there'll</span> <span m="2987580">be this</span> <span m="2987750">full on</span> <span m="2987970">series</span> <span m="2988435">about</span> <span m="2988900">that.</span> <span m="2990172">So</span> <span m="2990596">it's</span> <span m="2991020">actually</span> <span m="2991365">pretty</span> <span m="2991710">tricky</span> <span m="2991930">to think</span> <span m="2992270">about</span> <span m="2992610">what</span> <span m="2992955">it</span> <span m="2993300">means to</span> <span m="2993420">actually</span> <span m="2993730">track</span> <span m="2994040">taint</span> <span m="2994295">at</span> <span m="2994550">the level</span> <span m="2994850">of x86</span> <span m="2996140">instruction.</span> <span m="2997130">Because</span> <span m="2997625">even</span> <span m="2998120">seemingly</span> <span m="2998615">simple</span> <span m="2999110">instructions,</span> <span m="2999605">like</span> <span m="3000100">sometimes</span> <span m="3000595">at,</span> <span m="3001090">they're</span> <span m="3001585">setting</span> <span m="3002080">all types</span> <span m="3002575">of</span> <span m="3003070">internal processor</span> <span m="3003565">registers</span> <span m="3004060">and</span> <span m="3004570">flags</span> <span m="3005010">and</span> <span m="3005140">things</span> <span m="3005370">like</span> <span m="3005560">that.</span> <span m="3005840">So it's</span> <span m="3006120">very</span> <span m="3006310">difficult</span> <span m="3006720">to</span> <span m="3006920">describe</span> <span m="3007410">in the</span> <span m="3007800">first</span> <span m="3008100">place.</span> </p>
<p><span m="3008400">If you</span> <span m="3008870">could</span> <span m="3009340">do that,</span> <span m="3009810">it's</span> <span m="3010010">also</span> <span m="3010340">oftentimes</span> <span m="3010880">very</span> <span m="3011490">expensive.</span> <span m="3012220">You're</span> <span m="3012350">sort</span> <span m="3012470">of</span> <span m="3013661">looking at</span> <span m="3014142">things</span> <span m="3014623">at</span> <span m="3015104">a</span> <span m="3015585">very, very</span> <span m="3016066">low level.</span> <span m="3016547">So</span> <span m="3017028">the amount of state</span> <span m="3017509">you have</span> <span m="3017990">to track might</span> <span m="3018471">get very large</span> <span m="3018952">very quickly.</span> <span m="3019914">It</span> <span m="3020395">might be</span> <span m="3020876">a very</span> <span m="3021360">sensitive</span> <span m="3021850">computational</span> <span m="3022340">clause.</span> <span m="3022710">Then there's this</span> <span m="3023070">issue</span> <span m="3023450">of</span> <span m="3023660">false positives.</span> <span m="3025090">This</span> <span m="3025270">is</span> <span m="3025370">actually</span> <span m="3026410">pretty</span> <span m="3027600">devastating.</span> <span m="3029180">You</span> <span m="3029675">can</span> <span m="3030170">get</span> <span m="3030530">into</span> <span m="3030630">bad</span> <span m="3031050">problems</span> <span m="3032346">if</span> <span m="3032792">you</span> <span m="3033238">ever</span> <span m="3034576">have</span> <span m="3035920">kernel</span> <span m="3036380">data</span> <span m="3039700">that</span> <span m="3040190">improperly</span> <span m="3041930">gets</span> <span m="3042230">tainted.</span> <span m="3047719">And if</span> <span m="3048218">this happens,</span> <span m="3050360">maybe</span> <span m="3050880">because</span> <span m="3051320">your</span> <span m="3052020">infrastructure's</span> <span m="3052960">trying</span> <span m="3053300">to</span> <span m="3053360">be</span> <span m="3053930">ultraconservative,</span> <span m="3055150">it</span> <span m="3055590">doesn't want</span> <span m="3056070">to miss</span> <span m="3056420">anything,</span> <span m="3056660">so it</span> <span m="3056760">says</span> <span m="3057170">well,</span> <span m="3057450">I'm going</span> <span m="3057730">to err</span> <span m="3058130">on the side</span> <span m="3058530">of</span> <span m="3058620">security.</span> <span m="3059480">And</span> <span m="3059945">I'm</span> <span m="3060410">going to</span> <span m="3060875">taint</span> <span m="3061340">some of this</span> <span m="3061805">kernel data</span> <span m="3062270">structure,</span> <span m="3062740">then what</span> <span m="3063060">you</span> <span m="3064260">get here</span> <span m="3065890">is this</span> <span m="3066530">exciting</span> <span m="3066850">term</span> <span m="3067170">they</span> <span m="3067470">call</span> <span m="3067770">taint</span> <span m="3068610">explosion.</span> </p>
<p><span m="3069190">What</span> <span m="3069350">this</span> <span m="3069830">basically</span> <span m="3070100">means</span> <span m="3070370">is that</span> <span m="3070980">at</span> <span m="3071090">a</span> <span m="3071150">certain</span> <span m="3071500">point,</span> <span m="3071730">there are</span> <span m="3071890">certain things</span> <span m="3072350">that</span> <span m="3072796">if they end</span> <span m="3073242">up getting</span> <span m="3073690">tainted,</span> <span m="3073780">they're involved</span> <span m="3074300">in</span> <span m="3074370">so</span> <span m="3074700">many</span> <span m="3074900">calculations</span> <span m="3075400">that</span> <span m="3075900">essentially</span> <span m="3076760">everything</span> <span m="3077260">in</span> <span m="3077300">your</span> <span m="3077510">program</span> <span m="3077910">gets</span> <span m="3078235">polluted.</span> <span m="3078810">It's</span> <span m="3079010">like</span> <span m="3079190">one of</span> <span m="3079230">these</span> <span m="3079440">things</span> <span m="3079710">in</span> <span m="3079900">Dungeons</span> <span m="3080390">and Dragons</span> <span m="3080550">where</span> <span m="3080933">you touch</span> <span m="3081316">this evil</span> <span m="3081700">thing and</span> <span m="3082095">eventually</span> <span m="3082900">death</span> <span m="3083190">spreads</span> <span m="3083480">throughout</span> <span m="3083870">your body.</span> </p>
<p><span m="3086395">This</span> <span m="3086820">is very bad,</span> <span m="3087790">because</span> <span m="3088250">if</span> <span m="3088708">you can't</span> <span m="3089166">tightly</span> <span m="3089624">constrain</span> <span m="3090082">the</span> <span m="3090540">way that</span> <span m="3090910">taint flows</span> <span m="3091280">through the</span> <span m="3091710">system,</span> <span m="3092140">then</span> <span m="3092614">eventually</span> <span m="3093088">what's</span> <span m="3093562">going to end</span> <span m="3094036">up happening</span> <span m="3094510">is that you let this run for a while,</span> <span m="3094984">the</span> <span m="3095458">system's</span> <span m="3095932">going to say</span> <span m="3096406">you can't do anything.</span> <span m="3096880">You</span> <span m="3097354">can't</span> <span m="3097828">send anything</span> <span m="3098302">over</span> <span m="3098776">the network,</span> <span m="3099250">you can't</span> <span m="3099724">display anything</span> <span m="3100198">on the screen,</span> <span m="3100672">because</span> <span m="3101160">everything</span> <span m="3101580">in</span> <span m="3101790">your</span> <span m="3102090">system seems</span> <span m="3102450">like</span> <span m="3102830">it's</span> <span m="3103010">been</span> <span m="3103300">tainted</span> <span m="3103675">by some</span> <span m="3104050">sensitive error,</span> <span m="3104700">even</span> <span m="3104970">if  that's not</span> <span m="3105410">the case.</span> </p>
<p><span m="3107350">One</span> <span m="3107610">way</span> <span m="3107860">that</span> <span m="3109190">this</span> <span m="3109933">can</span> <span m="3110396">happen</span> <span m="3110860">is</span> <span m="3111590">if</span> <span m="3111800">somehow</span> <span m="3113980">the</span> <span m="3114380">stack</span> <span m="3114600">pointer</span> <span m="3115640">or</span> <span m="3116400">the</span> <span m="3117038">break</span> <span m="3117456">pointer</span> <span m="3119130">get</span> <span m="3119370">tainted.</span> <span m="3123780">If</span> <span m="3124100">this happens,</span> <span m="3124320">you're</span> <span m="3124500">probably</span> <span m="3124970">in a</span> <span m="3125460">world of hurt.</span> <span m="3126819">You can</span> <span m="3127272">imagine</span> <span m="3127725">that all</span> <span m="3128178">of the instructions</span> <span m="3128631">in x86,</span> <span m="3129540">for</span> <span m="3129630">example,</span> <span m="3130120">that</span> <span m="3130830">access</span> <span m="3131420">the stack,</span> <span m="3131930">they all</span> <span m="3132530">go through</span> <span m="3134180">ESB.</span> <span m="3135100">So</span> <span m="3135360">the</span> <span m="3135490">stack</span> <span m="3135875">register</span> <span m="3136260">gets</span> <span m="3136790">corrupted</span> <span m="3137060">somehow,</span> <span m="3137700">that's</span> <span m="3138045">bad.</span> <span m="3139130">If the</span> <span m="3139500">break point</span> <span m="3139835">register</span> <span m="3140170">gets</span> <span m="3140420">bad,</span> <span m="3140910">a</span> <span m="3140960">lot</span> <span m="3141280">of</span> <span m="3141740">times</span> <span m="3142670">when</span> <span m="3143050">you want</span> <span m="3143380">your equivalents</span> <span m="3143730">to access</span> <span m="3144065">local</span> <span m="3144400">variables,</span> <span m="3144970">it</span> <span m="3145210">has</span> <span m="3145380">to</span> <span m="3145550">go</span> <span m="3146350">the</span> <span m="3146822">EBP</span> <span m="3147294">indirectly.</span> <span m="3148238">So</span> <span m="3148710">if anybody</span> <span m="3149182">ever</span> <span m="3149654">touches</span> <span m="3150126">those in terms</span> <span m="3150598">of taint,</span> <span m="3151070">it's basically</span> <span m="3151542">game over.</span> <span m="3152486">So</span> <span m="3152958">there's</span> <span m="3153430">a link in the lecture</span> <span m="3153705">that's</span> <span m="3153980">about a paper</span> <span m="3154420">that</span> <span m="3154860">acknowledges</span> <span m="3155145">some of this</span> <span m="3155430">stuff</span> <span m="3155765">and</span> <span m="3156100">basically</span> <span m="3156500">says</span> <span m="3156790">that we have</span> <span m="3157290">to be very careful</span> <span m="3158290">when</span> <span m="3158790">we</span> <span m="3159290">do taint</span> <span m="3159790">tracking</span> <span m="3160290">at this low level</span> <span m="3160790">because</span> <span m="3161290">very</span> <span m="3161790">quickly,</span> <span m="3162270">if you're</span> <span m="3162750">looking at how</span> <span m="3163230">this works in the Linux</span> <span m="3163710">kernel,</span> <span m="3164190">there are</span> <span m="3164670">certain</span> <span m="3165150">optimizations</span> <span m="3165630">the Linux kernel</span> <span m="3166110">would do to</span> <span m="3166590">make its</span> <span m="3167070">code fast,</span> <span m="3167550">but</span> <span m="3167720">will</span> <span m="3168110">result,</span> <span m="3168570">unintentionally,</span> <span m="3169054">in</span> <span m="3169538">the break</span> <span m="3170022">pointer or</span> <span m="3170506">the stack pointer</span> <span m="3170990">getting</span> <span m="3171474">tainted.</span> <span m="3171960">And</span> <span m="3172100">once</span> <span m="3172260">that</span> <span m="3172400">happens,</span> <span m="3173333">you can't</span> <span m="3173806">really do</span> <span m="3174279">anything</span> <span m="3174752">useful</span> <span m="3175225">with the taint tracking system.</span> </p>
<p><span m="3175698">AUDIENCE:</span> <span m="3176171">So how do you</span> <span m="3176644">do this</span> <span m="3177117">[INAUDIBLE]</span> <span m="3179960">programs?</span> <span m="3181316">It seems like you have</span> <span m="3181672">all</span> <span m="3182030">these</span> <span m="3182448">register</span> <span m="3182866">files</span> <span m="3183284">in the CPU.</span> </p>
<p><span m="3184120">PROFESSOR:</span> <span m="3184540">Yeah,</span> <span m="3184990">so</span> <span m="3185180">great.</span> <span m="3186210">So</span> <span m="3186410">all</span> <span m="3186825">those</span> <span m="3187240">register</span> <span m="3187644">files,</span> <span m="3188048">it hangs back</span> <span m="3188452">to the correctness case.</span> <span m="3189260">So</span> <span m="3189520">unless</span> <span m="3189810">you</span> <span m="3189990">are</span> <span m="3190140">very,</span> <span m="3190410">very</span> <span m="3190886">good</span> <span m="3191362">at understanding</span> <span m="3191838">x86</span> <span m="3192314">architecture,</span> <span m="3192790">there</span> <span m="3193266">are going to be</span> <span m="3193742">things that you miss.</span> <span m="3194694">It terms of</span> <span m="3195170">computation</span> <span m="3195646">level,</span> <span m="3196122">how</span> <span m="3196598">do you</span> <span m="3197074">actually</span> <span m="3197550">do this thing.</span> <span m="3198260">There's</span> <span m="3198520">this--</span> <span m="3200010">I</span> <span m="3200090">think</span> <span m="3200510">the</span> <span m="3200630">most</span> <span m="3200890">popular</span> <span m="3201330">way,</span> <span m="3202430">and I</span> <span m="3202550">could be</span> <span m="3202780">wrong about</span> <span m="3203190">this.</span> <span m="3203640">So when</span> <span m="3203880">I say it's</span> <span m="3204338">popular,</span> <span m="3204796">the way</span> <span m="3205254">I know about,</span> <span m="3205712">because I'm a knowledge</span> <span m="3206170">[INAUDIBLE],</span> <span m="3206628">right.</span> <span m="3208010">There's</span> <span m="3208360">this</span> <span m="3208460">system</span> <span m="3208580">submitter</span> <span m="3208840">called</span> <span m="3209100">Bochs,</span> <span m="3211050">I think</span> <span m="3211465">it's</span> <span m="3211880">spelled</span> <span m="3212205">like</span> <span m="3215190">this.</span> <span m="3215850">They</span> <span m="3216250">actually have</span> <span m="3216420">something</span> <span m="3216730">called</span> <span m="3217010">TaintBochs,</span> <span m="3218360">which</span> <span m="3218620">actually</span> <span m="3219280">does</span> <span m="3220090">x86</span> <span m="3220950">level</span> <span m="3222150">innuation</span> <span m="3222645">of</span> <span m="3223140">flow.</span> </p>
<p><span m="3223600">And</span> <span m="3223970">it's</span> <span m="3224180">actually</span> <span m="3224605">an</span> <span m="3225030">interpreter,</span> <span m="3225390">you can</span> <span m="3225750">think</span> <span m="3226110">of it as.</span> <span m="3227840">So</span> <span m="3228100">it's</span> <span m="3228210">going</span> <span m="3228480">to</span> <span m="3228800">take</span> <span m="3229100">your</span> <span m="3229290">entire</span> <span m="3229450">OS</span> <span m="3229880">and all your</span> <span m="3230310">applications,</span> <span m="3231050">and</span> <span m="3231425">it's</span> <span m="3231800">going</span> <span m="3231970">to look at each</span> <span m="3232210">x86</span> <span m="3232450">instruction</span> <span m="3232800">and</span> <span m="3233525">try</span> <span m="3233900">to</span> <span m="3233990">simulate</span> <span m="3235450">what</span> <span m="3235710">the hardware</span> <span m="3235970">would</span> <span m="3236230">do.</span> <span m="3237230">So you</span> <span m="3237730">can imagine</span> <span m="3238230">this is very,</span> <span m="3238640">very slow.</span> <span m="3239090">What's</span> <span m="3239360">nice</span> <span m="3239590">about</span> <span m="3239800">that</span> <span m="3240000">is you</span> <span m="3240260">don't</span> <span m="3240650">require any hardware</span> <span m="3240940">support,</span> <span m="3241660">and</span> <span m="3241995">then</span> <span m="3242330">it's</span> <span m="3242620">relatively</span> <span m="3242910">straightforward</span> <span m="3243290">to</span> <span m="3244274">tweak</span> <span m="3245258">your</span> <span m="3245750">software model</span> <span m="3246242">of how things</span> <span m="3246734">work,</span> <span m="3247226">if you discovered</span> <span m="3247718">that you weren't</span> <span m="3248210">tracking some</span> <span m="3248702">registered files</span> <span m="3249194">or something like that.</span> </p>
<p><span m="3249686">AUDIENCE:</span> <span m="3250178">So</span> <span m="3250670">the ideal</span> <span m="3251162">solution</span> <span m="3251654">would be</span> <span m="3252146">architectural</span> <span m="3252638">support.</span> </p>
<p><span m="3254114">PROFESSOR:</span> <span m="3254620">Yeah,</span> <span m="3254935">so</span> <span m="3255250">there have</span> <span m="3255590">been techniques</span> <span m="3255840">to do that,</span> <span m="3256225">too.</span> <span m="3257240">That</span> <span m="3257650">gets</span> <span m="3257830">a</span> <span m="3257920">little</span> <span m="3258400">bit</span> <span m="3258710">subtle</span> <span m="3259575">because,</span> <span m="3260060">for</span> <span m="3260350">example,</span> <span m="3262560">if you look</span> <span m="3262790">here you've</span> <span m="3263180">looked</span> <span m="3263390">at</span> <span m="3263490">how</span> <span m="3263720">we've</span> <span m="3264010">allocated</span> <span m="3265295">the</span> <span m="3265790">taint</span> <span m="3266215">state</span> <span m="3266640">next</span> <span m="3267040">to</span> <span m="3267240">the variables themselves.</span> <span m="3268840">So</span> <span m="3269230">if</span> <span m="3269540">you bake in</span> <span m="3269850">that</span> <span m="3270050">support</span> <span m="3270860">in the</span> <span m="3271130">hardware,</span> <span m="3271610">it can be</span> <span m="3271760">very</span> <span m="3272100">difficult</span> <span m="3272505">to,</span> <span m="3272910">for</span> <span m="3273050">example,</span> <span m="3273880">change</span> <span m="3274210">the</span> <span m="3274540">way you</span> <span m="3274590">want</span> <span m="3274790">the</span> <span m="3274860">layout</span> <span m="3275290">to work.</span> <span m="3275920">Because</span> <span m="3276070">then it's</span> <span m="3276260">like</span> <span m="3276350">baked</span> <span m="3276780">into the silicon.</span> <span m="3277610">You</span> <span m="3277930">could</span> <span m="3278210">imagine</span> <span m="3278390">doing some</span> <span m="3278810">of this</span> <span m="3279230">because</span> <span m="3279440">at</span> <span m="3279825">a</span> <span m="3280210">high level--</span> <span m="3282258">where</span> <span m="3282694">do we have</span> <span m="3283130">it.</span> <span m="3283580">So</span> <span m="3283870">the</span> <span m="3284230">Dalvik</span> <span m="3285436">VM</span> <span m="3285838">and</span> <span m="3286039">TaintDroid</span> <span m="3286240">is</span> <span m="3287000">executing these</span> <span m="3287450">high level instructions</span> <span m="3288250">and it's</span> <span m="3288680">assigning</span> <span m="3289170">taint</span> <span m="3289210">at</span> <span m="3289520">this level.</span> <span m="3289960">You</span> <span m="3290355">can imagine</span> <span m="3290750">doing</span> <span m="3291200">that</span> <span m="3291500">at the hardware</span> <span m="3291800">level, too.</span> <span m="3292580">So</span> <span m="3292700">actually, if</span> <span m="3293070">this is the</span> <span m="3293340">silicon,</span> <span m="3293840">you can</span> <span m="3294340">probably make</span> <span m="3294840">that work.</span> <span m="3295340">So that's</span> <span m="3295840">definitely</span> <span m="3296340">possible.</span> <span m="3296840">You</span> <span m="3297340">had</span> <span m="3297840">a question?</span> </p>
<p><span m="3298340">AUDIENCE:</span> <span m="3298840">What does</span> <span m="3299340">TaintDroid</span> <span m="3299840">do</span> <span m="3300840">with</span> <span m="3301340">information</span> <span m="3301840">built</span> <span m="3302340">from</span> <span m="3302840">branching</span> <span m="3303340">and permission</span> <span m="3303840">tests.</span> </p>
<p><span m="3304340">PROFESSOR: Oh,</span> <span m="3304750">we're</span> <span m="3304850">going to</span> <span m="3305263">get to that</span> <span m="3305676">in a second.</span> <span m="3306090">So just</span> <span m="3306220">hold</span> <span m="3306700">that thought,</span> <span m="3307186">we're going to get</span> <span m="3307672">to that.</span> </p>
<p><span m="3308158">AUDIENCE:</span> <span m="3308644">I'm curious,</span> <span m="3309616">how</span> <span m="3310102">long was it</span> <span m="3310588">to</span> <span m="3311074">things</span> <span m="3311560">like</span> <span m="3312046">buffer overflow</span> <span m="3312532">because</span> <span m="3313018">all the</span> <span m="3313504">things are</span> <span m="3313990">so nested together</span> <span m="3314476">[INAUDIBLE]?</span> </p>
<p><span m="3318850">PROFESSOR:</span> <span m="3319340">That's</span> <span m="3319820">a good</span> <span m="3319920">question.</span> <span m="3320340">So</span> <span m="3320660">presumably,</span> <span m="3321436">one</span> <span m="3321892">would</span> <span m="3322348">hope</span> <span m="3322804">that</span> <span m="3323260">in</span> <span m="3323720">a language</span> <span m="3324125">like Java</span> <span m="3324530">there</span> <span m="3325014">are</span> <span m="3325498">no buffer overflow,</span> <span m="3325982">right.</span> <span m="3326950">But</span> <span m="3327434">you</span> <span m="3327920">can</span> <span m="3328290">imagine</span> <span m="3328660">in a language</span> <span m="3329020">like C,</span> <span m="3329436">for</span> <span m="3329852">example,</span> <span m="3330270">where you didn't have</span> <span m="3330570">this protection,</span> <span m="3331700">maybe there's</span> <span m="3331850">something</span> <span m="3332060">catastrophic</span> <span m="3332415">that</span> <span m="3332770">could</span> <span m="3332880">happen</span> <span m="3333180">or</span> <span m="3333330">somehow,</span> <span m="3334240">if</span> <span m="3334460">you did</span> <span m="3334630">a</span> <span m="3334690">buffer</span> <span m="3335070">overflow</span> <span m="3336000">and</span> <span m="3336320">then you were</span> <span m="3336510">able</span> <span m="3336700">to</span> <span m="3336860">overwrite</span> <span m="3337350">taint</span> <span m="3337610">tags</span> <span m="3337880">and</span> <span m="3338150">you</span> <span m="3338420">could set</span> <span m="3338620">this</span> <span m="3338820">to</span> <span m="3339050">zeros,</span> <span m="3340670">then</span> <span m="3340910">you</span> <span m="3341060">could just</span> <span m="3341260">let</span> <span m="3341390">your</span> <span m="3341480">data</span> <span m="3341790">exfiltrate.</span> </p>
<p><span m="3342280">AUDIENCE:</span> <span m="3342766">I think</span> <span m="3343252">if it's</span> <span m="3343738">super</span> <span m="3344224">predictable,</span> <span m="3345196">like one</span> <span m="3345682">every other</span> <span m="3346168">one for</span> <span m="3346775">the</span> <span m="3346897">next</span> <span m="3347018">q</span> <span m="3347140">variables,</span> <span m="3347626">there's no</span> <span m="3348112">stacking--</span> </p>
<p><span m="3349084">PROFESSOR:</span> <span m="3349580">I was</span> <span m="3349900">going to say,</span> <span m="3350130">that's</span> <span m="3350602">exactly</span> <span m="3351074">right.</span> <span m="3351546">So you</span> <span m="3352018">run into</span> <span m="3352490">somewhat similar issues</span> <span m="3352550">like</span> <span m="3352860">what we can</span> <span m="3353310">discuss</span> <span m="3353680">with</span> <span m="3353910">the stack</span> <span m="3354315">canaries,</span> <span m="3354720">because</span> <span m="3355100">basically</span> <span m="3355530">we have</span> <span m="3355810">this</span> <span m="3356300">data</span> <span m="3356555">on</span> <span m="3356810">the stack,</span> <span m="3357520">like</span> <span m="3357970">in this</span> <span m="3358060">particular</span> <span m="3358190">layout,</span> <span m="3358640">that</span> <span m="3358820">you</span> <span m="3359470">don't</span> <span m="3359970">neither</span> <span m="3360370">want to</span> <span m="3360590">make</span> <span m="3360855">it</span> <span m="3361120">impossible</span> <span m="3361650">to</span> <span m="3361740">overwrite,</span> <span m="3362720">or</span> <span m="3363080">if</span> <span m="3363300">it is</span> <span m="3363770">overwritten,</span> <span m="3363970">one</span> <span m="3364100">that's</span> <span m="3364215">hacked</span> <span m="3364330">in some way.</span> <span m="3365400">So</span> <span m="3365720">you're</span> <span m="3365880">exactly</span> <span m="3366320">right</span> <span m="3366792">about that.</span> </p>
<p><span m="3372120">So</span> <span m="3372450">you</span> <span m="3372730">can</span> <span m="3373110">in fact</span> <span m="3373530">do</span> <span m="3374270">taint</span> <span m="3374700">tracking</span> <span m="3375130">at this</span> <span m="3375650">low</span> <span m="3376055">level</span> <span m="3376460">although</span> <span m="3376855">it may be</span> <span m="3377250">expensive</span> <span m="3377450">and a</span> <span m="3377770">little</span> <span m="3377930">bit</span> <span m="3378030">difficult</span> <span m="3378360">to</span> <span m="3378400">get</span> <span m="3378560">right.</span> <span m="3379700">So</span> <span m="3379870">you</span> <span m="3379960">might</span> <span m="3380180">say</span> <span m="3380360">well,</span> <span m="3380720">why</span> <span m="3380900">don't</span> <span m="3381070">we</span> <span m="3381300">just</span> <span m="3381710">punt</span> <span m="3381980">on this whole</span> <span m="3382240">issue of taint</span> <span m="3382500">tracking</span> <span m="3382800">in the</span> <span m="3383100">first</span> <span m="3383370">place</span> <span m="3383810">and</span> <span m="3384130">instead</span> <span m="3384830">we're</span> <span m="3384950">just</span> <span m="3385150">going</span> <span m="3385350">to</span> <span m="3385620">look</span> <span m="3385880">at the</span> <span m="3386210">things</span> <span m="3386870">that</span> <span m="3386990">the</span> <span m="3387070">program</span> <span m="3387530">tries</span> <span m="3387800">to output</span> <span m="3388100">over</span> <span m="3388485">the network, let's</span> <span m="3388870">say,</span> <span m="3389450">and just</span> <span m="3389660">do</span> <span m="3389880">a scan</span> <span m="3390170">for</span> <span m="3390535">data</span> <span m="3390900">that seems</span> <span m="3391100">sensitive.</span> <span m="3392290">That</span> <span m="3392550">seems to</span> <span m="3392895">be much</span> <span m="3393240">more</span> <span m="3393430">lightweight,</span> <span m="3394150">you</span> <span m="3394340">don't have</span> <span m="3394690">to do</span> <span m="3395060">this</span> <span m="3395430">dynamic</span> <span m="3395800">instrumentation</span> <span m="3396890">of</span> <span m="3397030">all</span> <span m="3397240">the things</span> <span m="3397550">the program's</span> <span m="3397950">doing.</span> </p>
<p><span m="3399240">The</span> <span m="3399360">problem</span> <span m="3399760">with that,</span> <span m="3400130">though,</span> <span m="3400340">is</span> <span m="3400730">that</span> <span m="3401100">that will</span> <span m="3401490">only work</span> <span m="3401710">as</span> <span m="3402090">a heuristic.</span> <span m="3403210">In</span> <span m="3403450">fact,</span> <span m="3403900">if the</span> <span m="3404010">attacker</span> <span m="3404500">knows</span> <span m="3404850">that this</span> <span m="3405070">is</span> <span m="3405520">what you're</span> <span m="3405890">doing,</span> <span m="3406100">then it's pretty</span> <span m="3406450">easy</span> <span m="3406720">to</span> <span m="3406800">subvert</span> <span m="3406930">that.</span> <span m="3408100">So</span> <span m="3408310">if you're</span> <span m="3408720">just sitting</span> <span m="3408950">there</span> <span m="3409250">and</span> <span m="3409520">you're</span> <span m="3409620">trying</span> <span m="3409790">to</span> <span m="3409890">do</span> <span m="3410090">a</span> <span m="3410430">grep</span> <span m="3410870">for</span> <span m="3411330">numbers,</span> <span m="3411890">Social</span> <span m="3412250">Security</span> <span m="3413320">numbers,</span> <span m="3413940">then</span> <span m="3414020">the</span> <span m="3414110">attacker</span> <span m="3414375">can</span> <span m="3414640">just</span> <span m="3415060">use</span> <span m="3415640">base</span> <span m="3415920">64</span> <span m="3416200">encoding,</span> <span m="3417030">or</span> <span m="3417470">do some other</span> <span m="3417910">wacky thing,</span> <span m="3418350">compress</span> <span m="3418630">it.</span> <span m="3419190">It's actually</span> <span m="3419360">trivial</span> <span m="3419770">to get</span> <span m="3419980">past</span> <span m="3420310">that</span> <span m="3420640">type of</span> <span m="3421135">filter.</span> <span m="3421630">So</span> <span m="3421850">in practice,</span> <span m="3422430">that's</span> <span m="3422750">completely</span> <span m="3423360">insufficient</span> <span m="3424148">from</span> <span m="3424596">the</span> <span m="3425044">security</span> <span m="3425492">perspective.</span> </p>
<p><span m="3426060">Now</span> <span m="3426530">let's get back</span> <span m="3426760">to</span> <span m="3426890">the</span> <span m="3427310">question</span> <span m="3427650">that</span> <span m="3428210">you</span> <span m="3428280">brought</span> <span m="3428590">up,</span> <span m="3429310">which</span> <span m="3429760">was</span> <span m="3430410">basically</span> <span m="3431650">how</span> <span m="3432520">can we</span> <span m="3432830">track</span> <span m="3434570">flows</span> <span m="3435150">through</span> <span m="3435560">things like</span> <span m="3435970">branches,</span> <span m="3436380">for</span> <span m="3436680">example.</span> <span m="3437290">So</span> <span m="3438540">this</span> <span m="3438750">is</span> <span m="3438900">basically</span> <span m="3439600">going</span> <span m="3439820">to</span> <span m="3440140">lead us to</span> <span m="3440400">a</span> <span m="3440660">topic</span> <span m="3442394">that's</span> <span m="3442846">called</span> <span m="3444490">implicit</span> <span m="3445030">flows.</span> <span m="3447450">And</span> <span m="3447650">so</span> <span m="3448290">an</span> <span m="3448400">implicit</span> <span m="3448600">flow</span> <span m="3449060">occurs</span> <span m="3449280">typically</span> <span m="3449900">when</span> <span m="3450620">you</span> <span m="3450830">have</span> <span m="3451050">a</span> <span m="3451190">tainted</span> <span m="3451580">value</span> <span m="3452330">that's</span> <span m="3452540">going</span> <span m="3452760">to</span> <span m="3452930">affect</span> <span m="3453710">the</span> <span m="3453770">way</span> <span m="3454560">that</span> <span m="3456170">another</span> <span m="3456450">variable</span> <span m="3457360">is</span> <span m="3457580">assigned,</span> <span m="3458560">even</span> <span m="3458870">though</span> <span m="3459450">that</span> <span m="3460940">implicit flow</span> <span m="3461250">variable</span> <span m="3461870">doesn't</span> <span m="3462230">directly</span> <span m="3462730">assign</span> <span m="3463100">variables.</span> <span m="3463530">This will</span> <span m="3463650">make</span> <span m="3464150">more</span> <span m="3464320">sense</span> <span m="3464560">with</span> <span m="3464860">a</span> <span m="3464940">concrete</span> <span m="3465260">example.</span> </p>
<p><span m="3466470">Let's</span> <span m="3466740">say</span> <span m="3466920">that you</span> <span m="3467300">have</span> <span m="3470030">an</span> <span m="3470480">if</span> <span m="3470680">statement</span> <span m="3471110">that</span> <span m="3471390">does</span> <span m="3471520">something</span> <span m="3471980">like,</span> <span m="3472470">it's going to</span> <span m="3472660">look</span> <span m="3472910">at</span> <span m="3473030">your</span> <span m="3473610">INEI</span> <span m="3474130">and</span> <span m="3474510">it's</span> <span m="3474730">going to</span> <span m="3474900">say</span> <span m="3475230">if it's</span> <span m="3476270">greater</span> <span m="3476580">than</span> <span m="3476870">42,</span> <span m="3478110">maybe</span> <span m="3478210">I'm going</span> <span m="3478510">to</span> <span m="3478890">assign</span> <span m="3480590">0</span> <span m="3480970">to</span> <span m="3481070">x.</span> <span m="3483340">Otherwise</span> <span m="3484790">I'm</span> <span m="3484930">going</span> <span m="3485270">to</span> <span m="3485970">assign</span> <span m="3486440">1.</span> <span m="3488350">So</span> <span m="3488880">what's</span> <span m="3489060">interesting</span> <span m="3489570">here</span> <span m="3489970">is</span> <span m="3490140">that</span> <span m="3491310">we're</span> <span m="3491430">looking</span> <span m="3491880">at</span> <span m="3492040">this</span> <span m="3492480">sensitive</span> <span m="3492640">data</span> <span m="3492940">here</span> <span m="3494240">and we're</span> <span m="3494540">doing</span> <span m="3495330">some</span> <span m="3495640">comparison</span> <span m="3496370">of it up</span> <span m="3496720">here,</span> <span m="3496960">but</span> <span m="3497220">when</span> <span m="3497500">we're</span> <span m="3497640">assigning</span> <span m="3498130">to</span> <span m="3498290">x</span> <span m="3498575">down</span> <span m="3498860">here,</span> <span m="3499610">we're</span> <span m="3499740">not</span> <span m="3499950">actually</span> <span m="3500340">assigning</span> <span m="3500680">something</span> <span m="3501470">that</span> <span m="3502610">is</span> <span m="3502910">directly</span> <span m="3503600">derived</span> <span m="3504600">from the</span> <span m="3504970">sensitive</span> <span m="3505340">data here.</span> <span m="3506940">This</span> <span m="3507090">is</span> <span m="3507240">an</span> <span m="3507450">example</span> <span m="3508150">of</span> <span m="3508290">one</span> <span m="3508660">of</span> <span m="3508920">these implicit flows.</span> <span m="3509200">Because</span> <span m="3509460">the</span> <span m="3509530">value</span> <span m="3510040">of</span> <span m="3510190">x</span> <span m="3510500">is</span> <span m="3510690">actually</span> <span m="3511070">dependent</span> <span m="3511950">on</span> <span m="3512160">this</span> <span m="3512270">thing</span> <span m="3512570">here,</span> <span m="3513170">but</span> <span m="3513800">the adversary,</span> <span m="3515150">if they're</span> <span m="3515590">clever,</span> <span m="3515680">can sort of</span> <span m="3515770">structure</span> <span m="3516040">their</span> <span m="3516310">code</span> <span m="3516500">in a</span> <span m="3516960">way</span> <span m="3517380">that there's</span> <span m="3517750">no</span> <span m="3518000">direct</span> <span m="3518285">assignment.</span> </p>
<p><span m="3519340">Now</span> <span m="3519590">note</span> <span m="3519720">that</span> <span m="3519910">even</span> <span m="3520170">here,</span> <span m="3520660">instead</span> <span m="3520820">of</span> <span m="3521000">just</span> <span m="3521230">assigning</span> <span m="3521515">to x,</span> <span m="3522590">you can just</span> <span m="3522980">say</span> <span m="3523520">let's</span> <span m="3523700">try to send</span> <span m="3523980">something</span> <span m="3524260">over</span> <span m="3524420">the</span> <span m="3524500">network.</span> <span m="3525190">You</span> <span m="3525360">might</span> <span m="3525560">say</span> <span m="3525720">over</span> <span m="3525840">the</span> <span m="3525910">network</span> <span m="3527610">x</span> <span m="3527870">is</span> <span m="3528030">0,</span> <span m="3528440">or</span> <span m="3528610">x</span> <span m="3528810">is</span> <span m="3528920">1,</span> <span m="3529180">or something</span> <span m="3529650">like that.</span> <span m="3530250">So that's</span> <span m="3530350">an</span> <span m="3530440">example</span> <span m="3530830">of</span> <span m="3531010">one of</span> <span m="3531110">these implicit</span> <span m="3531680">flows</span> <span m="3532380">that</span> <span m="3533860">a</span> <span m="3533990">system like</span> <span m="3534190">TaintDroid</span> <span m="3535330">cannot</span> <span m="3535660">actually</span> <span m="3536130">handle.</span> <span m="3537050">So</span> <span m="3537920">do</span> <span m="3538270">people</span> <span m="3538590">sort</span> <span m="3538730">of</span> <span m="3538790">see</span> <span m="3539050">the</span> <span m="3539420">problem</span> <span m="3539770">here</span> <span m="3540160">at</span> <span m="3540450">a</span> <span m="3540480">high</span> <span m="3540630">level?</span> <span m="3541250">Yes.</span> <span m="3541490">This</span> <span m="3541640">is</span> <span m="3541710">called an</span> <span m="3542000">explicit</span> <span m="3542530">flow</span> <span m="3542850">as</span> <span m="3543230">contrast</span> <span m="3543890">to</span> <span m="3544520">those</span> <span m="3544720">direct</span> <span m="3545180">flows</span> <span m="3545400">like</span> <span m="3546090">from the</span> <span m="3546170">assignment</span> <span m="3546600">operator.</span> </p>
<p><span m="3548042">AUDIENCE:</span> <span m="3548518">What</span> <span m="3548994">if</span> <span m="3549470">[INAUDIBLE]</span> <span m="3551850">a</span> <span m="3552802">native</span> <span m="3554535">power</span> <span m="3554840">function</span> <span m="3555339">that</span> <span m="3555838">did</span> <span m="3556337">exactly</span> <span m="3556836">[INAUDIBLE]?</span> <span m="3560735">Because</span> <span m="3561140">the output</span> <span m="3561636">in that</span> <span m="3562132">case</span> <span m="3562628">would be,</span> <span m="3563124">right?</span> </p>
<p><span m="3563620">PROFESSOR: Well,</span> <span m="3563940">let's</span> <span m="3564170">see.</span> <span m="3564480">So</span> <span m="3565110">it</span> <span m="3565592">depends.</span> <span m="3566074">So</span> <span m="3566556">if I</span> <span m="3567038">understand</span> <span m="3567520">your question correctly,</span> <span m="3568002">you're saying</span> <span m="3568484">there could</span> <span m="3568966">be some native function</span> <span m="3569448">that</span> <span m="3569930">does something</span> <span m="3570412">that's sort of</span> <span m="3570900">equivalent to this,</span> <span m="3571440">and</span> <span m="3571630">so</span> <span m="3571860">for example,</span> <span m="3572330">TaintDroid</span> <span m="3572720">wouldn't know</span> <span m="3573420">necessarily,</span> <span m="3574340">because</span> <span m="3574640">it</span> <span m="3574940">can't look inside</span> <span m="3575250">this native</span> <span m="3575570">code</span> <span m="3575890">to see</span> <span m="3576140">this</span> <span m="3576330">type</span> <span m="3576795">of thing.</span> <span m="3578627">The</span> <span m="3579094">way that the</span> <span m="3579561">authors</span> <span m="3580030">claim</span> <span m="3580450">that they would</span> <span m="3580870">handle that</span> <span m="3580980">is that</span> <span m="3581150">they</span> <span m="3581370">would</span> <span m="3581680">say</span> <span m="3581980">for</span> <span m="3582920">native</span> <span m="3583723">methods</span> <span m="3584066">that</span> <span m="3584410">are</span> <span m="3584600">defined by</span> <span m="3584950">the</span> <span m="3585086">VM</span> <span m="3585223">itself,</span> <span m="3585770">they</span> <span m="3585940">would look</span> <span m="3586380">at the</span> <span m="3586630">contract</span> <span m="3587380">that method</span> <span m="3587820">exposes</span> <span m="3588240">and</span> <span m="3588660">they might</span> <span m="3589140">say things like</span> <span m="3589620">I take</span> <span m="3590100">these</span> <span m="3590580">two</span> <span m="3591060">integers</span> <span m="3591540">and</span> <span m="3592020">then return</span> <span m="3592500">the average.</span> <span m="3592980">So</span> <span m="3593230">then</span> <span m="3593660">the</span> <span m="3593920">TaintDroid</span> <span m="3594440">system</span> <span m="3594700">would</span> <span m="3594960">say we</span> <span m="3595200">trust</span> <span m="3595460">that the</span> <span m="3595720">native</span> <span m="3596115">function</span> <span m="3596510">does</span> <span m="3596950">that,</span> <span m="3597120">so we need to</span> <span m="3597330">figure</span> <span m="3597630">out</span> <span m="3597940">what</span> <span m="3598160">the appropriate</span> <span m="3598560">tainting</span> <span m="3599005">policy</span> <span m="3599450">should</span> <span m="3599630">be.</span> </p>
<p><span m="3600380">However,</span> <span m="3600870">you</span> <span m="3601030">are</span> <span m="3601170">correct</span> <span m="3601810">that</span> <span m="3602120">if</span> <span m="3602490">something</span> <span m="3602770">like</span> <span m="3602950">this was</span> <span m="3603380">sort of hidden</span> <span m="3603570">inside</span> <span m="3604470">and</span> <span m="3604940">for</span> <span m="3605180">whatever</span> <span m="3605520">reason</span> <span m="3605640">wasn't</span> <span m="3605880">exposed</span> <span m="3606140">to the</span> <span m="3606400">public-facing</span> <span m="3606940">contract,</span> <span m="3607850">then</span> <span m="3610600">the</span> <span m="3611050">manual</span> <span m="3611280">policy</span> <span m="3611800">that</span> <span m="3612060">the TaintDroid</span> <span m="3612280">authors</span> <span m="3612570">came</span> <span m="3612860">up with</span> <span m="3613310">might</span> <span m="3613560">not catch</span> <span m="3614030">this</span> <span m="3614370">implicit</span> <span m="3614710">flow.</span> <span m="3615220">It</span> <span m="3615510">might actually</span> <span m="3615830">allow</span> <span m="3616220">information</span> <span m="3616700">to leak</span> <span m="3617130">out somehow.</span> <span m="3617960">But</span> <span m="3618160">I mean</span> <span m="3618340">for</span> <span m="3618750">that matter,</span> <span m="3618980">there</span> <span m="3619170">might</span> <span m="3619230">even be</span> <span m="3619505">a</span> <span m="3619780">direct</span> <span m="3620070">flow</span> <span m="3620562">in there that</span> <span m="3621054">the TaintDroid</span> <span m="3622038">authors</span> <span m="3623022">couldn't</span> <span m="3623514">see</span> <span m="3624006">and you might</span> <span m="3624498">still have</span> <span m="3624990">an even more</span> <span m="3625482">direct leak.</span> </p>
<p><span m="3626958">AUDIENCE:</span> <span m="3627450">So</span> <span m="3627942">in practice,</span> <span m="3628434">this</span> <span m="3628926">seems</span> <span m="3629418">very dangerous,</span> <span m="3629910">right?</span> <span m="3630402">Because</span> <span m="3630894">you can literally</span> <span m="3631386">send the whole</span> <span m="3631878">[INAUDIBLE]</span> <span m="3632370">value</span> <span m="3632862">by</span> <span m="3633354">just</span> <span m="3633846">looking</span> <span m="3634338">at this last</span> <span m="3634830">three--</span> </p>
<p><span m="3637782">PROFESSOR:</span> <span m="3638280">That's</span> <span m="3638500">right.</span> <span m="3638870">We had</span> <span m="3639145">class a few times where</span> <span m="3639420">you'd</span> <span m="3639780">sit in a</span> <span m="3639910">while</span> <span m="3640290">loop</span> <span m="3640780">and you'd</span> <span m="3641270">try to</span> <span m="3641600">construct these</span> <span m="3641930">implicit</span> <span m="3642354">flows to</span> <span m="3642778">do these</span> <span m="3643202">types of things.</span> <span m="3644050">There's</span> <span m="3644210">actually</span> <span m="3644540">some</span> <span m="3644810">ways</span> <span m="3645220">that</span> <span m="3645840">you</span> <span m="3645950">can</span> <span m="3646140">think</span> <span m="3646350">about</span> <span m="3646960">trying to fix</span> <span m="3647160">some</span> <span m="3647480">of this stuff.</span> <span m="3649390">At</span> <span m="3649630">a</span> <span m="3649700">high</span> <span m="3650050">level,</span> <span m="3650960">one</span> <span m="3651260">approach</span> <span m="3651650">you</span> <span m="3652142">can do to try</span> <span m="3652634">to prevent this</span> <span m="3653126">stuff</span> <span m="3653618">is you</span> <span m="3654110">can actually</span> <span m="3657640">assign</span> <span m="3658016">a</span> <span m="3659530">taint tag</span> <span m="3663100">to</span> <span m="3663210">the</span> <span m="3663410">PC.</span> <span m="3667390">Then</span> <span m="3667530">essentially</span> <span m="3668270">you</span> <span m="3670410">taint</span> <span m="3670760">it</span> <span m="3673060">with</span> <span m="3674370">the</span> <span m="3675380">branch</span> <span m="3675795">test.</span> <span m="3678690">So the idea</span> <span m="3679090">here</span> <span m="3679810">is</span> <span m="3679980">that</span> <span m="3681190">we as</span> <span m="3681900">humans can</span> <span m="3682120">look</span> <span m="3682620">at this</span> <span m="3682960">code</span> <span m="3683130">here</span> <span m="3683480">and</span> <span m="3683830">we</span> <span m="3683960">can tell</span> <span m="3684330">that there's</span> <span m="3684830">this</span> <span m="3684970">implicit</span> <span m="3685050">flow</span> <span m="3685380">here,</span> <span m="3685710">because</span> <span m="3686020">we</span> <span m="3686140">know</span> <span m="3686400">that</span> <span m="3686570">somehow</span> <span m="3687470">to</span> <span m="3687600">get</span> <span m="3687940">here,</span> <span m="3688470">we</span> <span m="3688640">had</span> <span m="3688980">to</span> <span m="3689300">look at</span> <span m="3689500">the</span> <span m="3689860">sensitive</span> <span m="3690280">data.</span> </p>
<p><span m="3690720">So</span> <span m="3691170">what does that mean</span> <span m="3691620">at the implementation</span> <span m="3692050">level?</span> <span m="3692480">That</span> <span m="3692910">means that to get here,</span> <span m="3693590">there's</span> <span m="3693850">something</span> <span m="3694200">about</span> <span m="3694440">the</span> <span m="3694550">PC</span> <span m="3695680">that</span> <span m="3695990">has</span> <span m="3696210">been</span> <span m="3696740">tainted</span> <span m="3697510">by</span> <span m="3697640">sensitive</span> <span m="3698180">data.</span> <span m="3699180">To</span> <span m="3699270">say</span> <span m="3699600">that we have</span> <span m="3699900">gotten</span> <span m="3700370">here is</span> <span m="3700710">to</span> <span m="3700880">say</span> <span m="3701010">the PC</span> <span m="3701220">has</span> <span m="3701470">been</span> <span m="3701700">set to</span> <span m="3701950">here</span> <span m="3702460">or</span> <span m="3702630">to here.</span> </p>
<p><span m="3703450">At</span> <span m="3704161">a</span> <span m="3704592">high level</span> <span m="3705023">we could</span> <span m="3705454">imagine</span> <span m="3705885">that</span> <span m="3706320">the</span> <span m="3706470">system</span> <span m="3707280">would</span> <span m="3708090">do</span> <span m="3708240">some</span> <span m="3708520">analysis</span> <span m="3708850">and</span> <span m="3709470">it would say</span> <span m="3709860">that</span> <span m="3710872">at</span> <span m="3711364">this point</span> <span m="3711856">in the code,</span> <span m="3712350">the</span> <span m="3712440">PC has</span> <span m="3713150">no</span> <span m="3713210">taint</span> <span m="3713450">at</span> <span m="3713530">all.</span> <span m="3714050">At</span> <span m="3714210">this</span> <span m="3714420">point,</span> <span m="3714900">it</span> <span m="3715190">gets</span> <span m="3715490">tainted</span> <span m="3715630">somehow</span> <span m="3716030">by</span> <span m="3716430">the</span> <span m="3716570">INEI,</span> <span m="3717180">and at</span> <span m="3717520">this</span> <span m="3717720">point</span> <span m="3718010">here,</span> <span m="3719940">it's</span> <span m="3720180">going</span> <span m="3720330">to</span> <span m="3720370">have</span> <span m="3720770">that</span> <span m="3721100">taint.</span> </p>
<p><span m="3721820">So</span> <span m="3722000">what will end up</span> <span m="3722360">happening</span> <span m="3722720">is</span> <span m="3722920">that</span> <span m="3724120">if</span> <span m="3724410">x</span> <span m="3725160">is</span> <span m="3725310">a</span> <span m="3725490">variable</span> <span m="3726520">that</span> <span m="3726840">initially</span> <span m="3727000">shows up</span> <span m="3727350">with no</span> <span m="3727600">taint</span> <span m="3727940">maybe we'll</span> <span m="3728090">say</span> <span m="3728310">OK,</span> <span m="3728630">at this</span> <span m="3728830">point,</span> <span m="3729410">it's actually</span> <span m="3729675">going to</span> <span m="3729940">give the taint of</span> <span m="3730410">the</span> <span m="3730880">PC</span> <span m="3731240">which is actually</span> <span m="3731460">going to taint</span> <span m="3731957">it there.</span> <span m="3733450">So there's</span> <span m="3733720">some</span> <span m="3734272">sublety</span> <span m="3734495">here</span> <span m="3734940">that I'm</span> <span m="3735300">glossing over,</span> <span m="3735787">but</span> <span m="3736274">at a high level</span> <span m="3736761">that's how you can</span> <span m="3737250">capture</span> <span m="3738030">some</span> <span m="3738380">of these flows here</span> <span m="3739110">by</span> <span m="3739230">actually</span> <span m="3739480">looking and</span> <span m="3739870">seeing</span> <span m="3740140">how</span> <span m="3740450">the PC</span> <span m="3741150">is getting</span> <span m="3741410">set,</span> <span m="3742240">and then trying to</span> <span m="3742380">propagate</span> <span m="3742960">that</span> <span m="3743430">to</span> <span m="3744360">the targets</span> <span m="3745010">of</span> <span m="3745410">these</span> <span m="3745715">if</span> <span m="3746020">statements.</span> </p>
<p><span m="3748190">Does that</span> <span m="3748480">all</span> <span m="3748740">makes</span> <span m="3748950">sense?</span> <span m="3750390">OK.</span> <span m="3750940">And if you're</span> <span m="3751790">interested in</span> <span m="3751950">learning</span> <span m="3752190">more</span> <span m="3752340">about</span> <span m="3752560">this,</span> <span m="3753195">come talk to</span> <span m="3753570">me,</span> <span m="3754100">there's</span> <span m="3754930">been</span> <span m="3755080">a lot</span> <span m="3755560">of research</span> <span m="3756005">into this kind</span> <span m="3756450">of stuff.</span> </p>
<p><span m="3757340">However,</span> <span m="3757560">you can</span> <span m="3757910">imagine</span> <span m="3758320">that</span> <span m="3759080">the</span> <span m="3759160">system</span> <span m="3759670">I</span> <span m="3759770">just</span> <span m="3759940">described</span> <span m="3761280">may</span> <span m="3761900">be</span> <span m="3762430">too</span> <span m="3762700">conservative</span> <span m="3764030">once</span> <span m="3764280">again.</span> <span m="3764750">So</span> <span m="3764840">imagine</span> <span m="3765420">that</span> <span m="3766300">instead</span> <span m="3766490">of having</span> <span m="3766960">this code</span> <span m="3767190">here,</span> <span m="3769770">this</span> <span m="3769990">was</span> <span m="3770210">also</span> <span m="3770660">0.</span> <span m="3771980">So</span> <span m="3772150">in this</span> <span m="3772530">dump</span> <span m="3772920">case,</span> <span m="3774950">there's</span> <span m="3775090">absolutely</span> <span m="3775460">no</span> <span m="3775810">reason</span> <span m="3776300">to</span> <span m="3776460">taint</span> <span m="3776890">x</span> <span m="3777330">with</span> <span m="3777770">anything</span> <span m="3778610">related</span> <span m="3779110">to</span> <span m="3779270">the</span> <span m="3779410">INEI,</span> <span m="3780830">because</span> <span m="3781130">you didn't</span> <span m="3781290">actually</span> <span m="3782230">leak</span> <span m="3782440">any</span> <span m="3782680">information</span> <span m="3783590">in either of these</span> <span m="3783970">branches.</span> <span m="3784995">But if you</span> <span m="3785370">use</span> <span m="3785870">it with</span> <span m="3785980">a naive</span> <span m="3787950">PC</span> <span m="3788250">tainting</span> <span m="3789180">scheme,</span> <span m="3789780">then</span> <span m="3791050">you</span> <span m="3791200">might</span> <span m="3793890">over-estimate</span> <span m="3794620">how</span> <span m="3795110">much x has</span> <span m="3795600">been tainted by.</span> <span m="3796580">So</span> <span m="3797220">I should</span> <span m="3797510">say there's</span> <span m="3797970">some subtlety</span> <span m="3798440">you</span> <span m="3798730">can do</span> <span m="3799020">to try</span> <span m="3799340">to get around</span> <span m="3799686">some of these</span> <span m="3800032">issues,</span> <span m="3801380">but it's</span> <span m="3801570">a</span> <span m="3801620">little</span> <span m="3801810">bit</span> <span m="3801950">tricky.</span> <span m="3804010">Does this all</span> <span m="3804310">make</span> <span m="3805060">sense?</span> <span m="3808120">All right.</span> </p>
<p><span m="3808505">AUDIENCE:</span> <span m="3808890">Just a question.</span> </p>
<p><span m="3809373">PROFESSOR:</span> <span m="3809856">Oh, sorry.</span> </p>
<p><span m="3810339">AUDIENCE:</span> <span m="3810822">When you get out</span> <span m="3811305">of the</span> <span m="3811788">if statement,</span> <span m="3813237">so you're out</span> <span m="3813720">of the branch,</span> <span m="3814203">do</span> <span m="3814686">you</span> <span m="3815169">[INAUDIBLE]</span> <span m="3815652">taint out?</span> </p>
<p><span m="3816140">PROFESSOR: Yeah,</span> <span m="3816640">so</span> <span m="3817080">typically, yes.</span> <span m="3817520">So like down</span> <span m="3817960">here</span> <span m="3818930">the PC</span> <span m="3819190">taint would</span> <span m="3819465">be</span> <span m="3819740">cleared.</span> <span m="3820640">So</span> <span m="3821100">it would</span> <span m="3821320">only</span> <span m="3821595">be set</span> <span m="3821870">inside</span> <span m="3822332">these</span> <span m="3822794">branch things</span> <span m="3823256">here.</span> <span m="3823718">And</span> <span m="3824180">the reason</span> <span m="3824642">for that is because</span> <span m="3825104">essentially,</span> <span m="3825566">by</span> <span m="3826028">the</span> <span m="3826490">time you</span> <span m="3826952">get down</span> <span m="3827414">here,</span> <span m="3827880">you get down</span> <span m="3828180">here</span> <span m="3828480">regardless</span> <span m="3828690">of what the</span> <span m="3828810">INEI</span> <span m="3829210">was.</span> <span m="3829686">So yeah,</span> <span m="3830162">you clear that.</span> <span m="3831114">It's a good</span> <span m="3831590">question.</span> <span m="3835480">Let's see.</span> </p>
<p><span m="3840680">You</span> <span m="3840960">talked</span> <span m="3841370">about</span> <span m="3842265">how</span> <span m="3842710">you</span> <span m="3843005">might</span> <span m="3843300">be able</span> <span m="3843580">to taint</span> <span m="3843860">at</span> <span m="3843917">this</span> <span m="3843975">very</span> <span m="3844032">low</span> <span m="3844090">level,</span> <span m="3844820">even</span> <span m="3845060">though</span> <span m="3845475">that might</span> <span m="3845890">be</span> <span m="3846720">expensive,</span> <span m="3847450">one reason</span> <span m="3847560">why it</span> <span m="3847660">might</span> <span m="3847920">be</span> <span m="3848140">useful</span> <span m="3849130">is</span> <span m="3849480">because</span> <span m="3849790">it will</span> <span m="3850215">actually</span> <span m="3850640">allow you to do</span> <span m="3850900">things like</span> <span m="3851130">see</span> <span m="3851420">what</span> <span m="3851590">your</span> <span m="3851670">data</span> <span m="3851910">lifetimes</span> <span m="3852295">look like.</span> <span m="3852680">So</span> <span m="3853000">a couple lectures</span> <span m="3853360">ago,</span> <span m="3853720">we talked</span> <span m="3854020">about</span> <span m="3854320">the fact</span> <span m="3854665">that</span> <span m="3855010">a lot of</span> <span m="3855320">times</span> <span m="3855930">key data,</span> <span m="3856450">for</span> <span m="3856580">example,</span> <span m="3857457">will live</span> <span m="3857934">in memory</span> <span m="3858411">longer than you</span> <span m="3858888">think that it should.</span> </p>
<p><span m="3859365">So you</span> <span m="3859842">can imagine</span> <span m="3860319">that</span> <span m="3860796">even if</span> <span m="3861273">some of the</span> <span m="3861750">x86 or</span> <span m="3862227">ARM</span> <span m="3862704">level</span> <span m="3864612">taint</span> <span m="3865089">tracking</span> <span m="3865580">is</span> <span m="3865800">expensive,</span> <span m="3866230">you</span> <span m="3866660">can</span> <span m="3867090">imagine</span> <span m="3867520">using it to form an audit</span> <span m="3867890">of</span> <span m="3868260">your</span> <span m="3868660">system and</span> <span m="3868790">actually</span> <span m="3869140">tainting,</span> <span m="3869420">let's</span> <span m="3869675">say,</span> <span m="3870190">some</span> <span m="3870635">secret</span> <span m="3871080">key</span> <span m="3871525">that the user</span> <span m="3871970">entered,</span> <span m="3872415">and just</span> <span m="3872860">seeing</span> <span m="3873305">where that goes</span> <span m="3873750">throughout</span> <span m="3874200">your system.</span> <span m="3874980">It's an</span> <span m="3875310">offline</span> <span m="3875450">analysis,</span> <span m="3875790">it's</span> <span m="3876000">not</span> <span m="3876190">facing</span> <span m="3876490">customers,</span> <span m="3876850">so</span> <span m="3876980">it's</span> <span m="3877200">OK</span> <span m="3877495">for it to be</span> <span m="3877790">slow.</span> <span m="3878380">That</span> <span m="3878650">might</span> <span m="3878940">actually</span> <span m="3879230">really</span> <span m="3879320">help</span> <span m="3879580">you to</span> <span m="3879690">figure</span> <span m="3880000">out</span> <span m="3880710">oh,</span> <span m="3880810">this</span> <span m="3880970">data's</span> <span m="3881330">getting</span> <span m="3881690">into</span> <span m="3882630">the keyboard</span> <span m="3883060">buffer,</span> <span m="3883550">it's getting</span> <span m="3883920">into the</span> <span m="3884220">x server,</span> <span m="3884480">it's</span> <span m="3884740">getting</span> <span m="3885240">to wherever.</span> <span m="3886240">So even</span> <span m="3886740">if it's</span> <span m="3887240">slow,</span> <span m="3887740">that can still</span> <span m="3888240">be very, very</span> <span m="3888740">useful.</span> <span m="3889240">So</span> <span m="3889740">I just</span> <span m="3890240">wanted to</span> <span m="3890740">mention</span> <span m="3891240">that briefly.</span> </p>
<p><span m="3894180">One</span> <span m="3894620">interesting</span> <span m="3895110">thing</span> <span m="3895440">you might</span> <span m="3895750">think</span> <span m="3896090">about</span> <span m="3897290">is</span> <span m="3897530">the</span> <span m="3897740">fact</span> <span m="3898140">that</span> <span m="3899570">as I</span> <span m="3899940">mentioned,</span> <span m="3900420">TaintDroid</span> <span m="3901010">is</span> <span m="3901320">nice</span> <span m="3901830">because</span> <span m="3901950">it</span> <span m="3902326">constrains</span> <span m="3903080">the</span> <span m="3903310">universe</span> <span m="3904430">of</span> <span m="3905410">taint</span> <span m="3905850">sources</span> <span m="3906490">and</span> <span m="3906912">taint</span> <span m="3907334">sinks.</span> <span m="3908180">But</span> <span m="3908540">as the</span> <span m="3909030">developer,</span> <span m="3909380">maybe you want</span> <span m="3909600">to</span> <span m="3909740">actually</span> <span m="3910090">explicitly</span> <span m="3911680">assert</span> <span m="3912005">some</span> <span m="3913800">more</span> <span m="3914200">fine</span> <span m="3914485">grain</span> <span m="3914770">control</span> <span m="3915700">over</span> <span m="3916290">the</span> <span m="3917620">labels</span> <span m="3918080">that</span> <span m="3918365">your</span> <span m="3918650">program interacts with.</span> <span m="3919270">So</span> <span m="3919450">now</span> <span m="3919750">as</span> <span m="3919950">a</span> <span m="3920030">programmer,</span> <span m="3921250">you want</span> <span m="3921710">to</span> <span m="3922170">be able</span> <span m="3922630">to say</span> <span m="3922800">something</span> <span m="3923110">like</span> <span m="3923460">this.</span> <span m="3923900">So</span> <span m="3924130">you</span> <span m="3924503">query</span> <span m="3925250">some</span> <span m="3926134">int,</span> <span m="3928344">and let's</span> <span m="3928790">say we</span> <span m="3928940">call</span> <span m="3929280">it</span> <span m="3929400">x,</span> <span m="3930320">then you</span> <span m="3930770">associate</span> <span m="3932120">some</span> <span m="3932570">label</span> <span m="3933405">with</span> <span m="3933790">it.</span> <span m="3934320">Maybe</span> <span m="3934850">the name of this</span> <span m="3935170">label</span> <span m="3935640">is that</span> <span m="3936080">Alice</span> <span m="3936360">is</span> <span m="3936640">the</span> <span m="3936820">owner</span> <span m="3937400">of</span> <span m="3937790">this data,</span> <span m="3938180">but</span> <span m="3938570">Alice</span> <span m="3939330">permits</span> <span m="3940380">Bob,</span> <span m="3940635">or something</span> <span m="3941630">labeled</span> <span m="3941790">with Bob,</span> <span m="3942320">to be able to</span> <span m="3942680">see</span> <span m="3943010">that.</span> </p>
<p><span m="3944882">TaintDroid</span> <span m="3945280">doesn't let</span> <span m="3945640">you do this,</span> <span m="3945930">because</span> <span m="3946080">it essentially</span> <span m="3946160">controls</span> <span m="3946650">that</span> <span m="3946970">universe</span> <span m="3947210">of labels.</span> <span m="3947830">But</span> <span m="3948280">maybe as a</span> <span m="3948700">programmer</span> <span m="3949040">you want</span> <span m="3949534">to be able to</span> <span m="3950028">do a thing like this.</span> <span m="3951510">You</span> <span m="3951690">can imagine</span> <span m="3952160">that</span> <span m="3953980">your</span> <span m="3954320">program</span> <span m="3954900">has</span> <span m="3955210">various</span> <span m="3956310">input</span> <span m="3956770">channels</span> <span m="3958530">and</span> <span m="3958890">output</span> <span m="3959350">channels,</span> <span m="3961150">and</span> <span m="3961600">all of</span> <span m="3962050">these</span> <span m="3962500">input and</span> <span m="3962966">output</span> <span m="3963432">channels,</span> <span m="3963898">they all</span> <span m="3964364">have</span> <span m="3965300">labels,</span> <span m="3965700">too.</span> <span m="3966310">And these</span> <span m="3966440">are labels</span> <span m="3966800">that</span> <span m="3967160">you</span> <span m="3967460">as</span> <span m="3967510">a</span> <span m="3967840">programmer</span> <span m="3968950">get</span> <span m="3969110">to</span> <span m="3969230">actually</span> <span m="3969730">pick,</span> <span m="3970220">as</span> <span m="3970400">opposed</span> <span m="3970850">to</span> <span m="3970930">the</span> <span m="3971090">system</span> <span m="3971470">itself</span> <span m="3971790">trying</span> <span m="3972110">to say</span> <span m="3972608">here's</span> <span m="3973106">this group of</span> <span m="3973604">fine set of things.</span> <span m="3974600">So</span> <span m="3974990">maybe</span> <span m="3975370">say</span> <span m="3976148">for</span> <span m="3976566">input</span> <span m="3976984">channels,</span> <span m="3978240">you</span> <span m="3978620">know the</span> <span m="3978910">read</span> <span m="3979110">values,</span> <span m="3983620">maybe</span> <span m="3984160">they</span> <span m="3984480">get the</span> <span m="3984590">label</span> <span m="3985020">of the channel.</span> </p>
<p><span m="3988040">That's</span> <span m="3988300">very</span> <span m="3988510">similar</span> <span m="3989460">to</span> <span m="3991780">how</span> <span m="3991940">TaintDroid</span> <span m="3992630">works</span> <span m="3992840">right</span> <span m="3993020">now.</span> <span m="3993800">So if</span> <span m="3994190">you read</span> <span m="3994520">something from</span> <span m="3994690">the</span> <span m="3995190">GPS,</span> <span m="3995360">that read value</span> <span m="3995560">is the</span> <span m="3995870">taint</span> <span m="3996360">of the GPS</span> <span m="3997030">channel,</span> <span m="3997210">but</span> <span m="3997480">now</span> <span m="3997750">you as</span> <span m="3998010">a</span> <span m="3998440">programmer</span> <span m="3998810">can</span> <span m="3999180">choose</span> <span m="4001024">what</span> <span m="4001485">those</span> <span m="4001946">labels are.</span> <span m="4003330">And</span> <span m="4003520">then</span> <span m="4004230">you</span> <span m="4004350">could</span> <span m="4004460">imagine</span> <span m="4004970">that</span> <span m="4005440">for output</span> <span m="4005990">channels</span> <span m="4006560">that</span> <span m="4007280">label</span> <span m="4007590">will</span> <span m="4007900">channel</span> <span m="4011482">has</span> <span m="4011959">to</span> <span m="4012436">match</span> <span m="4014350">some</span> <span m="4016610">label</span> <span m="4017240">value</span> <span m="4018892">we've</span> <span m="4019363">written.</span> </p>
<p><span m="4025020">You</span> <span m="4025240">can imagine</span> <span m="4025640">other</span> <span m="4025940">policies</span> <span m="4026195">here</span> <span m="4026450">as</span> <span m="4026640">well.</span> <span m="4027090">But</span> <span m="4027290">the</span> <span m="4027460">basic</span> <span m="4027630">idea</span> <span m="4028090">is that</span> <span m="4028550">there are</span> <span m="4028890">actually</span> <span m="4029170">program</span> <span m="4029540">managers</span> <span m="4029910">that</span> <span m="4030010">allow you</span> <span m="4030380">the</span> <span m="4030750">developer</span> <span m="4031080">to</span> <span m="4031906">pick</span> <span m="4032402">what the</span> <span m="4032898">labels</span> <span m="4033394">are and</span> <span m="4033890">what the semantics</span> <span m="4034386">for</span> <span m="4034882">those labels</span> <span m="4035378">can be.</span> <span m="4036370">So</span> <span m="4036866">what's nice</span> <span m="4037858">about</span> <span m="4038354">some</span> <span m="4038850">of these</span> <span m="4039346">is</span> <span m="4039842">they do</span> <span m="4040338">require the</span> <span m="4040834">programmer to do</span> <span m="4041330">a little</span> <span m="4041826">bit more</span> <span m="4042330">work,</span> <span m="4043830">but</span> <span m="4044110">the</span> <span m="4044550">outcome</span> <span m="4045530">of that</span> <span m="4045990">work</span> <span m="4046650">is</span> <span m="4046850">that</span> <span m="4047460">static</span> <span m="4048020">checking--</span> <span m="4049710">and by static</span> <span m="4049970">checking I</span> <span m="4050230">mean</span> <span m="4050570">checking</span> <span m="4051050">that's</span> <span m="4051630">done</span> <span m="4051810">at</span> <span m="4052020">compile time--</span> <span m="4055948">can</span> <span m="4056439">catch</span> <span m="4056930">many</span> <span m="4057350">types</span> <span m="4058080">of</span> <span m="4058370">information</span> <span m="4059120">flow</span> <span m="4059820">bugs.</span> </p>
<p><span m="4062530">So</span> <span m="4062900">if</span> <span m="4063180">you're</span> <span m="4063460">diligent</span> <span m="4064080">about</span> <span m="4064610">labeling</span> <span m="4065190">all</span> <span m="4065590">of</span> <span m="4066062">your network</span> <span m="4066534">channels</span> <span m="4067006">and</span> <span m="4067480">screen</span> <span m="4067860">channels</span> <span m="4068120">with</span> <span m="4069080">the</span> <span m="4069380">appropriate</span> <span m="4069861">permissions,</span> <span m="4070342">and</span> <span m="4070823">you're</span> <span m="4071304">very diligent</span> <span m="4071785">about leaving</span> <span m="4072266">your data like</span> <span m="4072750">this,</span> <span m="4073260">what</span> <span m="4073560">can happen</span> <span m="4074090">is that</span> <span m="4074515">at</span> <span m="4074940">compile time,</span> <span m="4075365">when</span> <span m="4075790">you compile</span> <span m="4076170">your</span> <span m="4076550">program</span> <span m="4076930">and</span> <span m="4077310">your</span> <span m="4077500">compiler</span> <span m="4077740">can tell</span> <span m="4077920">you</span> <span m="4078020">things</span> <span m="4078230">like</span> <span m="4078576">hey,</span> <span m="4079270">if you were to</span> <span m="4079410">run</span> <span m="4079590">this</span> <span m="4079770">program,</span> <span m="4080440">then you</span> <span m="4080700">actually</span> <span m="4081160">have an</span> <span m="4081470">information</span> <span m="4081730">leak</span> <span m="4082590">that</span> <span m="4083080">this</span> <span m="4083590">particular</span> <span m="4083990">piece</span> <span m="4084210">of</span> <span m="4084330">data</span> <span m="4085150">will</span> <span m="4085510">pass</span> <span m="4085830">an equal</span> <span m="4086130">channel,</span> <span m="4086430">which is</span> <span m="4086923">untrusted.</span> </p>
<p><span m="4087910">And</span> <span m="4089020">at</span> <span m="4089200">a high</span> <span m="4089650">level,</span> <span m="4089930">the reason</span> <span m="4090300">why static checking</span> <span m="4090605">can</span> <span m="4090910">catch</span> <span m="4091140">a lot</span> <span m="4091610">of these</span> <span m="4092010">bugs</span> <span m="4092485">is</span> <span m="4092960">because</span> <span m="4093435">usually speaking,</span> <span m="4093910">when you think</span> <span m="4094385">of some</span> <span m="4094860">of these</span> <span m="4095335">annotations,</span> <span m="4096340">they're</span> <span m="4096740">somewhat</span> <span m="4097229">similar to</span> <span m="4097300">types.</span> <span m="4098580">So</span> <span m="4098710">the</span> <span m="4098819">same</span> <span m="4099100">way</span> <span m="4099540">that</span> <span m="4100270">compilers</span> <span m="4100450">can</span> <span m="4100880">catch</span> <span m="4101630">errors</span> <span m="4103140">involving</span> <span m="4103450">types</span> <span m="4103928">and</span> <span m="4104406">installing</span> <span m="4104884">type language,</span> <span m="4105362">you</span> <span m="4105840">can imagine that</span> <span m="4106318">the compiler</span> <span m="4106796">in</span> <span m="4107274">a language</span> <span m="4107752">like this</span> <span m="4108230">can</span> <span m="4108708">codes some</span> <span m="4109186">calculus</span> <span m="4109664">over</span> <span m="4110142">this</span> <span m="4110630">label,</span> <span m="4110730">and</span> <span m="4110830">in</span> <span m="4110930">many</span> <span m="4111140">cases,</span> <span m="4112130">determine</span> <span m="4113080">hey,</span> <span m="4113557">if</span> <span m="4114034">you would</span> <span m="4114511">actually run</span> <span m="4114990">this program,</span> <span m="4115450">this</span> <span m="4115620">would be</span> <span m="4115680">a</span> <span m="4115880">problem.</span> <span m="4116250">So</span> <span m="4116380">you</span> <span m="4116802">really</span> <span m="4117224">need</span> <span m="4117646">to</span> <span m="4118250">fix</span> <span m="4118430">the way</span> <span m="4118745">that the</span> <span m="4119060">labels</span> <span m="4119380">work,</span> <span m="4119960">maybe</span> <span m="4120240">you need</span> <span m="4120520">to</span> <span m="4120794">explicitly</span> <span m="4121069">declassify</span> <span m="4121520">something,</span> <span m="4122140">so on and</span> <span m="4122625">so forth.</span> </p>
<p><span m="4123110">AUDIENCE:</span> <span m="4123595">You</span> <span m="4124080">can't just</span> <span m="4124565">[INAUDIBLE]?</span> </p>
<p><span m="4128445">PROFESSOR:</span> <span m="4128930">Yeah,</span> <span m="4129415">yeah,</span> <span m="4129910">that's right.</span> <span m="4131020">So</span> <span m="4131800">depending</span> <span m="4131859">on</span> <span m="4132120">the language,</span> <span m="4132880">these</span> <span m="4133365">labels</span> <span m="4133850">can associate</span> <span m="4134220">people</span> <span m="4134990">with</span> <span m="4135439">IO</span> <span m="4135660">ports,</span> <span m="4136590">all</span> <span m="4136779">that</span> <span m="4137130">kind of stuff.</span> <span m="4137380">That's</span> <span m="4137590">exactly</span> <span m="4138069">right.</span> <span m="4139533">So</span> <span m="4140021">this</span> <span m="4140509">is</span> <span m="4140997">just</span> <span m="4141485">interesting</span> <span m="4141973">to know</span> <span m="4142461">about,</span> <span m="4142949">because</span> <span m="4144420">TaintDroid</span> <span m="4144720">has</span> <span m="4145180">a</span> <span m="4145300">very</span> <span m="4145700">nice</span> <span m="4145939">general</span> <span m="4146080">introduction</span> <span m="4146729">to</span> <span m="4146984">this</span> <span m="4147240">information</span> <span m="4147569">flows</span> <span m="4147734">stuff,</span> <span m="4148393">but there's</span> <span m="4148887">actually</span> <span m="4149381">some really</span> <span m="4149875">hardcore</span> <span m="4150369">systems out there</span> <span m="4150863">than can</span> <span m="4151359">express</span> <span m="4151739">much</span> <span m="4152120">richer</span> <span m="4152602">semantics</span> <span m="4153084">in the</span> <span m="4153566">control</span> <span m="4154048">of a program</span> <span m="4154530">with respect</span> <span m="4155500">to information</span> <span m="4155920">flow.</span> </p>
<p><span m="4157500">And you know,</span> <span m="4157770">too,</span> <span m="4157979">that</span> <span m="4158090">when</span> <span m="4158508">we</span> <span m="4158926">talk</span> <span m="4159344">about static</span> <span m="4159762">checking</span> <span m="4160180">and being able to catch many bugs,</span> <span m="4160779">it's</span> <span m="4161164">actually</span> <span m="4161549">preferable</span> <span m="4162810">to</span> <span m="4162970">catch</span> <span m="4163359">as many</span> <span m="4163830">bugs</span> <span m="4164279">using static</span> <span m="4164534">checking</span> <span m="4165284">and</span> <span m="4165778">static</span> <span m="4166272">failures</span> <span m="4166766">as</span> <span m="4167260">opposed to</span> <span m="4167754">dynamic</span> <span m="4168248">checking and</span> <span m="4168742">dynamic</span> <span m="4169236">failures.</span> <span m="4170224">There's a very</span> <span m="4170718">subtle but powerful</span> <span m="4171212">reason</span> <span m="4171706">for</span> <span m="4172200">why that is.</span> <span m="4172694">The</span> <span m="4173188">reason is that,</span> <span m="4173682">let's</span> <span m="4174176">say</span> <span m="4174670">that</span> <span m="4175164">we</span> <span m="4175658">defer</span> <span m="4176152">all of the static checks</span> <span m="4176646">to the runtime,</span> <span m="4178128">which you</span> <span m="4178622">could certainly</span> <span m="4179116">do.</span> <span m="4179610">There's no</span> <span m="4180104">reason you couldn't</span> <span m="4180598">take all</span> <span m="4181109">the static checks and</span> <span m="4181380">give you a name for it.</span> <span m="4182359">The problem</span> <span m="4182679">is that</span> <span m="4183000">the</span> <span m="4183490">failure</span> <span m="4183910">or</span> <span m="4184090">success</span> <span m="4184689">of</span> <span m="4184870">these</span> <span m="4185069">checks</span> <span m="4185770">is</span> <span m="4185899">actually</span> <span m="4186279">a covert</span> <span m="4186744">channel,</span> <span m="4187210">perhaps.</span> </p>
<p><span m="4188359">So</span> <span m="4188490">the</span> <span m="4188640">attacker</span> <span m="4189130">could</span> <span m="4189485">actually</span> <span m="4189840">feed your</span> <span m="4190290">program</span> <span m="4190680">some</span> <span m="4191040">information</span> <span m="4191449">and then</span> <span m="4191859">see</span> <span m="4192090">whether</span> <span m="4192439">it crashed or</span> <span m="4192699">not.</span> <span m="4193819">And if</span> <span m="4193890">it crashed,</span> <span m="4194700">it</span> <span m="4194910">might</span> <span m="4195180">say,</span> <span m="4195350">aha,</span> <span m="4195720">you've</span> <span m="4196090">passed</span> <span m="4196720">some</span> <span m="4196950">dynamic</span> <span m="4197270">check</span> <span m="4197590">of information</span> <span m="4197955">flow,</span> <span m="4198760">that</span> <span m="4198960">must mean</span> <span m="4199510">something</span> <span m="4200250">was</span> <span m="4200500">secret</span> <span m="4200960">about</span> <span m="4201160">this</span> <span m="4201300">value</span> <span m="4201630">I sort of</span> <span m="4202120">cajoled</span> <span m="4202530">you</span> <span m="4202953">into</span> <span m="4203376">computing.</span> <span m="4203800">So</span> <span m="4203950">you</span> <span m="4204020">want</span> <span m="4204260">to try</span> <span m="4204570">to make these</span> <span m="4204900">checks</span> <span m="4205590">as static</span> <span m="4205780">as</span> <span m="4206190">possible</span> <span m="4206840">to the greatest</span> <span m="4207300">possible</span> <span m="4207640">extent.</span> </p>
<p><span m="4210240">If</span> <span m="4210580">you want</span> <span m="4211160">more</span> <span m="4211410">information</span> <span m="4212640">on</span> <span m="4212920">this</span> <span m="4213080">kind</span> <span m="4213420">of</span> <span m="4213790">stuff,</span> <span m="4214160">maybe</span> <span m="4214480">a</span> <span m="4214800">good</span> <span m="4215270">place</span> <span m="4215360">to</span> <span m="4216090">start,</span> <span m="4216400">a word to search</span> <span m="4216830">is Jif.</span> <span m="4217818">It's a very influential</span> <span m="4219300">system</span> <span m="4219794">that built</span> <span m="4220288">some</span> <span m="4220782">of these issues</span> <span m="4221276">of</span> <span m="4222264">label</span> <span m="4222758">computation.</span> <span m="4223746">So</span> <span m="4224240">you can</span> <span m="4224734">start</span> <span m="4224857">there and</span> <span m="4224981">sort of</span> <span m="4225228">roll forward.</span> <span m="4227204">My co-professor</span> <span m="4227698">actually</span> <span m="4228192">has</span> <span m="4228686">done a lot</span> <span m="4229180">of good work</span> <span m="4229674">on</span> <span m="4229772">this,</span> <span m="4229871">so</span> <span m="4229970">you</span> <span m="4230069">could</span> <span m="4230168">ask him about that</span> <span m="4230662">if</span> <span m="4231156">you want</span> <span m="4231650">to talk</span> <span m="4232144">more label stuff.</span> <span m="4234614">That's</span> <span m="4235130">sort of</span> <span m="4235620">interesting to know</span> <span m="4236880">that</span> <span m="4237340">TaintDroid</span> <span m="4238090">is</span> <span m="4238260">actually</span> <span m="4238630">fairly</span> <span m="4239340">restrictive</span> <span m="4240350">in the</span> <span m="4240820">expressiveness</span> <span m="4241526">of</span> <span m="4241880">the</span> <span m="4242265">labels</span> <span m="4242650">it allows</span> <span m="4243149">you</span> <span m="4243648">to look</span> <span m="4244147">at.</span> <span m="4244646">There</span> <span m="4245145">are systems</span> <span m="4245644">out there that allow</span> <span m="4246143">you to do</span> <span m="4246642">more</span> <span m="4247640">powerful</span> <span m="4247770">stuff.</span> </p>
<p><span m="4251610">Finally,</span> <span m="4251820">what I'd like</span> <span m="4252120">to</span> <span m="4252410">talk</span> <span m="4252750">about</span> <span m="4256010">is</span> <span m="4256450">what</span> <span m="4257010">we can</span> <span m="4257370">do</span> <span m="4258242">if we</span> <span m="4258734">want</span> <span m="4259226">to</span> <span m="4259718">track</span> <span m="4260210">information</span> <span m="4260702">flows</span> <span m="4262180">in some</span> <span m="4262390">of these</span> <span m="4262610">legacy</span> <span m="4263040">programs,</span> <span m="4264460">or</span> <span m="4264955">through</span> <span m="4265450">programs</span> <span m="4265945">that</span> <span m="4266440">are written</span> <span m="4266935">in C</span> <span m="4267430">or</span> <span m="4267930">C++</span> <span m="4268670">that</span> <span m="4269120">don't</span> <span m="4269570">have all the</span> <span m="4270064">fancy runtime</span> <span m="4270558">support.</span> <span m="4272040">So</span> <span m="4272680">there's</span> <span m="4273040">a</span> <span m="4273720">very</span> <span m="4274040">cute</span> <span m="4274350">system,</span> <span m="4275970">some of the same</span> <span m="4276580">authors</span> <span m="4277960">on</span> <span m="4278210">this</span> <span m="4278430">paper</span> <span m="4279230">that</span> <span m="4279470">looks</span> <span m="4279660">at</span> <span m="4279750">this</span> <span m="4279990">issue</span> <span m="4280620">of</span> <span m="4280950">how</span> <span m="4281310">can we</span> <span m="4282080">track</span> <span m="4282710">informational</span> <span m="4282950">leaks</span> <span m="4284160">in</span> <span m="4284700">a</span> <span m="4285189">system</span> <span m="4285678">which</span> <span m="4286167">we</span> <span m="4286656">don't</span> <span m="4287145">want</span> <span m="4287634">to</span> <span m="4288123">modify the application</span> <span m="4288612">at all.</span> <span m="4289101">This</span> <span m="4289590">is the</span> <span m="4290079">TightLip system.</span> </p>
<p><span m="4290568">So the</span> <span m="4291057">basic</span> <span m="4291546">idea</span> <span m="4292035">is that they</span> <span m="4292524">introduce</span> <span m="4293013">this notion of</span> <span m="4293502">what they call</span> <span m="4294969">doppelganger</span> <span m="4295810">processes.</span> <span m="4302020">TightLip</span> <span m="4302315">uses</span> <span m="4302610">doppelganger</span> <span m="4302960">processes</span> <span m="4303510">evolved.</span> <span m="4304200">So</span> <span m="4305464">the</span> <span m="4305908">first</span> <span m="4306352">thing it</span> <span m="4306796">does</span> <span m="4307240">is</span> <span m="4307684">it</span> <span m="4308130">periodically</span> <span m="4308350">scans</span> <span m="4309520">a</span> <span m="4309890">user's</span> <span m="4310110">file</span> <span m="4310410">system</span> <span m="4313590">and it</span> <span m="4314082">looks</span> <span m="4314574">for</span> <span m="4315070">sensitive</span> <span m="4315530">file types.</span> <span m="4317690">This</span> <span m="4317890">might</span> <span m="4318360">be things</span> <span m="4318770">like</span> <span m="4319760">your</span> <span m="4320350">mail file,</span> <span m="4320480">your</span> <span m="4321390">word</span> <span m="4321670">processing</span> <span m="4322720">documents,</span> <span m="4323290">so on and</span> <span m="4323520">so</span> <span m="4323820">forth.</span> <span m="4325040">So</span> <span m="4325330">what</span> <span m="4325580">it's</span> <span m="4325890">going to do</span> <span m="4326305">for each one of these</span> <span m="4326720">files</span> <span m="4327025">is</span> <span m="4327330">it's</span> <span m="4327690">going</span> <span m="4327970">to produce</span> <span m="4329296">a</span> <span m="4329780">scrubbed version.</span> <span m="4333410">So</span> <span m="4333520">for</span> <span m="4333670">example,</span> <span m="4334330">if it</span> <span m="4334600">finds</span> <span m="4334875">an</span> <span m="4335150">email</span> <span m="4335505">file,</span> <span m="4336060">it's</span> <span m="4336310">going</span> <span m="4336720">to</span> <span m="4338900">replace</span> <span m="4339620">the to</span> <span m="4340010">or the</span> <span m="4340508">from</span> <span m="4341006">information</span> <span m="4341504">with,</span> <span m="4342002">let's say,</span> <span m="4342500">a</span> <span m="4342998">string</span> <span m="4343496">of</span> <span m="4343994">the</span> <span m="4344492">same</span> <span m="4344990">length but just</span> <span m="4345488">dummy data.</span> <span m="4345986">Maybe all</span> <span m="4346484">spaces or something</span> <span m="4346982">like that.</span> <span m="4348180">It</span> <span m="4348836">does</span> <span m="4349828">this</span> <span m="4350324">as</span> <span m="4350820">a</span> <span m="4351316">background task.</span> </p>
<p><span m="4352308">Then</span> <span m="4352804">the second</span> <span m="4353300">thing it's</span> <span m="4353796">going to</span> <span m="4354292">do,</span> <span m="4355780">at</span> <span m="4356276">some point a process</span> <span m="4356772">is going</span> <span m="4357268">to start</span> <span m="4357764">executing,</span> <span m="4358260">and so</span> <span m="4359760">then</span> <span m="4359890">TightLip is</span> <span m="4360180">going</span> <span m="4360410">to</span> <span m="4361210">detect</span> <span m="4364170">when</span> <span m="4364570">and if</span> <span m="4364875">the</span> <span m="4365180">process</span> <span m="4367730">tries</span> <span m="4368200">to</span> <span m="4368430">access</span> <span m="4369010">a</span> <span m="4369100">sensitive</span> <span m="4369290">file.</span> <span m="4372510">And</span> <span m="4373010">if such</span> <span m="4373140">an</span> <span m="4373360">access</span> <span m="4373960">does</span> <span m="4374220">take</span> <span m="4374480">place,</span> <span m="4377220">TightLip</span> <span m="4377340">is</span> <span m="4377800">going</span> <span m="4377950">to</span> <span m="4378380">spawn</span> <span m="4379630">one</span> <span m="4379990">of these</span> <span m="4381580">doppelganger</span> <span m="4382090">processes.</span> <span m="4385520">And</span> <span m="4385930">so</span> <span m="4388180">what</span> <span m="4388330">the</span> <span m="4388420">doppelganger</span> <span m="4389000">process</span> <span m="4389500">looks</span> <span m="4389720">like</span> <span m="4390660">is</span> <span m="4391395">very</span> <span m="4391700">similar</span> <span m="4392310">to</span> <span m="4392595">the</span> <span m="4393776">original</span> <span m="4394224">process</span> <span m="4394672">that tried</span> <span m="4395120">to touch that</span> <span m="4395570">sensitive data,</span> <span m="4396760">but</span> <span m="4396960">the</span> <span m="4397090">key</span> <span m="4397440">difference</span> <span m="4397745">is</span> <span m="4398050">that</span> <span m="4399490">the</span> <span m="4400808">doppelganger,</span> <span m="4401297">which</span> <span m="4401786">I'll</span> <span m="4402275">abbreviate</span> <span m="4402764">DG,</span> <span m="4404720">reads</span> <span m="4406187">the</span> <span m="4406680">scrubbed</span> <span m="4407070">data.</span> </p>
<p><span m="4411180">So</span> <span m="4411580">imagine</span> <span m="4412340">that--</span> <span m="4412720">so the process</span> <span m="4413055">is</span> <span m="4413390">executing,</span> <span m="4414460">it tries</span> <span m="4414630">to</span> <span m="4414820">access</span> <span m="4415930">your</span> <span m="4416130">email</span> <span m="4416395">file.</span> <span m="4416900">The</span> <span m="4417070">system</span> <span m="4417240">spawns</span> <span m="4417360">this new</span> <span m="4418170">process,</span> <span m="4418440">the</span> <span m="4418710">doppelganger,</span> <span m="4419500">that</span> <span m="4419670">doppelganger</span> <span m="4420190">is</span> <span m="4420290">exactly</span> <span m="4420710">the</span> <span m="4421202">same</span> <span m="4421694">as</span> <span m="4422186">that original</span> <span m="4422678">one,</span> <span m="4423170">but it is now reading</span> <span m="4423662">from the scrub</span> <span m="4424154">data</span> <span m="4424646">instead of the</span> <span m="4425138">real sensitive</span> <span m="4425630">data.</span> </p>
<p><span m="4428760">What</span> <span m="4428950">happens</span> <span m="4429370">then.</span> <span m="4431458">Essentially,</span> <span m="4432414">TightLip,</span> <span m="4434326">we're</span> <span m="4434804">going to run</span> <span m="4435760">those</span> <span m="4436238">two processes</span> <span m="4437672">in</span> <span m="4438150">parallel.</span> <span m="4441020">It needs</span> <span m="4441170">to just</span> <span m="4441490">watch</span> <span m="4441890">them</span> <span m="4442440">and</span> <span m="4442640">see</span> <span m="4442900">what</span> <span m="4443010">they</span> <span m="4443150">do.</span> <span m="4445620">And</span> <span m="4445860">so</span> <span m="4446680">in</span> <span m="4446830">particular,</span> <span m="4447700">we're</span> <span m="4447820">going</span> <span m="4448100">to</span> <span m="4448170">see,</span> <span m="4449842">do</span> <span m="4450310">the</span> <span m="4450620">processes</span> <span m="4454040">issue</span> <span m="4456020">the</span> <span m="4456280">same</span> <span m="4456720">system</span> <span m="4457080">calls</span> <span m="4461330">with</span> <span m="4462180">the</span> <span m="4462340">same</span> <span m="4463249">arguments.</span> <span m="4468050">And if that's</span> <span m="4468350">the</span> <span m="4468480">case,</span> <span m="4471100">then</span> <span m="4471360">presumably</span> <span m="4473190">those</span> <span m="4473480">system</span> <span m="4473925">calls</span> <span m="4474795">do</span> <span m="4475220">not</span> <span m="4475690">depend</span> <span m="4476135">on the</span> <span m="4476580">sensitive</span> <span m="4476800">data.</span> <span m="4478610">So</span> <span m="4479020">in</span> <span m="4479350">other</span> <span m="4479520">words,</span> <span m="4479560">if</span> <span m="4479600">I</span> <span m="4479640">start a</span> <span m="4480020">process</span> <span m="4481130">that</span> <span m="4481410">tries</span> <span m="4481580">to</span> <span m="4482000">open</span> <span m="4482420">some sensitive file,</span> <span m="4483160">I</span> <span m="4483390">feed</span> <span m="4483690">it</span> <span m="4484090">basically junk</span> <span m="4484415">data,</span> <span m="4485170">I let it</span> <span m="4485270">execute.</span> <span m="4486390">If that</span> <span m="4486915">doppelganger</span> <span m="4487200">process</span> <span m="4488150">still</span> <span m="4488670">does</span> <span m="4488960">the</span> <span m="4489050">same</span> <span m="4489460">things</span> <span m="4489860">that</span> <span m="4489970">the</span> <span m="4490130">regular</span> <span m="4490520">process</span> <span m="4490850">would</span> <span m="4491306">have</span> <span m="4491762">done,</span> <span m="4492220">then</span> <span m="4492380">presumably</span> <span m="4492990">it wasn't</span> <span m="4493330">influenced</span> <span m="4493520">by</span> <span m="4493910">that sensitive</span> <span m="4494245">data</span> <span m="4494835">at</span> <span m="4495090">all.</span> </p>
<p><span m="4496550">So</span> <span m="4496640">essentially</span> <span m="4497520">doppelganger will let these</span> <span m="4498010">processes</span> <span m="4498600">run,</span> <span m="4500500">TightLip</span> <span m="4501040">will let</span> <span m="4501540">these</span> <span m="4502020">processes</span> <span m="4502335">run,</span> <span m="4502440">and</span> <span m="4502545">then check</span> <span m="4502650">the system</span> <span m="4503040">calls</span> <span m="4503460">here.</span> <span m="4503920">And</span> <span m="4504130">then</span> <span m="4505170">it</span> <span m="4505300">might</span> <span m="4505600">happen</span> <span m="4505890">that</span> <span m="4505930">in some</span> <span m="4506370">case</span> <span m="4508380">the</span> <span m="4508510">sys</span> <span m="4508800">calls</span> <span m="4509150">divert.</span> <span m="4513530">So</span> <span m="4513650">in</span> <span m="4513740">particular,</span> <span m="4514775">what</span> <span m="4515110">if</span> <span m="4515610">the</span> <span m="4516650">doppelganger</span> <span m="4517260">starts</span> <span m="4517585">doing</span> <span m="4517910">things</span> <span m="4518810">that</span> <span m="4519260">the</span> <span m="4519710">regular</span> <span m="4520160">version</span> <span m="4520610">of the process</span> <span m="4521060">would not have</span> <span m="4521510">done,</span> <span m="4522330">and then</span> <span m="4522680">the doppelganger</span> <span m="4523000">tries</span> <span m="4523170">to make</span> <span m="4523360">a</span> <span m="4523510">network</span> <span m="4523880">call.</span> <span m="4524800">So</span> <span m="4524920">just</span> <span m="4525250">like</span> <span m="4525680">in</span> <span m="4525870">TaintDroid,</span> <span m="4526560">when that</span> <span m="4526810">doppelganger</span> <span m="4527110">tries</span> <span m="4527210">to</span> <span m="4527510">make</span> <span m="4527810">a network</span> <span m="4528260">call,</span> <span m="4528720">that's</span> <span m="4528980">when we</span> <span m="4529180">say</span> <span m="4529350">aha,</span> <span m="4529650">we should probably</span> <span m="4530210">stop</span> <span m="4530690">what's happening</span> <span m="4530965">right</span> <span m="4531240">now</span> <span m="4531660">and</span> <span m="4531945">then do</span> <span m="4532230">something.</span> </p>
<p><span m="4533660">So</span> <span m="4533940">if</span> <span m="4534090">the</span> <span m="4534230">system</span> <span m="4534340">calls</span> <span m="4534560">diverge,</span> <span m="4539140">then</span> <span m="4539630">the doppelganger</span> <span m="4540120">makes a</span> <span m="4540610">network</span> <span m="4540900">call,</span> <span m="4545184">then we're</span> <span m="4545660">going</span> <span m="4545960">to</span> <span m="4546290">do</span> <span m="4546590">something.</span> <span m="4547540">So</span> <span m="4547940">we're going</span> <span m="4548240">to either</span> <span m="4549455">raise</span> <span m="4549820">an</span> <span m="4550160">alert to the</span> <span m="4550500">user</span> <span m="4550980">or</span> <span m="4552010">whatever.</span> <span m="4552737">Kind of</span> <span m="4553234">like in</span> <span m="4553731">TaintDroid,</span> <span m="4554230">but at this</span> <span m="4554480">point there's</span> <span m="4554860">a specific</span> <span m="4555260">policy</span> <span m="4555680">you can</span> <span m="4555980">add</span> <span m="4556280">in some</span> <span m="4556728">particular</span> <span m="4557176">system you're going</span> <span m="4557624">to use.</span> <span m="4558520">But this</span> <span m="4558968">is sort of an</span> <span m="4559420">interesting point at which</span> <span m="4559570">you can say</span> <span m="4560110">well,</span> <span m="4560560">somehow</span> <span m="4562420">that</span> <span m="4563020">doppelganger</span> <span m="4563590">process</span> <span m="4564840">was</span> <span m="4565140">affected</span> <span m="4565650">by</span> <span m="4565810">that</span> <span m="4566105">sensitive</span> <span m="4566400">data</span> <span m="4566980">that</span> <span m="4567260">was</span> <span m="4567625">returned.</span> <span m="4567990">That</span> <span m="4568250">means</span> <span m="4568560">that</span> <span m="4568730">maybe</span> <span m="4569035">if</span> <span m="4569340">the</span> <span m="4569580">user</span> <span m="4569820">did</span> <span m="4570050">not</span> <span m="4570390">think</span> <span m="4570650">that</span> <span m="4570860">a</span> <span m="4570970">particular</span> <span m="4571400">process</span> <span m="4572130">was</span> <span m="4572615">going to</span> <span m="4573100">get exfiltrated</span> <span m="4573585">data,</span> <span m="4574070">now the user</span> <span m="4574220">can actually</span> <span m="4574680">do an audit</span> <span m="4575010">of that</span> <span m="4575220">program</span> <span m="4575730">to</span> <span m="4575880">figure</span> <span m="4576290">out</span> <span m="4576940">why</span> <span m="4577670">that</span> <span m="4577870">program</span> <span m="4578240">returned</span> <span m="4578610">send</span> <span m="4578980">that data</span> <span m="4579290">over the</span> <span m="4579630">network.</span> <span m="4580600">So</span> <span m="4580696">does</span> <span m="4580793">anyone--</span> <span m="4581160">go</span> <span m="4581632">ahead.</span> </p>
<p><span m="4582104">AUDIENCE:</span> <span m="4582576">So if you're</span> <span m="4583048">hitting</span> <span m="4583520">something</span> <span m="4583992">like a</span> <span m="4584464">word</span> <span m="4584936">file</span> <span m="4585408">or</span> <span m="4585880">whatever,</span> <span m="4586352">you kind of have</span> <span m="4586824">to know what</span> <span m="4587300">you're</span> <span m="4587645">zeroing</span> <span m="4587990">out and</span> <span m="4588469">what you're</span> <span m="4588948">[INAUDIBLE].</span> </p>
<p><span m="4592780">PROFESSOR:</span> <span m="4593259">Good question,</span> <span m="4593738">that's right.</span> <span m="4594217">So I</span> <span m="4594696">was going to</span> <span m="4595175">discuss</span> <span m="4595654">some limitations,</span> <span m="4596133">and one of the limitations</span> <span m="4596612">is precisely that.</span> <span m="4597091">You</span> <span m="4597570">need</span> <span m="4598049">to</span> <span m="4598528">have</span> <span m="4599010">per file type</span> <span m="4599470">scrubbers.</span> <span m="4600874">So you</span> <span m="4601342">can't just</span> <span m="4601810">take</span> <span m="4602278">your email scrubber</span> <span m="4602746">and</span> <span m="4603214">use</span> <span m="4603690">it</span> <span m="4603750">for</span> <span m="4604060">Word.</span> <span m="4604380">And in</span> <span m="4604650">fact,</span> <span m="4605080">if those</span> <span m="4605480">scrubbers</span> <span m="4605956">miss</span> <span m="4606432">something,</span> <span m="4607860">so</span> <span m="4608010">if they</span> <span m="4608390">don't</span> <span m="4609380">redact</span> <span m="4610080">everything,</span> <span m="4610670">then</span> <span m="4611010">this</span> <span m="4611270">system</span> <span m="4611410">may not</span> <span m="4611720">catch</span> <span m="4612270">all the</span> <span m="4612640">possible</span> <span m="4613080">sensitive</span> <span m="4613506">data leaks.</span> <span m="4614360">So you're</span> <span m="4614730">exactly</span> <span m="4615100">right about that.</span> <span m="4615900">But</span> <span m="4616330">I think--</span> <span m="4616730">go ahead.</span> </p>
<p><span m="4617130">AUDIENCE:</span> <span m="4617611">So</span> <span m="4618092">if</span> <span m="4618573">I</span> <span m="4619054">understand,</span> <span m="4620020">why</span> <span m="4620450">should</span> <span m="4620880">the</span> <span m="4621335">process</span> <span m="4622140">look</span> <span m="4622190">at the</span> <span m="4622671">data</span> <span m="4623152">before saying</span> <span m="4623633">go ahead?</span> <span m="4624595">Why wouldn't</span> <span m="4625076">you just</span> <span m="4625557">send the stuff in?</span> </p>
<p><span m="4627000">PROFESSOR:</span> <span m="4627490">Why would</span> <span m="4627875">the</span> <span m="4628260">process--</span> </p>
<p><span m="4629240">AUDIENCE:</span> <span m="4629585">If the</span> <span m="4629930">process plans</span> <span m="4630190">to</span> <span m="4630840">input</span> <span m="4631340">data,</span> <span m="4632560">[INAUDIBLE]?</span> </p>
<p><span m="4635410">PROFESSOR:</span> <span m="4635902">Oh, no,</span> <span m="4636394">no.</span> <span m="4637870">From</span> <span m="4638362">the perspective</span> <span m="4638860">of the</span> <span m="4639115">doppelganger,</span> <span m="4640650">I</span> <span m="4640770">mean,</span> <span m="4641100">it</span> <span m="4641210">may try</span> <span m="4641670">to,</span> <span m="4641960">in fact,</span> <span m="4642250">look and</span> <span m="4642420">see</span> <span m="4642660">things</span> <span m="4642910">like</span> <span m="4643530">does this</span> <span m="4643840">email</span> <span m="4644170">address</span> <span m="4644490">make</span> <span m="4644855">sense,</span> <span m="4645220">for</span> <span m="4645540">example,</span> <span m="4645660">before</span> <span m="4645740">it tries</span> <span m="4646090">to send</span> <span m="4646500">it out.</span> <span m="4646580">But the</span> <span m="4646680">doppelganger</span> <span m="4647200">process,</span> <span m="4647630">it shouldn't</span> <span m="4648020">know</span> <span m="4648450">that</span> <span m="4648580">it's</span> <span m="4648740">gotten</span> <span m="4649000">this</span> <span m="4649170">weird</span> <span m="4649520">scrubbed</span> <span m="4649820">data.</span> <span m="4650740">So this</span> <span m="4650980">gets back a little</span> <span m="4651300">bit to</span> <span m="4651530">the</span> <span m="4651630">question</span> <span m="4652010">we were just</span> <span m="4652080">talking</span> <span m="4652470">about.</span> <span m="4653030">If your</span> <span m="4654866">scrubber</span> <span m="4656294">doesn't</span> <span m="4657250">scrub</span> <span m="4657580">things</span> <span m="4657620">in</span> <span m="4657890">a semantically</span> <span m="4658720">reasonable</span> <span m="4659180">way,</span> <span m="4659790">the</span> <span m="4660090">doppelganger</span> <span m="4660290">may,</span> <span m="4660530">in fact,</span> <span m="4660750">crash,</span> <span m="4661680">for</span> <span m="4662070">example.</span> <span m="4662725">It expects</span> <span m="4663130">things in</span> <span m="4663420">this</span> <span m="4663487">sort of</span> <span m="4663555">format,</span> <span m="4663690">but it's</span> <span m="4663960">not.</span> </p>
<p><span m="4665080">But at a</span> <span m="4665370">high level,</span> <span m="4666130">the</span> <span m="4666520">idea</span> <span m="4666690">is that</span> <span m="4666880">we're</span> <span m="4666990">trying</span> <span m="4667360">to</span> <span m="4667420">trick</span> <span m="4668580">the</span> <span m="4668790">doppelganger</span> <span m="4669795">into</span> <span m="4670100">doing what it</span> <span m="4670450">would</span> <span m="4670940">do</span> <span m="4671330">normally,</span> <span m="4672060">but</span> <span m="4672490">on data</span> <span m="4672750">that's</span> <span m="4674420">different</span> <span m="4674690">in</span> <span m="4675025">the original</span> <span m="4675360">version</span> <span m="4675780">and</span> <span m="4676200">see</span> <span m="4676640">if there</span> <span m="4677080">will be</span> <span m="4677520">that divergence.</span> <span m="4679120">So</span> <span m="4679240">one</span> <span m="4679420">drawback</span> <span m="4679810">is</span> <span m="4679910">that,</span> <span m="4680350">like we're</span> <span m="4680450">discussing,</span> <span m="4681440">this</span> <span m="4681670">basically</span> <span m="4682650">puts</span> <span m="4683050">the</span> <span m="4683270">scrubbers</span> <span m="4683810">in TCB</span> <span m="4684410">and</span> <span m="4684600">if</span> <span m="4684720">they</span> <span m="4684820">don't</span> <span m="4685010">work</span> <span m="4685240">properly,</span> <span m="4685970">doppelgangers</span> <span m="4686423">might crash,</span> <span m="4686876">you</span> <span m="4687330">might</span> <span m="4687580">not be</span> <span m="4687670">able</span> <span m="4687840">to</span> <span m="4687880">catch</span> <span m="4688110">some</span> <span m="4688610">violations,</span> <span m="4689220">things</span> <span m="4689410">like</span> <span m="4689590">that.</span> </p>
<p><span m="4690410">But</span> <span m="4690530">the</span> <span m="4690610">nice</span> <span m="4690960">thing</span> <span m="4691140">about</span> <span m="4691430">this</span> <span m="4691590">is that it</span> <span m="4691890">works</span> <span m="4692350">with</span> <span m="4692790">legacy</span> <span m="4693240">systems.</span> <span m="4694530">So</span> <span m="4694660">we</span> <span m="4694730">don't</span> <span m="4695100">have to change</span> <span m="4695520">anything</span> <span m="4695820">about</span> <span m="4696110">the</span> <span m="4696190">application</span> <span m="4696680">itself</span> <span m="4697190">runs.</span> <span m="4697680">We just</span> <span m="4698590">have to</span> <span m="4699080">make some fairly</span> <span m="4699460">minor</span> <span m="4699860">changes</span> <span m="4700320">to</span> <span m="4700380">the</span> <span m="4700530">OS</span> <span m="4700830">kernel</span> <span m="4701950">to</span> <span m="4702010">be</span> <span m="4702140">able</span> <span m="4702320">to</span> <span m="4702450">track</span> <span m="4703020">the</span> <span m="4703230">system</span> <span m="4703520">call stuff,</span> <span m="4704520">and then</span> <span m="4705020">things sort</span> <span m="4705220">of</span> <span m="4705340">work.</span> <span m="4706420">It's</span> <span m="4706800">very, very</span> <span m="4707110">nice.</span> <span m="4707420">And</span> <span m="4707570">the</span> <span m="4707720">overhead</span> <span m="4708230">of the</span> <span m="4708320">system</span> <span m="4708760">is</span> <span m="4708860">essentially</span> <span m="4709210">the</span> <span m="4709380">overhead</span> <span m="4710090">of</span> <span m="4710280">running an</span> <span m="4710530">additional</span> <span m="4710910">process,</span> <span m="4711630">which</span> <span m="4711810">is</span> <span m="4711970">fairly</span> <span m="4712300">low</span> <span m="4713150">in a</span> <span m="4713370">modern</span> <span m="4713640">operating</span> <span m="4713990">system.</span> </p>
<p><span m="4715030">This</span> <span m="4715190">is</span> <span m="4715310">just sort</span> <span m="4715440">of</span> <span m="4715530">a</span> <span m="4715580">neat</span> <span m="4715900">way</span> <span m="4716150">to</span> <span m="4716240">think</span> <span m="4716400">about</span> <span m="4716620">how</span> <span m="4717035">to</span> <span m="4717450">do</span> <span m="4717865">some type of</span> <span m="4718470">limited</span> <span m="4720030">taint</span> <span m="4720230">tracking</span> <span m="4720970">without</span> <span m="4721340">doing</span> <span m="4722720">heavyweight</span> <span m="4723120">changes</span> <span m="4723510">to the</span> <span m="4723620">runtime</span> <span m="4724020">without</span> <span m="4724520">requiring</span> <span m="4724780">changes</span> <span m="4725040">from</span> <span m="4725360">the OS--</span> <span m="4725665">or</span> <span m="4725970">sorry,</span> <span m="4726220">from the</span> <span m="4726490">application.</span> </p>
<p><span m="4727040">AUDIENCE:</span> <span m="4727530">Are</span> <span m="4728020">we only</span> <span m="4728510">doing</span> <span m="4729000">parallel</span> <span m="4729490">or</span> <span m="4729980">waiting for each one?</span> <span m="4731940">Are</span> <span m="4732430">we</span> <span m="4732920">running</span> <span m="4733410">both processes</span> <span m="4733900">and then</span> <span m="4734390">after that</span> <span m="4734880">we can just</span> <span m="4735370">check that the</span> <span m="4735860">system calls are the same?</span> <span m="4736350">Like when do we check--</span> </p>
<p><span m="4736840">PROFESSOR:</span> <span m="4737350">Yeah,</span> <span m="4737750">two questions.</span> <span m="4738070">So</span> <span m="4738380">as</span> <span m="4738570">long</span> <span m="4738970">as</span> <span m="4739120">the</span> <span m="4740480">doppelganger</span> <span m="4741360">process</span> <span m="4742680">does</span> <span m="4743060">things</span> <span m="4743500">that</span> <span m="4743880">the OS</span> <span m="4744250">can control</span> <span m="4745070">and</span> <span m="4745240">keep</span> <span m="4745460">on the</span> <span m="4745530">local</span> <span m="4745940">machine,</span> <span m="4746800">you</span> <span m="4746930">can</span> <span m="4747240">imagine</span> <span m="4747570">running</span> <span m="4747880">the</span> <span m="4748190">doppelganger</span> <span m="4748610">process</span> <span m="4748925">and the regular</span> <span m="4749240">one</span> <span m="4749510">forward.</span> <span m="4750120">But</span> <span m="4750220">as</span> <span m="4750460">soon</span> <span m="4750820">as</span> <span m="4751250">the</span> <span m="4751490">doppelganger</span> <span m="4752020">tries</span> <span m="4752140">to</span> <span m="4752650">affect</span> <span m="4753090">external</span> <span m="4753530">state,</span> <span m="4754240">so</span> <span m="4754420">maybe</span> <span m="4754930">the network</span> <span m="4755110">is doing this and that.</span> <span m="4756200">Maybe</span> <span m="4757210">you</span> <span m="4757650">can think</span> <span m="4757860">of some other</span> <span m="4757950">linked sources</span> <span m="4758320">like that.</span> <span m="4758810">Maybe</span> <span m="4759020">there's something</span> <span m="4759270">like</span> <span m="4759630">pipes,</span> <span m="4760180">for</span> <span m="4760630">example,</span> <span m="4761530">that the</span> <span m="4761570">kernel doesn't know</span> <span m="4761780">how</span> <span m="4761950">to</span> <span m="4762160">create</span> <span m="4762450">doppelganger</span> <span m="4762800">state</span> <span m="4763150">for.</span> <span m="4763670">At</span> <span m="4763830">that</span> <span m="4764050">point</span> <span m="4764400">you have</span> <span m="4764480">to stop</span> <span m="4764920">it</span> <span m="4765386">and then</span> <span m="4766590">declare</span> <span m="4766860">success</span> <span m="4767130">or victory,</span> <span m="4767400">basically.</span> <span m="4770930">Any</span> <span m="4771140">other</span> <span m="4771610">questions?</span> <span m="4773370">All</span> <span m="4773490">right,</span> <span m="4773930">well,</span> <span m="4774270">that's the</span> <span m="4774460">end of the</span> <span m="4774840">lecture.</span> <span m="4775220">Have a good</span> <span m="4775330">Thanksgiving.</span> <span m="4775930">See</span> <span m="4776230">you next</span> <span m="4776530">week.</span> </p>
</div>
        <div id="vid_related" itemprop="description" class="tabContent hide">
<h2 class="subhead">Free Downloads</h2>
<h3 class="subsubhead">Video</h3>
<ul>
<li>iTunes U (<a href="https://itunes.apple.com/us/itunes-u/id1017908130">MP4 - 176MB</a>)</li>
<li>Internet Archive (<a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec21_300k.mp4">MP4 - 176MB</a>)</li>
</ul>
<br>
<h3 class="subsubhead">Caption</h3>
<ul>
<li>English-US (<a href="../../../contents/video-lectures/lecture-21-data-tracking/WG5UbMrUiLU.srt">SRT</a>)</li>
</ul>
</div>
    
   </div>  




      					 
        <div class="" id="parent-fieldname-bottom_html_area">
            
            
        </div>
    
               </main><!--Course_inner_media tag close -->
           		</div>
<!--Course_wrapper tag close -->
            </div>
<!--left tag close -->
            <aside id="right">
                <!--Begin Right Portion -->
                    <div>
    



</div>

                	<div>
    



</div>


        <div class="" id="parent-fieldname-rsi_top_html_area">
            
            
        </div>
    

<!-- RSI google ad space-->



<div id="google_ads">    
    <script async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <script type="text/javascript">var googletag = googletag || {}; googletag.cmd = googletag.cmd || [];</script>
    <script type="text/javascript">
googletag.cmd.push(function() {googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_A_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_A_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_B_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_B_DL').addService(googletag.pubads());googletag.defineSlot('/1064917/VIDEO_INDIVIDUAL_SLOT_C_DL', [[300, 250], [300, 300], [180, 200], [180, 150], [160, 600]], 'VIDEO_INDIVIDUAL_SLOT_C_DL').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
 googletag.enableServices();
});</script>
    <script language="javascript" type="text/javascript">
googletag.cmd.push(function() {googletag.pubads().set("TYPE","HOUSE");googletag.pubads().set("DEPARTMENT","6");googletag.pubads().set("CRS_BEG2","85");googletag.pubads().set("CRS_END","8");googletag.pubads().set("SESSION","F");googletag.pubads().set("YEAR","14");})
</script>
    
    <div id="VIDEO_INDIVIDUAL_SLOT_A_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_A_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_B_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_B_DL'); });</script>
    </div>
    <div id="VIDEO_INDIVIDUAL_SLOT_C_DL">
    	<script>googletag.cmd.push(function() { googletag.display('VIDEO_INDIVIDUAL_SLOT_C_DL'); });</script>
    </div>
</div>

<!-- End RSI ads--> 


<div>
    



</div>

            </aside><!--Right div close -->
            <div class="clear"></div>
        </div>
<!--grid tag close -->
      </div>
		
		<footer id="bottom">
			<div id="grid">
				
<div id="portletwrapper-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572" class="portletWrapper kssattr-portlethash-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572">
<div class="portletStaticText portlet-static-site-footer"><div id="footer">
<nav aria-label="Footer">     <nav id="foot-c1" class="grid_2 alpha" aria-labelledby="f-find-courses">       <span class="footer" id="f-find-courses" aria-hidden="true">Find Courses</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/courses/find-by-topic/">Find by Topic</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-number/">Find by Course Number</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-department/">Find by Department</a></li>
    <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights</a></li>
    <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
    <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx &amp; Related OCW Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/mit-open-learning-library/">MIT Open Learning Library</a></li>
    <li><a href="https://ocw.mit.edu/courses/translated-courses/">Translated Courses</a></li>
</ul>
</nav>
<div id="foot-c2" class="grid_2"><nav aria-labelledby="f-for-educators">         <span id="f-for-educators" class="footer" aria-hidden="true">For Educators</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://chalk-radio.simplecast.com/">Chalk Radio Podcast</a></li>
    <li><a href="https://ocw.mit.edu/educator/">OCW Educator Portal </a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights by Department</a></li>
    <li><a href="https://openlearning.mit.edu/campus/digital-innovations/" aria-label="External Link: Residential Digital Innovations">Residential Digital Innovations </a></li>
    <li><a href="https://ocw.mit.edu/high-school/">OCW Highlights for High School</a></li>
    <li><a href="https://ocw.mit.edu/educator/additional-resources/">Additional Resources</a></li>
</ul>
</nav></div>
<nav class="grid_2" id="foot-c3" aria-labelledby="f-donate">       <span id="f-donate" class="footer" aria-hidden="true">Give Now</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
    <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
    <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
    <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
    <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
</ul>
</nav>
<div class="grid_2" id="foot-c4">
<nav aria-labelledby="f-about">         <span id="f-about" class="footer" aria-hidden="true">About</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/about/">About OpenCourseWare</a></li>
    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
    <li><a href="https://ocw.mit.edu/about/newsletter/">Newsletter</a></li>
    <li><a href="https://www.ocw-openmatters.org/">Open Matters Blog</a></li>
</ul>
</nav><!--about-->       <nav aria-labelledby="f-tools">         <span id="f-tools" class="footer" aria-hidden="true">Tools</span>
<ul class="foot-bullet" role="presentation">
    <li><a href="https://ocw.mit.edu/help/">Help &amp; FAQs</a></li>
    <li><a href="https://ocw.mit.edu/about/contactus">Contact Us</a></li>
    <li><a href="https://accessibility.mit.edu/" target="_blank">Accessibility</a></li>
    <li><a href="https://ocw.mit.edu/help/site-map/">Site Map</a></li>
    <li><a href="../../../common/terms/index.htm">Privacy &amp; Terms of Use</a></li>
    <li><a href="https://ocw.mit.edu/help/rss/">RSS Feeds</a></li>
</ul>
</nav><!--tools-->
</div>
</nav> <aside style="min-height: 289px;" aria-labelledby="f-our-corporate-supporters" class="grid_4 omega" id="foot-c5">           <span aria-hidden="true" class="footer" id="f-our-corporate-supporters">Our Corporate Supporters</span>           <!-- HOME_CORP_LOGO_1 -->
<div id="div-gpt-ad-1388181177156-0" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-0'); });
            </script></div>
<!-- HOME_CORP_LOGO_2 -->
<div id="div-gpt-ad-1388181177156-1" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-1'); });
            </script></div>
<!-- HOME_CORP_LOGO_3 -->
<div id="div-gpt-ad-1388181177156-2" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-2'); });
            </script></div>
<!-- HOME_CORP_LOGO_4 -->
<div id="div-gpt-ad-1388181177156-3" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-3'); });
            </script></div>
<!-- HOME_CORP_LOGO_5 -->
<div id="div-gpt-ad-1388181177156-4" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-4'); });
              </script></div>
<!-- HOME_CORP_LOGO_6 -->
<div id="div-gpt-ad-1388181177156-5" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-5'); });
              </script></div>
</aside>
<div class="grid_12 alpha omega" itemprop="publisher" itemscope="" itemtype="http://schema.org/CollegeOrUniversity">
<h4 class="footer" style="border-top: thin solid #d5c9ba; padding-top: 10px; margin-bottom: 10px;">About <span itemprop="name">MIT OpenCourseWare</span>
</h4>
<p style="color: #999; font-size: 1em; line-height: 1.5em; margin-top: 10px;" itemprop="description">MIT OpenCourseWare is an online publication of materials from over 2,500 MIT courses, freely sharing knowledge with learners and educators around the world. <a href="https://ocw.mit.edu/about/">Learn more »</a></p>
</div>
<div id="foot-copy" class="grid_12 alpha omega" style="border-top: none;">
<a href="http://web.mit.edu"><img src="../../../common/images/logo_mit.png" alt="Massachusetts Institute of Technology logo and name." style="width: 195; height: 44;"></a><a href="https://openlearning.mit.edu/"><img src="https://ocw.mit.edu/images/mitol_logo.png" alt="MIT Open Learning logo and name." style="width: 265; height: 50; vertical-align: top; padding-left:30px;"></a><a href="https://www.oeglobal.org/"><img src="https://ocw.mit.edu/images/oeg_logo.gif" alt="Open Education Consortium logo." style="width: 219px; height: 59px; vertical-align: top; padding-left:20px;"></a><a rel="license" itemprop="useRightsUrl" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="../../../common/images/cc_by-nc-sa.png" alt="Creative Commons logo with terms BY-NC-SA." style="width: 126px; height: 44px; margin-right: 0; padding-left: 20px;"></a>
<p class="copyright">© 2001–2018<br>
Massachusetts Institute of Technology</p>
<p style="font-size: 0.9em; margin-bottom: 15px;">Your use of the MIT OpenCourseWare site and materials is subject to our <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license">Creative Commons License</a> and other <a href="../../../common/terms/index.htm" rel="cc:morePermissions">terms of use</a>.</p>
</div>
</div></div>

</div>





                
			</div> <!-- bottom grid end -->
		</footer><!-- footer bottom end -->


   </body>
 </html>
